(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[]]);!function(n){function t(t){for(var r,o,s=t[0],c=t[1],l=t[2],p=0,d=[];p<s.length;p++)o=s[p],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(n[r]=c[r]);for(u&&u(t);d.length;)d.shift()();return a.push.apply(a,l||[]),e()}function e(){for(var n,t=0;t<a.length;t++){for(var e=a[t],r=!0,s=1;s<e.length;s++){var c=e[s];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),n=o(o.s=e[0]))}return n}var r={},i={1:0},a=[];function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.e=function(n){var t=[],e=i[n];if(0!==e)if(e)t.push(e[2]);else{var r=new Promise((function(t,r){e=i[n]=[t,r]}));t.push(e[2]=r);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(n){return o.p+"assets/js/"+({}[n]||n)+"."+{2:"803b0d2b",3:"a34b78c4",4:"5c305dec",5:"2ad0f61b",6:"a7ef5206",7:"5a7ac743",8:"9fb37c50",9:"add552d6",10:"c6698d77",11:"c38f8b8a",12:"627adaa3",13:"f2b6b24a",14:"073a66cc",15:"4fe2673b",16:"01c406f5"}[n]+".js"}(n);var c=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(l);var e=i[n];if(0!==e){if(e){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+n+" failed.\n("+r+": "+a+")",c.name="ChunkLoadError",c.type=r,c.request=a,e[1](c)}i[n]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},o.m=n,o.c=r,o.d=function(n,t,e){o.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:e})},o.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,t){if(1&t&&(n=o(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var r in n)o.d(e,r,function(t){return n[t]}.bind(null,r));return e},o.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(t,"a",t),t},o.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},o.p="/notes/",o.oe=function(n){throw console.error(n),n};var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;a.push([243,0]),e()}([function(n,t){var e=function(n){return n&&n.Math==Math&&n};n.exports=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof global&&global)||function(){return this}()||Function("return this")()},function(n,t,e){var r=e(0),i=e(40).f,a=e(29),o=e(15),s=e(120),c=e(124),l=e(112);n.exports=function(n,t){var e,u,p,d,f,h=n.target,m=n.global,v=n.stat;if(e=m?r:v?r[h]||s(h,{}):(r[h]||{}).prototype)for(u in t){if(d=t[u],p=n.dontCallGetSet?(f=i(e,u))&&f.value:e[u],!l(m?u:h+(v?".":"#")+u,n.forced)&&void 0!==p){if(typeof d==typeof p)continue;c(d,p)}(n.sham||p&&p.sham)&&a(d,"sham",!0),o(e,u,d,n)}}},function(n,t){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n,t,e){var r=e(68),i=Function.prototype,a=i.bind,o=i.call,s=r&&a.bind(o,o);n.exports=r?function(n){return n&&s(n)}:function(n){return n&&function(){return o.apply(n,arguments)}}},function(n,t){n.exports=function(n){return"function"==typeof n}},function(n,t,e){var r=e(127),i=e(15),a=e(271);r||i(Object.prototype,"toString",a,{unsafe:!0})},function(n,t,e){var r=e(0),i=e(53),a=e(9),o=e(89),s=e(54),c=e(161),l=i("wks"),u=r.Symbol,p=u&&u.for,d=c?u:u&&u.withoutSetter||o;n.exports=function(n){if(!a(l,n)||!s&&"string"!=typeof l[n]){var t="Symbol."+n;s&&a(u,n)?l[n]=u[n]:l[n]=c&&p?p(t):d(t)}return l[n]}},function(n,t,e){var r=e(68),i=Function.prototype.call;n.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},function(n,t,e){var r=e(2);n.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(n,t,e){var r=e(3),i=e(16),a=r({}.hasOwnProperty);n.exports=Object.hasOwn||function(n,t){return a(i(n),t)}},function(n,t,e){var r=e(0),i=e(11),a=r.String,o=r.TypeError;n.exports=function(n){if(i(n))return n;throw o(a(n)+" is not an object")}},function(n,t,e){var r=e(4);n.exports=function(n){return"object"==typeof n?null!==n:r(n)}},function(n,t,e){var r=e(0),i=e(86),a=r.String;n.exports=function(n){if("Symbol"===i(n))throw TypeError("Cannot convert a Symbol value to a string");return a(n)}},function(n,t,e){var r=e(0),i=e(8),a=e(163),o=e(162),s=e(10),c=e(91),l=r.TypeError,u=Object.defineProperty,p=Object.getOwnPropertyDescriptor;t.f=i?o?function(n,t,e){if(s(n),t=c(t),s(e),"function"==typeof n&&"prototype"===t&&"value"in e&&"writable"in e&&!e.writable){var r=p(n,t);r&&r.writable&&(n[t]=e.value,e={configurable:"configurable"in e?e.configurable:r.configurable,enumerable:"enumerable"in e?e.enumerable:r.enumerable,writable:!1})}return u(n,t,e)}:u:function(n,t,e){if(s(n),t=c(t),s(e),a)try{return u(n,t,e)}catch(n){}if("get"in e||"set"in e)throw l("Accessors not supported");return"value"in e&&(n[t]=e.value),n}},function(n,t,e){var r=e(0),i=e(4),a=function(n){return i(n)?n:void 0};n.exports=function(n,t){return arguments.length<2?a(r[n]):r[n]&&r[n][t]}},function(n,t,e){var r=e(4),i=e(29),a=e(168),o=e(120);n.exports=function(n,t,e,s){s||(s={});var c=s.enumerable,l=void 0!==s.name?s.name:t;return r(e)&&a(e,l,s),s.global?c?n[t]=e:o(t,e):(s.unsafe?n[t]&&(c=!0):delete n[t],c?n[t]=e:i(n,t,e)),n}},function(n,t,e){var r=e(0),i=e(18),a=r.Object;n.exports=function(n){return a(i(n))}},function(n,t){n.exports=!1},function(n,t,e){var r=e(0).TypeError;n.exports=function(n){if(null==n)throw r("Can't call method on "+n);return n}},function(n,t,e){"use strict";var r=e(1),i=e(102);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},function(n,t,e){var r=e(56);n.exports=function(n){return r(n.length)}},function(n,t,e){var r=e(67),i=e(18);n.exports=function(n){return r(i(n))}},function(n,t,e){"use strict";var r=e(184).charAt,i=e(12),a=e(39),o=e(167),s=a.set,c=a.getterFor("String Iterator");o(String,"String",(function(n){s(this,{type:"String Iterator",string:i(n),index:0})}),(function(){var n,t=c(this),e=t.string,i=t.index;return i>=e.length?{value:void 0,done:!0}:(n=r(e,i),t.index+=n.length,{value:n,done:!1})}))},function(n,t,e){var r=e(15),i=e(280),a=Error.prototype;a.toString!==i&&r(a,"toString",i)},function(n,t,e){var r=e(0),i=e(4),a=e(70),o=r.TypeError;n.exports=function(n){if(i(n))return n;throw o(a(n)+" is not a function")}},function(n,t,e){var r=e(0),i=e(185),a=e(186),o=e(150),s=e(29),c=e(6),l=c("iterator"),u=c("toStringTag"),p=o.values,d=function(n,t){if(n){if(n[l]!==p)try{s(n,l,p)}catch(t){n[l]=p}if(n[u]||s(n,u,t),i[t])for(var e in o)if(n[e]!==o[e])try{s(n,e,o[e])}catch(t){n[e]=o[e]}}};for(var f in i)d(r[f]&&r[f].prototype,f);d(a,"DOMTokenList")},function(n,t,e){"use strict";var r=e(1),i=e(188);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},function(n,t,e){var r=e(0),i=e(185),a=e(186),o=e(188),s=e(29),c=function(n){if(n&&n.forEach!==o)try{s(n,"forEach",o)}catch(t){n.forEach=o}};for(var l in i)i[l]&&c(r[l]&&r[l].prototype);c(a)},function(n,t,e){var r=e(3),i=r({}.toString),a=r("".slice);n.exports=function(n){return a(i(n),8,-1)}},function(n,t,e){var r=e(8),i=e(13),a=e(50);n.exports=r?function(n,t,e){return i.f(n,t,a(1,e))}:function(n,t,e){return n[t]=e,n}},function(n,t){var e=Array.isArray;n.exports=e},function(n,t,e){var r=e(14);n.exports=r("navigator","userAgent")||""},function(n,t,e){var r=e(195),i="object"==typeof self&&self&&self.Object===Object&&self,a=r||i||Function("return this")();n.exports=a},function(n,t,e){"use strict";function r(n,t,e,r,i,a,o,s){var c,l="function"==typeof n?n.options:n;if(t&&(l.render=t,l.staticRenderFns=e,l._compiled=!0),r&&(l.functional=!0),a&&(l._scopeId="data-v-"+a),o?(c=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),i&&i.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(o)},l._ssrRegister=c):i&&(c=s?function(){i.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(n,t){return c.call(t),u(n,t)}}else{var p=l.beforeCreate;l.beforeCreate=p?[].concat(p,c):[c]}return{exports:n,options:l}}e.d(t,"a",(function(){return r}))},function(n,t,e){"use strict";var r=e(1),i=e(63).filter;r({target:"Array",proto:!0,forced:!e(79)("filter")},{filter:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,t,e){var r,i=e(10),a=e(151),o=e(122),s=e(71),c=e(166),l=e(90),u=e(94),p=u("IE_PROTO"),d=function(){},f=function(n){return"<script>"+n+"<\/script>"},h=function(n){n.write(f("")),n.close();var t=n.parentWindow.Object;return n=null,t},m=function(){try{r=new ActiveXObject("htmlfile")}catch(n){}var n,t;m="undefined"!=typeof document?document.domain&&r?h(r):((t=l("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(n=t.contentWindow.document).open(),n.write(f("document.F=Object")),n.close(),n.F):h(r);for(var e=o.length;e--;)delete m.prototype[o[e]];return m()};s[p]=!0,n.exports=Object.create||function(n,t){var e;return null!==n?(d.prototype=i(n),e=new d,d.prototype=null,e[p]=n):e=m(),void 0===t?e:a.f(e,t)}},function(n,t,e){var r=e(3);n.exports=r({}.isPrototypeOf)},function(n,t,e){var r=e(13).f,i=e(9),a=e(6)("toStringTag");n.exports=function(n,t,e){n&&!e&&(n=n.prototype),n&&!i(n,a)&&r(n,a,{configurable:!0,value:t})}},function(n,t,e){var r=e(1),i=e(0),a=e(41),o=e(276),s=i.WebAssembly,c=7!==Error("e",{cause:7}).cause,l=function(n,t){var e={};e[n]=o(n,t,c),r({global:!0,constructor:!0,arity:1,forced:c},e)},u=function(n,t){if(s&&s[n]){var e={};e[n]=o("WebAssembly."+n,t,c),r({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:c},e)}};l("Error",(function(n){return function(t){return a(n,this,arguments)}})),l("EvalError",(function(n){return function(t){return a(n,this,arguments)}})),l("RangeError",(function(n){return function(t){return a(n,this,arguments)}})),l("ReferenceError",(function(n){return function(t){return a(n,this,arguments)}})),l("SyntaxError",(function(n){return function(t){return a(n,this,arguments)}})),l("TypeError",(function(n){return function(t){return a(n,this,arguments)}})),l("URIError",(function(n){return function(t){return a(n,this,arguments)}})),u("CompileError",(function(n){return function(t){return a(n,this,arguments)}})),u("LinkError",(function(n){return function(t){return a(n,this,arguments)}})),u("RuntimeError",(function(n){return function(t){return a(n,this,arguments)}}))},function(n,t,e){var r,i,a,o=e(246),s=e(0),c=e(3),l=e(11),u=e(29),p=e(9),d=e(119),f=e(94),h=e(71),m=s.TypeError,v=s.WeakMap;if(o||d.state){var g=d.state||(d.state=new v),b=c(g.get),y=c(g.has),w=c(g.set);r=function(n,t){if(y(g,n))throw new m("Object already initialized");return t.facade=n,w(g,n,t),t},i=function(n){return b(g,n)||{}},a=function(n){return y(g,n)}}else{var k=f("state");h[k]=!0,r=function(n,t){if(p(n,k))throw new m("Object already initialized");return t.facade=n,u(n,k,t),t},i=function(n){return p(n,k)?n[k]:{}},a=function(n){return p(n,k)}}n.exports={set:r,get:i,has:a,enforce:function(n){return a(n)?i(n):r(n,{})},getterFor:function(n){return function(t){var e;if(!l(t)||(e=i(t)).type!==n)throw m("Incompatible receiver, "+n+" required");return e}}}},function(n,t,e){var r=e(8),i=e(7),a=e(123),o=e(50),s=e(21),c=e(91),l=e(9),u=e(163),p=Object.getOwnPropertyDescriptor;t.f=r?p:function(n,t){if(n=s(n),t=c(t),u)try{return p(n,t)}catch(n){}if(l(n,t))return o(!i(a.f,n,t),n[t])}},function(n,t,e){var r=e(68),i=Function.prototype,a=i.apply,o=i.call;n.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(a):function(){return o.apply(a,arguments)})},function(n,t,e){var r=e(310),i=e(313);n.exports=function(n,t){var e=i(n,t);return r(e)?e:void 0}},function(n,t,e){"use strict";var r=e(1),i=e(0),a=e(51),o=e(98),s=e(11),c=e(93),l=e(20),u=e(21),p=e(58),d=e(6),f=e(79),h=e(75),m=f("slice"),v=d("species"),g=i.Array,b=Math.max;r({target:"Array",proto:!0,forced:!m},{slice:function(n,t){var e,r,i,d=u(this),f=l(d),m=c(n,f),y=c(void 0===t?f:t,f);if(a(d)&&(e=d.constructor,(o(e)&&(e===g||a(e.prototype))||s(e)&&null===(e=e[v]))&&(e=void 0),e===g||void 0===e))return h(d,m,y);for(r=new(void 0===e?g:e)(b(y-m,0)),i=0;m<y;m++,i++)m in d&&p(r,i,d[m]);return r.length=i,r}})},function(n,t,e){"use strict";e.d(t,"e",(function(){return r})),e.d(t,"b",(function(){return a})),e.d(t,"j",(function(){return o})),e.d(t,"g",(function(){return c})),e.d(t,"h",(function(){return l})),e.d(t,"i",(function(){return u})),e.d(t,"c",(function(){return p})),e.d(t,"f",(function(){return d})),e.d(t,"l",(function(){return f})),e.d(t,"m",(function(){return h})),e.d(t,"d",(function(){return v})),e.d(t,"k",(function(){return g})),e.d(t,"n",(function(){return b})),e.d(t,"a",(function(){return w}));e(19),e(46),e(147),e(85),e(145),e(118),e(45),e(26),e(5),e(27),e(34),e(88),e(84),e(160),e(83),e(216),e(23),e(149);var r=/#.*$/,i=/\.(md|html)$/,a=/\/$/,o=/^[a-z]+:/i;function s(n){return decodeURI(n).replace(r,"").replace(i,"")}function c(n){return o.test(n)}function l(n){return/^mailto:/.test(n)}function u(n){return/^tel:/.test(n)}function p(n){if(c(n))return n;if(!n)return"404";var t=n.match(r),e=t?t[0]:"",i=s(n);return a.test(i)?n:i+".html"+e}function d(n,t){var e=n.hash,i=function(n){var t=n&&n.match(r);if(t)return t[0]}(t);return(!i||e===i)&&s(n.path)===s(t)}function f(n,t,e){if(c(t))return{type:"external",path:t};e&&(t=function(n,t,e){var r=n.charAt(0);if("/"===r)return n;if("?"===r||"#"===r)return t+n;var i=t.split("/");e&&i[i.length-1]||i.pop();for(var a=n.replace(/^\//,"").split("/"),o=0;o<a.length;o++){var s=a[o];".."===s?i.pop():"."!==s&&i.push(s)}""!==i[0]&&i.unshift("");return i.join("/")}(t,e));for(var r=s(t),i=0;i<n.length;i++)if(s(n[i].regularPath)===r)return Object.assign({},n[i],{type:"page",path:p(n[i].path)});return console.error('[vuepress] No matching page found for sidebar item "'.concat(t,'"')),{}}function h(n,t,e,r){var i=e.pages,a=e.themeConfig,o=r&&a.locales&&a.locales[r]||a;if("auto"===(n.frontmatter.sidebar||o.sidebar||a.sidebar))return m(n);var s=o.sidebar||a.sidebar;if(s){var c=function(n,t){if(Array.isArray(t))return{base:"/",config:t};for(var e in t)if(0===(r=n,/(\.html|\/)$/.test(r)?r:r+"/").indexOf(encodeURI(e)))return{base:e,config:t[e]};var r;return{}}(t,s),l=c.base,u=c.config;return"auto"===u?m(n):u?u.map((function(n){return function n(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if("string"==typeof t)return f(e,t,r);if(Array.isArray(t))return Object.assign(f(e,t[0],r),{title:t[1]});i>3&&console.error("[vuepress] detected a too deep nested sidebar group.");var a=t.children||[];return 0===a.length&&t.path?Object.assign(f(e,t.path,r),{title:t.title}):{type:"group",path:t.path,title:t.title,sidebarDepth:t.sidebarDepth,initialOpenGroupIndex:t.initialOpenGroupIndex,children:a.map((function(t){return n(t,e,r,i+1)})),collapsable:!1!==t.collapsable}}(n,i,l)})):[]}return[]}function m(n){var t=v(n.headers||[]);return[{type:"group",collapsable:!1,title:n.title,path:null,children:t.map((function(t){return{type:"auto",title:t.title,basePath:n.path,path:n.path+"#"+t.slug,children:t.children||[]}}))}]}function v(n){var t;return(n=n.map((function(n){return Object.assign({},n)}))).forEach((function(n){2===n.level?t=n:t&&(t.children||(t.children=[])).push(n)})),n.filter((function(n){return 2===n.level}))}function g(n){return Object.assign(n,{type:n.items&&n.items.length?"links":"link"})}function b(n){return Object.prototype.toString.call(n).match(/\[object (.*?)\]/)[1].toLowerCase()}function y(n){var t=n.frontmatter.date||n.lastUpdated||new Date,e=new Date(t);return"Invalid Date"==e&&t&&(e=new Date(t.replace(/-/g,"/"))),e.getTime()}function w(n,t){return y(t)-y(n)}},function(n,t,e){"use strict";var r=e(1),i=e(63).map;r({target:"Array",proto:!0,forced:!e(79)("map")},{map:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,t,e){"use strict";var r=e(41),i=e(7),a=e(3),o=e(116),s=e(2),c=e(10),l=e(4),u=e(47),p=e(56),d=e(12),f=e(18),h=e(134),m=e(49),v=e(291),g=e(117),b=e(6)("replace"),y=Math.max,w=Math.min,k=a([].concat),x=a([].push),_=a("".indexOf),S=a("".slice),T="$0"==="a".replace(/./,"$0"),j=!!/./[b]&&""===/./[b]("a","$0");o("replace",(function(n,t,e){var a=j?"$":"$0";return[function(n,e){var r=f(this),a=null==n?void 0:m(n,b);return a?i(a,n,r,e):i(t,d(r),n,e)},function(n,i){var o=c(this),s=d(n);if("string"==typeof i&&-1===_(i,a)&&-1===_(i,"$<")){var f=e(t,o,s,i);if(f.done)return f.value}var m=l(i);m||(i=d(i));var b=o.global;if(b){var T=o.unicode;o.lastIndex=0}for(var j=[];;){var C=g(o,s);if(null===C)break;if(x(j,C),!b)break;""===d(C[0])&&(o.lastIndex=h(s,p(o.lastIndex),T))}for(var I,A="",O=0,E=0;E<j.length;E++){for(var L=d((C=j[E])[0]),z=y(w(u(C.index),s.length),0),M=[],R=1;R<C.length;R++)x(M,void 0===(I=C[R])?I:String(I));var P=C.groups;if(m){var B=k([L],M,z,s);void 0!==P&&x(B,P);var N=d(r(i,void 0,B))}else N=v(L,s,z,M,P,i);z>=O&&(A+=S(s,O,z)+N,O=z+L.length)}return A+S(s,O)}]}),!!s((function(){var n=/./;return n.exec=function(){var n=[];return n.groups={a:"7"},n},"7"!=="".replace(n,"$<a>")}))||!T||j)},function(n,t,e){var r=e(245);n.exports=function(n){var t=+n;return t!=t||0===t?0:r(t)}},function(n,t,e){"use strict";var r=e(2);n.exports=function(n,t){var e=[][n];return!!e&&r((function(){e.call(null,t||function(){return 1},1)}))}},function(n,t,e){var r=e(24);n.exports=function(n,t){var e=n[t];return null==e?void 0:r(e)}},function(n,t){n.exports=function(n,t){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:t}}},function(n,t,e){var r=e(28);n.exports=Array.isArray||function(n){return"Array"==r(n)}},function(n,t){n.exports=function(n){return null!=n&&"object"==typeof n}},function(n,t,e){var r=e(17),i=e(119);(n.exports=function(n,t){return i[n]||(i[n]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.7",mode:r?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.7/LICENSE",source:"https://github.com/zloirock/core-js"})},function(n,t,e){var r=e(55),i=e(2);n.exports=!!Object.getOwnPropertySymbols&&!i((function(){var n=Symbol();return!String(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(n,t,e){var r,i,a=e(0),o=e(31),s=a.process,c=a.Deno,l=s&&s.versions||c&&c.version,u=l&&l.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(i=+r[1]),n.exports=i},function(n,t,e){var r=e(47),i=Math.min;n.exports=function(n){return n>0?i(r(n),9007199254740991):0}},function(n,t,e){var r=e(0);n.exports=r.Promise},function(n,t,e){"use strict";var r=e(91),i=e(13),a=e(50);n.exports=function(n,t,e){var o=r(t);o in n?i.f(n,o,a(0,e)):n[o]=e}},function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));e(65),e(78),e(5),e(100),e(22),e(25),e(272),e(273),e(274),e(275),e(111),e(131),e(38),e(23),e(132),e(26),e(27),e(87),e(133),e(281),e(43);var r=e(60);function i(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
i=function(){return n};var n={},t=Object.prototype,e=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(n,t,e){return Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{l({},"")}catch(n){l=function(n,t,e){return n[t]=e}}function u(n,t,e,r){var i=t&&t.prototype instanceof f?t:f,a=Object.create(i.prototype),o=new T(r||[]);return a._invoke=function(n,t,e){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return C()}for(e.method=i,e.arg=a;;){var o=e.delegate;if(o){var s=x(o,e);if(s){if(s===d)continue;return s}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if("suspendedStart"===r)throw r="completed",e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);r="executing";var c=p(n,t,e);if("normal"===c.type){if(r=e.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(r="completed",e.method="throw",e.arg=c.arg)}}}(n,e,o),a}function p(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}n.wrap=u;var d={};function f(){}function h(){}function m(){}var v={};l(v,o,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(j([])));b&&b!==t&&e.call(b,o)&&(v=b);var y=m.prototype=f.prototype=Object.create(v);function w(n){["next","throw","return"].forEach((function(t){l(n,t,(function(n){return this._invoke(t,n)}))}))}function k(n,t){var i;this._invoke=function(a,o){function s(){return new t((function(i,s){!function i(a,o,s,c){var l=p(n[a],n,o);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==Object(r.a)(d)&&e.call(d,"__await")?t.resolve(d.__await).then((function(n){i("next",n,s,c)}),(function(n){i("throw",n,s,c)})):t.resolve(d).then((function(n){u.value=n,s(u)}),(function(n){return i("throw",n,s,c)}))}c(l.arg)}(a,o,i,s)}))}return i=i?i.then(s,s):s()}}function x(n,t){var e=n.iterator[t.method];if(void 0===e){if(t.delegate=null,"throw"===t.method){if(n.iterator.return&&(t.method="return",t.arg=void 0,x(n,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=p(e,n.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var i=r.arg;return i?i.done?(t[n.resultName]=i.value,t.next=n.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function _(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function S(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function T(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(_,this),this.reset(!0)}function j(n){if(n){var t=n[o];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,i=function t(){for(;++r<n.length;)if(e.call(n,r))return t.value=n[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return h.prototype=m,l(y,"constructor",m),l(m,"constructor",h),h.displayName=l(m,c,"GeneratorFunction"),n.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,m):(n.__proto__=m,l(n,c,"GeneratorFunction")),n.prototype=Object.create(y),n},n.awrap=function(n){return{__await:n}},w(k.prototype),l(k.prototype,s,(function(){return this})),n.AsyncIterator=k,n.async=function(t,e,r,i,a){void 0===a&&(a=Promise);var o=new k(u(t,e,r,i),a);return n.isGeneratorFunction(e)?o:o.next().then((function(n){return n.done?n.value:o.next()}))},w(y),l(y,c,"Generator"),l(y,o,(function(){return this})),l(y,"toString",(function(){return"[object Generator]"})),n.keys=function(n){var t=[];for(var e in n)t.push(e);return t.reverse(),function e(){for(;t.length;){var r=t.pop();if(r in n)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=j,T.prototype={constructor:T,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!n)for(var t in this)"t"===t.charAt(0)&&e.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function r(e,r){return o.type="throw",o.arg=n,t.next=e,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=e.call(a,"catchLoc"),c=e.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(n,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&e.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===n||"continue"===n)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=n,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),d},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===n)return this.complete(e.completion,e.afterLoc),S(e),d}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===n){var r=e.completion;if("throw"===r.type){var i=r.arg;S(e)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(n,t,e){return this.delegate={iterator:j(n),resultName:t,nextLoc:e},"next"===this.method&&(this.arg=void 0),d}},n}},function(n,t,e){"use strict";e.d(t,"a",(function(){return r}));e(65),e(78),e(5),e(100),e(22),e(25);function r(n){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}},function(n,t,e){e(386),e(387)},function(n,t,e){var r=e(3),i=e(24),a=e(68),o=r(r.bind);n.exports=function(n,t){return i(n),void 0===t?n:a?o(n,t):function(){return n.apply(t,arguments)}}},function(n,t,e){var r=e(62),i=e(3),a=e(67),o=e(16),s=e(20),c=e(114),l=i([].push),u=function(n){var t=1==n,e=2==n,i=3==n,u=4==n,p=6==n,d=7==n,f=5==n||p;return function(h,m,v,g){for(var b,y,w=o(h),k=a(w),x=r(m,v),_=s(k),S=0,T=g||c,j=t?T(h,_):e||d?T(h,0):void 0;_>S;S++)if((f||S in k)&&(y=x(b=k[S],S,w),n))if(t)j[S]=y;else if(y)switch(n){case 3:return!0;case 5:return b;case 6:return S;case 2:l(j,b)}else switch(n){case 4:return!1;case 7:l(j,b)}return p?-1:i||u?u:j}};n.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},function(n,t,e){var r=e(165),i=e(122).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(n){return r(n,i)}},function(n,t,e){e(264),e(268),e(269),e(130),e(270)},function(n,t,e){var r=e(80),i=e(295),a=e(296),o=r?r.toStringTag:void 0;n.exports=function(n){return null==n?void 0===n?"[object Undefined]":"[object Null]":o&&o in Object(n)?i(n):a(n)}},function(n,t,e){var r=e(0),i=e(3),a=e(2),o=e(28),s=r.Object,c=i("".split);n.exports=a((function(){return!s("z").propertyIsEnumerable(0)}))?function(n){return"String"==o(n)?c(n,""):s(n)}:s},function(n,t,e){var r=e(2);n.exports=!r((function(){var n=function(){}.bind();return"function"!=typeof n||n.hasOwnProperty("prototype")}))},function(n,t,e){var r=e(0),i=e(14),a=e(4),o=e(36),s=e(161),c=r.Object;n.exports=s?function(n){return"symbol"==typeof n}:function(n){var t=i("Symbol");return a(t)&&o(t.prototype,c(n))}},function(n,t,e){var r=e(0).String;n.exports=function(n){try{return r(n)}catch(n){return"Object"}}},function(n,t){n.exports={}},function(n,t){n.exports={}},function(n,t,e){var r=e(8),i=e(9),a=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,s=i(a,"name"),c=s&&"something"===function(){}.name,l=s&&(!r||r&&o(a,"name").configurable);n.exports={EXISTS:s,PROPER:c,CONFIGURABLE:l}},function(n,t,e){var r=e(3),i=e(10),a=e(247);n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var n,t=!1,e={};try{(n=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(e,[]),t=e instanceof Array}catch(n){}return function(e,r){return i(e),a(r),t?n(e,r):e.__proto__=r,e}}():void 0)},function(n,t,e){var r=e(3);n.exports=r([].slice)},function(n,t,e){var r=e(0),i=e(57),a=e(4),o=e(112),s=e(95),c=e(6),l=e(255),u=e(17),p=e(55),d=i&&i.prototype,f=c("species"),h=!1,m=a(r.PromiseRejectionEvent),v=o("Promise",(function(){var n=s(i),t=n!==String(i);if(!t&&66===p)return!0;if(u&&(!d.catch||!d.finally))return!0;if(p>=51&&/native code/.test(n))return!1;var e=new i((function(n){n(1)})),r=function(n){n((function(){}),(function(){}))};return(e.constructor={})[f]=r,!(h=e.then((function(){}))instanceof r)||!t&&l&&!m}));n.exports={CONSTRUCTOR:v,REJECTION_EVENT:m,SUBCLASSING:h}},function(n,t,e){"use strict";var r=e(24),i=function(n){var t,e;this.promise=new n((function(n,r){if(void 0!==t||void 0!==e)throw TypeError("Bad Promise constructor");t=n,e=r})),this.resolve=r(t),this.reject=r(e)};n.exports.f=function(n){return new i(n)}},function(n,t,e){"use strict";var r=e(1),i=e(8),a=e(0),o=e(3),s=e(9),c=e(4),l=e(36),u=e(12),p=e(13).f,d=e(124),f=a.Symbol,h=f&&f.prototype;if(i&&c(f)&&(!("description"in h)||void 0!==f().description)){var m={},v=function(){var n=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),t=l(h,this)?new f(n):void 0===n?f():f(n);return""===n&&(m[t]=!0),t};d(v,f),v.prototype=h,h.constructor=v;var g="Symbol(test)"==String(f("test")),b=o(h.toString),y=o(h.valueOf),w=/^Symbol\((.*)\)[^)]+$/,k=o("".replace),x=o("".slice);p(h,"description",{configurable:!0,get:function(){var n=y(this),t=b(n);if(s(m,n))return"";var e=g?x(t,7,-1):k(t,w,"$1");return""===e?void 0:e}}),r({global:!0,constructor:!0,forced:!0},{Symbol:v})}},function(n,t,e){var r=e(2),i=e(6),a=e(55),o=i("species");n.exports=function(n){return a>=51||!r((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[n](Boolean).foo}))}},function(n,t,e){var r=e(32).Symbol;n.exports=r},function(n,t,e){"use strict";e.d(t,"a",(function(){return a}));e(88);var r=e(82);e(65),e(78),e(5),e(100),e(22),e(25),e(192);var i=e(108);e(38),e(23);function a(n){return function(n){if(Array.isArray(n))return Object(r.a)(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||Object(i.a)(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(n,t,e){"use strict";function r(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}e.d(t,"a",(function(){return r}))},function(n,t,e){"use strict";var r=e(1),i=e(0),a=e(2),o=e(51),s=e(11),c=e(16),l=e(20),u=e(58),p=e(114),d=e(79),f=e(6),h=e(55),m=f("isConcatSpreadable"),v=i.TypeError,g=h>=51||!a((function(){var n=[];return n[m]=!1,n.concat()[0]!==n})),b=d("concat"),y=function(n){if(!s(n))return!1;var t=n[m];return void 0!==t?!!t:o(n)};r({target:"Array",proto:!0,arity:1,forced:!g||!b},{concat:function(n){var t,e,r,i,a,o=c(this),s=p(o,0),d=0;for(t=-1,r=arguments.length;t<r;t++)if(y(a=-1===t?o:arguments[t])){if(d+(i=l(a))>9007199254740991)throw v("Maximum allowed index exceeded");for(e=0;e<i;e++,d++)e in a&&u(s,d,a[e])}else{if(d>=9007199254740991)throw v("Maximum allowed index exceeded");u(s,d++,a)}return s.length=d,s}})},function(n,t,e){"use strict";var r=e(1),i=e(3),a=e(121).indexOf,o=e(48),s=i([].indexOf),c=!!s&&1/s([1],1,-0)<0,l=o("indexOf");r({target:"Array",proto:!0,forced:c||!l},{indexOf:function(n){var t=arguments.length>1?arguments[1]:void 0;return c?s(this,n,t)||0:a(this,n,t)}})},function(n,t,e){"use strict";e(19);var r,i,a=e(1),o=e(0),s=e(7),c=e(3),l=e(4),u=e(11),p=(r=!1,(i=/[ac]/).exec=function(){return r=!0,/./.exec.apply(this,arguments)},!0===i.test("abc")&&r),d=o.Error,f=c(/./.test);a({target:"RegExp",proto:!0,forced:!p},{test:function(n){var t=this.exec;if(!l(t))return f(this,n);var e=s(t,this,n);if(null!==e&&!u(e))throw new d("RegExp exec method returned something other than an Object or null");return!!e}})},function(n,t,e){var r=e(0),i=e(127),a=e(4),o=e(28),s=e(6)("toStringTag"),c=r.Object,l="Arguments"==o(function(){return arguments}());n.exports=i?o:function(n){var t,e,r;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(e=function(n,t){try{return n[t]}catch(n){}}(t=c(n),s))?e:l?o(t):"Object"==(r=o(t))&&a(t.callee)?"Arguments":r}},function(n,t,e){var r=e(8),i=e(73).EXISTS,a=e(3),o=e(13).f,s=Function.prototype,c=a(s.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=a(l.exec);r&&!i&&o(s,"name",{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(n){return""}}})},function(n,t,e){e(1)({target:"Array",stat:!0},{isArray:e(51)})},function(n,t,e){var r=e(3),i=0,a=Math.random(),o=r(1..toString);n.exports=function(n){return"Symbol("+(void 0===n?"":n)+")_"+o(++i+a,36)}},function(n,t,e){var r=e(0),i=e(11),a=r.document,o=i(a)&&i(a.createElement);n.exports=function(n){return o?a.createElement(n):{}}},function(n,t,e){var r=e(164),i=e(69);n.exports=function(n){var t=r(n,"string");return i(t)?t:t+""}},function(n,t,e){var r=e(165),i=e(122);n.exports=Object.keys||function(n){return r(n,i)}},function(n,t,e){var r=e(47),i=Math.max,a=Math.min;n.exports=function(n,t){var e=r(n);return e<0?i(e+t,0):a(e,t)}},function(n,t,e){var r=e(53),i=e(89),a=r("keys");n.exports=function(n){return a[n]||(a[n]=i(n))}},function(n,t,e){var r=e(3),i=e(4),a=e(119),o=r(Function.toString);i(a.inspectSource)||(a.inspectSource=function(n){return o(n)}),n.exports=a.inspectSource},function(n,t){t.f=Object.getOwnPropertySymbols},function(n,t,e){var r=e(28),i=e(0);n.exports="process"==r(i.process)},function(n,t,e){var r=e(3),i=e(2),a=e(4),o=e(86),s=e(14),c=e(95),l=function(){},u=[],p=s("Reflect","construct"),d=/^\s*(?:class|function)\b/,f=r(d.exec),h=!d.exec(l),m=function(n){if(!a(n))return!1;try{return p(l,u,n),!0}catch(n){return!1}},v=function(n){if(!a(n))return!1;switch(o(n)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!f(d,c(n))}catch(n){return!0}};v.sham=!0,n.exports=!p||i((function(){var n;return m(m.call)||!m(Object)||!m((function(){n=!0}))||n}))?v:m},function(n,t,e){var r=e(265),i=e(9),a=e(182),o=e(13).f;n.exports=function(n){var t=r.Symbol||(r.Symbol={});i(t,n)||o(t,n,{value:a.f(n)})}},function(n,t,e){e(99)("iterator")},function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));e(5);function r(n,t,e,r,i,a,o){try{var s=n[a](o),c=s.value}catch(n){return void e(n)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(n){return function(){var t=this,e=arguments;return new Promise((function(i,a){var o=n.apply(t,e);function s(n){r(o,i,a,s,c,"next",n)}function c(n){r(o,i,a,s,c,"throw",n)}s(void 0)}))}}},function(n,t,e){"use strict";var r,i,a=e(7),o=e(3),s=e(12),c=e(193),l=e(115),u=e(53),p=e(35),d=e(39).get,f=e(228),h=e(234),m=u("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,g=v,b=o("".charAt),y=o("".indexOf),w=o("".replace),k=o("".slice),x=(i=/b*/g,a(v,r=/a/,"a"),a(v,i,"a"),0!==r.lastIndex||0!==i.lastIndex),_=l.BROKEN_CARET,S=void 0!==/()??/.exec("")[1];(x||S||_||f||h)&&(g=function(n){var t,e,r,i,o,l,u,f=this,h=d(f),T=s(n),j=h.raw;if(j)return j.lastIndex=f.lastIndex,t=a(g,j,T),f.lastIndex=j.lastIndex,t;var C=h.groups,I=_&&f.sticky,A=a(c,f),O=f.source,E=0,L=T;if(I&&(A=w(A,"y",""),-1===y(A,"g")&&(A+="g"),L=k(T,f.lastIndex),f.lastIndex>0&&(!f.multiline||f.multiline&&"\n"!==b(T,f.lastIndex-1))&&(O="(?: "+O+")",L=" "+L,E++),e=new RegExp("^(?:"+O+")",A)),S&&(e=new RegExp("^"+O+"$(?!\\s)",A)),x&&(r=f.lastIndex),i=a(v,I?e:f,L),I?i?(i.input=k(i.input,E),i[0]=k(i[0],E),i.index=f.lastIndex,f.lastIndex+=i[0].length):f.lastIndex=0:x&&i&&(f.lastIndex=f.global?i.index+i[0].length:r),S&&i&&i.length>1&&a(m,i[0],e,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&C)for(i.groups=l=p(null),o=0;o<C.length;o++)l[(u=C[o])[0]]=i[u[1]];return i}),n.exports=g},function(n,t,e){var r=e(300),i=e(301),a=e(302),o=e(303),s=e(304);function c(n){var t=-1,e=null==n?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=o,c.prototype.set=s,n.exports=c},function(n,t,e){var r=e(197);n.exports=function(n,t){for(var e=n.length;e--;)if(r(n[e][0],t))return e;return-1}},function(n,t,e){var r=e(42)(Object,"create");n.exports=r},function(n,t,e){var r=e(322);n.exports=function(n,t){var e=n.__data__;return r(t)?e["string"==typeof t?"string":"hash"]:e.map}},function(n,t,e){var r=e(142);n.exports=function(n){if("string"==typeof n||r(n))return n;var t=n+"";return"0"==t&&1/n==-1/0?"-0":t}},function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));e(43),e(5),e(87),e(192),e(22),e(19),e(85);var r=e(82);function i(n,t){if(n){if("string"==typeof n)return Object(r.a)(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Object(r.a)(n,t):void 0}}},function(n,t,e){var r,i;
/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */void 0===(i="function"==typeof(r=function(){var n,t,e={version:"0.2.0"},r=e.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function i(n,t,e){return n<t?t:n>e?e:n}function a(n){return 100*(-1+n)}e.configure=function(n){var t,e;for(t in n)void 0!==(e=n[t])&&n.hasOwnProperty(t)&&(r[t]=e);return this},e.status=null,e.set=function(n){var t=e.isStarted();n=i(n,r.minimum,1),e.status=1===n?null:n;var c=e.render(!t),l=c.querySelector(r.barSelector),u=r.speed,p=r.easing;return c.offsetWidth,o((function(t){""===r.positionUsing&&(r.positionUsing=e.getPositioningCSS()),s(l,function(n,t,e){var i;return(i="translate3d"===r.positionUsing?{transform:"translate3d("+a(n)+"%,0,0)"}:"translate"===r.positionUsing?{transform:"translate("+a(n)+"%,0)"}:{"margin-left":a(n)+"%"}).transition="all "+t+"ms "+e,i}(n,u,p)),1===n?(s(c,{transition:"none",opacity:1}),c.offsetWidth,setTimeout((function(){s(c,{transition:"all "+u+"ms linear",opacity:0}),setTimeout((function(){e.remove(),t()}),u)}),u)):setTimeout(t,u)})),this},e.isStarted=function(){return"number"==typeof e.status},e.start=function(){e.status||e.set(0);var n=function(){setTimeout((function(){e.status&&(e.trickle(),n())}),r.trickleSpeed)};return r.trickle&&n(),this},e.done=function(n){return n||e.status?e.inc(.3+.5*Math.random()).set(1):this},e.inc=function(n){var t=e.status;return t?("number"!=typeof n&&(n=(1-t)*i(Math.random()*t,.1,.95)),t=i(t+n,0,.994),e.set(t)):e.start()},e.trickle=function(){return e.inc(Math.random()*r.trickleRate)},n=0,t=0,e.promise=function(r){return r&&"resolved"!==r.state()?(0===t&&e.start(),n++,t++,r.always((function(){0==--t?(n=0,e.done()):e.set((n-t)/n)})),this):this},e.render=function(n){if(e.isRendered())return document.getElementById("nprogress");l(document.documentElement,"nprogress-busy");var t=document.createElement("div");t.id="nprogress",t.innerHTML=r.template;var i,o=t.querySelector(r.barSelector),c=n?"-100":a(e.status||0),u=document.querySelector(r.parent);return s(o,{transition:"all 0 linear",transform:"translate3d("+c+"%,0,0)"}),r.showSpinner||(i=t.querySelector(r.spinnerSelector))&&d(i),u!=document.body&&l(u,"nprogress-custom-parent"),u.appendChild(t),t},e.remove=function(){u(document.documentElement,"nprogress-busy"),u(document.querySelector(r.parent),"nprogress-custom-parent");var n=document.getElementById("nprogress");n&&d(n)},e.isRendered=function(){return!!document.getElementById("nprogress")},e.getPositioningCSS=function(){var n=document.body.style,t="WebkitTransform"in n?"Webkit":"MozTransform"in n?"Moz":"msTransform"in n?"ms":"OTransform"in n?"O":"";return t+"Perspective"in n?"translate3d":t+"Transform"in n?"translate":"margin"};var o=function(){var n=[];function t(){var e=n.shift();e&&e(t)}return function(e){n.push(e),1==n.length&&t()}}(),s=function(){var n=["Webkit","O","Moz","ms"],t={};function e(e){return e=e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(n,t){return t.toUpperCase()})),t[e]||(t[e]=function(t){var e=document.body.style;if(t in e)return t;for(var r,i=n.length,a=t.charAt(0).toUpperCase()+t.slice(1);i--;)if((r=n[i]+a)in e)return r;return t}(e))}function r(n,t,r){t=e(t),n.style[t]=r}return function(n,t){var e,i,a=arguments;if(2==a.length)for(e in t)void 0!==(i=t[e])&&t.hasOwnProperty(e)&&r(n,e,i);else r(n,a[1],a[2])}}();function c(n,t){return("string"==typeof n?n:p(n)).indexOf(" "+t+" ")>=0}function l(n,t){var e=p(n),r=e+t;c(e,t)||(n.className=r.substring(1))}function u(n,t){var e,r=p(n);c(n,t)&&(e=r.replace(" "+t+" "," "),n.className=e.substring(1,e.length-1))}function p(n){return(" "+(n.className||"")+" ").replace(/\s+/gi," ")}function d(n){n&&n.parentNode&&n.parentNode.removeChild(n)}return e})?r.call(t,e,t,n):r)||(n.exports=i)},function(n,t,e){var r=e(1),i=e(16),a=e(92);r({target:"Object",stat:!0,forced:e(2)((function(){a(1)}))},{keys:function(n){return a(i(n))}})},function(n,t,e){var r=e(1),i=e(8),a=e(13).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==a,sham:!i},{defineProperty:a})},function(n,t,e){var r=e(2),i=e(4),a=/#|\.prototype\./,o=function(n,t){var e=c[s(n)];return e==u||e!=l&&(i(t)?r(t):!!t)},s=o.normalize=function(n){return String(n).replace(a,".").toLowerCase()},c=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";n.exports=o},function(n,t,e){var r=e(86),i=e(49),a=e(72),o=e(6)("iterator");n.exports=function(n){if(null!=n)return i(n,o)||i(n,"@@iterator")||a[r(n)]}},function(n,t,e){var r=e(267);n.exports=function(n,t){return new(r(n))(0===t?0:t)}},function(n,t,e){var r=e(2),i=e(0).RegExp,a=r((function(){var n=i("a","y");return n.lastIndex=2,null!=n.exec("abcd")})),o=a||r((function(){return!i("a","y").sticky})),s=a||r((function(){var n=i("^r","gy");return n.lastIndex=2,null!=n.exec("str")}));n.exports={BROKEN_CARET:s,MISSED_STICKY:o,UNSUPPORTED_Y:a}},function(n,t,e){"use strict";e(19);var r=e(3),i=e(15),a=e(102),o=e(2),s=e(6),c=e(29),l=s("species"),u=RegExp.prototype;n.exports=function(n,t,e,p){var d=s(n),f=!o((function(){var t={};return t[d]=function(){return 7},7!=""[n](t)})),h=f&&!o((function(){var t=!1,e=/a/;return"split"===n&&((e={}).constructor={},e.constructor[l]=function(){return e},e.flags="",e[d]=/./[d]),e.exec=function(){return t=!0,null},e[d](""),!t}));if(!f||!h||e){var m=r(/./[d]),v=t(d,""[n],(function(n,t,e,i,o){var s=r(n),c=t.exec;return c===a||c===u.exec?f&&!o?{done:!0,value:m(t,e,i)}:{done:!0,value:s(e,t,i)}:{done:!1}}));i(String.prototype,n,v[0]),i(u,d,v[1])}p&&c(u[d],"sham",!0)}},function(n,t,e){var r=e(0),i=e(7),a=e(10),o=e(4),s=e(28),c=e(102),l=r.TypeError;n.exports=function(n,t){var e=n.exec;if(o(e)){var r=i(e,n,t);return null!==r&&a(r),r}if("RegExp"===s(n))return i(c,n,t);throw l("RegExp#exec called on incompatible receiver")}},function(n,t,e){"use strict";var r=e(1),i=e(3),a=e(67),o=e(21),s=e(48),c=i([].join),l=a!=Object,u=s("join",",");r({target:"Array",proto:!0,forced:l||!u},{join:function(n){return c(o(this),void 0===n?",":n)}})},function(n,t,e){var r=e(0),i=e(120),a=r["__core-js_shared__"]||i("__core-js_shared__",{});n.exports=a},function(n,t,e){var r=e(0),i=Object.defineProperty;n.exports=function(n,t){try{i(r,n,{value:t,configurable:!0,writable:!0})}catch(e){r[n]=t}return t}},function(n,t,e){var r=e(21),i=e(93),a=e(20),o=function(n){return function(t,e,o){var s,c=r(t),l=a(c),u=i(o,l);if(n&&e!=e){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((n||u in c)&&c[u]===e)return n||u||0;return!n&&-1}};n.exports={includes:o(!0),indexOf:o(!1)}},function(n,t){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(n,t,e){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,a=i&&!r.call({1:2},1);t.f=a?function(n){var t=i(this,n);return!!t&&t.enumerable}:r},function(n,t,e){var r=e(9),i=e(169),a=e(40),o=e(13);n.exports=function(n,t,e){for(var s=i(t),c=o.f,l=a.f,u=0;u<s.length;u++){var p=s[u];r(n,p)||e&&r(e,p)||c(n,p,l(t,p))}}},function(n,t,e){var r=e(0),i=e(9),a=e(4),o=e(16),s=e(94),c=e(171),l=s("IE_PROTO"),u=r.Object,p=u.prototype;n.exports=c?u.getPrototypeOf:function(n){var t=o(n);if(i(t,l))return t[l];var e=t.constructor;return a(e)&&t instanceof e?e.prototype:t instanceof u?p:null}},function(n,t,e){var r=e(10),i=e(172),a=e(6)("species");n.exports=function(n,t){var e,o=r(n).constructor;return void 0===o||null==(e=r(o)[a])?t:i(e)}},function(n,t,e){var r={};r[e(6)("toStringTag")]="z",n.exports="[object z]"===String(r)},function(n,t){n.exports=function(n){try{return{error:!1,value:n()}}catch(n){return{error:!0,value:n}}}},function(n,t,e){var r=e(0),i=e(93),a=e(20),o=e(58),s=r.Array,c=Math.max;n.exports=function(n,t,e){for(var r=a(n),l=i(t,r),u=i(void 0===e?r:e,r),p=s(c(u-l,0)),d=0;l<u;l++,d++)o(p,d,n[l]);return p.length=d,p}},function(n,t,e){var r=e(1),i=e(14),a=e(41),o=e(7),s=e(3),c=e(2),l=e(51),u=e(4),p=e(11),d=e(69),f=e(75),h=e(54),m=i("JSON","stringify"),v=s(/./.exec),g=s("".charAt),b=s("".charCodeAt),y=s("".replace),w=s(1..toString),k=/[\uD800-\uDFFF]/g,x=/^[\uD800-\uDBFF]$/,_=/^[\uDC00-\uDFFF]$/,S=!h||c((function(){var n=i("Symbol")();return"[null]"!=m([n])||"{}"!=m({a:n})||"{}"!=m(Object(n))})),T=c((function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")})),j=function(n,t){var e=f(arguments),r=t;if((p(t)||void 0!==n)&&!d(n))return l(t)||(t=function(n,t){if(u(r)&&(t=o(r,this,n,t)),!d(t))return t}),e[1]=t,a(m,null,e)},C=function(n,t,e){var r=g(e,t-1),i=g(e,t+1);return v(x,n)&&!v(_,i)||v(_,n)&&!v(x,r)?"\\u"+w(b(n,0),16):n};m&&r({target:"JSON",stat:!0,arity:3,forced:S||T},{stringify:function(n,t,e){var r=f(arguments),i=a(S?j:m,null,r);return T&&"string"==typeof i?y(i,k,C):i}})},function(n,t,e){e(1)({target:"Object",stat:!0,sham:!e(8)},{create:e(35)})},function(n,t,e){var r=e(1),i=e(2),a=e(16),o=e(125),s=e(171);r({target:"Object",stat:!0,forced:i((function(){o(1)})),sham:!s},{getPrototypeOf:function(n){return o(a(n))}})},function(n,t,e){e(1)({target:"Object",stat:!0},{setPrototypeOf:e(74)})},function(n,t,e){"use strict";var r=e(184).charAt;n.exports=function(n,t,e){return t+(e?r(n,t).length:1)}},function(n,t,e){var r=e(294),i=e(52),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(n){return i(n)&&o.call(n,"callee")&&!s.call(n,"callee")};n.exports=c},function(n,t,e){var r=e(42)(e(32),"Map");n.exports=r},function(n,t){n.exports=function(n){var t=typeof n;return null!=n&&("object"==t||"function"==t)}},function(n,t,e){var r=e(314),i=e(321),a=e(323),o=e(324),s=e(325);function c(n){var t=-1,e=null==n?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=o,c.prototype.set=s,n.exports=c},function(n,t){n.exports=function(n){var t=-1,e=Array(n.size);return n.forEach((function(n){e[++t]=n})),e}},function(n,t){n.exports=function(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=9007199254740991}},function(n,t,e){var r=e(30),i=e(142),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;n.exports=function(n,t){if(r(n))return!1;var e=typeof n;return!("number"!=e&&"symbol"!=e&&"boolean"!=e&&null!=n&&!i(n))||(o.test(n)||!a.test(n)||null!=t&&n in Object(t))}},function(n,t,e){var r=e(66),i=e(52);n.exports=function(n){return"symbol"==typeof n||i(n)&&"[object Symbol]"==r(n)}},function(n,t){n.exports=function(n){return n}},function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));e(88);e(65),e(78),e(5),e(100),e(22),e(25);var r=e(108);e(38),e(23);function i(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var r,i,a=[],o=!0,s=!1;try{for(e=e.call(n);!(o=(r=e.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(n){s=!0,i=n}finally{try{o||null==e.return||e.return()}finally{if(s)throw i}}return a}}(n,t)||Object(r.a)(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(n,t,e){"use strict";var r=e(41),i=e(7),a=e(3),o=e(116),s=e(155),c=e(10),l=e(18),u=e(126),p=e(134),d=e(56),f=e(12),h=e(49),m=e(129),v=e(117),g=e(102),b=e(115),y=e(2),w=b.UNSUPPORTED_Y,k=Math.min,x=[].push,_=a(/./.exec),S=a(x),T=a("".slice);o("split",(function(n,t,e){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(n,e){var a=f(l(this)),o=void 0===e?4294967295:e>>>0;if(0===o)return[];if(void 0===n)return[a];if(!s(n))return i(t,a,n,o);for(var c,u,p,d=[],h=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(n.sticky?"y":""),v=0,b=new RegExp(n.source,h+"g");(c=i(g,b,a))&&!((u=b.lastIndex)>v&&(S(d,T(a,v,c.index)),c.length>1&&c.index<a.length&&r(x,d,m(c,1)),p=c[0].length,v=u,d.length>=o));)b.lastIndex===c.index&&b.lastIndex++;return v===a.length?!p&&_(b,"")||S(d,""):S(d,T(a,v)),d.length>o?m(d,0,o):d}:"0".split(void 0,0).length?function(n,e){return void 0===n&&0===e?[]:i(t,this,n,e)}:t,[function(t,e){var r=l(this),o=null==t?void 0:h(t,n);return o?i(o,t,r,e):i(a,f(r),t,e)},function(n,r){var i=c(this),o=f(n),s=e(a,i,o,r,a!==t);if(s.done)return s.value;var l=u(i,RegExp),h=i.unicode,m=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(w?"g":"y"),g=new l(w?"^(?:"+i.source+")":i,m),b=void 0===r?4294967295:r>>>0;if(0===b)return[];if(0===o.length)return null===v(g,o)?[o]:[];for(var y=0,x=0,_=[];x<o.length;){g.lastIndex=w?0:x;var j,C=v(g,w?T(o,x):o);if(null===C||(j=k(d(g.lastIndex+(w?x:0)),o.length))===y)x=p(o,x,h);else{if(S(_,T(o,y,x)),_.length===b)return _;for(var I=1;I<=C.length-1;I++)if(S(_,C[I]),_.length===b)return _;x=y=j}}return S(_,T(o,y)),_}]}),!!y((function(){var n=/(?:)/,t=n.exec;n.exec=function(){return t.apply(this,arguments)};var e="ab".split(n);return 2!==e.length||"a"!==e[0]||"b"!==e[1]})),w)},function(n,t,e){"use strict";var r=e(1),i=e(63).some;r({target:"Array",proto:!0,forced:!e(48)("some")},{some:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,t,e){"use strict";var r=e(7),i=e(116),a=e(10),o=e(56),s=e(12),c=e(18),l=e(49),u=e(134),p=e(117);i("match",(function(n,t,e){return[function(t){var e=c(this),i=null==t?void 0:l(t,n);return i?r(i,t,e):new RegExp(t)[n](s(e))},function(n){var r=a(this),i=s(n),c=e(t,r,i);if(c.done)return c.value;if(!r.global)return p(r,i);var l=r.unicode;r.lastIndex=0;for(var d,f=[],h=0;null!==(d=p(r,i));){var m=s(d[0]);f[h]=m,""===m&&(r.lastIndex=u(i,o(r.lastIndex),l)),h++}return 0===h?null:f}]}))},function(n,t,e){var r=e(6),i=e(35),a=e(13).f,o=r("unscopables"),s=Array.prototype;null==s[o]&&a(s,o,{configurable:!0,value:i(null)}),n.exports=function(n){s[o][n]=!0}},function(n,t,e){"use strict";var r=e(73).PROPER,i=e(15),a=e(10),o=e(12),s=e(2),c=e(239),l=RegExp.prototype.toString,u=s((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),p=r&&"toString"!=l.name;(u||p)&&i(RegExp.prototype,"toString",(function(){var n=a(this);return"/"+o(n.source)+"/"+o(c(n))}),{unsafe:!0})},function(n,t,e){"use strict";var r=e(21),i=e(148),a=e(72),o=e(39),s=e(13).f,c=e(167),l=e(17),u=e(8),p=o.set,d=o.getterFor("Array Iterator");n.exports=c(Array,"Array",(function(n,t){p(this,{type:"Array Iterator",target:r(n),index:0,kind:t})}),(function(){var n=d(this),t=n.target,e=n.kind,r=n.index++;return!t||r>=t.length?(n.target=void 0,{value:void 0,done:!0}):"keys"==e?{value:r,done:!1}:"values"==e?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var f=a.Arguments=a.Array;if(i("keys"),i("values"),i("entries"),!l&&u&&"values"!==f.name)try{s(f,"name",{value:"values"})}catch(n){}},function(n,t,e){var r=e(8),i=e(162),a=e(13),o=e(10),s=e(21),c=e(92);t.f=r&&!i?Object.defineProperties:function(n,t){o(n);for(var e,r=s(t),i=c(t),l=i.length,u=0;l>u;)a.f(n,e=i[u++],r[e]);return n}},function(n,t,e){var r=e(0).TypeError;n.exports=function(n,t){if(n<t)throw r("Not enough arguments");return n}},function(n,t,e){var r=e(0),i=e(7),a=e(24),o=e(10),s=e(70),c=e(113),l=r.TypeError;n.exports=function(n,t){var e=arguments.length<2?c(n):t;if(a(e))return o(i(e,n));throw l(s(n)+" is not iterable")}},function(n,t,e){var r=e(4),i=e(11),a=e(74);n.exports=function(n,t,e){var o,s;return a&&r(o=t.constructor)&&o!==e&&i(s=o.prototype)&&s!==e.prototype&&a(n,s),n}},function(n,t,e){var r=e(11),i=e(28),a=e(6)("match");n.exports=function(n){var t;return r(n)&&(void 0!==(t=n[a])?!!t:"RegExp"==i(n))}},function(n,t){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,t){var e=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,s="object"==typeof global&&global&&global.Object===Object&&global,c="object"==typeof self&&self&&self.Object===Object&&self,l=s||c||Function("return this")(),u=Object.prototype.toString,p=Math.max,d=Math.min,f=function(){return l.Date.now()};function h(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function m(n){if("number"==typeof n)return n;if(function(n){return"symbol"==typeof n||function(n){return!!n&&"object"==typeof n}(n)&&"[object Symbol]"==u.call(n)}(n))return NaN;if(h(n)){var t="function"==typeof n.valueOf?n.valueOf():n;n=h(t)?t+"":t}if("string"!=typeof n)return 0===n?n:+n;n=n.replace(e,"");var s=i.test(n);return s||a.test(n)?o(n.slice(2),s?2:8):r.test(n)?NaN:+n}n.exports=function(n,t,e){var r,i,a,o,s,c,l=0,u=!1,v=!1,g=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function b(t){var e=r,a=i;return r=i=void 0,l=t,o=n.apply(a,e)}function y(n){return l=n,s=setTimeout(k,t),u?b(n):o}function w(n){var e=n-c;return void 0===c||e>=t||e<0||v&&n-l>=a}function k(){var n=f();if(w(n))return x(n);s=setTimeout(k,function(n){var e=t-(n-c);return v?d(e,a-(n-l)):e}(n))}function x(n){return s=void 0,g&&r?b(n):(r=i=void 0,o)}function _(){var n=f(),e=w(n);if(r=arguments,i=this,c=n,e){if(void 0===s)return y(c);if(v)return s=setTimeout(k,t),b(c)}return void 0===s&&(s=setTimeout(k,t)),o}return t=m(t)||0,h(e)&&(u=!!e.leading,a=(v="maxWait"in e)?p(m(e.maxWait)||0,t):a,g="trailing"in e?!!e.trailing:g),_.cancel=function(){void 0!==s&&clearTimeout(s),l=0,r=c=i=s=void 0},_.flush=function(){return void 0===s?o:x(f())},_}},function(n,t,e){var r=e(3),i=e(18),a=e(12),o=e(159),s=r("".replace),c="["+o+"]",l=RegExp("^"+c+c+"*"),u=RegExp(c+c+"*$"),p=function(n){return function(t){var e=a(i(t));return 1&n&&(e=s(e,l,"")),2&n&&(e=s(e,u,"")),e}};n.exports={start:p(1),end:p(2),trim:p(3)}},function(n,t){n.exports="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff"},function(n,t,e){var r=e(3),i=e(15),a=Date.prototype,o=r(a.toString),s=r(a.getTime);"Invalid Date"!=String(new Date(NaN))&&i(a,"toString",(function(){var n=s(this);return n==n?o(this):"Invalid Date"}))},function(n,t,e){var r=e(54);n.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(n,t,e){var r=e(8),i=e(2);n.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(n,t,e){var r=e(8),i=e(2),a=e(90);n.exports=!r&&!i((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},function(n,t,e){var r=e(0),i=e(7),a=e(11),o=e(69),s=e(49),c=e(244),l=e(6),u=r.TypeError,p=l("toPrimitive");n.exports=function(n,t){if(!a(n)||o(n))return n;var e,r=s(n,p);if(r){if(void 0===t&&(t="default"),e=i(r,n,t),!a(e)||o(e))return e;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(n,t)}},function(n,t,e){var r=e(3),i=e(9),a=e(21),o=e(121).indexOf,s=e(71),c=r([].push);n.exports=function(n,t){var e,r=a(n),l=0,u=[];for(e in r)!i(s,e)&&i(r,e)&&c(u,e);for(;t.length>l;)i(r,e=t[l++])&&(~o(u,e)||c(u,e));return u}},function(n,t,e){var r=e(14);n.exports=r("document","documentElement")},function(n,t,e){"use strict";var r=e(1),i=e(7),a=e(17),o=e(73),s=e(4),c=e(229),l=e(125),u=e(74),p=e(37),d=e(29),f=e(15),h=e(6),m=e(72),v=e(170),g=o.PROPER,b=o.CONFIGURABLE,y=v.IteratorPrototype,w=v.BUGGY_SAFARI_ITERATORS,k=h("iterator"),x=function(){return this};n.exports=function(n,t,e,o,h,v,_){c(e,t,o);var S,T,j,C=function(n){if(n===h&&L)return L;if(!w&&n in O)return O[n];switch(n){case"keys":case"values":case"entries":return function(){return new e(this,n)}}return function(){return new e(this)}},I=t+" Iterator",A=!1,O=n.prototype,E=O[k]||O["@@iterator"]||h&&O[h],L=!w&&E||C(h),z="Array"==t&&O.entries||E;if(z&&(S=l(z.call(new n)))!==Object.prototype&&S.next&&(a||l(S)===y||(u?u(S,y):s(S[k])||f(S,k,x)),p(S,I,!0,!0),a&&(m[I]=x)),g&&"values"==h&&E&&"values"!==E.name&&(!a&&b?d(O,"name","values"):(A=!0,L=function(){return i(E,this)})),h)if(T={values:C("values"),keys:v?L:C("keys"),entries:C("entries")},_)for(j in T)(w||A||!(j in O))&&f(O,j,T[j]);else r({target:t,proto:!0,forced:w||A},T);return a&&!_||O[k]===L||f(O,k,L,{name:h}),m[t]=L,T}},function(n,t,e){var r=e(2),i=e(4),a=e(9),o=e(8),s=e(73).CONFIGURABLE,c=e(95),l=e(39),u=l.enforce,p=l.get,d=Object.defineProperty,f=o&&!r((function(){return 8!==d((function(){}),"length",{value:8}).length})),h=String(String).split("String"),m=n.exports=function(n,t,e){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!a(n,"name")||s&&n.name!==t)&&d(n,"name",{value:t,configurable:!0}),f&&e&&a(e,"arity")&&n.length!==e.arity&&d(n,"length",{value:e.arity});try{e&&a(e,"constructor")&&e.constructor?o&&d(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch(n){}var r=u(n);return a(r,"source")||(r.source=h.join("string"==typeof t?t:"")),n};Function.prototype.toString=m((function(){return i(this)&&p(this).source||c(this)}),"toString")},function(n,t,e){var r=e(14),i=e(3),a=e(64),o=e(96),s=e(10),c=i([].concat);n.exports=r("Reflect","ownKeys")||function(n){var t=a.f(s(n)),e=o.f;return e?c(t,e(n)):t}},function(n,t,e){"use strict";var r,i,a,o=e(2),s=e(4),c=e(35),l=e(125),u=e(15),p=e(6),d=e(17),f=p("iterator"),h=!1;[].keys&&("next"in(a=[].keys())?(i=l(l(a)))!==Object.prototype&&(r=i):h=!0),null==r||o((function(){var n={};return r[f].call(n)!==n}))?r={}:d&&(r=c(r)),s(r[f])||u(r,f,(function(){return this})),n.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},function(n,t,e){var r=e(2);n.exports=!r((function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype}))},function(n,t,e){var r=e(0),i=e(98),a=e(70),o=r.TypeError;n.exports=function(n){if(i(n))return n;throw o(a(n)+" is not a constructor")}},function(n,t,e){var r,i,a,o,s=e(0),c=e(41),l=e(62),u=e(4),p=e(9),d=e(2),f=e(166),h=e(75),m=e(90),v=e(152),g=e(174),b=e(97),y=s.setImmediate,w=s.clearImmediate,k=s.process,x=s.Dispatch,_=s.Function,S=s.MessageChannel,T=s.String,j=0,C={};try{r=s.location}catch(n){}var I=function(n){if(p(C,n)){var t=C[n];delete C[n],t()}},A=function(n){return function(){I(n)}},O=function(n){I(n.data)},E=function(n){s.postMessage(T(n),r.protocol+"//"+r.host)};y&&w||(y=function(n){v(arguments.length,1);var t=u(n)?n:_(n),e=h(arguments,1);return C[++j]=function(){c(t,void 0,e)},i(j),j},w=function(n){delete C[n]},b?i=function(n){k.nextTick(A(n))}:x&&x.now?i=function(n){x.now(A(n))}:S&&!g?(o=(a=new S).port2,a.port1.onmessage=O,i=l(o.postMessage,o)):s.addEventListener&&u(s.postMessage)&&!s.importScripts&&r&&"file:"!==r.protocol&&!d(E)?(i=E,s.addEventListener("message",O,!1)):i="onreadystatechange"in m("script")?function(n){f.appendChild(m("script")).onreadystatechange=function(){f.removeChild(this),I(n)}}:function(n){setTimeout(A(n),0)}),n.exports={set:y,clear:w}},function(n,t,e){var r=e(31);n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},function(n,t,e){var r=e(0),i=e(62),a=e(7),o=e(10),s=e(70),c=e(176),l=e(20),u=e(36),p=e(153),d=e(113),f=e(177),h=r.TypeError,m=function(n,t){this.stopped=n,this.result=t},v=m.prototype;n.exports=function(n,t,e){var r,g,b,y,w,k,x,_=e&&e.that,S=!(!e||!e.AS_ENTRIES),T=!(!e||!e.IS_ITERATOR),j=!(!e||!e.INTERRUPTED),C=i(t,_),I=function(n){return r&&f(r,"normal",n),new m(!0,n)},A=function(n){return S?(o(n),j?C(n[0],n[1],I):C(n[0],n[1])):j?C(n,I):C(n)};if(T)r=n;else{if(!(g=d(n)))throw h(s(n)+" is not iterable");if(c(g)){for(b=0,y=l(n);y>b;b++)if((w=A(n[b]))&&u(v,w))return w;return new m(!1)}r=p(n,g)}for(k=r.next;!(x=a(k,r)).done;){try{w=A(x.value)}catch(n){f(r,"throw",n)}if("object"==typeof w&&w&&u(v,w))return w}return new m(!1)}},function(n,t,e){var r=e(6),i=e(72),a=r("iterator"),o=Array.prototype;n.exports=function(n){return void 0!==n&&(i.Array===n||o[a]===n)}},function(n,t,e){var r=e(7),i=e(10),a=e(49);n.exports=function(n,t,e){var o,s;i(n);try{if(!(o=a(n,"return"))){if("throw"===t)throw e;return e}o=r(o,n)}catch(n){s=!0,o=n}if("throw"===t)throw e;if(s)throw o;return i(o),e}},function(n,t,e){var r=e(57),i=e(179),a=e(76).CONSTRUCTOR;n.exports=a||!i((function(n){r.all(n).then(void 0,(function(){}))}))},function(n,t,e){var r=e(6)("iterator"),i=!1;try{var a=0,o={next:function(){return{done:!!a++}},return:function(){i=!0}};o[r]=function(){return this},Array.from(o,(function(){throw 2}))}catch(n){}n.exports=function(n,t){if(!t&&!i)return!1;var e=!1;try{var a={};a[r]=function(){return{next:function(){return{done:e=!0}}}},n(a)}catch(n){}return e}},function(n,t,e){var r=e(10),i=e(11),a=e(77);n.exports=function(n,t){if(r(n),i(t)&&t.constructor===n)return t;var e=a.f(n);return(0,e.resolve)(t),e.promise}},function(n,t,e){var r=e(28),i=e(21),a=e(64).f,o=e(129),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(n){return s&&"Window"==r(n)?function(n){try{return a(n)}catch(n){return o(s)}}(n):a(i(n))}},function(n,t,e){var r=e(6);t.f=r},function(n,t,e){var r=e(54);n.exports=r&&!!Symbol.for&&!!Symbol.keyFor},function(n,t,e){var r=e(3),i=e(47),a=e(12),o=e(18),s=r("".charAt),c=r("".charCodeAt),l=r("".slice),u=function(n){return function(t,e){var r,u,p=a(o(t)),d=i(e),f=p.length;return d<0||d>=f?n?"":void 0:(r=c(p,d))<55296||r>56319||d+1===f||(u=c(p,d+1))<56320||u>57343?n?s(p,d):r:n?l(p,d,d+2):u-56320+(r-55296<<10)+65536}};n.exports={codeAt:u(!1),charAt:u(!0)}},function(n,t){n.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(n,t,e){var r=e(90)("span").classList,i=r&&r.constructor&&r.constructor.prototype;n.exports=i===Object.prototype?void 0:i},function(n,t,e){var r=e(12);n.exports=function(n,t){return void 0===n?arguments.length<2?"":t:r(n)}},function(n,t,e){"use strict";var r=e(63).forEach,i=e(48)("forEach");n.exports=i?[].forEach:function(n){return r(this,n,arguments.length>1?arguments[1]:void 0)}},function(n,t,e){var r=e(0),i=e(155),a=r.TypeError;n.exports=function(n){if(i(n))throw a("The method doesn't accept regular expressions");return n}},function(n,t,e){var r=e(6)("match");n.exports=function(n){var t=/./;try{"/./"[n](t)}catch(e){try{return t[r]=!1,"/./"[n](t)}catch(n){}}return!1}},function(n,t,e){var r=e(2);n.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(n,t,e){var r=e(1),i=e(289);r({target:"Array",stat:!0,forced:!e(179)((function(n){Array.from(n)}))},{from:i})},function(n,t,e){"use strict";var r=e(10);n.exports=function(){var n=r(this),t="";return n.hasIndices&&(t+="d"),n.global&&(t+="g"),n.ignoreCase&&(t+="i"),n.multiline&&(t+="m"),n.dotAll&&(t+="s"),n.unicode&&(t+="u"),n.sticky&&(t+="y"),t}},function(n,t){n.exports=function(n,t){for(var e=-1,r=t.length,i=n.length;++e<r;)n[i+e]=t[e];return n}},function(n,t){var e="object"==typeof global&&global&&global.Object===Object&&global;n.exports=e},function(n,t,e){var r=e(103),i=e(305),a=e(306),o=e(307),s=e(308),c=e(309);function l(n){var t=this.__data__=new r(n);this.size=t.size}l.prototype.clear=i,l.prototype.delete=a,l.prototype.get=o,l.prototype.has=s,l.prototype.set=c,n.exports=l},function(n,t){n.exports=function(n,t){return n===t||n!=n&&t!=t}},function(n,t,e){var r=e(66),i=e(137);n.exports=function(n){if(!i(n))return!1;var t=r(n);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(n,t){var e=Function.prototype.toString;n.exports=function(n){if(null!=n){try{return e.call(n)}catch(n){}try{return n+""}catch(n){}}return""}},function(n,t,e){var r=e(326),i=e(52);n.exports=function n(t,e,a,o,s){return t===e||(null==t||null==e||!i(t)&&!i(e)?t!=t&&e!=e:r(t,e,a,o,n,s))}},function(n,t,e){var r=e(202),i=e(329),a=e(203);n.exports=function(n,t,e,o,s,c){var l=1&e,u=n.length,p=t.length;if(u!=p&&!(l&&p>u))return!1;var d=c.get(n),f=c.get(t);if(d&&f)return d==t&&f==n;var h=-1,m=!0,v=2&e?new r:void 0;for(c.set(n,t),c.set(t,n);++h<u;){var g=n[h],b=t[h];if(o)var y=l?o(b,g,h,t,n,c):o(g,b,h,n,t,c);if(void 0!==y){if(y)continue;m=!1;break}if(v){if(!i(t,(function(n,t){if(!a(v,t)&&(g===n||s(g,n,e,o,c)))return v.push(t)}))){m=!1;break}}else if(g!==b&&!s(g,b,e,o,c)){m=!1;break}}return c.delete(n),c.delete(t),m}},function(n,t,e){var r=e(138),i=e(327),a=e(328);function o(n){var t=-1,e=null==n?0:n.length;for(this.__data__=new r;++t<e;)this.add(n[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,n.exports=o},function(n,t){n.exports=function(n,t){return n.has(t)}},function(n,t,e){var r=e(339),i=e(345),a=e(208);n.exports=function(n){return a(n)?r(n):i(n)}},function(n,t,e){(function(n){var r=e(32),i=e(341),a=t&&!t.nodeType&&t,o=a&&"object"==typeof n&&n&&!n.nodeType&&n,s=o&&o.exports===a?r.Buffer:void 0,c=(s?s.isBuffer:void 0)||i;n.exports=c}).call(this,e(156)(n))},function(n,t){var e=/^(?:0|[1-9]\d*)$/;n.exports=function(n,t){var r=typeof n;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&e.test(n))&&n>-1&&n%1==0&&n<t}},function(n,t,e){var r=e(342),i=e(343),a=e(344),o=a&&a.isTypedArray,s=o?i(o):r;n.exports=s},function(n,t,e){var r=e(198),i=e(140);n.exports=function(n){return null!=n&&i(n.length)&&!r(n)}},function(n,t,e){var r=e(42)(e(32),"Set");n.exports=r},function(n,t,e){var r=e(137);n.exports=function(n){return n==n&&!r(n)}},function(n,t){n.exports=function(n,t){return function(e){return null!=e&&(e[n]===t&&(void 0!==t||n in Object(e)))}}},function(n,t,e){var r=e(213),i=e(107);n.exports=function(n,t){for(var e=0,a=(t=r(t,n)).length;null!=n&&e<a;)n=n[i(t[e++])];return e&&e==a?n:void 0}},function(n,t,e){var r=e(30),i=e(141),a=e(356),o=e(359);n.exports=function(n,t){return r(n)?n:i(n,t)?[n]:a(o(n))}},function(n,t,e){var r=e(0),i=e(41),a=e(4),o=e(31),s=e(75),c=e(152),l=/MSIE .\./.test(o),u=r.Function,p=function(n){return l?function(t,e){var r=c(arguments.length,1)>2,o=a(t)?t:u(t),l=r?s(arguments,2):void 0;return n(r?function(){i(o,this,l)}:o,e)}:n};n.exports={setTimeout:p(r.setTimeout),setInterval:p(r.setInterval)}},function(n,t,e){"use strict";var r=e(0),i=e(3),a=e(24),o=e(11),s=e(9),c=e(75),l=e(68),u=r.Function,p=i([].concat),d=i([].join),f={},h=function(n,t,e){if(!s(f,t)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";f[t]=u("C,a","return new C("+d(r,",")+")")}return f[t](n,e)};n.exports=l?u.bind:function(n){var t=a(this),e=t.prototype,r=c(arguments,1),i=function(){var e=p(r,c(arguments));return this instanceof i?h(t,e.length,e):t.apply(n,e)};return o(e)&&(i.prototype=e),i}},function(n,t,e){"use strict";var r=e(1),i=e(393).start;r({target:"String",proto:!0,forced:e(395)},{padStart:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}})},function(n,t,e){},function(n,t,e){},function(n,t,e){var r=e(1),i=e(14),a=e(41),o=e(215),s=e(172),c=e(10),l=e(11),u=e(35),p=e(2),d=i("Reflect","construct"),f=Object.prototype,h=[].push,m=p((function(){function n(){}return!(d((function(){}),[],n)instanceof n)})),v=!p((function(){d((function(){}))})),g=m||v;r({target:"Reflect",stat:!0,forced:g,sham:g},{construct:function(n,t){s(n),c(t);var e=arguments.length<3?n:s(arguments[2]);if(v&&!m)return d(n,t,e);if(n==e){switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3])}var r=[null];return a(h,r,t),new(a(o,n,r))}var i=e.prototype,p=u(l(i)?i:f),g=a(n,p,t);return l(g)?g:p}})},function(n,t,e){var r=e(1),i=e(0),a=e(37);r({global:!0},{Reflect:{}}),a(i.Reflect,"Reflect",!0)},function(n,t,e){},function(n,t,e){},function(n,t,e){var r=e(292),i=e(297),a=e(368),o=e(376),s=e(385),c=e(237),l=a((function(n){var t=c(n);return s(t)&&(t=void 0),o(r(n,1,s,!0),i(t,2))}));n.exports=l},function(n,t,e){"use strict";
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var r=/["'&<>]/;n.exports=function(n){var t,e=""+n,i=r.exec(e);if(!i)return e;var a="",o=0,s=0;for(o=i.index;o<e.length;o++){switch(e.charCodeAt(o)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}s!==o&&(a+=e.substring(s,o)),s=o+1,a+=t}return s!==o?a+e.substring(s,o):a}},function(n,t,e){"use strict";e.r(t);var r={name:"CodeBlock",props:{title:{type:String,required:!0},active:{type:Boolean,default:!1}}},i=(e(396),e(33)),a=Object(i.a)(r,(function(){var n=this.$createElement;return(this._self._c||n)("div",{staticClass:"theme-code-block",class:{"theme-code-block__active":this.active}},[this._t("default")],2)}),[],!1,null,"4f1e9d0c",null);t.default=a.exports},function(n,t,e){"use strict";e.r(t);e(26),e(5),e(27),e(45),e(34);var r={name:"CodeGroup",data:function(){return{codeTabs:[],activeCodeTabIndex:-1}},watch:{activeCodeTabIndex:function(n){this.codeTabs.forEach((function(n){n.elm.classList.remove("theme-code-block__active")})),this.codeTabs[n].elm.classList.add("theme-code-block__active")}},mounted:function(){var n=this;this.codeTabs=(this.$slots.default||[]).filter((function(n){return Boolean(n.componentOptions)})).map((function(t,e){return""===t.componentOptions.propsData.active&&(n.activeCodeTabIndex=e),{title:t.componentOptions.propsData.title,elm:t.elm}})),-1===this.activeCodeTabIndex&&this.codeTabs.length>0&&(this.activeCodeTabIndex=0)},methods:{changeCodeTab:function(n){this.activeCodeTabIndex=n}}},i=(e(397),e(33)),a=Object(i.a)(r,(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"theme-code-group"},[e("div",{staticClass:"theme-code-group__nav"},[e("ul",{staticClass:"theme-code-group__ul"},n._l(n.codeTabs,(function(t,r){return e("li",{key:t.title,staticClass:"theme-code-group__li"},[e("button",{staticClass:"theme-code-group__nav-tab",class:{"theme-code-group__nav-tab-active":r===n.activeCodeTabIndex},on:{click:function(t){return n.changeCodeTab(r)}}},[n._v("\n            "+n._s(t.title)+"\n          ")])])})),0)]),n._v(" "),n._t("default"),n._v(" "),n.codeTabs.length<1?e("pre",{staticClass:"pre-blank"},[n._v("// Make sure to add code blocks to your code group")]):n._e()],2)}),[],!1,null,"2f5f1757",null);t.default=a.exports},function(n,t,e){"use strict";var r=e(8),i=e(0),a=e(3),o=e(112),s=e(15),c=e(9),l=e(154),u=e(36),p=e(69),d=e(164),f=e(2),h=e(64).f,m=e(40).f,v=e(13).f,g=e(392),b=e(158).trim,y=i.Number,w=y.prototype,k=i.TypeError,x=a("".slice),_=a("".charCodeAt),S=function(n){var t=d(n,"number");return"bigint"==typeof t?t:T(t)},T=function(n){var t,e,r,i,a,o,s,c,l=d(n,"number");if(p(l))throw k("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=b(l),43===(t=_(l,0))||45===t){if(88===(e=_(l,2))||120===e)return NaN}else if(48===t){switch(_(l,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+l}for(o=(a=x(l,2)).length,s=0;s<o;s++)if((c=_(a,s))<48||c>i)return NaN;return parseInt(a,r)}return+l};if(o("Number",!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var j,C=function(n){var t=arguments.length<1?0:y(S(n)),e=this;return u(w,e)&&f((function(){g(e)}))?l(Object(t),e,C):t},I=r?h(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),A=0;I.length>A;A++)c(y,j=I[A])&&!c(C,j)&&v(C,j,m(y,j));C.prototype=w,w.constructor=C,s(i,"Number",C,{constructor:!0})}},function(n,t,e){var r=e(2),i=e(0).RegExp;n.exports=r((function(){var n=i(".","s");return!(n.dotAll&&n.exec("\n")&&"s"===n.flags)}))},function(n,t,e){"use strict";var r=e(170).IteratorPrototype,i=e(35),a=e(50),o=e(37),s=e(72),c=function(){return this};n.exports=function(n,t,e,l){var u=t+" Iterator";return n.prototype=i(r,{next:a(+!l,e)}),o(n,u,!1,!0),s[u]=c,n}},function(n,t,e){"use strict";var r=e(14),i=e(13),a=e(6),o=e(8),s=a("species");n.exports=function(n){var t=r(n),e=i.f;o&&t&&!t[s]&&e(t,s,{configurable:!0,get:function(){return this}})}},function(n,t,e){var r=e(0),i=e(36),a=r.TypeError;n.exports=function(n,t){if(i(t,n))return n;throw a("Incorrect invocation")}},function(n,t,e){var r=e(13).f;n.exports=function(n,t,e){e in n||r(n,e,{configurable:!0,get:function(){return t[e]},set:function(n){t[e]=n}})}},function(n,t,e){var r=e(1),i=e(8),a=e(169),o=e(21),s=e(40),c=e(58);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(n){for(var t,e,r=o(n),i=s.f,l=a(r),u={},p=0;l.length>p;)void 0!==(e=i(r,t=l[p++]))&&c(u,t,e);return u}})},function(n,t,e){var r=e(2),i=e(0).RegExp;n.exports=r((function(){var n=i("(?<a>b)","g");return"b"!==n.exec("b").groups.a||"bc"!=="b".replace(n,"$<a>c")}))},function(n,t,e){"use strict";var r=e(1),i=e(121).includes,a=e(2),o=e(148);r({target:"Array",proto:!0,forced:a((function(){return!Array(1).includes()}))},{includes:function(n){return i(this,n,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(n,t,e){"use strict";var r=e(1),i=e(3),a=e(189),o=e(18),s=e(12),c=e(190),l=i("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(n){return!!~l(s(o(this)),s(a(n)),arguments.length>1?arguments[1]:void 0)}})},function(n,t){n.exports=function(n){var t=null==n?0:n.length;return t?n[t-1]:void 0}},function(n,t,e){"use strict";var r=e(1),i=e(158).trim;r({target:"String",proto:!0,forced:e(390)("trim")},{trim:function(){return i(this)}})},function(n,t,e){var r=e(7),i=e(9),a=e(36),o=e(193),s=RegExp.prototype;n.exports=function(n){var t=n.flags;return void 0!==t||"flags"in s||i(n,"flags")||!a(s,n)?t:r(o,n)}},function(n,t,e){var r=e(129),i=Math.floor,a=function(n,t){var e=n.length,c=i(e/2);return e<8?o(n,t):s(n,a(r(n,0,c),t),a(r(n,c),t),t)},o=function(n,t){for(var e,r,i=n.length,a=1;a<i;){for(r=a,e=n[a];r&&t(n[r-1],e)>0;)n[r]=n[--r];r!==a++&&(n[r]=e)}return n},s=function(n,t,e,r){for(var i=t.length,a=e.length,o=0,s=0;o<i||s<a;)n[o+s]=o<i&&s<a?r(t[o],e[s])<=0?t[o++]:e[s++]:o<i?t[o++]:e[s++];return n};n.exports=a},function(n,t,e){var r=e(0),i=e(8),a=e(115).MISSED_STICKY,o=e(28),s=e(242),c=e(39).get,l=RegExp.prototype,u=r.TypeError;i&&a&&s(l,"sticky",{configurable:!0,get:function(){if(this!==l){if("RegExp"===o(this))return!!c(this).sticky;throw u("Incompatible receiver, RegExp required")}}})},function(n,t,e){var r=e(168),i=e(13);n.exports=function(n,t,e){return e.get&&r(e.get,t,{getter:!0}),e.set&&r(e.set,t,{setter:!0}),i.f(n,t,e)}},function(n,t,e){n.exports=e(407)},function(n,t,e){var r=e(0),i=e(7),a=e(4),o=e(11),s=r.TypeError;n.exports=function(n,t){var e,r;if("string"===t&&a(e=n.toString)&&!o(r=i(e,n)))return r;if(a(e=n.valueOf)&&!o(r=i(e,n)))return r;if("string"!==t&&a(e=n.toString)&&!o(r=i(e,n)))return r;throw s("Can't convert object to primitive value")}},function(n,t){var e=Math.ceil,r=Math.floor;n.exports=Math.trunc||function(n){var t=+n;return(t>0?r:e)(t)}},function(n,t,e){var r=e(0),i=e(4),a=e(95),o=r.WeakMap;n.exports=i(o)&&/native code/.test(a(o))},function(n,t,e){var r=e(0),i=e(4),a=r.String,o=r.TypeError;n.exports=function(n){if("object"==typeof n||i(n))return n;throw o("Can't set "+a(n)+" as a prototype")}},function(n,t,e){e(249),e(256),e(257),e(258),e(259),e(260)},function(n,t,e){"use strict";var r,i,a,o=e(1),s=e(17),c=e(97),l=e(0),u=e(7),p=e(15),d=e(74),f=e(37),h=e(230),m=e(24),v=e(4),g=e(11),b=e(231),y=e(126),w=e(173).set,k=e(250),x=e(253),_=e(128),S=e(254),T=e(39),j=e(57),C=e(76),I=e(77),A=C.CONSTRUCTOR,O=C.REJECTION_EVENT,E=C.SUBCLASSING,L=T.getterFor("Promise"),z=T.set,M=j&&j.prototype,R=j,P=M,B=l.TypeError,N=l.document,D=l.process,$=I.f,U=$,F=!!(N&&N.createEvent&&l.dispatchEvent),q=function(n){var t;return!(!g(n)||!v(t=n.then))&&t},V=function(n,t){var e,r,i,a=t.value,o=1==t.state,s=o?n.ok:n.fail,c=n.resolve,l=n.reject,p=n.domain;try{s?(o||(2===t.rejection&&K(t),t.rejection=1),!0===s?e=a:(p&&p.enter(),e=s(a),p&&(p.exit(),i=!0)),e===n.promise?l(B("Promise-chain cycle")):(r=q(e))?u(r,e,c,l):c(e)):l(a)}catch(n){p&&!i&&p.exit(),l(n)}},J=function(n,t){n.notified||(n.notified=!0,k((function(){for(var e,r=n.reactions;e=r.get();)V(e,n);n.notified=!1,t&&!n.rejection&&G(n)})))},W=function(n,t,e){var r,i;F?((r=N.createEvent("Event")).promise=t,r.reason=e,r.initEvent(n,!1,!0),l.dispatchEvent(r)):r={promise:t,reason:e},!O&&(i=l["on"+n])?i(r):"unhandledrejection"===n&&x("Unhandled promise rejection",e)},G=function(n){u(w,l,(function(){var t,e=n.facade,r=n.value;if(H(n)&&(t=_((function(){c?D.emit("unhandledRejection",r,e):W("unhandledrejection",e,r)})),n.rejection=c||H(n)?2:1,t.error))throw t.value}))},H=function(n){return 1!==n.rejection&&!n.parent},K=function(n){u(w,l,(function(){var t=n.facade;c?D.emit("rejectionHandled",t):W("rejectionhandled",t,n.value)}))},X=function(n,t,e){return function(r){n(t,r,e)}},Q=function(n,t,e){n.done||(n.done=!0,e&&(n=e),n.value=t,n.state=2,J(n,!0))},Y=function(n,t,e){if(!n.done){n.done=!0,e&&(n=e);try{if(n.facade===t)throw B("Promise can't be resolved itself");var r=q(t);r?k((function(){var e={done:!1};try{u(r,t,X(Y,e,n),X(Q,e,n))}catch(t){Q(e,t,n)}})):(n.value=t,n.state=1,J(n,!1))}catch(t){Q({done:!1},t,n)}}};if(A&&(P=(R=function(n){b(this,P),m(n),u(r,this);var t=L(this);try{n(X(Y,t),X(Q,t))}catch(n){Q(t,n)}}).prototype,(r=function(n){z(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new S,rejection:!1,state:0,value:void 0})}).prototype=p(P,"then",(function(n,t){var e=L(this),r=$(y(this,R));return e.parent=!0,r.ok=!v(n)||n,r.fail=v(t)&&t,r.domain=c?D.domain:void 0,0==e.state?e.reactions.add(r):k((function(){V(r,e)})),r.promise})),i=function(){var n=new r,t=L(n);this.promise=n,this.resolve=X(Y,t),this.reject=X(Q,t)},I.f=$=function(n){return n===R||void 0===n?new i(n):U(n)},!s&&v(j)&&M!==Object.prototype)){a=M.then,E||p(M,"then",(function(n,t){var e=this;return new R((function(n,t){u(a,e,n,t)})).then(n,t)}),{unsafe:!0});try{delete M.constructor}catch(n){}d&&d(M,P)}o({global:!0,constructor:!0,wrap:!0,forced:A},{Promise:R}),f(R,"Promise",!1,!0),h("Promise")},function(n,t,e){var r,i,a,o,s,c,l,u,p=e(0),d=e(62),f=e(40).f,h=e(173).set,m=e(174),v=e(251),g=e(252),b=e(97),y=p.MutationObserver||p.WebKitMutationObserver,w=p.document,k=p.process,x=p.Promise,_=f(p,"queueMicrotask"),S=_&&_.value;S||(r=function(){var n,t;for(b&&(n=k.domain)&&n.exit();i;){t=i.fn,i=i.next;try{t()}catch(n){throw i?o():a=void 0,n}}a=void 0,n&&n.enter()},m||b||g||!y||!w?!v&&x&&x.resolve?((l=x.resolve(void 0)).constructor=x,u=d(l.then,l),o=function(){u(r)}):b?o=function(){k.nextTick(r)}:(h=d(h,p),o=function(){h(r)}):(s=!0,c=w.createTextNode(""),new y(r).observe(c,{characterData:!0}),o=function(){c.data=s=!s})),n.exports=S||function(n){var t={fn:n,next:void 0};a&&(a.next=t),i||(i=t,o()),a=t}},function(n,t,e){var r=e(31),i=e(0);n.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==i.Pebble},function(n,t,e){var r=e(31);n.exports=/web0s(?!.*chrome)/i.test(r)},function(n,t,e){var r=e(0);n.exports=function(n,t){var e=r.console;e&&e.error&&(1==arguments.length?e.error(n):e.error(n,t))}},function(n,t){var e=function(){this.head=null,this.tail=null};e.prototype={add:function(n){var t={item:n,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var n=this.head;if(n)return this.head=n.next,this.tail===n&&(this.tail=null),n.item}},n.exports=e},function(n,t){n.exports="object"==typeof window&&"object"!=typeof Deno},function(n,t,e){"use strict";var r=e(1),i=e(7),a=e(24),o=e(77),s=e(128),c=e(175);r({target:"Promise",stat:!0,forced:e(178)},{all:function(n){var t=this,e=o.f(t),r=e.resolve,l=e.reject,u=s((function(){var e=a(t.resolve),o=[],s=0,u=1;c(n,(function(n){var a=s++,c=!1;u++,i(e,t,n).then((function(n){c||(c=!0,o[a]=n,--u||r(o))}),l)})),--u||r(o)}));return u.error&&l(u.value),e.promise}})},function(n,t,e){"use strict";var r=e(1),i=e(17),a=e(76).CONSTRUCTOR,o=e(57),s=e(14),c=e(4),l=e(15),u=o&&o.prototype;if(r({target:"Promise",proto:!0,forced:a,real:!0},{catch:function(n){return this.then(void 0,n)}}),!i&&c(o)){var p=s("Promise").prototype.catch;u.catch!==p&&l(u,"catch",p,{unsafe:!0})}},function(n,t,e){"use strict";var r=e(1),i=e(7),a=e(24),o=e(77),s=e(128),c=e(175);r({target:"Promise",stat:!0,forced:e(178)},{race:function(n){var t=this,e=o.f(t),r=e.reject,l=s((function(){var o=a(t.resolve);c(n,(function(n){i(o,t,n).then(e.resolve,r)}))}));return l.error&&r(l.value),e.promise}})},function(n,t,e){"use strict";var r=e(1),i=e(7),a=e(77);r({target:"Promise",stat:!0,forced:e(76).CONSTRUCTOR},{reject:function(n){var t=a.f(this);return i(t.reject,void 0,n),t.promise}})},function(n,t,e){"use strict";var r=e(1),i=e(14),a=e(17),o=e(57),s=e(76).CONSTRUCTOR,c=e(180),l=i("Promise"),u=a&&!s;r({target:"Promise",stat:!0,forced:a||s},{resolve:function(n){return c(u&&this===l?o:this,n)}})},function(n,t,e){var r=e(1),i=e(262);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==i},{assign:i})},function(n,t,e){"use strict";var r=e(8),i=e(3),a=e(7),o=e(2),s=e(92),c=e(96),l=e(123),u=e(16),p=e(67),d=Object.assign,f=Object.defineProperty,h=i([].concat);n.exports=!d||o((function(){if(r&&1!==d({b:1},d(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var n={},t={},e=Symbol();return n[e]=7,"abcdefghijklmnopqrst".split("").forEach((function(n){t[n]=n})),7!=d({},n)[e]||"abcdefghijklmnopqrst"!=s(d({},t)).join("")}))?function(n,t){for(var e=u(n),i=arguments.length,o=1,d=c.f,f=l.f;i>o;)for(var m,v=p(arguments[o++]),g=d?h(s(v),d(v)):s(v),b=g.length,y=0;b>y;)m=g[y++],r&&!a(f,v,m)||(e[m]=v[m]);return e}:d},function(n,t,e){"use strict";var r=e(1),i=e(17),a=e(57),o=e(2),s=e(14),c=e(4),l=e(126),u=e(180),p=e(15),d=a&&a.prototype;if(r({target:"Promise",proto:!0,real:!0,forced:!!a&&o((function(){d.finally.call({then:function(){}},(function(){}))}))},{finally:function(n){var t=l(this,s("Promise")),e=c(n);return this.then(e?function(e){return u(t,n()).then((function(){return e}))}:n,e?function(e){return u(t,n()).then((function(){throw e}))}:n)}}),!i&&c(a)){var f=s("Promise").prototype.finally;d.finally!==f&&p(d,"finally",f,{unsafe:!0})}},function(n,t,e){"use strict";var r=e(1),i=e(0),a=e(7),o=e(3),s=e(17),c=e(8),l=e(54),u=e(2),p=e(9),d=e(36),f=e(10),h=e(21),m=e(91),v=e(12),g=e(50),b=e(35),y=e(92),w=e(64),k=e(181),x=e(96),_=e(40),S=e(13),T=e(151),j=e(123),C=e(15),I=e(53),A=e(94),O=e(71),E=e(89),L=e(6),z=e(182),M=e(99),R=e(266),P=e(37),B=e(39),N=e(63).forEach,D=A("hidden"),$=B.set,U=B.getterFor("Symbol"),F=Object.prototype,q=i.Symbol,V=q&&q.prototype,J=i.TypeError,W=i.QObject,G=_.f,H=S.f,K=k.f,X=j.f,Q=o([].push),Y=I("symbols"),Z=I("op-symbols"),nn=I("wks"),tn=!W||!W.prototype||!W.prototype.findChild,en=c&&u((function(){return 7!=b(H({},"a",{get:function(){return H(this,"a",{value:7}).a}})).a}))?function(n,t,e){var r=G(F,t);r&&delete F[t],H(n,t,e),r&&n!==F&&H(F,t,r)}:H,rn=function(n,t){var e=Y[n]=b(V);return $(e,{type:"Symbol",tag:n,description:t}),c||(e.description=t),e},an=function(n,t,e){n===F&&an(Z,t,e),f(n);var r=m(t);return f(e),p(Y,r)?(e.enumerable?(p(n,D)&&n[D][r]&&(n[D][r]=!1),e=b(e,{enumerable:g(0,!1)})):(p(n,D)||H(n,D,g(1,{})),n[D][r]=!0),en(n,r,e)):H(n,r,e)},on=function(n,t){f(n);var e=h(t),r=y(e).concat(un(e));return N(r,(function(t){c&&!a(sn,e,t)||an(n,t,e[t])})),n},sn=function(n){var t=m(n),e=a(X,this,t);return!(this===F&&p(Y,t)&&!p(Z,t))&&(!(e||!p(this,t)||!p(Y,t)||p(this,D)&&this[D][t])||e)},cn=function(n,t){var e=h(n),r=m(t);if(e!==F||!p(Y,r)||p(Z,r)){var i=G(e,r);return!i||!p(Y,r)||p(e,D)&&e[D][r]||(i.enumerable=!0),i}},ln=function(n){var t=K(h(n)),e=[];return N(t,(function(n){p(Y,n)||p(O,n)||Q(e,n)})),e},un=function(n){var t=n===F,e=K(t?Z:h(n)),r=[];return N(e,(function(n){!p(Y,n)||t&&!p(F,n)||Q(r,Y[n])})),r};l||(C(V=(q=function(){if(d(V,this))throw J("Symbol is not a constructor");var n=arguments.length&&void 0!==arguments[0]?v(arguments[0]):void 0,t=E(n),e=function(n){this===F&&a(e,Z,n),p(this,D)&&p(this[D],t)&&(this[D][t]=!1),en(this,t,g(1,n))};return c&&tn&&en(F,t,{configurable:!0,set:e}),rn(t,n)}).prototype,"toString",(function(){return U(this).tag})),C(q,"withoutSetter",(function(n){return rn(E(n),n)})),j.f=sn,S.f=an,T.f=on,_.f=cn,w.f=k.f=ln,x.f=un,z.f=function(n){return rn(L(n),n)},c&&(H(V,"description",{configurable:!0,get:function(){return U(this).description}}),s||C(F,"propertyIsEnumerable",sn,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!l,sham:!l},{Symbol:q}),N(y(nn),(function(n){M(n)})),r({target:"Symbol",stat:!0,forced:!l},{useSetter:function(){tn=!0},useSimple:function(){tn=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!c},{create:function(n,t){return void 0===t?b(n):on(b(n),t)},defineProperty:an,defineProperties:on,getOwnPropertyDescriptor:cn}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:ln}),R(),P(q,"Symbol"),O[D]=!0},function(n,t,e){var r=e(0);n.exports=r},function(n,t,e){var r=e(7),i=e(14),a=e(6),o=e(15);n.exports=function(){var n=i("Symbol"),t=n&&n.prototype,e=t&&t.valueOf,s=a("toPrimitive");t&&!t[s]&&o(t,s,(function(n){return r(e,this)}),{arity:1})}},function(n,t,e){var r=e(0),i=e(51),a=e(98),o=e(11),s=e(6)("species"),c=r.Array;n.exports=function(n){var t;return i(n)&&(t=n.constructor,(a(t)&&(t===c||i(t.prototype))||o(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?c:t}},function(n,t,e){var r=e(1),i=e(14),a=e(9),o=e(12),s=e(53),c=e(183),l=s("string-to-symbol-registry"),u=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{for:function(n){var t=o(n);if(a(l,t))return l[t];var e=i("Symbol")(t);return l[t]=e,u[e]=t,e}})},function(n,t,e){var r=e(1),i=e(9),a=e(69),o=e(70),s=e(53),c=e(183),l=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{keyFor:function(n){if(!a(n))throw TypeError(o(n)+" is not a symbol");if(i(l,n))return l[n]}})},function(n,t,e){var r=e(1),i=e(54),a=e(2),o=e(96),s=e(16);r({target:"Object",stat:!0,forced:!i||a((function(){o.f(1)}))},{getOwnPropertySymbols:function(n){var t=o.f;return t?t(s(n)):[]}})},function(n,t,e){"use strict";var r=e(127),i=e(86);n.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(n,t,e){e(99)("asyncIterator")},function(n,t,e){var r=e(14),i=e(99),a=e(37);i("toStringTag"),a(r("Symbol"),"Symbol")},function(n,t,e){var r=e(0);e(37)(r.JSON,"JSON",!0)},function(n,t,e){e(37)(Math,"Math",!0)},function(n,t,e){"use strict";var r=e(14),i=e(9),a=e(29),o=e(36),s=e(74),c=e(124),l=e(232),u=e(154),p=e(187),d=e(277),f=e(278),h=e(279),m=e(8),v=e(17);n.exports=function(n,t,e,g){var b=g?2:1,y=n.split("."),w=y[y.length-1],k=r.apply(null,y);if(k){var x=k.prototype;if(!v&&i(x,"cause")&&delete x.cause,!e)return k;var _=r("Error"),S=t((function(n,t){var e=p(g?t:n,void 0),r=g?new k(n):new k;return void 0!==e&&a(r,"message",e),h&&a(r,"stack",f(r.stack,2)),this&&o(x,this)&&u(r,this,S),arguments.length>b&&d(r,arguments[b]),r}));if(S.prototype=x,"Error"!==w?s?s(S,_):c(S,_,{name:!0}):m&&"stackTraceLimit"in k&&(l(S,k,"stackTraceLimit"),l(S,k,"prepareStackTrace")),c(S,k),!v)try{x.name!==w&&a(x,"name",w),x.constructor=S}catch(n){}return S}}},function(n,t,e){var r=e(11),i=e(29);n.exports=function(n,t){r(t)&&"cause"in t&&i(n,"cause",t.cause)}},function(n,t,e){var r=e(3),i=Error,a=r("".replace),o=String(i("zxcasd").stack),s=/\n\s*at [^:]*:[^\n]*/,c=s.test(o);n.exports=function(n,t){if(c&&"string"==typeof n&&!i.prepareStackTrace)for(;t--;)n=a(n,s,"");return n}},function(n,t,e){var r=e(2),i=e(50);n.exports=!r((function(){var n=Error("a");return!("stack"in n)||(Object.defineProperty(n,"stack",i(1,7)),7!==n.stack)}))},function(n,t,e){"use strict";var r=e(8),i=e(2),a=e(10),o=e(35),s=e(187),c=Error.prototype.toString,l=i((function(){if(r){var n=o(Object.defineProperty({},"name",{get:function(){return this===n}}));if("true"!==c.call(n))return!0}return"2: 1"!==c.call({message:1,name:2})||"Error"!==c.call({})}));n.exports=l?function(){var n=a(this),t=s(n.name,"Error"),e=s(n.message);return t?e?t+": "+e:t:e}:c},function(n,t,e){"use strict";var r=e(1),i=e(3),a=e(51),o=i([].reverse),s=[1,2];r({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return a(this)&&(this.length=this.length),o(this)}})},function(n,t,e){"use strict";var r=e(1),i=e(283).left,a=e(48),o=e(55),s=e(97);r({target:"Array",proto:!0,forced:!a("reduce")||!s&&o>79&&o<83},{reduce:function(n){var t=arguments.length;return i(this,n,t,t>1?arguments[1]:void 0)}})},function(n,t,e){var r=e(0),i=e(24),a=e(16),o=e(67),s=e(20),c=r.TypeError,l=function(n){return function(t,e,r,l){i(e);var u=a(t),p=o(u),d=s(u),f=n?d-1:0,h=n?-1:1;if(r<2)for(;;){if(f in p){l=p[f],f+=h;break}if(f+=h,n?f<0:d<=f)throw c("Reduce of empty array with no initial value")}for(;n?f>=0:d>f;f+=h)f in p&&(l=e(l,p[f],f,u));return l}};n.exports={left:l(!1),right:l(!0)}},function(n,t,e){"use strict";var r,i=e(1),a=e(3),o=e(40).f,s=e(56),c=e(12),l=e(189),u=e(18),p=e(190),d=e(17),f=a("".startsWith),h=a("".slice),m=Math.min,v=p("startsWith");i({target:"String",proto:!0,forced:!!(d||v||(r=o(String.prototype,"startsWith"),!r||r.writable))&&!v},{startsWith:function(n){var t=c(u(this));l(n);var e=s(m(arguments.length>1?arguments[1]:void 0,t.length)),r=c(n);return f?f(t,r,e):h(t,e,e+r.length)===r}})},function(n,t,e){var r=e(1),i=e(191),a=e(2),o=e(11),s=e(286).onFreeze,c=Object.freeze;r({target:"Object",stat:!0,forced:a((function(){c(1)})),sham:!i},{freeze:function(n){return c&&o(n)?c(s(n)):n}})},function(n,t,e){var r=e(1),i=e(3),a=e(71),o=e(11),s=e(9),c=e(13).f,l=e(64),u=e(181),p=e(287),d=e(89),f=e(191),h=!1,m=d("meta"),v=0,g=function(n){c(n,m,{value:{objectID:"O"+v++,weakData:{}}})},b=n.exports={enable:function(){b.enable=function(){},h=!0;var n=l.f,t=i([].splice),e={};e[m]=1,n(e).length&&(l.f=function(e){for(var r=n(e),i=0,a=r.length;i<a;i++)if(r[i]===m){t(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(n,t){if(!o(n))return"symbol"==typeof n?n:("string"==typeof n?"S":"P")+n;if(!s(n,m)){if(!p(n))return"F";if(!t)return"E";g(n)}return n[m].objectID},getWeakData:function(n,t){if(!s(n,m)){if(!p(n))return!0;if(!t)return!1;g(n)}return n[m].weakData},onFreeze:function(n){return f&&h&&p(n)&&!s(n,m)&&g(n),n}};a[m]=!0},function(n,t,e){var r=e(2),i=e(11),a=e(28),o=e(288),s=Object.isExtensible,c=r((function(){s(1)}));n.exports=c||o?function(n){return!!i(n)&&((!o||"ArrayBuffer"!=a(n))&&(!s||s(n)))}:s},function(n,t,e){var r=e(2);n.exports=r((function(){if("function"==typeof ArrayBuffer){var n=new ArrayBuffer(8);Object.isExtensible(n)&&Object.defineProperty(n,"a",{value:8})}}))},function(n,t,e){"use strict";var r=e(0),i=e(62),a=e(7),o=e(16),s=e(290),c=e(176),l=e(98),u=e(20),p=e(58),d=e(153),f=e(113),h=r.Array;n.exports=function(n){var t=o(n),e=l(this),r=arguments.length,m=r>1?arguments[1]:void 0,v=void 0!==m;v&&(m=i(m,r>2?arguments[2]:void 0));var g,b,y,w,k,x,_=f(t),S=0;if(!_||this==h&&c(_))for(g=u(t),b=e?new this(g):h(g);g>S;S++)x=v?m(t[S],S):t[S],p(b,S,x);else for(k=(w=d(t,_)).next,b=e?new this:[];!(y=a(k,w)).done;S++)x=v?s(w,m,[y.value,S],!0):y.value,p(b,S,x);return b.length=S,b}},function(n,t,e){var r=e(10),i=e(177);n.exports=function(n,t,e,a){try{return a?t(r(e)[0],e[1]):t(e)}catch(t){i(n,"throw",t)}}},function(n,t,e){var r=e(3),i=e(16),a=Math.floor,o=r("".charAt),s=r("".replace),c=r("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;n.exports=function(n,t,e,r,p,d){var f=e+n.length,h=r.length,m=u;return void 0!==p&&(p=i(p),m=l),s(d,m,(function(i,s){var l;switch(o(s,0)){case"$":return"$";case"&":return n;case"`":return c(t,0,e);case"'":return c(t,f);case"<":l=p[c(s,1,-1)];break;default:var u=+s;if(0===u)return i;if(u>h){var d=a(u/10);return 0===d?i:d<=h?void 0===r[d-1]?o(s,1):r[d-1]+o(s,1):i}l=r[u-1]}return void 0===l?"":l}))}},function(n,t,e){var r=e(194),i=e(293);n.exports=function n(t,e,a,o,s){var c=-1,l=t.length;for(a||(a=i),s||(s=[]);++c<l;){var u=t[c];e>0&&a(u)?e>1?n(u,e-1,a,o,s):r(s,u):o||(s[s.length]=u)}return s}},function(n,t,e){var r=e(80),i=e(135),a=e(30),o=r?r.isConcatSpreadable:void 0;n.exports=function(n){return a(n)||i(n)||!!(o&&n&&n[o])}},function(n,t,e){var r=e(66),i=e(52);n.exports=function(n){return i(n)&&"[object Arguments]"==r(n)}},function(n,t,e){var r=e(80),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r?r.toStringTag:void 0;n.exports=function(n){var t=a.call(n,s),e=n[s];try{n[s]=void 0;var r=!0}catch(n){}var i=o.call(n);return r&&(t?n[s]=e:delete n[s]),i}},function(n,t){var e=Object.prototype.toString;n.exports=function(n){return e.call(n)}},function(n,t,e){var r=e(298),i=e(354),a=e(143),o=e(30),s=e(365);n.exports=function(n){return"function"==typeof n?n:null==n?a:"object"==typeof n?o(n)?i(n[0],n[1]):r(n):s(n)}},function(n,t,e){var r=e(299),i=e(353),a=e(211);n.exports=function(n){var t=i(n);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(e){return e===n||r(e,n,t)}}},function(n,t,e){var r=e(196),i=e(200);n.exports=function(n,t,e,a){var o=e.length,s=o,c=!a;if(null==n)return!s;for(n=Object(n);o--;){var l=e[o];if(c&&l[2]?l[1]!==n[l[0]]:!(l[0]in n))return!1}for(;++o<s;){var u=(l=e[o])[0],p=n[u],d=l[1];if(c&&l[2]){if(void 0===p&&!(u in n))return!1}else{var f=new r;if(a)var h=a(p,d,u,n,t,f);if(!(void 0===h?i(d,p,3,a,f):h))return!1}}return!0}},function(n,t){n.exports=function(){this.__data__=[],this.size=0}},function(n,t,e){var r=e(104),i=Array.prototype.splice;n.exports=function(n){var t=this.__data__,e=r(t,n);return!(e<0)&&(e==t.length-1?t.pop():i.call(t,e,1),--this.size,!0)}},function(n,t,e){var r=e(104);n.exports=function(n){var t=this.__data__,e=r(t,n);return e<0?void 0:t[e][1]}},function(n,t,e){var r=e(104);n.exports=function(n){return r(this.__data__,n)>-1}},function(n,t,e){var r=e(104);n.exports=function(n,t){var e=this.__data__,i=r(e,n);return i<0?(++this.size,e.push([n,t])):e[i][1]=t,this}},function(n,t,e){var r=e(103);n.exports=function(){this.__data__=new r,this.size=0}},function(n,t){n.exports=function(n){var t=this.__data__,e=t.delete(n);return this.size=t.size,e}},function(n,t){n.exports=function(n){return this.__data__.get(n)}},function(n,t){n.exports=function(n){return this.__data__.has(n)}},function(n,t,e){var r=e(103),i=e(136),a=e(138);n.exports=function(n,t){var e=this.__data__;if(e instanceof r){var o=e.__data__;if(!i||o.length<199)return o.push([n,t]),this.size=++e.size,this;e=this.__data__=new a(o)}return e.set(n,t),this.size=e.size,this}},function(n,t,e){var r=e(198),i=e(311),a=e(137),o=e(199),s=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,p=l.hasOwnProperty,d=RegExp("^"+u.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(n){return!(!a(n)||i(n))&&(r(n)?d:s).test(o(n))}},function(n,t,e){var r,i=e(312),a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";n.exports=function(n){return!!a&&a in n}},function(n,t,e){var r=e(32)["__core-js_shared__"];n.exports=r},function(n,t){n.exports=function(n,t){return null==n?void 0:n[t]}},function(n,t,e){var r=e(315),i=e(103),a=e(136);n.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||i),string:new r}}},function(n,t,e){var r=e(316),i=e(317),a=e(318),o=e(319),s=e(320);function c(n){var t=-1,e=null==n?0:n.length;for(this.clear();++t<e;){var r=n[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=o,c.prototype.set=s,n.exports=c},function(n,t,e){var r=e(105);n.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(n,t){n.exports=function(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}},function(n,t,e){var r=e(105),i=Object.prototype.hasOwnProperty;n.exports=function(n){var t=this.__data__;if(r){var e=t[n];return"__lodash_hash_undefined__"===e?void 0:e}return i.call(t,n)?t[n]:void 0}},function(n,t,e){var r=e(105),i=Object.prototype.hasOwnProperty;n.exports=function(n){var t=this.__data__;return r?void 0!==t[n]:i.call(t,n)}},function(n,t,e){var r=e(105);n.exports=function(n,t){var e=this.__data__;return this.size+=this.has(n)?0:1,e[n]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(n,t,e){var r=e(106);n.exports=function(n){var t=r(this,n).delete(n);return this.size-=t?1:0,t}},function(n,t){n.exports=function(n){var t=typeof n;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==n:null===n}},function(n,t,e){var r=e(106);n.exports=function(n){return r(this,n).get(n)}},function(n,t,e){var r=e(106);n.exports=function(n){return r(this,n).has(n)}},function(n,t,e){var r=e(106);n.exports=function(n,t){var e=r(this,n),i=e.size;return e.set(n,t),this.size+=e.size==i?0:1,this}},function(n,t,e){var r=e(196),i=e(201),a=e(330),o=e(333),s=e(349),c=e(30),l=e(205),u=e(207),p="[object Object]",d=Object.prototype.hasOwnProperty;n.exports=function(n,t,e,f,h,m){var v=c(n),g=c(t),b=v?"[object Array]":s(n),y=g?"[object Array]":s(t),w=(b="[object Arguments]"==b?p:b)==p,k=(y="[object Arguments]"==y?p:y)==p,x=b==y;if(x&&l(n)){if(!l(t))return!1;v=!0,w=!1}if(x&&!w)return m||(m=new r),v||u(n)?i(n,t,e,f,h,m):a(n,t,b,e,f,h,m);if(!(1&e)){var _=w&&d.call(n,"__wrapped__"),S=k&&d.call(t,"__wrapped__");if(_||S){var T=_?n.value():n,j=S?t.value():t;return m||(m=new r),h(T,j,e,f,m)}}return!!x&&(m||(m=new r),o(n,t,e,f,h,m))}},function(n,t){n.exports=function(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this}},function(n,t){n.exports=function(n){return this.__data__.has(n)}},function(n,t){n.exports=function(n,t){for(var e=-1,r=null==n?0:n.length;++e<r;)if(t(n[e],e,n))return!0;return!1}},function(n,t,e){var r=e(80),i=e(331),a=e(197),o=e(201),s=e(332),c=e(139),l=r?r.prototype:void 0,u=l?l.valueOf:void 0;n.exports=function(n,t,e,r,l,p,d){switch(e){case"[object DataView]":if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(n.byteLength!=t.byteLength||!p(new i(n),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+n,+t);case"[object Error]":return n.name==t.name&&n.message==t.message;case"[object RegExp]":case"[object String]":return n==t+"";case"[object Map]":var f=s;case"[object Set]":var h=1&r;if(f||(f=c),n.size!=t.size&&!h)return!1;var m=d.get(n);if(m)return m==t;r|=2,d.set(n,t);var v=o(f(n),f(t),r,l,p,d);return d.delete(n),v;case"[object Symbol]":if(u)return u.call(n)==u.call(t)}return!1}},function(n,t,e){var r=e(32).Uint8Array;n.exports=r},function(n,t){n.exports=function(n){var t=-1,e=Array(n.size);return n.forEach((function(n,r){e[++t]=[r,n]})),e}},function(n,t,e){var r=e(334),i=Object.prototype.hasOwnProperty;n.exports=function(n,t,e,a,o,s){var c=1&e,l=r(n),u=l.length;if(u!=r(t).length&&!c)return!1;for(var p=u;p--;){var d=l[p];if(!(c?d in t:i.call(t,d)))return!1}var f=s.get(n),h=s.get(t);if(f&&h)return f==t&&h==n;var m=!0;s.set(n,t),s.set(t,n);for(var v=c;++p<u;){var g=n[d=l[p]],b=t[d];if(a)var y=c?a(b,g,d,t,n,s):a(g,b,d,n,t,s);if(!(void 0===y?g===b||o(g,b,e,a,s):y)){m=!1;break}v||(v="constructor"==d)}if(m&&!v){var w=n.constructor,k=t.constructor;w==k||!("constructor"in n)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof k&&k instanceof k||(m=!1)}return s.delete(n),s.delete(t),m}},function(n,t,e){var r=e(335),i=e(336),a=e(204);n.exports=function(n){return r(n,a,i)}},function(n,t,e){var r=e(194),i=e(30);n.exports=function(n,t,e){var a=t(n);return i(n)?a:r(a,e(n))}},function(n,t,e){var r=e(337),i=e(338),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(n){return null==n?[]:(n=Object(n),r(o(n),(function(t){return a.call(n,t)})))}:i;n.exports=s},function(n,t){n.exports=function(n,t){for(var e=-1,r=null==n?0:n.length,i=0,a=[];++e<r;){var o=n[e];t(o,e,n)&&(a[i++]=o)}return a}},function(n,t){n.exports=function(){return[]}},function(n,t,e){var r=e(340),i=e(135),a=e(30),o=e(205),s=e(206),c=e(207),l=Object.prototype.hasOwnProperty;n.exports=function(n,t){var e=a(n),u=!e&&i(n),p=!e&&!u&&o(n),d=!e&&!u&&!p&&c(n),f=e||u||p||d,h=f?r(n.length,String):[],m=h.length;for(var v in n)!t&&!l.call(n,v)||f&&("length"==v||p&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,m))||h.push(v);return h}},function(n,t){n.exports=function(n,t){for(var e=-1,r=Array(n);++e<n;)r[e]=t(e);return r}},function(n,t){n.exports=function(){return!1}},function(n,t,e){var r=e(66),i=e(140),a=e(52),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,n.exports=function(n){return a(n)&&i(n.length)&&!!o[r(n)]}},function(n,t){n.exports=function(n){return function(t){return n(t)}}},function(n,t,e){(function(n){var r=e(195),i=t&&!t.nodeType&&t,a=i&&"object"==typeof n&&n&&!n.nodeType&&n,o=a&&a.exports===i&&r.process,s=function(){try{var n=a&&a.require&&a.require("util").types;return n||o&&o.binding&&o.binding("util")}catch(n){}}();n.exports=s}).call(this,e(156)(n))},function(n,t,e){var r=e(346),i=e(347),a=Object.prototype.hasOwnProperty;n.exports=function(n){if(!r(n))return i(n);var t=[];for(var e in Object(n))a.call(n,e)&&"constructor"!=e&&t.push(e);return t}},function(n,t){var e=Object.prototype;n.exports=function(n){var t=n&&n.constructor;return n===("function"==typeof t&&t.prototype||e)}},function(n,t,e){var r=e(348)(Object.keys,Object);n.exports=r},function(n,t){n.exports=function(n,t){return function(e){return n(t(e))}}},function(n,t,e){var r=e(350),i=e(136),a=e(351),o=e(209),s=e(352),c=e(66),l=e(199),u=l(r),p=l(i),d=l(a),f=l(o),h=l(s),m=c;(r&&"[object DataView]"!=m(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=m(new i)||a&&"[object Promise]"!=m(a.resolve())||o&&"[object Set]"!=m(new o)||s&&"[object WeakMap]"!=m(new s))&&(m=function(n){var t=c(n),e="[object Object]"==t?n.constructor:void 0,r=e?l(e):"";if(r)switch(r){case u:return"[object DataView]";case p:return"[object Map]";case d:return"[object Promise]";case f:return"[object Set]";case h:return"[object WeakMap]"}return t}),n.exports=m},function(n,t,e){var r=e(42)(e(32),"DataView");n.exports=r},function(n,t,e){var r=e(42)(e(32),"Promise");n.exports=r},function(n,t,e){var r=e(42)(e(32),"WeakMap");n.exports=r},function(n,t,e){var r=e(210),i=e(204);n.exports=function(n){for(var t=i(n),e=t.length;e--;){var a=t[e],o=n[a];t[e]=[a,o,r(o)]}return t}},function(n,t,e){var r=e(200),i=e(355),a=e(362),o=e(141),s=e(210),c=e(211),l=e(107);n.exports=function(n,t){return o(n)&&s(t)?c(l(n),t):function(e){var o=i(e,n);return void 0===o&&o===t?a(e,n):r(t,o,3)}}},function(n,t,e){var r=e(212);n.exports=function(n,t,e){var i=null==n?void 0:r(n,t);return void 0===i?e:i}},function(n,t,e){var r=e(357),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=r((function(n){var t=[];return 46===n.charCodeAt(0)&&t.push(""),n.replace(i,(function(n,e,r,i){t.push(r?i.replace(a,"$1"):e||n)})),t}));n.exports=o},function(n,t,e){var r=e(358);n.exports=function(n){var t=r(n,(function(n){return 500===e.size&&e.clear(),n})),e=t.cache;return t}},function(n,t,e){var r=e(138);function i(n,t){if("function"!=typeof n||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var e=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=e.cache;if(a.has(i))return a.get(i);var o=n.apply(this,r);return e.cache=a.set(i,o)||a,o};return e.cache=new(i.Cache||r),e}i.Cache=r,n.exports=i},function(n,t,e){var r=e(360);n.exports=function(n){return null==n?"":r(n)}},function(n,t,e){var r=e(80),i=e(361),a=e(30),o=e(142),s=r?r.prototype:void 0,c=s?s.toString:void 0;n.exports=function n(t){if("string"==typeof t)return t;if(a(t))return i(t,n)+"";if(o(t))return c?c.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(n,t){n.exports=function(n,t){for(var e=-1,r=null==n?0:n.length,i=Array(r);++e<r;)i[e]=t(n[e],e,n);return i}},function(n,t,e){var r=e(363),i=e(364);n.exports=function(n,t){return null!=n&&i(n,t,r)}},function(n,t){n.exports=function(n,t){return null!=n&&t in Object(n)}},function(n,t,e){var r=e(213),i=e(135),a=e(30),o=e(206),s=e(140),c=e(107);n.exports=function(n,t,e){for(var l=-1,u=(t=r(t,n)).length,p=!1;++l<u;){var d=c(t[l]);if(!(p=null!=n&&e(n,d)))break;n=n[d]}return p||++l!=u?p:!!(u=null==n?0:n.length)&&s(u)&&o(d,u)&&(a(n)||i(n))}},function(n,t,e){var r=e(366),i=e(367),a=e(141),o=e(107);n.exports=function(n){return a(n)?r(o(n)):i(n)}},function(n,t){n.exports=function(n){return function(t){return null==t?void 0:t[n]}}},function(n,t,e){var r=e(212);n.exports=function(n){return function(t){return r(t,n)}}},function(n,t,e){var r=e(143),i=e(369),a=e(371);n.exports=function(n,t){return a(i(n,t,r),n+"")}},function(n,t,e){var r=e(370),i=Math.max;n.exports=function(n,t,e){return t=i(void 0===t?n.length-1:t,0),function(){for(var a=arguments,o=-1,s=i(a.length-t,0),c=Array(s);++o<s;)c[o]=a[t+o];o=-1;for(var l=Array(t+1);++o<t;)l[o]=a[o];return l[t]=e(c),r(n,this,l)}}},function(n,t){n.exports=function(n,t,e){switch(e.length){case 0:return n.call(t);case 1:return n.call(t,e[0]);case 2:return n.call(t,e[0],e[1]);case 3:return n.call(t,e[0],e[1],e[2])}return n.apply(t,e)}},function(n,t,e){var r=e(372),i=e(375)(r);n.exports=i},function(n,t,e){var r=e(373),i=e(374),a=e(143),o=i?function(n,t){return i(n,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:a;n.exports=o},function(n,t){n.exports=function(n){return function(){return n}}},function(n,t,e){var r=e(42),i=function(){try{var n=r(Object,"defineProperty");return n({},"",{}),n}catch(n){}}();n.exports=i},function(n,t){var e=Date.now;n.exports=function(n){var t=0,r=0;return function(){var i=e(),a=16-(i-r);if(r=i,a>0){if(++t>=800)return arguments[0]}else t=0;return n.apply(void 0,arguments)}}},function(n,t,e){var r=e(202),i=e(377),a=e(382),o=e(203),s=e(383),c=e(139);n.exports=function(n,t,e){var l=-1,u=i,p=n.length,d=!0,f=[],h=f;if(e)d=!1,u=a;else if(p>=200){var m=t?null:s(n);if(m)return c(m);d=!1,u=o,h=new r}else h=t?[]:f;n:for(;++l<p;){var v=n[l],g=t?t(v):v;if(v=e||0!==v?v:0,d&&g==g){for(var b=h.length;b--;)if(h[b]===g)continue n;t&&h.push(g),f.push(v)}else u(h,g,e)||(h!==f&&h.push(g),f.push(v))}return f}},function(n,t,e){var r=e(378);n.exports=function(n,t){return!!(null==n?0:n.length)&&r(n,t,0)>-1}},function(n,t,e){var r=e(379),i=e(380),a=e(381);n.exports=function(n,t,e){return t==t?a(n,t,e):r(n,i,e)}},function(n,t){n.exports=function(n,t,e,r){for(var i=n.length,a=e+(r?1:-1);r?a--:++a<i;)if(t(n[a],a,n))return a;return-1}},function(n,t){n.exports=function(n){return n!=n}},function(n,t){n.exports=function(n,t,e){for(var r=e-1,i=n.length;++r<i;)if(n[r]===t)return r;return-1}},function(n,t){n.exports=function(n,t,e){for(var r=-1,i=null==n?0:n.length;++r<i;)if(e(t,n[r]))return!0;return!1}},function(n,t,e){var r=e(209),i=e(384),a=e(139),o=r&&1/a(new r([,-0]))[1]==1/0?function(n){return new r(n)}:i;n.exports=o},function(n,t){n.exports=function(){}},function(n,t,e){var r=e(208),i=e(52);n.exports=function(n){return i(n)&&r(n)}},function(n,t,e){var r=e(1),i=e(0),a=e(214).setInterval;r({global:!0,bind:!0,forced:i.setInterval!==a},{setInterval:a})},function(n,t,e){var r=e(1),i=e(0),a=e(214).setTimeout;r({global:!0,bind:!0,forced:i.setTimeout!==a},{setTimeout:a})},function(n,t,e){},function(n,t,e){},function(n,t,e){var r=e(73).PROPER,i=e(2),a=e(159);n.exports=function(n){return i((function(){return!!a[n]()||"âÂá "!=="âÂá "[n]()||r&&a[n].name!==n}))}},function(n,t,e){var r=e(1),i=e(215);r({target:"Function",proto:!0,forced:Function.bind!==i},{bind:i})},function(n,t,e){var r=e(3);n.exports=r(1..valueOf)},function(n,t,e){var r=e(3),i=e(56),a=e(12),o=e(394),s=e(18),c=r(o),l=r("".slice),u=Math.ceil,p=function(n){return function(t,e,r){var o,p,d=a(s(t)),f=i(e),h=d.length,m=void 0===r?" ":a(r);return f<=h||""==m?d:((p=c(m,u((o=f-h)/m.length))).length>o&&(p=l(p,0,o)),n?d+p:p+d)}};n.exports={start:p(!1),end:p(!0)}},function(n,t,e){"use strict";var r=e(0),i=e(47),a=e(12),o=e(18),s=r.RangeError;n.exports=function(n){var t=a(o(this)),e="",r=i(n);if(r<0||r==1/0)throw s("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(e+=t);return e}},function(n,t,e){var r=e(31);n.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},function(n,t,e){"use strict";e(217)},function(n,t,e){"use strict";e(218)},function(n,t,e){"use strict";var r=e(1),i=e(3),a=e(24),o=e(16),s=e(20),c=e(12),l=e(2),u=e(240),p=e(48),d=e(399),f=e(400),h=e(55),m=e(401),v=[],g=i(v.sort),b=i(v.push),y=l((function(){v.sort(void 0)})),w=l((function(){v.sort(null)})),k=p("sort"),x=!l((function(){if(h)return h<70;if(!(d&&d>3)){if(f)return!0;if(m)return m<603;var n,t,e,r,i="";for(n=65;n<76;n++){switch(t=String.fromCharCode(n),n){case 66:case 69:case 70:case 72:e=3;break;case 68:case 71:e=4;break;default:e=2}for(r=0;r<47;r++)v.push({k:t+r,v:e})}for(v.sort((function(n,t){return t.v-n.v})),r=0;r<v.length;r++)t=v[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));r({target:"Array",proto:!0,forced:y||!w||!k||!x},{sort:function(n){void 0!==n&&a(n);var t=o(this);if(x)return void 0===n?g(t):g(t,n);var e,r,i=[],l=s(t);for(r=0;r<l;r++)r in t&&b(i,t[r]);for(u(i,function(n){return function(t,e){return void 0===e?-1:void 0===t?1:void 0!==n?+n(t,e)||0:c(t)>c(e)?1:-1}}(n)),e=i.length,r=0;r<e;)t[r]=i[r++];for(;r<l;)delete t[r++];return t}})},function(n,t,e){var r=e(31).match(/firefox\/(\d+)/i);n.exports=!!r&&+r[1]},function(n,t,e){var r=e(31);n.exports=/MSIE|Trident/.test(r)},function(n,t,e){var r=e(31).match(/AppleWebKit\/(\d+)\./);n.exports=!!r&&+r[1]},function(n,t,e){},function(n,t,e){},function(n,t,e){"use strict";var r=e(1),i=e(0),a=e(93),o=e(47),s=e(20),c=e(16),l=e(114),u=e(58),p=e(79)("splice"),d=i.TypeError,f=Math.max,h=Math.min;r({target:"Array",proto:!0,forced:!p},{splice:function(n,t){var e,r,i,p,m,v,g=c(this),b=s(g),y=a(n,b),w=arguments.length;if(0===w?e=r=0:1===w?(e=0,r=b-y):(e=w-2,r=h(f(o(t),0),b-y)),b+e-r>9007199254740991)throw d("Maximum allowed length exceeded");for(i=l(g,r),p=0;p<r;p++)(m=y+p)in g&&u(i,p,g[m]);if(i.length=r,e<r){for(p=y;p<b-r;p++)v=p+e,(m=p+r)in g?g[v]=g[m]:delete g[v];for(p=b;p>b-r+e;p--)delete g[p-1]}else if(e>r)for(p=b-r;p>y;p--)v=p+e-1,(m=p+r-1)in g?g[v]=g[m]:delete g[v];for(p=0;p<e;p++)g[p+y]=arguments[p+2];return g.length=b-r+e,i}})},function(n,t,e){"use strict";e(221)},function(n,t,e){"use strict";e(222)},function(n,t,e){"use strict";e.r(t);e(150),e(248),e(261),e(263);var r=e(59),i=e(101),a=(e(43),e(5),e(22),e(25),e(45),e(34),Object.freeze({}));function o(n){return null==n}function s(n){return null!=n}function c(n){return!0===n}function l(n){return"string"==typeof n||"number"==typeof n||"symbol"==typeof n||"boolean"==typeof n}function u(n){return null!==n&&"object"==typeof n}var p=Object.prototype.toString;function d(n){return"[object Object]"===p.call(n)}function f(n){return"[object RegExp]"===p.call(n)}function h(n){var t=parseFloat(String(n));return t>=0&&Math.floor(t)===t&&isFinite(n)}function m(n){return s(n)&&"function"==typeof n.then&&"function"==typeof n.catch}function v(n){return null==n?"":Array.isArray(n)||d(n)&&n.toString===p?JSON.stringify(n,null,2):String(n)}function g(n){var t=parseFloat(n);return isNaN(t)?n:t}function b(n,t){for(var e=Object.create(null),r=n.split(","),i=0;i<r.length;i++)e[r[i]]=!0;return t?function(n){return e[n.toLowerCase()]}:function(n){return e[n]}}b("slot,component",!0);var y=b("key,ref,slot,slot-scope,is");function w(n,t){if(n.length){var e=n.indexOf(t);if(e>-1)return n.splice(e,1)}}var k=Object.prototype.hasOwnProperty;function x(n,t){return k.call(n,t)}function _(n){var t=Object.create(null);return function(e){return t[e]||(t[e]=n(e))}}var S=/-(\w)/g,T=_((function(n){return n.replace(S,(function(n,t){return t?t.toUpperCase():""}))})),j=_((function(n){return n.charAt(0).toUpperCase()+n.slice(1)})),C=/\B([A-Z])/g,I=_((function(n){return n.replace(C,"-$1").toLowerCase()}));var A=Function.prototype.bind?function(n,t){return n.bind(t)}:function(n,t){function e(e){var r=arguments.length;return r?r>1?n.apply(t,arguments):n.call(t,e):n.call(t)}return e._length=n.length,e};function O(n,t){t=t||0;for(var e=n.length-t,r=new Array(e);e--;)r[e]=n[e+t];return r}function E(n,t){for(var e in t)n[e]=t[e];return n}function L(n){for(var t={},e=0;e<n.length;e++)n[e]&&E(t,n[e]);return t}function z(n,t,e){}var M=function(n,t,e){return!1},R=function(n){return n};function P(n,t){if(n===t)return!0;var e=u(n),r=u(t);if(!e||!r)return!e&&!r&&String(n)===String(t);try{var i=Array.isArray(n),a=Array.isArray(t);if(i&&a)return n.length===t.length&&n.every((function(n,e){return P(n,t[e])}));if(n instanceof Date&&t instanceof Date)return n.getTime()===t.getTime();if(i||a)return!1;var o=Object.keys(n),s=Object.keys(t);return o.length===s.length&&o.every((function(e){return P(n[e],t[e])}))}catch(n){return!1}}function B(n,t){for(var e=0;e<n.length;e++)if(P(n[e],t))return e;return-1}function N(n){var t=!1;return function(){t||(t=!0,n.apply(this,arguments))}}var D=["component","directive","filter"],$=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],U={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:M,isReservedAttr:M,isUnknownElement:M,getTagNamespace:z,parsePlatformTagName:R,mustUseProp:M,async:!0,_lifecycleHooks:$},F=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function q(n,t,e,r){Object.defineProperty(n,t,{value:e,enumerable:!!r,writable:!0,configurable:!0})}var V=new RegExp("[^"+F.source+".$_\\d]");var J,W="__proto__"in{},G="undefined"!=typeof window,H="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,K=H&&WXEnvironment.platform.toLowerCase(),X=G&&window.navigator.userAgent.toLowerCase(),Q=X&&/msie|trident/.test(X),Y=X&&X.indexOf("msie 9.0")>0,Z=X&&X.indexOf("edge/")>0,nn=(X&&X.indexOf("android"),X&&/iphone|ipad|ipod|ios/.test(X)||"ios"===K),tn=(X&&/chrome\/\d+/.test(X),X&&/phantomjs/.test(X),X&&X.match(/firefox\/(\d+)/)),en={}.watch,rn=!1;if(G)try{var an={};Object.defineProperty(an,"passive",{get:function(){rn=!0}}),window.addEventListener("test-passive",null,an)}catch(n){}var on=function(){return void 0===J&&(J=!G&&!H&&"undefined"!=typeof global&&(global.process&&"server"===global.process.env.VUE_ENV)),J},sn=G&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function cn(n){return"function"==typeof n&&/native code/.test(n.toString())}var ln,un="undefined"!=typeof Symbol&&cn(Symbol)&&"undefined"!=typeof Reflect&&cn(Reflect.ownKeys);ln="undefined"!=typeof Set&&cn(Set)?Set:function(){function n(){this.set=Object.create(null)}return n.prototype.has=function(n){return!0===this.set[n]},n.prototype.add=function(n){this.set[n]=!0},n.prototype.clear=function(){this.set=Object.create(null)},n}();var pn=z,dn=0,fn=function(){this.id=dn++,this.subs=[]};fn.prototype.addSub=function(n){this.subs.push(n)},fn.prototype.removeSub=function(n){w(this.subs,n)},fn.prototype.depend=function(){fn.target&&fn.target.addDep(this)},fn.prototype.notify=function(){var n=this.subs.slice();for(var t=0,e=n.length;t<e;t++)n[t].update()},fn.target=null;var hn=[];function mn(n){hn.push(n),fn.target=n}function vn(){hn.pop(),fn.target=hn[hn.length-1]}var gn=function(n,t,e,r,i,a,o,s){this.tag=n,this.data=t,this.children=e,this.text=r,this.elm=i,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},bn={child:{configurable:!0}};bn.child.get=function(){return this.componentInstance},Object.defineProperties(gn.prototype,bn);var yn=function(n){void 0===n&&(n="");var t=new gn;return t.text=n,t.isComment=!0,t};function wn(n){return new gn(void 0,void 0,void 0,String(n))}function kn(n){var t=new gn(n.tag,n.data,n.children&&n.children.slice(),n.text,n.elm,n.context,n.componentOptions,n.asyncFactory);return t.ns=n.ns,t.isStatic=n.isStatic,t.key=n.key,t.isComment=n.isComment,t.fnContext=n.fnContext,t.fnOptions=n.fnOptions,t.fnScopeId=n.fnScopeId,t.asyncMeta=n.asyncMeta,t.isCloned=!0,t}var xn=Array.prototype,_n=Object.create(xn);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(n){var t=xn[n];q(_n,n,(function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];var i,a=t.apply(this,e),o=this.__ob__;switch(n){case"push":case"unshift":i=e;break;case"splice":i=e.slice(2)}return i&&o.observeArray(i),o.dep.notify(),a}))}));var Sn=Object.getOwnPropertyNames(_n),Tn=!0;function jn(n){Tn=n}var Cn=function(n){this.value=n,this.dep=new fn,this.vmCount=0,q(n,"__ob__",this),Array.isArray(n)?(W?function(n,t){n.__proto__=t}(n,_n):function(n,t,e){for(var r=0,i=e.length;r<i;r++){var a=e[r];q(n,a,t[a])}}(n,_n,Sn),this.observeArray(n)):this.walk(n)};function In(n,t){var e;if(u(n)&&!(n instanceof gn))return x(n,"__ob__")&&n.__ob__ instanceof Cn?e=n.__ob__:Tn&&!on()&&(Array.isArray(n)||d(n))&&Object.isExtensible(n)&&!n._isVue&&(e=new Cn(n)),t&&e&&e.vmCount++,e}function An(n,t,e,r,i){var a=new fn,o=Object.getOwnPropertyDescriptor(n,t);if(!o||!1!==o.configurable){var s=o&&o.get,c=o&&o.set;s&&!c||2!==arguments.length||(e=n[t]);var l=!i&&In(e);Object.defineProperty(n,t,{enumerable:!0,configurable:!0,get:function(){var t=s?s.call(n):e;return fn.target&&(a.depend(),l&&(l.dep.depend(),Array.isArray(t)&&Ln(t))),t},set:function(t){var r=s?s.call(n):e;t===r||t!=t&&r!=r||s&&!c||(c?c.call(n,t):e=t,l=!i&&In(t),a.notify())}})}}function On(n,t,e){if(Array.isArray(n)&&h(t))return n.length=Math.max(n.length,t),n.splice(t,1,e),e;if(t in n&&!(t in Object.prototype))return n[t]=e,e;var r=n.__ob__;return n._isVue||r&&r.vmCount?e:r?(An(r.value,t,e),r.dep.notify(),e):(n[t]=e,e)}function En(n,t){if(Array.isArray(n)&&h(t))n.splice(t,1);else{var e=n.__ob__;n._isVue||e&&e.vmCount||x(n,t)&&(delete n[t],e&&e.dep.notify())}}function Ln(n){for(var t=void 0,e=0,r=n.length;e<r;e++)(t=n[e])&&t.__ob__&&t.__ob__.dep.depend(),Array.isArray(t)&&Ln(t)}Cn.prototype.walk=function(n){for(var t=Object.keys(n),e=0;e<t.length;e++)An(n,t[e])},Cn.prototype.observeArray=function(n){for(var t=0,e=n.length;t<e;t++)In(n[t])};var zn=U.optionMergeStrategies;function Mn(n,t){if(!t)return n;for(var e,r,i,a=un?Reflect.ownKeys(t):Object.keys(t),o=0;o<a.length;o++)"__ob__"!==(e=a[o])&&(r=n[e],i=t[e],x(n,e)?r!==i&&d(r)&&d(i)&&Mn(r,i):On(n,e,i));return n}function Rn(n,t,e){return e?function(){var r="function"==typeof t?t.call(e,e):t,i="function"==typeof n?n.call(e,e):n;return r?Mn(r,i):i}:t?n?function(){return Mn("function"==typeof t?t.call(this,this):t,"function"==typeof n?n.call(this,this):n)}:t:n}function Pn(n,t){var e=t?n?n.concat(t):Array.isArray(t)?t:[t]:n;return e?function(n){for(var t=[],e=0;e<n.length;e++)-1===t.indexOf(n[e])&&t.push(n[e]);return t}(e):e}function Bn(n,t,e,r){var i=Object.create(n||null);return t?E(i,t):i}zn.data=function(n,t,e){return e?Rn(n,t,e):t&&"function"!=typeof t?n:Rn(n,t)},$.forEach((function(n){zn[n]=Pn})),D.forEach((function(n){zn[n+"s"]=Bn})),zn.watch=function(n,t,e,r){if(n===en&&(n=void 0),t===en&&(t=void 0),!t)return Object.create(n||null);if(!n)return t;var i={};for(var a in E(i,n),t){var o=i[a],s=t[a];o&&!Array.isArray(o)&&(o=[o]),i[a]=o?o.concat(s):Array.isArray(s)?s:[s]}return i},zn.props=zn.methods=zn.inject=zn.computed=function(n,t,e,r){if(!n)return t;var i=Object.create(null);return E(i,n),t&&E(i,t),i},zn.provide=Rn;var Nn=function(n,t){return void 0===t?n:t};function Dn(n,t,e){if("function"==typeof t&&(t=t.options),function(n,t){var e=n.props;if(e){var r,i,a={};if(Array.isArray(e))for(r=e.length;r--;)"string"==typeof(i=e[r])&&(a[T(i)]={type:null});else if(d(e))for(var o in e)i=e[o],a[T(o)]=d(i)?i:{type:i};else 0;n.props=a}}(t),function(n,t){var e=n.inject;if(e){var r=n.inject={};if(Array.isArray(e))for(var i=0;i<e.length;i++)r[e[i]]={from:e[i]};else if(d(e))for(var a in e){var o=e[a];r[a]=d(o)?E({from:a},o):{from:o}}else 0}}(t),function(n){var t=n.directives;if(t)for(var e in t){var r=t[e];"function"==typeof r&&(t[e]={bind:r,update:r})}}(t),!t._base&&(t.extends&&(n=Dn(n,t.extends,e)),t.mixins))for(var r=0,i=t.mixins.length;r<i;r++)n=Dn(n,t.mixins[r],e);var a,o={};for(a in n)s(a);for(a in t)x(n,a)||s(a);function s(r){var i=zn[r]||Nn;o[r]=i(n[r],t[r],e,r)}return o}function $n(n,t,e,r){if("string"==typeof e){var i=n[t];if(x(i,e))return i[e];var a=T(e);if(x(i,a))return i[a];var o=j(a);return x(i,o)?i[o]:i[e]||i[a]||i[o]}}function Un(n,t,e,r){var i=t[n],a=!x(e,n),o=e[n],s=Jn(Boolean,i.type);if(s>-1)if(a&&!x(i,"default"))o=!1;else if(""===o||o===I(n)){var c=Jn(String,i.type);(c<0||s<c)&&(o=!0)}if(void 0===o){o=function(n,t,e){if(!x(t,"default"))return;var r=t.default;0;if(n&&n.$options.propsData&&void 0===n.$options.propsData[e]&&void 0!==n._props[e])return n._props[e];return"function"==typeof r&&"Function"!==qn(t.type)?r.call(n):r}(r,i,n);var l=Tn;jn(!0),In(o),jn(l)}return o}var Fn=/^\s*function (\w+)/;function qn(n){var t=n&&n.toString().match(Fn);return t?t[1]:""}function Vn(n,t){return qn(n)===qn(t)}function Jn(n,t){if(!Array.isArray(t))return Vn(t,n)?0:-1;for(var e=0,r=t.length;e<r;e++)if(Vn(t[e],n))return e;return-1}function Wn(n,t,e){mn();try{if(t)for(var r=t;r=r.$parent;){var i=r.$options.errorCaptured;if(i)for(var a=0;a<i.length;a++)try{if(!1===i[a].call(r,n,t,e))return}catch(n){Hn(n,r,"errorCaptured hook")}}Hn(n,t,e)}finally{vn()}}function Gn(n,t,e,r,i){var a;try{(a=e?n.apply(t,e):n.call(t))&&!a._isVue&&m(a)&&!a._handled&&(a.catch((function(n){return Wn(n,r,i+" (Promise/async)")})),a._handled=!0)}catch(n){Wn(n,r,i)}return a}function Hn(n,t,e){if(U.errorHandler)try{return U.errorHandler.call(null,n,t,e)}catch(t){t!==n&&Kn(t,null,"config.errorHandler")}Kn(n,t,e)}function Kn(n,t,e){if(!G&&!H||"undefined"==typeof console)throw n;console.error(n)}var Xn,Qn=!1,Yn=[],Zn=!1;function nt(){Zn=!1;var n=Yn.slice(0);Yn.length=0;for(var t=0;t<n.length;t++)n[t]()}if("undefined"!=typeof Promise&&cn(Promise)){var tt=Promise.resolve();Xn=function(){tt.then(nt),nn&&setTimeout(z)},Qn=!0}else if(Q||"undefined"==typeof MutationObserver||!cn(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Xn="undefined"!=typeof setImmediate&&cn(setImmediate)?function(){setImmediate(nt)}:function(){setTimeout(nt,0)};else{var et=1,rt=new MutationObserver(nt),it=document.createTextNode(String(et));rt.observe(it,{characterData:!0}),Xn=function(){et=(et+1)%2,it.data=String(et)},Qn=!0}function at(n,t){var e;if(Yn.push((function(){if(n)try{n.call(t)}catch(n){Wn(n,t,"nextTick")}else e&&e(t)})),Zn||(Zn=!0,Xn()),!n&&"undefined"!=typeof Promise)return new Promise((function(n){e=n}))}var ot=new ln;function st(n){!function n(t,e){var r,i,a=Array.isArray(t);if(!a&&!u(t)||Object.isFrozen(t)||t instanceof gn)return;if(t.__ob__){var o=t.__ob__.dep.id;if(e.has(o))return;e.add(o)}if(a)for(r=t.length;r--;)n(t[r],e);else for(i=Object.keys(t),r=i.length;r--;)n(t[i[r]],e)}(n,ot),ot.clear()}var ct=_((function(n){var t="&"===n.charAt(0),e="~"===(n=t?n.slice(1):n).charAt(0),r="!"===(n=e?n.slice(1):n).charAt(0);return{name:n=r?n.slice(1):n,once:e,capture:r,passive:t}}));function lt(n,t){function e(){var n=arguments,r=e.fns;if(!Array.isArray(r))return Gn(r,null,arguments,t,"v-on handler");for(var i=r.slice(),a=0;a<i.length;a++)Gn(i[a],null,n,t,"v-on handler")}return e.fns=n,e}function ut(n,t,e,r,i,a){var s,l,u,p;for(s in n)l=n[s],u=t[s],p=ct(s),o(l)||(o(u)?(o(l.fns)&&(l=n[s]=lt(l,a)),c(p.once)&&(l=n[s]=i(p.name,l,p.capture)),e(p.name,l,p.capture,p.passive,p.params)):l!==u&&(u.fns=l,n[s]=u));for(s in t)o(n[s])&&r((p=ct(s)).name,t[s],p.capture)}function pt(n,t,e){var r;n instanceof gn&&(n=n.data.hook||(n.data.hook={}));var i=n[t];function a(){e.apply(this,arguments),w(r.fns,a)}o(i)?r=lt([a]):s(i.fns)&&c(i.merged)?(r=i).fns.push(a):r=lt([i,a]),r.merged=!0,n[t]=r}function dt(n,t,e,r,i){if(s(t)){if(x(t,e))return n[e]=t[e],i||delete t[e],!0;if(x(t,r))return n[e]=t[r],i||delete t[r],!0}return!1}function ft(n){return l(n)?[wn(n)]:Array.isArray(n)?function n(t,e){var r,i,a,u,p=[];for(r=0;r<t.length;r++)o(i=t[r])||"boolean"==typeof i||(a=p.length-1,u=p[a],Array.isArray(i)?i.length>0&&(ht((i=n(i,(e||"")+"_"+r))[0])&&ht(u)&&(p[a]=wn(u.text+i[0].text),i.shift()),p.push.apply(p,i)):l(i)?ht(u)?p[a]=wn(u.text+i):""!==i&&p.push(wn(i)):ht(i)&&ht(u)?p[a]=wn(u.text+i.text):(c(t._isVList)&&s(i.tag)&&o(i.key)&&s(e)&&(i.key="__vlist"+e+"_"+r+"__"),p.push(i)));return p}(n):void 0}function ht(n){return s(n)&&s(n.text)&&!1===n.isComment}function mt(n,t){if(n){for(var e=Object.create(null),r=un?Reflect.ownKeys(n):Object.keys(n),i=0;i<r.length;i++){var a=r[i];if("__ob__"!==a){for(var o=n[a].from,s=t;s;){if(s._provided&&x(s._provided,o)){e[a]=s._provided[o];break}s=s.$parent}if(!s)if("default"in n[a]){var c=n[a].default;e[a]="function"==typeof c?c.call(t):c}else 0}}return e}}function vt(n,t){if(!n||!n.length)return{};for(var e={},r=0,i=n.length;r<i;r++){var a=n[r],o=a.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,a.context!==t&&a.fnContext!==t||!o||null==o.slot)(e.default||(e.default=[])).push(a);else{var s=o.slot,c=e[s]||(e[s]=[]);"template"===a.tag?c.push.apply(c,a.children||[]):c.push(a)}}for(var l in e)e[l].every(gt)&&delete e[l];return e}function gt(n){return n.isComment&&!n.asyncFactory||" "===n.text}function bt(n){return n.isComment&&n.asyncFactory}function yt(n,t,e){var r,i=Object.keys(t).length>0,o=n?!!n.$stable:!i,s=n&&n.$key;if(n){if(n._normalized)return n._normalized;if(o&&e&&e!==a&&s===e.$key&&!i&&!e.$hasNormal)return e;for(var c in r={},n)n[c]&&"$"!==c[0]&&(r[c]=wt(t,c,n[c]))}else r={};for(var l in t)l in r||(r[l]=kt(t,l));return n&&Object.isExtensible(n)&&(n._normalized=r),q(r,"$stable",o),q(r,"$key",s),q(r,"$hasNormal",i),r}function wt(n,t,e){var r=function(){var n=arguments.length?e.apply(null,arguments):e({}),t=(n=n&&"object"==typeof n&&!Array.isArray(n)?[n]:ft(n))&&n[0];return n&&(!t||1===n.length&&t.isComment&&!bt(t))?void 0:n};return e.proxy&&Object.defineProperty(n,t,{get:r,enumerable:!0,configurable:!0}),r}function kt(n,t){return function(){return n[t]}}function xt(n,t){var e,r,i,a,o;if(Array.isArray(n)||"string"==typeof n)for(e=new Array(n.length),r=0,i=n.length;r<i;r++)e[r]=t(n[r],r);else if("number"==typeof n)for(e=new Array(n),r=0;r<n;r++)e[r]=t(r+1,r);else if(u(n))if(un&&n[Symbol.iterator]){e=[];for(var c=n[Symbol.iterator](),l=c.next();!l.done;)e.push(t(l.value,e.length)),l=c.next()}else for(a=Object.keys(n),e=new Array(a.length),r=0,i=a.length;r<i;r++)o=a[r],e[r]=t(n[o],o,r);return s(e)||(e=[]),e._isVList=!0,e}function _t(n,t,e,r){var i,a=this.$scopedSlots[n];a?(e=e||{},r&&(e=E(E({},r),e)),i=a(e)||("function"==typeof t?t():t)):i=this.$slots[n]||("function"==typeof t?t():t);var o=e&&e.slot;return o?this.$createElement("template",{slot:o},i):i}function St(n){return $n(this.$options,"filters",n)||R}function Tt(n,t){return Array.isArray(n)?-1===n.indexOf(t):n!==t}function jt(n,t,e,r,i){var a=U.keyCodes[t]||e;return i&&r&&!U.keyCodes[t]?Tt(i,r):a?Tt(a,n):r?I(r)!==t:void 0===n}function Ct(n,t,e,r,i){if(e)if(u(e)){var a;Array.isArray(e)&&(e=L(e));var o=function(o){if("class"===o||"style"===o||y(o))a=n;else{var s=n.attrs&&n.attrs.type;a=r||U.mustUseProp(t,s,o)?n.domProps||(n.domProps={}):n.attrs||(n.attrs={})}var c=T(o),l=I(o);c in a||l in a||(a[o]=e[o],i&&((n.on||(n.on={}))["update:"+o]=function(n){e[o]=n}))};for(var s in e)o(s)}else;return n}function It(n,t){var e=this._staticTrees||(this._staticTrees=[]),r=e[n];return r&&!t||Ot(r=e[n]=this.$options.staticRenderFns[n].call(this._renderProxy,null,this),"__static__"+n,!1),r}function At(n,t,e){return Ot(n,"__once__"+t+(e?"_"+e:""),!0),n}function Ot(n,t,e){if(Array.isArray(n))for(var r=0;r<n.length;r++)n[r]&&"string"!=typeof n[r]&&Et(n[r],t+"_"+r,e);else Et(n,t,e)}function Et(n,t,e){n.isStatic=!0,n.key=t,n.isOnce=e}function Lt(n,t){if(t)if(d(t)){var e=n.on=n.on?E({},n.on):{};for(var r in t){var i=e[r],a=t[r];e[r]=i?[].concat(i,a):a}}else;return n}function zt(n,t,e,r){t=t||{$stable:!e};for(var i=0;i<n.length;i++){var a=n[i];Array.isArray(a)?zt(a,t,e):a&&(a.proxy&&(a.fn.proxy=!0),t[a.key]=a.fn)}return r&&(t.$key=r),t}function Mt(n,t){for(var e=0;e<t.length;e+=2){var r=t[e];"string"==typeof r&&r&&(n[t[e]]=t[e+1])}return n}function Rt(n,t){return"string"==typeof n?t+n:n}function Pt(n){n._o=At,n._n=g,n._s=v,n._l=xt,n._t=_t,n._q=P,n._i=B,n._m=It,n._f=St,n._k=jt,n._b=Ct,n._v=wn,n._e=yn,n._u=zt,n._g=Lt,n._d=Mt,n._p=Rt}function Bt(n,t,e,r,i){var o,s=this,l=i.options;x(r,"_uid")?(o=Object.create(r))._original=r:(o=r,r=r._original);var u=c(l._compiled),p=!u;this.data=n,this.props=t,this.children=e,this.parent=r,this.listeners=n.on||a,this.injections=mt(l.inject,r),this.slots=function(){return s.$slots||yt(n.scopedSlots,s.$slots=vt(e,r)),s.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return yt(n.scopedSlots,this.slots())}}),u&&(this.$options=l,this.$slots=this.slots(),this.$scopedSlots=yt(n.scopedSlots,this.$slots)),l._scopeId?this._c=function(n,t,e,i){var a=Vt(o,n,t,e,i,p);return a&&!Array.isArray(a)&&(a.fnScopeId=l._scopeId,a.fnContext=r),a}:this._c=function(n,t,e,r){return Vt(o,n,t,e,r,p)}}function Nt(n,t,e,r,i){var a=kn(n);return a.fnContext=e,a.fnOptions=r,t.slot&&((a.data||(a.data={})).slot=t.slot),a}function Dt(n,t){for(var e in t)n[T(e)]=t[e]}Pt(Bt.prototype);var $t={init:function(n,t){if(n.componentInstance&&!n.componentInstance._isDestroyed&&n.data.keepAlive){var e=n;$t.prepatch(e,e)}else{(n.componentInstance=function(n,t){var e={_isComponent:!0,_parentVnode:n,parent:t},r=n.data.inlineTemplate;s(r)&&(e.render=r.render,e.staticRenderFns=r.staticRenderFns);return new n.componentOptions.Ctor(e)}(n,Zt)).$mount(t?n.elm:void 0,t)}},prepatch:function(n,t){var e=t.componentOptions;!function(n,t,e,r,i){0;var o=r.data.scopedSlots,s=n.$scopedSlots,c=!!(o&&!o.$stable||s!==a&&!s.$stable||o&&n.$scopedSlots.$key!==o.$key||!o&&n.$scopedSlots.$key),l=!!(i||n.$options._renderChildren||c);n.$options._parentVnode=r,n.$vnode=r,n._vnode&&(n._vnode.parent=r);if(n.$options._renderChildren=i,n.$attrs=r.data.attrs||a,n.$listeners=e||a,t&&n.$options.props){jn(!1);for(var u=n._props,p=n.$options._propKeys||[],d=0;d<p.length;d++){var f=p[d],h=n.$options.props;u[f]=Un(f,h,t,n)}jn(!0),n.$options.propsData=t}e=e||a;var m=n.$options._parentListeners;n.$options._parentListeners=e,Yt(n,e,m),l&&(n.$slots=vt(i,r.context),n.$forceUpdate());0}(t.componentInstance=n.componentInstance,e.propsData,e.listeners,t,e.children)},insert:function(n){var t,e=n.context,r=n.componentInstance;r._isMounted||(r._isMounted=!0,re(r,"mounted")),n.data.keepAlive&&(e._isMounted?((t=r)._inactive=!1,ae.push(t)):ee(r,!0))},destroy:function(n){var t=n.componentInstance;t._isDestroyed||(n.data.keepAlive?function n(t,e){if(e&&(t._directInactive=!0,te(t)))return;if(!t._inactive){t._inactive=!0;for(var r=0;r<t.$children.length;r++)n(t.$children[r]);re(t,"deactivated")}}(t,!0):t.$destroy())}},Ut=Object.keys($t);function Ft(n,t,e,r,i){if(!o(n)){var l=e.$options._base;if(u(n)&&(n=l.extend(n)),"function"==typeof n){var p;if(o(n.cid)&&void 0===(n=function(n,t){if(c(n.error)&&s(n.errorComp))return n.errorComp;if(s(n.resolved))return n.resolved;var e=Wt;e&&s(n.owners)&&-1===n.owners.indexOf(e)&&n.owners.push(e);if(c(n.loading)&&s(n.loadingComp))return n.loadingComp;if(e&&!s(n.owners)){var r=n.owners=[e],i=!0,a=null,l=null;e.$on("hook:destroyed",(function(){return w(r,e)}));var p=function(n){for(var t=0,e=r.length;t<e;t++)r[t].$forceUpdate();n&&(r.length=0,null!==a&&(clearTimeout(a),a=null),null!==l&&(clearTimeout(l),l=null))},d=N((function(e){n.resolved=Gt(e,t),i?r.length=0:p(!0)})),f=N((function(t){s(n.errorComp)&&(n.error=!0,p(!0))})),h=n(d,f);return u(h)&&(m(h)?o(n.resolved)&&h.then(d,f):m(h.component)&&(h.component.then(d,f),s(h.error)&&(n.errorComp=Gt(h.error,t)),s(h.loading)&&(n.loadingComp=Gt(h.loading,t),0===h.delay?n.loading=!0:a=setTimeout((function(){a=null,o(n.resolved)&&o(n.error)&&(n.loading=!0,p(!1))}),h.delay||200)),s(h.timeout)&&(l=setTimeout((function(){l=null,o(n.resolved)&&f(null)}),h.timeout)))),i=!1,n.loading?n.loadingComp:n.resolved}}(p=n,l)))return function(n,t,e,r,i){var a=yn();return a.asyncFactory=n,a.asyncMeta={data:t,context:e,children:r,tag:i},a}(p,t,e,r,i);t=t||{},Te(n),s(t.model)&&function(n,t){var e=n.model&&n.model.prop||"value",r=n.model&&n.model.event||"input";(t.attrs||(t.attrs={}))[e]=t.model.value;var i=t.on||(t.on={}),a=i[r],o=t.model.callback;s(a)?(Array.isArray(a)?-1===a.indexOf(o):a!==o)&&(i[r]=[o].concat(a)):i[r]=o}(n.options,t);var d=function(n,t,e){var r=t.options.props;if(!o(r)){var i={},a=n.attrs,c=n.props;if(s(a)||s(c))for(var l in r){var u=I(l);dt(i,c,l,u,!0)||dt(i,a,l,u,!1)}return i}}(t,n);if(c(n.options.functional))return function(n,t,e,r,i){var o=n.options,c={},l=o.props;if(s(l))for(var u in l)c[u]=Un(u,l,t||a);else s(e.attrs)&&Dt(c,e.attrs),s(e.props)&&Dt(c,e.props);var p=new Bt(e,c,i,r,n),d=o.render.call(null,p._c,p);if(d instanceof gn)return Nt(d,e,p.parent,o,p);if(Array.isArray(d)){for(var f=ft(d)||[],h=new Array(f.length),m=0;m<f.length;m++)h[m]=Nt(f[m],e,p.parent,o,p);return h}}(n,d,t,e,r);var f=t.on;if(t.on=t.nativeOn,c(n.options.abstract)){var h=t.slot;t={},h&&(t.slot=h)}!function(n){for(var t=n.hook||(n.hook={}),e=0;e<Ut.length;e++){var r=Ut[e],i=t[r],a=$t[r];i===a||i&&i._merged||(t[r]=i?qt(a,i):a)}}(t);var v=n.options.name||i;return new gn("vue-component-"+n.cid+(v?"-"+v:""),t,void 0,void 0,void 0,e,{Ctor:n,propsData:d,listeners:f,tag:i,children:r},p)}}}function qt(n,t){var e=function(e,r){n(e,r),t(e,r)};return e._merged=!0,e}function Vt(n,t,e,r,i,a){return(Array.isArray(e)||l(e))&&(i=r,r=e,e=void 0),c(a)&&(i=2),function(n,t,e,r,i){if(s(e)&&s(e.__ob__))return yn();s(e)&&s(e.is)&&(t=e.is);if(!t)return yn();0;Array.isArray(r)&&"function"==typeof r[0]&&((e=e||{}).scopedSlots={default:r[0]},r.length=0);2===i?r=ft(r):1===i&&(r=function(n){for(var t=0;t<n.length;t++)if(Array.isArray(n[t]))return Array.prototype.concat.apply([],n);return n}(r));var a,l;if("string"==typeof t){var p;l=n.$vnode&&n.$vnode.ns||U.getTagNamespace(t),a=U.isReservedTag(t)?new gn(U.parsePlatformTagName(t),e,r,void 0,void 0,n):e&&e.pre||!s(p=$n(n.$options,"components",t))?new gn(t,e,r,void 0,void 0,n):Ft(p,e,n,r,t)}else a=Ft(t,e,n,r);return Array.isArray(a)?a:s(a)?(s(l)&&function n(t,e,r){t.ns=e,"foreignObject"===t.tag&&(e=void 0,r=!0);if(s(t.children))for(var i=0,a=t.children.length;i<a;i++){var l=t.children[i];s(l.tag)&&(o(l.ns)||c(r)&&"svg"!==l.tag)&&n(l,e,r)}}(a,l),s(e)&&function(n){u(n.style)&&st(n.style);u(n.class)&&st(n.class)}(e),a):yn()}(n,t,e,r,i)}var Jt,Wt=null;function Gt(n,t){return(n.__esModule||un&&"Module"===n[Symbol.toStringTag])&&(n=n.default),u(n)?t.extend(n):n}function Ht(n){if(Array.isArray(n))for(var t=0;t<n.length;t++){var e=n[t];if(s(e)&&(s(e.componentOptions)||bt(e)))return e}}function Kt(n,t){Jt.$on(n,t)}function Xt(n,t){Jt.$off(n,t)}function Qt(n,t){var e=Jt;return function r(){var i=t.apply(null,arguments);null!==i&&e.$off(n,r)}}function Yt(n,t,e){Jt=n,ut(t,e||{},Kt,Xt,Qt,n),Jt=void 0}var Zt=null;function ne(n){var t=Zt;return Zt=n,function(){Zt=t}}function te(n){for(;n&&(n=n.$parent);)if(n._inactive)return!0;return!1}function ee(n,t){if(t){if(n._directInactive=!1,te(n))return}else if(n._directInactive)return;if(n._inactive||null===n._inactive){n._inactive=!1;for(var e=0;e<n.$children.length;e++)ee(n.$children[e]);re(n,"activated")}}function re(n,t){mn();var e=n.$options[t],r=t+" hook";if(e)for(var i=0,a=e.length;i<a;i++)Gn(e[i],n,null,n,r);n._hasHookEvent&&n.$emit("hook:"+t),vn()}var ie=[],ae=[],oe={},se=!1,ce=!1,le=0;var ue=0,pe=Date.now;if(G&&!Q){var de=window.performance;de&&"function"==typeof de.now&&pe()>document.createEvent("Event").timeStamp&&(pe=function(){return de.now()})}function fe(){var n,t;for(ue=pe(),ce=!0,ie.sort((function(n,t){return n.id-t.id})),le=0;le<ie.length;le++)(n=ie[le]).before&&n.before(),t=n.id,oe[t]=null,n.run();var e=ae.slice(),r=ie.slice();le=ie.length=ae.length=0,oe={},se=ce=!1,function(n){for(var t=0;t<n.length;t++)n[t]._inactive=!0,ee(n[t],!0)}(e),function(n){var t=n.length;for(;t--;){var e=n[t],r=e.vm;r._watcher===e&&r._isMounted&&!r._isDestroyed&&re(r,"updated")}}(r),sn&&U.devtools&&sn.emit("flush")}var he=0,me=function(n,t,e,r,i){this.vm=n,i&&(n._watcher=this),n._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=e,this.id=++he,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ln,this.newDepIds=new ln,this.expression="","function"==typeof t?this.getter=t:(this.getter=function(n){if(!V.test(n)){var t=n.split(".");return function(n){for(var e=0;e<t.length;e++){if(!n)return;n=n[t[e]]}return n}}}(t),this.getter||(this.getter=z)),this.value=this.lazy?void 0:this.get()};me.prototype.get=function(){var n;mn(this);var t=this.vm;try{n=this.getter.call(t,t)}catch(n){if(!this.user)throw n;Wn(n,t,'getter for watcher "'+this.expression+'"')}finally{this.deep&&st(n),vn(),this.cleanupDeps()}return n},me.prototype.addDep=function(n){var t=n.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(n),this.depIds.has(t)||n.addSub(this))},me.prototype.cleanupDeps=function(){for(var n=this.deps.length;n--;){var t=this.deps[n];this.newDepIds.has(t.id)||t.removeSub(this)}var e=this.depIds;this.depIds=this.newDepIds,this.newDepIds=e,this.newDepIds.clear(),e=this.deps,this.deps=this.newDeps,this.newDeps=e,this.newDeps.length=0},me.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(n){var t=n.id;if(null==oe[t]){if(oe[t]=!0,ce){for(var e=ie.length-1;e>le&&ie[e].id>n.id;)e--;ie.splice(e+1,0,n)}else ie.push(n);se||(se=!0,at(fe))}}(this)},me.prototype.run=function(){if(this.active){var n=this.get();if(n!==this.value||u(n)||this.deep){var t=this.value;if(this.value=n,this.user){var e='callback for watcher "'+this.expression+'"';Gn(this.cb,this.vm,[n,t],this.vm,e)}else this.cb.call(this.vm,n,t)}}},me.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},me.prototype.depend=function(){for(var n=this.deps.length;n--;)this.deps[n].depend()},me.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||w(this.vm._watchers,this);for(var n=this.deps.length;n--;)this.deps[n].removeSub(this);this.active=!1}};var ve={enumerable:!0,configurable:!0,get:z,set:z};function ge(n,t,e){ve.get=function(){return this[t][e]},ve.set=function(n){this[t][e]=n},Object.defineProperty(n,e,ve)}function be(n){n._watchers=[];var t=n.$options;t.props&&function(n,t){var e=n.$options.propsData||{},r=n._props={},i=n.$options._propKeys=[];n.$parent&&jn(!1);var a=function(a){i.push(a);var o=Un(a,t,e,n);An(r,a,o),a in n||ge(n,"_props",a)};for(var o in t)a(o);jn(!0)}(n,t.props),t.methods&&function(n,t){n.$options.props;for(var e in t)n[e]="function"!=typeof t[e]?z:A(t[e],n)}(n,t.methods),t.data?function(n){var t=n.$options.data;d(t=n._data="function"==typeof t?function(n,t){mn();try{return n.call(t,t)}catch(n){return Wn(n,t,"data()"),{}}finally{vn()}}(t,n):t||{})||(t={});var e=Object.keys(t),r=n.$options.props,i=(n.$options.methods,e.length);for(;i--;){var a=e[i];0,r&&x(r,a)||(o=void 0,36!==(o=(a+"").charCodeAt(0))&&95!==o&&ge(n,"_data",a))}var o;In(t,!0)}(n):In(n._data={},!0),t.computed&&function(n,t){var e=n._computedWatchers=Object.create(null),r=on();for(var i in t){var a=t[i],o="function"==typeof a?a:a.get;0,r||(e[i]=new me(n,o||z,z,ye)),i in n||we(n,i,a)}}(n,t.computed),t.watch&&t.watch!==en&&function(n,t){for(var e in t){var r=t[e];if(Array.isArray(r))for(var i=0;i<r.length;i++)_e(n,e,r[i]);else _e(n,e,r)}}(n,t.watch)}var ye={lazy:!0};function we(n,t,e){var r=!on();"function"==typeof e?(ve.get=r?ke(t):xe(e),ve.set=z):(ve.get=e.get?r&&!1!==e.cache?ke(t):xe(e.get):z,ve.set=e.set||z),Object.defineProperty(n,t,ve)}function ke(n){return function(){var t=this._computedWatchers&&this._computedWatchers[n];if(t)return t.dirty&&t.evaluate(),fn.target&&t.depend(),t.value}}function xe(n){return function(){return n.call(this,this)}}function _e(n,t,e,r){return d(e)&&(r=e,e=e.handler),"string"==typeof e&&(e=n[e]),n.$watch(t,e,r)}var Se=0;function Te(n){var t=n.options;if(n.super){var e=Te(n.super);if(e!==n.superOptions){n.superOptions=e;var r=function(n){var t,e=n.options,r=n.sealedOptions;for(var i in e)e[i]!==r[i]&&(t||(t={}),t[i]=e[i]);return t}(n);r&&E(n.extendOptions,r),(t=n.options=Dn(e,n.extendOptions)).name&&(t.components[t.name]=n)}}return t}function je(n){this._init(n)}function Ce(n){n.cid=0;var t=1;n.extend=function(n){n=n||{};var e=this,r=e.cid,i=n._Ctor||(n._Ctor={});if(i[r])return i[r];var a=n.name||e.options.name;var o=function(n){this._init(n)};return(o.prototype=Object.create(e.prototype)).constructor=o,o.cid=t++,o.options=Dn(e.options,n),o.super=e,o.options.props&&function(n){var t=n.options.props;for(var e in t)ge(n.prototype,"_props",e)}(o),o.options.computed&&function(n){var t=n.options.computed;for(var e in t)we(n.prototype,e,t[e])}(o),o.extend=e.extend,o.mixin=e.mixin,o.use=e.use,D.forEach((function(n){o[n]=e[n]})),a&&(o.options.components[a]=o),o.superOptions=e.options,o.extendOptions=n,o.sealedOptions=E({},o.options),i[r]=o,o}}function Ie(n){return n&&(n.Ctor.options.name||n.tag)}function Ae(n,t){return Array.isArray(n)?n.indexOf(t)>-1:"string"==typeof n?n.split(",").indexOf(t)>-1:!!f(n)&&n.test(t)}function Oe(n,t){var e=n.cache,r=n.keys,i=n._vnode;for(var a in e){var o=e[a];if(o){var s=o.name;s&&!t(s)&&Ee(e,a,r,i)}}}function Ee(n,t,e,r){var i=n[t];!i||r&&i.tag===r.tag||i.componentInstance.$destroy(),n[t]=null,w(e,t)}!function(n){n.prototype._init=function(n){var t=this;t._uid=Se++,t._isVue=!0,n&&n._isComponent?function(n,t){var e=n.$options=Object.create(n.constructor.options),r=t._parentVnode;e.parent=t.parent,e._parentVnode=r;var i=r.componentOptions;e.propsData=i.propsData,e._parentListeners=i.listeners,e._renderChildren=i.children,e._componentTag=i.tag,t.render&&(e.render=t.render,e.staticRenderFns=t.staticRenderFns)}(t,n):t.$options=Dn(Te(t.constructor),n||{},t),t._renderProxy=t,t._self=t,function(n){var t=n.$options,e=t.parent;if(e&&!t.abstract){for(;e.$options.abstract&&e.$parent;)e=e.$parent;e.$children.push(n)}n.$parent=e,n.$root=e?e.$root:n,n.$children=[],n.$refs={},n._watcher=null,n._inactive=null,n._directInactive=!1,n._isMounted=!1,n._isDestroyed=!1,n._isBeingDestroyed=!1}(t),function(n){n._events=Object.create(null),n._hasHookEvent=!1;var t=n.$options._parentListeners;t&&Yt(n,t)}(t),function(n){n._vnode=null,n._staticTrees=null;var t=n.$options,e=n.$vnode=t._parentVnode,r=e&&e.context;n.$slots=vt(t._renderChildren,r),n.$scopedSlots=a,n._c=function(t,e,r,i){return Vt(n,t,e,r,i,!1)},n.$createElement=function(t,e,r,i){return Vt(n,t,e,r,i,!0)};var i=e&&e.data;An(n,"$attrs",i&&i.attrs||a,null,!0),An(n,"$listeners",t._parentListeners||a,null,!0)}(t),re(t,"beforeCreate"),function(n){var t=mt(n.$options.inject,n);t&&(jn(!1),Object.keys(t).forEach((function(e){An(n,e,t[e])})),jn(!0))}(t),be(t),function(n){var t=n.$options.provide;t&&(n._provided="function"==typeof t?t.call(n):t)}(t),re(t,"created"),t.$options.el&&t.$mount(t.$options.el)}}(je),function(n){var t={get:function(){return this._data}},e={get:function(){return this._props}};Object.defineProperty(n.prototype,"$data",t),Object.defineProperty(n.prototype,"$props",e),n.prototype.$set=On,n.prototype.$delete=En,n.prototype.$watch=function(n,t,e){if(d(t))return _e(this,n,t,e);(e=e||{}).user=!0;var r=new me(this,n,t,e);if(e.immediate){var i='callback for immediate watcher "'+r.expression+'"';mn(),Gn(t,this,[r.value],this,i),vn()}return function(){r.teardown()}}}(je),function(n){var t=/^hook:/;n.prototype.$on=function(n,e){var r=this;if(Array.isArray(n))for(var i=0,a=n.length;i<a;i++)r.$on(n[i],e);else(r._events[n]||(r._events[n]=[])).push(e),t.test(n)&&(r._hasHookEvent=!0);return r},n.prototype.$once=function(n,t){var e=this;function r(){e.$off(n,r),t.apply(e,arguments)}return r.fn=t,e.$on(n,r),e},n.prototype.$off=function(n,t){var e=this;if(!arguments.length)return e._events=Object.create(null),e;if(Array.isArray(n)){for(var r=0,i=n.length;r<i;r++)e.$off(n[r],t);return e}var a,o=e._events[n];if(!o)return e;if(!t)return e._events[n]=null,e;for(var s=o.length;s--;)if((a=o[s])===t||a.fn===t){o.splice(s,1);break}return e},n.prototype.$emit=function(n){var t=this,e=t._events[n];if(e){e=e.length>1?O(e):e;for(var r=O(arguments,1),i='event handler for "'+n+'"',a=0,o=e.length;a<o;a++)Gn(e[a],t,r,t,i)}return t}}(je),function(n){n.prototype._update=function(n,t){var e=this,r=e.$el,i=e._vnode,a=ne(e);e._vnode=n,e.$el=i?e.__patch__(i,n):e.__patch__(e.$el,n,t,!1),a(),r&&(r.__vue__=null),e.$el&&(e.$el.__vue__=e),e.$vnode&&e.$parent&&e.$vnode===e.$parent._vnode&&(e.$parent.$el=e.$el)},n.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},n.prototype.$destroy=function(){var n=this;if(!n._isBeingDestroyed){re(n,"beforeDestroy"),n._isBeingDestroyed=!0;var t=n.$parent;!t||t._isBeingDestroyed||n.$options.abstract||w(t.$children,n),n._watcher&&n._watcher.teardown();for(var e=n._watchers.length;e--;)n._watchers[e].teardown();n._data.__ob__&&n._data.__ob__.vmCount--,n._isDestroyed=!0,n.__patch__(n._vnode,null),re(n,"destroyed"),n.$off(),n.$el&&(n.$el.__vue__=null),n.$vnode&&(n.$vnode.parent=null)}}}(je),function(n){Pt(n.prototype),n.prototype.$nextTick=function(n){return at(n,this)},n.prototype._render=function(){var n,t=this,e=t.$options,r=e.render,i=e._parentVnode;i&&(t.$scopedSlots=yt(i.data.scopedSlots,t.$slots,t.$scopedSlots)),t.$vnode=i;try{Wt=t,n=r.call(t._renderProxy,t.$createElement)}catch(e){Wn(e,t,"render"),n=t._vnode}finally{Wt=null}return Array.isArray(n)&&1===n.length&&(n=n[0]),n instanceof gn||(n=yn()),n.parent=i,n}}(je);var Le=[String,RegExp,Array],ze={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Le,exclude:Le,max:[String,Number]},methods:{cacheVNode:function(){var n=this.cache,t=this.keys,e=this.vnodeToCache,r=this.keyToCache;if(e){var i=e.tag,a=e.componentInstance,o=e.componentOptions;n[r]={name:Ie(o),tag:i,componentInstance:a},t.push(r),this.max&&t.length>parseInt(this.max)&&Ee(n,t[0],t,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var n in this.cache)Ee(this.cache,n,this.keys)},mounted:function(){var n=this;this.cacheVNode(),this.$watch("include",(function(t){Oe(n,(function(n){return Ae(t,n)}))})),this.$watch("exclude",(function(t){Oe(n,(function(n){return!Ae(t,n)}))}))},updated:function(){this.cacheVNode()},render:function(){var n=this.$slots.default,t=Ht(n),e=t&&t.componentOptions;if(e){var r=Ie(e),i=this.include,a=this.exclude;if(i&&(!r||!Ae(i,r))||a&&r&&Ae(a,r))return t;var o=this.cache,s=this.keys,c=null==t.key?e.Ctor.cid+(e.tag?"::"+e.tag:""):t.key;o[c]?(t.componentInstance=o[c].componentInstance,w(s,c),s.push(c)):(this.vnodeToCache=t,this.keyToCache=c),t.data.keepAlive=!0}return t||n&&n[0]}}};!function(n){var t={get:function(){return U}};Object.defineProperty(n,"config",t),n.util={warn:pn,extend:E,mergeOptions:Dn,defineReactive:An},n.set=On,n.delete=En,n.nextTick=at,n.observable=function(n){return In(n),n},n.options=Object.create(null),D.forEach((function(t){n.options[t+"s"]=Object.create(null)})),n.options._base=n,E(n.options.components,ze),function(n){n.use=function(n){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(n)>-1)return this;var e=O(arguments,1);return e.unshift(this),"function"==typeof n.install?n.install.apply(n,e):"function"==typeof n&&n.apply(null,e),t.push(n),this}}(n),function(n){n.mixin=function(n){return this.options=Dn(this.options,n),this}}(n),Ce(n),function(n){D.forEach((function(t){n[t]=function(n,e){return e?("component"===t&&d(e)&&(e.name=e.name||n,e=this.options._base.extend(e)),"directive"===t&&"function"==typeof e&&(e={bind:e,update:e}),this.options[t+"s"][n]=e,e):this.options[t+"s"][n]}}))}(n)}(je),Object.defineProperty(je.prototype,"$isServer",{get:on}),Object.defineProperty(je.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(je,"FunctionalRenderContext",{value:Bt}),je.version="2.6.14";var Me=b("style,class"),Re=b("input,textarea,option,select,progress"),Pe=b("contenteditable,draggable,spellcheck"),Be=b("events,caret,typing,plaintext-only"),Ne=b("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),De="http://www.w3.org/1999/xlink",$e=function(n){return":"===n.charAt(5)&&"xlink"===n.slice(0,5)},Ue=function(n){return $e(n)?n.slice(6,n.length):""},Fe=function(n){return null==n||!1===n};function qe(n){for(var t=n.data,e=n,r=n;s(r.componentInstance);)(r=r.componentInstance._vnode)&&r.data&&(t=Ve(r.data,t));for(;s(e=e.parent);)e&&e.data&&(t=Ve(t,e.data));return function(n,t){if(s(n)||s(t))return Je(n,We(t));return""}(t.staticClass,t.class)}function Ve(n,t){return{staticClass:Je(n.staticClass,t.staticClass),class:s(n.class)?[n.class,t.class]:t.class}}function Je(n,t){return n?t?n+" "+t:n:t||""}function We(n){return Array.isArray(n)?function(n){for(var t,e="",r=0,i=n.length;r<i;r++)s(t=We(n[r]))&&""!==t&&(e&&(e+=" "),e+=t);return e}(n):u(n)?function(n){var t="";for(var e in n)n[e]&&(t&&(t+=" "),t+=e);return t}(n):"string"==typeof n?n:""}var Ge={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},He=b("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Ke=b("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Xe=function(n){return He(n)||Ke(n)};var Qe=Object.create(null);var Ye=b("text,number,password,search,email,tel,url");var Ze=Object.freeze({createElement:function(n,t){var e=document.createElement(n);return"select"!==n||t.data&&t.data.attrs&&void 0!==t.data.attrs.multiple&&e.setAttribute("multiple","multiple"),e},createElementNS:function(n,t){return document.createElementNS(Ge[n],t)},createTextNode:function(n){return document.createTextNode(n)},createComment:function(n){return document.createComment(n)},insertBefore:function(n,t,e){n.insertBefore(t,e)},removeChild:function(n,t){n.removeChild(t)},appendChild:function(n,t){n.appendChild(t)},parentNode:function(n){return n.parentNode},nextSibling:function(n){return n.nextSibling},tagName:function(n){return n.tagName},setTextContent:function(n,t){n.textContent=t},setStyleScope:function(n,t){n.setAttribute(t,"")}}),nr={create:function(n,t){tr(t)},update:function(n,t){n.data.ref!==t.data.ref&&(tr(n,!0),tr(t))},destroy:function(n){tr(n,!0)}};function tr(n,t){var e=n.data.ref;if(s(e)){var r=n.context,i=n.componentInstance||n.elm,a=r.$refs;t?Array.isArray(a[e])?w(a[e],i):a[e]===i&&(a[e]=void 0):n.data.refInFor?Array.isArray(a[e])?a[e].indexOf(i)<0&&a[e].push(i):a[e]=[i]:a[e]=i}}var er=new gn("",{},[]),rr=["create","activate","update","remove","destroy"];function ir(n,t){return n.key===t.key&&n.asyncFactory===t.asyncFactory&&(n.tag===t.tag&&n.isComment===t.isComment&&s(n.data)===s(t.data)&&function(n,t){if("input"!==n.tag)return!0;var e,r=s(e=n.data)&&s(e=e.attrs)&&e.type,i=s(e=t.data)&&s(e=e.attrs)&&e.type;return r===i||Ye(r)&&Ye(i)}(n,t)||c(n.isAsyncPlaceholder)&&o(t.asyncFactory.error))}function ar(n,t,e){var r,i,a={};for(r=t;r<=e;++r)s(i=n[r].key)&&(a[i]=r);return a}var or={create:sr,update:sr,destroy:function(n){sr(n,er)}};function sr(n,t){(n.data.directives||t.data.directives)&&function(n,t){var e,r,i,a=n===er,o=t===er,s=lr(n.data.directives,n.context),c=lr(t.data.directives,t.context),l=[],u=[];for(e in c)r=s[e],i=c[e],r?(i.oldValue=r.value,i.oldArg=r.arg,pr(i,"update",t,n),i.def&&i.def.componentUpdated&&u.push(i)):(pr(i,"bind",t,n),i.def&&i.def.inserted&&l.push(i));if(l.length){var p=function(){for(var e=0;e<l.length;e++)pr(l[e],"inserted",t,n)};a?pt(t,"insert",p):p()}u.length&&pt(t,"postpatch",(function(){for(var e=0;e<u.length;e++)pr(u[e],"componentUpdated",t,n)}));if(!a)for(e in s)c[e]||pr(s[e],"unbind",n,n,o)}(n,t)}var cr=Object.create(null);function lr(n,t){var e,r,i=Object.create(null);if(!n)return i;for(e=0;e<n.length;e++)(r=n[e]).modifiers||(r.modifiers=cr),i[ur(r)]=r,r.def=$n(t.$options,"directives",r.name);return i}function ur(n){return n.rawName||n.name+"."+Object.keys(n.modifiers||{}).join(".")}function pr(n,t,e,r,i){var a=n.def&&n.def[t];if(a)try{a(e.elm,n,e,r,i)}catch(r){Wn(r,e.context,"directive "+n.name+" "+t+" hook")}}var dr=[nr,or];function fr(n,t){var e=t.componentOptions;if(!(s(e)&&!1===e.Ctor.options.inheritAttrs||o(n.data.attrs)&&o(t.data.attrs))){var r,i,a=t.elm,c=n.data.attrs||{},l=t.data.attrs||{};for(r in s(l.__ob__)&&(l=t.data.attrs=E({},l)),l)i=l[r],c[r]!==i&&hr(a,r,i,t.data.pre);for(r in(Q||Z)&&l.value!==c.value&&hr(a,"value",l.value),c)o(l[r])&&($e(r)?a.removeAttributeNS(De,Ue(r)):Pe(r)||a.removeAttribute(r))}}function hr(n,t,e,r){r||n.tagName.indexOf("-")>-1?mr(n,t,e):Ne(t)?Fe(e)?n.removeAttribute(t):(e="allowfullscreen"===t&&"EMBED"===n.tagName?"true":t,n.setAttribute(t,e)):Pe(t)?n.setAttribute(t,function(n,t){return Fe(t)||"false"===t?"false":"contenteditable"===n&&Be(t)?t:"true"}(t,e)):$e(t)?Fe(e)?n.removeAttributeNS(De,Ue(t)):n.setAttributeNS(De,t,e):mr(n,t,e)}function mr(n,t,e){if(Fe(e))n.removeAttribute(t);else{if(Q&&!Y&&"TEXTAREA"===n.tagName&&"placeholder"===t&&""!==e&&!n.__ieph){var r=function(t){t.stopImmediatePropagation(),n.removeEventListener("input",r)};n.addEventListener("input",r),n.__ieph=!0}n.setAttribute(t,e)}}var vr={create:fr,update:fr};function gr(n,t){var e=t.elm,r=t.data,i=n.data;if(!(o(r.staticClass)&&o(r.class)&&(o(i)||o(i.staticClass)&&o(i.class)))){var a=qe(t),c=e._transitionClasses;s(c)&&(a=Je(a,We(c))),a!==e._prevClass&&(e.setAttribute("class",a),e._prevClass=a)}}var br,yr={create:gr,update:gr};function wr(n,t,e){var r=br;return function i(){var a=t.apply(null,arguments);null!==a&&_r(n,i,e,r)}}var kr=Qn&&!(tn&&Number(tn[1])<=53);function xr(n,t,e,r){if(kr){var i=ue,a=t;t=a._wrapper=function(n){if(n.target===n.currentTarget||n.timeStamp>=i||n.timeStamp<=0||n.target.ownerDocument!==document)return a.apply(this,arguments)}}br.addEventListener(n,t,rn?{capture:e,passive:r}:e)}function _r(n,t,e,r){(r||br).removeEventListener(n,t._wrapper||t,e)}function Sr(n,t){if(!o(n.data.on)||!o(t.data.on)){var e=t.data.on||{},r=n.data.on||{};br=t.elm,function(n){if(s(n.__r)){var t=Q?"change":"input";n[t]=[].concat(n.__r,n[t]||[]),delete n.__r}s(n.__c)&&(n.change=[].concat(n.__c,n.change||[]),delete n.__c)}(e),ut(e,r,xr,_r,wr,t.context),br=void 0}}var Tr,jr={create:Sr,update:Sr};function Cr(n,t){if(!o(n.data.domProps)||!o(t.data.domProps)){var e,r,i=t.elm,a=n.data.domProps||{},c=t.data.domProps||{};for(e in s(c.__ob__)&&(c=t.data.domProps=E({},c)),a)e in c||(i[e]="");for(e in c){if(r=c[e],"textContent"===e||"innerHTML"===e){if(t.children&&(t.children.length=0),r===a[e])continue;1===i.childNodes.length&&i.removeChild(i.childNodes[0])}if("value"===e&&"PROGRESS"!==i.tagName){i._value=r;var l=o(r)?"":String(r);Ir(i,l)&&(i.value=l)}else if("innerHTML"===e&&Ke(i.tagName)&&o(i.innerHTML)){(Tr=Tr||document.createElement("div")).innerHTML="<svg>"+r+"</svg>";for(var u=Tr.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;u.firstChild;)i.appendChild(u.firstChild)}else if(r!==a[e])try{i[e]=r}catch(n){}}}}function Ir(n,t){return!n.composing&&("OPTION"===n.tagName||function(n,t){var e=!0;try{e=document.activeElement!==n}catch(n){}return e&&n.value!==t}(n,t)||function(n,t){var e=n.value,r=n._vModifiers;if(s(r)){if(r.number)return g(e)!==g(t);if(r.trim)return e.trim()!==t.trim()}return e!==t}(n,t))}var Ar={create:Cr,update:Cr},Or=_((function(n){var t={},e=/:(.+)/;return n.split(/;(?![^(]*\))/g).forEach((function(n){if(n){var r=n.split(e);r.length>1&&(t[r[0].trim()]=r[1].trim())}})),t}));function Er(n){var t=Lr(n.style);return n.staticStyle?E(n.staticStyle,t):t}function Lr(n){return Array.isArray(n)?L(n):"string"==typeof n?Or(n):n}var zr,Mr=/^--/,Rr=/\s*!important$/,Pr=function(n,t,e){if(Mr.test(t))n.style.setProperty(t,e);else if(Rr.test(e))n.style.setProperty(I(t),e.replace(Rr,""),"important");else{var r=Nr(t);if(Array.isArray(e))for(var i=0,a=e.length;i<a;i++)n.style[r]=e[i];else n.style[r]=e}},Br=["Webkit","Moz","ms"],Nr=_((function(n){if(zr=zr||document.createElement("div").style,"filter"!==(n=T(n))&&n in zr)return n;for(var t=n.charAt(0).toUpperCase()+n.slice(1),e=0;e<Br.length;e++){var r=Br[e]+t;if(r in zr)return r}}));function Dr(n,t){var e=t.data,r=n.data;if(!(o(e.staticStyle)&&o(e.style)&&o(r.staticStyle)&&o(r.style))){var i,a,c=t.elm,l=r.staticStyle,u=r.normalizedStyle||r.style||{},p=l||u,d=Lr(t.data.style)||{};t.data.normalizedStyle=s(d.__ob__)?E({},d):d;var f=function(n,t){var e,r={};if(t)for(var i=n;i.componentInstance;)(i=i.componentInstance._vnode)&&i.data&&(e=Er(i.data))&&E(r,e);(e=Er(n.data))&&E(r,e);for(var a=n;a=a.parent;)a.data&&(e=Er(a.data))&&E(r,e);return r}(t,!0);for(a in p)o(f[a])&&Pr(c,a,"");for(a in f)(i=f[a])!==p[a]&&Pr(c,a,null==i?"":i)}}var $r={create:Dr,update:Dr},Ur=/\s+/;function Fr(n,t){if(t&&(t=t.trim()))if(n.classList)t.indexOf(" ")>-1?t.split(Ur).forEach((function(t){return n.classList.add(t)})):n.classList.add(t);else{var e=" "+(n.getAttribute("class")||"")+" ";e.indexOf(" "+t+" ")<0&&n.setAttribute("class",(e+t).trim())}}function qr(n,t){if(t&&(t=t.trim()))if(n.classList)t.indexOf(" ")>-1?t.split(Ur).forEach((function(t){return n.classList.remove(t)})):n.classList.remove(t),n.classList.length||n.removeAttribute("class");else{for(var e=" "+(n.getAttribute("class")||"")+" ",r=" "+t+" ";e.indexOf(r)>=0;)e=e.replace(r," ");(e=e.trim())?n.setAttribute("class",e):n.removeAttribute("class")}}function Vr(n){if(n){if("object"==typeof n){var t={};return!1!==n.css&&E(t,Jr(n.name||"v")),E(t,n),t}return"string"==typeof n?Jr(n):void 0}}var Jr=_((function(n){return{enterClass:n+"-enter",enterToClass:n+"-enter-to",enterActiveClass:n+"-enter-active",leaveClass:n+"-leave",leaveToClass:n+"-leave-to",leaveActiveClass:n+"-leave-active"}})),Wr=G&&!Y,Gr="transition",Hr="transitionend",Kr="animation",Xr="animationend";Wr&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Gr="WebkitTransition",Hr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Kr="WebkitAnimation",Xr="webkitAnimationEnd"));var Qr=G?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(n){return n()};function Yr(n){Qr((function(){Qr(n)}))}function Zr(n,t){var e=n._transitionClasses||(n._transitionClasses=[]);e.indexOf(t)<0&&(e.push(t),Fr(n,t))}function ni(n,t){n._transitionClasses&&w(n._transitionClasses,t),qr(n,t)}function ti(n,t,e){var r=ri(n,t),i=r.type,a=r.timeout,o=r.propCount;if(!i)return e();var s="transition"===i?Hr:Xr,c=0,l=function(){n.removeEventListener(s,u),e()},u=function(t){t.target===n&&++c>=o&&l()};setTimeout((function(){c<o&&l()}),a+1),n.addEventListener(s,u)}var ei=/\b(transform|all)(,|$)/;function ri(n,t){var e,r=window.getComputedStyle(n),i=(r[Gr+"Delay"]||"").split(", "),a=(r[Gr+"Duration"]||"").split(", "),o=ii(i,a),s=(r[Kr+"Delay"]||"").split(", "),c=(r[Kr+"Duration"]||"").split(", "),l=ii(s,c),u=0,p=0;return"transition"===t?o>0&&(e="transition",u=o,p=a.length):"animation"===t?l>0&&(e="animation",u=l,p=c.length):p=(e=(u=Math.max(o,l))>0?o>l?"transition":"animation":null)?"transition"===e?a.length:c.length:0,{type:e,timeout:u,propCount:p,hasTransform:"transition"===e&&ei.test(r[Gr+"Property"])}}function ii(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max.apply(null,t.map((function(t,e){return ai(t)+ai(n[e])})))}function ai(n){return 1e3*Number(n.slice(0,-1).replace(",","."))}function oi(n,t){var e=n.elm;s(e._leaveCb)&&(e._leaveCb.cancelled=!0,e._leaveCb());var r=Vr(n.data.transition);if(!o(r)&&!s(e._enterCb)&&1===e.nodeType){for(var i=r.css,a=r.type,c=r.enterClass,l=r.enterToClass,p=r.enterActiveClass,d=r.appearClass,f=r.appearToClass,h=r.appearActiveClass,m=r.beforeEnter,v=r.enter,b=r.afterEnter,y=r.enterCancelled,w=r.beforeAppear,k=r.appear,x=r.afterAppear,_=r.appearCancelled,S=r.duration,T=Zt,j=Zt.$vnode;j&&j.parent;)T=j.context,j=j.parent;var C=!T._isMounted||!n.isRootInsert;if(!C||k||""===k){var I=C&&d?d:c,A=C&&h?h:p,O=C&&f?f:l,E=C&&w||m,L=C&&"function"==typeof k?k:v,z=C&&x||b,M=C&&_||y,R=g(u(S)?S.enter:S);0;var P=!1!==i&&!Y,B=li(L),D=e._enterCb=N((function(){P&&(ni(e,O),ni(e,A)),D.cancelled?(P&&ni(e,I),M&&M(e)):z&&z(e),e._enterCb=null}));n.data.show||pt(n,"insert",(function(){var t=e.parentNode,r=t&&t._pending&&t._pending[n.key];r&&r.tag===n.tag&&r.elm._leaveCb&&r.elm._leaveCb(),L&&L(e,D)})),E&&E(e),P&&(Zr(e,I),Zr(e,A),Yr((function(){ni(e,I),D.cancelled||(Zr(e,O),B||(ci(R)?setTimeout(D,R):ti(e,a,D)))}))),n.data.show&&(t&&t(),L&&L(e,D)),P||B||D()}}}function si(n,t){var e=n.elm;s(e._enterCb)&&(e._enterCb.cancelled=!0,e._enterCb());var r=Vr(n.data.transition);if(o(r)||1!==e.nodeType)return t();if(!s(e._leaveCb)){var i=r.css,a=r.type,c=r.leaveClass,l=r.leaveToClass,p=r.leaveActiveClass,d=r.beforeLeave,f=r.leave,h=r.afterLeave,m=r.leaveCancelled,v=r.delayLeave,b=r.duration,y=!1!==i&&!Y,w=li(f),k=g(u(b)?b.leave:b);0;var x=e._leaveCb=N((function(){e.parentNode&&e.parentNode._pending&&(e.parentNode._pending[n.key]=null),y&&(ni(e,l),ni(e,p)),x.cancelled?(y&&ni(e,c),m&&m(e)):(t(),h&&h(e)),e._leaveCb=null}));v?v(_):_()}function _(){x.cancelled||(!n.data.show&&e.parentNode&&((e.parentNode._pending||(e.parentNode._pending={}))[n.key]=n),d&&d(e),y&&(Zr(e,c),Zr(e,p),Yr((function(){ni(e,c),x.cancelled||(Zr(e,l),w||(ci(k)?setTimeout(x,k):ti(e,a,x)))}))),f&&f(e,x),y||w||x())}}function ci(n){return"number"==typeof n&&!isNaN(n)}function li(n){if(o(n))return!1;var t=n.fns;return s(t)?li(Array.isArray(t)?t[0]:t):(n._length||n.length)>1}function ui(n,t){!0!==t.data.show&&oi(t)}var pi=function(n){var t,e,r={},i=n.modules,a=n.nodeOps;for(t=0;t<rr.length;++t)for(r[rr[t]]=[],e=0;e<i.length;++e)s(i[e][rr[t]])&&r[rr[t]].push(i[e][rr[t]]);function u(n){var t=a.parentNode(n);s(t)&&a.removeChild(t,n)}function p(n,t,e,i,o,l,u){if(s(n.elm)&&s(l)&&(n=l[u]=kn(n)),n.isRootInsert=!o,!function(n,t,e,i){var a=n.data;if(s(a)){var o=s(n.componentInstance)&&a.keepAlive;if(s(a=a.hook)&&s(a=a.init)&&a(n,!1),s(n.componentInstance))return d(n,t),f(e,n.elm,i),c(o)&&function(n,t,e,i){var a,o=n;for(;o.componentInstance;)if(o=o.componentInstance._vnode,s(a=o.data)&&s(a=a.transition)){for(a=0;a<r.activate.length;++a)r.activate[a](er,o);t.push(o);break}f(e,n.elm,i)}(n,t,e,i),!0}}(n,t,e,i)){var p=n.data,m=n.children,b=n.tag;s(b)?(n.elm=n.ns?a.createElementNS(n.ns,b):a.createElement(b,n),g(n),h(n,m,t),s(p)&&v(n,t),f(e,n.elm,i)):c(n.isComment)?(n.elm=a.createComment(n.text),f(e,n.elm,i)):(n.elm=a.createTextNode(n.text),f(e,n.elm,i))}}function d(n,t){s(n.data.pendingInsert)&&(t.push.apply(t,n.data.pendingInsert),n.data.pendingInsert=null),n.elm=n.componentInstance.$el,m(n)?(v(n,t),g(n)):(tr(n),t.push(n))}function f(n,t,e){s(n)&&(s(e)?a.parentNode(e)===n&&a.insertBefore(n,t,e):a.appendChild(n,t))}function h(n,t,e){if(Array.isArray(t)){0;for(var r=0;r<t.length;++r)p(t[r],e,n.elm,null,!0,t,r)}else l(n.text)&&a.appendChild(n.elm,a.createTextNode(String(n.text)))}function m(n){for(;n.componentInstance;)n=n.componentInstance._vnode;return s(n.tag)}function v(n,e){for(var i=0;i<r.create.length;++i)r.create[i](er,n);s(t=n.data.hook)&&(s(t.create)&&t.create(er,n),s(t.insert)&&e.push(n))}function g(n){var t;if(s(t=n.fnScopeId))a.setStyleScope(n.elm,t);else for(var e=n;e;)s(t=e.context)&&s(t=t.$options._scopeId)&&a.setStyleScope(n.elm,t),e=e.parent;s(t=Zt)&&t!==n.context&&t!==n.fnContext&&s(t=t.$options._scopeId)&&a.setStyleScope(n.elm,t)}function y(n,t,e,r,i,a){for(;r<=i;++r)p(e[r],a,n,t,!1,e,r)}function w(n){var t,e,i=n.data;if(s(i))for(s(t=i.hook)&&s(t=t.destroy)&&t(n),t=0;t<r.destroy.length;++t)r.destroy[t](n);if(s(t=n.children))for(e=0;e<n.children.length;++e)w(n.children[e])}function k(n,t,e){for(;t<=e;++t){var r=n[t];s(r)&&(s(r.tag)?(x(r),w(r)):u(r.elm))}}function x(n,t){if(s(t)||s(n.data)){var e,i=r.remove.length+1;for(s(t)?t.listeners+=i:t=function(n,t){function e(){0==--e.listeners&&u(n)}return e.listeners=t,e}(n.elm,i),s(e=n.componentInstance)&&s(e=e._vnode)&&s(e.data)&&x(e,t),e=0;e<r.remove.length;++e)r.remove[e](n,t);s(e=n.data.hook)&&s(e=e.remove)?e(n,t):t()}else u(n.elm)}function _(n,t,e,r){for(var i=e;i<r;i++){var a=t[i];if(s(a)&&ir(n,a))return i}}function S(n,t,e,i,l,u){if(n!==t){s(t.elm)&&s(i)&&(t=i[l]=kn(t));var d=t.elm=n.elm;if(c(n.isAsyncPlaceholder))s(t.asyncFactory.resolved)?C(n.elm,t,e):t.isAsyncPlaceholder=!0;else if(c(t.isStatic)&&c(n.isStatic)&&t.key===n.key&&(c(t.isCloned)||c(t.isOnce)))t.componentInstance=n.componentInstance;else{var f,h=t.data;s(h)&&s(f=h.hook)&&s(f=f.prepatch)&&f(n,t);var v=n.children,g=t.children;if(s(h)&&m(t)){for(f=0;f<r.update.length;++f)r.update[f](n,t);s(f=h.hook)&&s(f=f.update)&&f(n,t)}o(t.text)?s(v)&&s(g)?v!==g&&function(n,t,e,r,i){var c,l,u,d=0,f=0,h=t.length-1,m=t[0],v=t[h],g=e.length-1,b=e[0],w=e[g],x=!i;for(0;d<=h&&f<=g;)o(m)?m=t[++d]:o(v)?v=t[--h]:ir(m,b)?(S(m,b,r,e,f),m=t[++d],b=e[++f]):ir(v,w)?(S(v,w,r,e,g),v=t[--h],w=e[--g]):ir(m,w)?(S(m,w,r,e,g),x&&a.insertBefore(n,m.elm,a.nextSibling(v.elm)),m=t[++d],w=e[--g]):ir(v,b)?(S(v,b,r,e,f),x&&a.insertBefore(n,v.elm,m.elm),v=t[--h],b=e[++f]):(o(c)&&(c=ar(t,d,h)),o(l=s(b.key)?c[b.key]:_(b,t,d,h))?p(b,r,n,m.elm,!1,e,f):ir(u=t[l],b)?(S(u,b,r,e,f),t[l]=void 0,x&&a.insertBefore(n,u.elm,m.elm)):p(b,r,n,m.elm,!1,e,f),b=e[++f]);d>h?y(n,o(e[g+1])?null:e[g+1].elm,e,f,g,r):f>g&&k(t,d,h)}(d,v,g,e,u):s(g)?(s(n.text)&&a.setTextContent(d,""),y(d,null,g,0,g.length-1,e)):s(v)?k(v,0,v.length-1):s(n.text)&&a.setTextContent(d,""):n.text!==t.text&&a.setTextContent(d,t.text),s(h)&&s(f=h.hook)&&s(f=f.postpatch)&&f(n,t)}}}function T(n,t,e){if(c(e)&&s(n.parent))n.parent.data.pendingInsert=t;else for(var r=0;r<t.length;++r)t[r].data.hook.insert(t[r])}var j=b("attrs,class,staticClass,staticStyle,key");function C(n,t,e,r){var i,a=t.tag,o=t.data,l=t.children;if(r=r||o&&o.pre,t.elm=n,c(t.isComment)&&s(t.asyncFactory))return t.isAsyncPlaceholder=!0,!0;if(s(o)&&(s(i=o.hook)&&s(i=i.init)&&i(t,!0),s(i=t.componentInstance)))return d(t,e),!0;if(s(a)){if(s(l))if(n.hasChildNodes())if(s(i=o)&&s(i=i.domProps)&&s(i=i.innerHTML)){if(i!==n.innerHTML)return!1}else{for(var u=!0,p=n.firstChild,f=0;f<l.length;f++){if(!p||!C(p,l[f],e,r)){u=!1;break}p=p.nextSibling}if(!u||p)return!1}else h(t,l,e);if(s(o)){var m=!1;for(var g in o)if(!j(g)){m=!0,v(t,e);break}!m&&o.class&&st(o.class)}}else n.data!==t.text&&(n.data=t.text);return!0}return function(n,t,e,i){if(!o(t)){var l,u=!1,d=[];if(o(n))u=!0,p(t,d);else{var f=s(n.nodeType);if(!f&&ir(n,t))S(n,t,d,null,null,i);else{if(f){if(1===n.nodeType&&n.hasAttribute("data-server-rendered")&&(n.removeAttribute("data-server-rendered"),e=!0),c(e)&&C(n,t,d))return T(t,d,!0),n;l=n,n=new gn(a.tagName(l).toLowerCase(),{},[],void 0,l)}var h=n.elm,v=a.parentNode(h);if(p(t,d,h._leaveCb?null:v,a.nextSibling(h)),s(t.parent))for(var g=t.parent,b=m(t);g;){for(var y=0;y<r.destroy.length;++y)r.destroy[y](g);if(g.elm=t.elm,b){for(var x=0;x<r.create.length;++x)r.create[x](er,g);var _=g.data.hook.insert;if(_.merged)for(var j=1;j<_.fns.length;j++)_.fns[j]()}else tr(g);g=g.parent}s(v)?k([n],0,0):s(n.tag)&&w(n)}}return T(t,d,u),t.elm}s(n)&&w(n)}}({nodeOps:Ze,modules:[vr,yr,jr,Ar,$r,G?{create:ui,activate:ui,remove:function(n,t){!0!==n.data.show?si(n,t):t()}}:{}].concat(dr)});Y&&document.addEventListener("selectionchange",(function(){var n=document.activeElement;n&&n.vmodel&&yi(n,"input")}));var di={inserted:function(n,t,e,r){"select"===e.tag?(r.elm&&!r.elm._vOptions?pt(e,"postpatch",(function(){di.componentUpdated(n,t,e)})):fi(n,t,e.context),n._vOptions=[].map.call(n.options,vi)):("textarea"===e.tag||Ye(n.type))&&(n._vModifiers=t.modifiers,t.modifiers.lazy||(n.addEventListener("compositionstart",gi),n.addEventListener("compositionend",bi),n.addEventListener("change",bi),Y&&(n.vmodel=!0)))},componentUpdated:function(n,t,e){if("select"===e.tag){fi(n,t,e.context);var r=n._vOptions,i=n._vOptions=[].map.call(n.options,vi);if(i.some((function(n,t){return!P(n,r[t])})))(n.multiple?t.value.some((function(n){return mi(n,i)})):t.value!==t.oldValue&&mi(t.value,i))&&yi(n,"change")}}};function fi(n,t,e){hi(n,t,e),(Q||Z)&&setTimeout((function(){hi(n,t,e)}),0)}function hi(n,t,e){var r=t.value,i=n.multiple;if(!i||Array.isArray(r)){for(var a,o,s=0,c=n.options.length;s<c;s++)if(o=n.options[s],i)a=B(r,vi(o))>-1,o.selected!==a&&(o.selected=a);else if(P(vi(o),r))return void(n.selectedIndex!==s&&(n.selectedIndex=s));i||(n.selectedIndex=-1)}}function mi(n,t){return t.every((function(t){return!P(t,n)}))}function vi(n){return"_value"in n?n._value:n.value}function gi(n){n.target.composing=!0}function bi(n){n.target.composing&&(n.target.composing=!1,yi(n.target,"input"))}function yi(n,t){var e=document.createEvent("HTMLEvents");e.initEvent(t,!0,!0),n.dispatchEvent(e)}function wi(n){return!n.componentInstance||n.data&&n.data.transition?n:wi(n.componentInstance._vnode)}var ki={model:di,show:{bind:function(n,t,e){var r=t.value,i=(e=wi(e)).data&&e.data.transition,a=n.__vOriginalDisplay="none"===n.style.display?"":n.style.display;r&&i?(e.data.show=!0,oi(e,(function(){n.style.display=a}))):n.style.display=r?a:"none"},update:function(n,t,e){var r=t.value;!r!=!t.oldValue&&((e=wi(e)).data&&e.data.transition?(e.data.show=!0,r?oi(e,(function(){n.style.display=n.__vOriginalDisplay})):si(e,(function(){n.style.display="none"}))):n.style.display=r?n.__vOriginalDisplay:"none")},unbind:function(n,t,e,r,i){i||(n.style.display=n.__vOriginalDisplay)}}},xi={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function _i(n){var t=n&&n.componentOptions;return t&&t.Ctor.options.abstract?_i(Ht(t.children)):n}function Si(n){var t={},e=n.$options;for(var r in e.propsData)t[r]=n[r];var i=e._parentListeners;for(var a in i)t[T(a)]=i[a];return t}function Ti(n,t){if(/\d-keep-alive$/.test(t.tag))return n("keep-alive",{props:t.componentOptions.propsData})}var ji=function(n){return n.tag||bt(n)},Ci=function(n){return"show"===n.name},Ii={name:"transition",props:xi,abstract:!0,render:function(n){var t=this,e=this.$slots.default;if(e&&(e=e.filter(ji)).length){0;var r=this.mode;0;var i=e[0];if(function(n){for(;n=n.parent;)if(n.data.transition)return!0}(this.$vnode))return i;var a=_i(i);if(!a)return i;if(this._leaving)return Ti(n,i);var o="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?o+"comment":o+a.tag:l(a.key)?0===String(a.key).indexOf(o)?a.key:o+a.key:a.key;var s=(a.data||(a.data={})).transition=Si(this),c=this._vnode,u=_i(c);if(a.data.directives&&a.data.directives.some(Ci)&&(a.data.show=!0),u&&u.data&&!function(n,t){return t.key===n.key&&t.tag===n.tag}(a,u)&&!bt(u)&&(!u.componentInstance||!u.componentInstance._vnode.isComment)){var p=u.data.transition=E({},s);if("out-in"===r)return this._leaving=!0,pt(p,"afterLeave",(function(){t._leaving=!1,t.$forceUpdate()})),Ti(n,i);if("in-out"===r){if(bt(a))return c;var d,f=function(){d()};pt(s,"afterEnter",f),pt(s,"enterCancelled",f),pt(p,"delayLeave",(function(n){d=n}))}}return i}}},Ai=E({tag:String,moveClass:String},xi);function Oi(n){n.elm._moveCb&&n.elm._moveCb(),n.elm._enterCb&&n.elm._enterCb()}function Ei(n){n.data.newPos=n.elm.getBoundingClientRect()}function Li(n){var t=n.data.pos,e=n.data.newPos,r=t.left-e.left,i=t.top-e.top;if(r||i){n.data.moved=!0;var a=n.elm.style;a.transform=a.WebkitTransform="translate("+r+"px,"+i+"px)",a.transitionDuration="0s"}}delete Ai.mode;var zi={Transition:Ii,TransitionGroup:{props:Ai,beforeMount:function(){var n=this,t=this._update;this._update=function(e,r){var i=ne(n);n.__patch__(n._vnode,n.kept,!1,!0),n._vnode=n.kept,i(),t.call(n,e,r)}},render:function(n){for(var t=this.tag||this.$vnode.data.tag||"span",e=Object.create(null),r=this.prevChildren=this.children,i=this.$slots.default||[],a=this.children=[],o=Si(this),s=0;s<i.length;s++){var c=i[s];if(c.tag)if(null!=c.key&&0!==String(c.key).indexOf("__vlist"))a.push(c),e[c.key]=c,(c.data||(c.data={})).transition=o;else;}if(r){for(var l=[],u=[],p=0;p<r.length;p++){var d=r[p];d.data.transition=o,d.data.pos=d.elm.getBoundingClientRect(),e[d.key]?l.push(d):u.push(d)}this.kept=n(t,null,l),this.removed=u}return n(t,null,a)},updated:function(){var n=this.prevChildren,t=this.moveClass||(this.name||"v")+"-move";n.length&&this.hasMove(n[0].elm,t)&&(n.forEach(Oi),n.forEach(Ei),n.forEach(Li),this._reflow=document.body.offsetHeight,n.forEach((function(n){if(n.data.moved){var e=n.elm,r=e.style;Zr(e,t),r.transform=r.WebkitTransform=r.transitionDuration="",e.addEventListener(Hr,e._moveCb=function n(r){r&&r.target!==e||r&&!/transform$/.test(r.propertyName)||(e.removeEventListener(Hr,n),e._moveCb=null,ni(e,t))})}})))},methods:{hasMove:function(n,t){if(!Wr)return!1;if(this._hasMove)return this._hasMove;var e=n.cloneNode();n._transitionClasses&&n._transitionClasses.forEach((function(n){qr(e,n)})),Fr(e,t),e.style.display="none",this.$el.appendChild(e);var r=ri(e);return this.$el.removeChild(e),this._hasMove=r.hasTransform}}}};je.config.mustUseProp=function(n,t,e){return"value"===e&&Re(n)&&"button"!==t||"selected"===e&&"option"===n||"checked"===e&&"input"===n||"muted"===e&&"video"===n},je.config.isReservedTag=Xe,je.config.isReservedAttr=Me,je.config.getTagNamespace=function(n){return Ke(n)?"svg":"math"===n?"math":void 0},je.config.isUnknownElement=function(n){if(!G)return!0;if(Xe(n))return!1;if(n=n.toLowerCase(),null!=Qe[n])return Qe[n];var t=document.createElement(n);return n.indexOf("-")>-1?Qe[n]=t.constructor===window.HTMLUnknownElement||t.constructor===window.HTMLElement:Qe[n]=/HTMLUnknownElement/.test(t.toString())},E(je.options.directives,ki),E(je.options.components,zi),je.prototype.__patch__=G?pi:z,je.prototype.$mount=function(n,t){return function(n,t,e){var r;return n.$el=t,n.$options.render||(n.$options.render=yn),re(n,"beforeMount"),r=function(){n._update(n._render(),e)},new me(n,r,z,{before:function(){n._isMounted&&!n._isDestroyed&&re(n,"beforeUpdate")}},!0),e=!1,null==n.$vnode&&(n._isMounted=!0,re(n,"mounted")),n}(this,n=n&&G?function(n){if("string"==typeof n){var t=document.querySelector(n);return t||document.createElement("div")}return n}(n):void 0,t)},G&&setTimeout((function(){U.devtools&&sn&&sn.emit("init",je)}),0);var Mi=je;
/*!
  * vue-router v3.5.4
  * (c) 2022 Evan You
  * @license MIT
  */function Ri(n,t){for(var e in t)n[e]=t[e];return n}var Pi=/[!'()*]/g,Bi=function(n){return"%"+n.charCodeAt(0).toString(16)},Ni=/%2C/g,Di=function(n){return encodeURIComponent(n).replace(Pi,Bi).replace(Ni,",")};function $i(n){try{return decodeURIComponent(n)}catch(n){0}return n}var Ui=function(n){return null==n||"object"==typeof n?n:String(n)};function Fi(n){var t={};return(n=n.trim().replace(/^(\?|#|&)/,""))?(n.split("&").forEach((function(n){var e=n.replace(/\+/g," ").split("="),r=$i(e.shift()),i=e.length>0?$i(e.join("=")):null;void 0===t[r]?t[r]=i:Array.isArray(t[r])?t[r].push(i):t[r]=[t[r],i]})),t):t}function qi(n){var t=n?Object.keys(n).map((function(t){var e=n[t];if(void 0===e)return"";if(null===e)return Di(t);if(Array.isArray(e)){var r=[];return e.forEach((function(n){void 0!==n&&(null===n?r.push(Di(t)):r.push(Di(t)+"="+Di(n)))})),r.join("&")}return Di(t)+"="+Di(e)})).filter((function(n){return n.length>0})).join("&"):null;return t?"?"+t:""}var Vi=/\/?$/;function Ji(n,t,e,r){var i=r&&r.options.stringifyQuery,a=t.query||{};try{a=Wi(a)}catch(n){}var o={name:t.name||n&&n.name,meta:n&&n.meta||{},path:t.path||"/",hash:t.hash||"",query:a,params:t.params||{},fullPath:Ki(t,i),matched:n?Hi(n):[]};return e&&(o.redirectedFrom=Ki(e,i)),Object.freeze(o)}function Wi(n){if(Array.isArray(n))return n.map(Wi);if(n&&"object"==typeof n){var t={};for(var e in n)t[e]=Wi(n[e]);return t}return n}var Gi=Ji(null,{path:"/"});function Hi(n){for(var t=[];n;)t.unshift(n),n=n.parent;return t}function Ki(n,t){var e=n.path,r=n.query;void 0===r&&(r={});var i=n.hash;return void 0===i&&(i=""),(e||"/")+(t||qi)(r)+i}function Xi(n,t,e){return t===Gi?n===t:!!t&&(n.path&&t.path?n.path.replace(Vi,"")===t.path.replace(Vi,"")&&(e||n.hash===t.hash&&Qi(n.query,t.query)):!(!n.name||!t.name)&&(n.name===t.name&&(e||n.hash===t.hash&&Qi(n.query,t.query)&&Qi(n.params,t.params))))}function Qi(n,t){if(void 0===n&&(n={}),void 0===t&&(t={}),!n||!t)return n===t;var e=Object.keys(n).sort(),r=Object.keys(t).sort();return e.length===r.length&&e.every((function(e,i){var a=n[e];if(r[i]!==e)return!1;var o=t[e];return null==a||null==o?a===o:"object"==typeof a&&"object"==typeof o?Qi(a,o):String(a)===String(o)}))}function Yi(n){for(var t=0;t<n.matched.length;t++){var e=n.matched[t];for(var r in e.instances){var i=e.instances[r],a=e.enteredCbs[r];if(i&&a){delete e.enteredCbs[r];for(var o=0;o<a.length;o++)i._isBeingDestroyed||a[o](i)}}}}var Zi={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(n,t){var e=t.props,r=t.children,i=t.parent,a=t.data;a.routerView=!0;for(var o=i.$createElement,s=e.name,c=i.$route,l=i._routerViewCache||(i._routerViewCache={}),u=0,p=!1;i&&i._routerRoot!==i;){var d=i.$vnode?i.$vnode.data:{};d.routerView&&u++,d.keepAlive&&i._directInactive&&i._inactive&&(p=!0),i=i.$parent}if(a.routerViewDepth=u,p){var f=l[s],h=f&&f.component;return h?(f.configProps&&na(h,a,f.route,f.configProps),o(h,a,r)):o()}var m=c.matched[u],v=m&&m.components[s];if(!m||!v)return l[s]=null,o();l[s]={component:v},a.registerRouteInstance=function(n,t){var e=m.instances[s];(t&&e!==n||!t&&e===n)&&(m.instances[s]=t)},(a.hook||(a.hook={})).prepatch=function(n,t){m.instances[s]=t.componentInstance},a.hook.init=function(n){n.data.keepAlive&&n.componentInstance&&n.componentInstance!==m.instances[s]&&(m.instances[s]=n.componentInstance),Yi(c)};var g=m.props&&m.props[s];return g&&(Ri(l[s],{route:c,configProps:g}),na(v,a,c,g)),o(v,a,r)}};function na(n,t,e,r){var i=t.props=function(n,t){switch(typeof t){case"undefined":return;case"object":return t;case"function":return t(n);case"boolean":return t?n.params:void 0;default:0}}(e,r);if(i){i=t.props=Ri({},i);var a=t.attrs=t.attrs||{};for(var o in i)n.props&&o in n.props||(a[o]=i[o],delete i[o])}}function ta(n,t,e){var r=n.charAt(0);if("/"===r)return n;if("?"===r||"#"===r)return t+n;var i=t.split("/");e&&i[i.length-1]||i.pop();for(var a=n.replace(/^\//,"").split("/"),o=0;o<a.length;o++){var s=a[o];".."===s?i.pop():"."!==s&&i.push(s)}return""!==i[0]&&i.unshift(""),i.join("/")}function ea(n){return n.replace(/\/(?:\s*\/)+/g,"/")}var ra=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)},ia=ba,aa=ua,oa=function(n,t){return da(ua(n,t),t)},sa=da,ca=ga,la=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function ua(n,t){for(var e,r=[],i=0,a=0,o="",s=t&&t.delimiter||"/";null!=(e=la.exec(n));){var c=e[0],l=e[1],u=e.index;if(o+=n.slice(a,u),a=u+c.length,l)o+=l[1];else{var p=n[a],d=e[2],f=e[3],h=e[4],m=e[5],v=e[6],g=e[7];o&&(r.push(o),o="");var b=null!=d&&null!=p&&p!==d,y="+"===v||"*"===v,w="?"===v||"*"===v,k=e[2]||s,x=h||m;r.push({name:f||i++,prefix:d||"",delimiter:k,optional:w,repeat:y,partial:b,asterisk:!!g,pattern:x?ha(x):g?".*":"[^"+fa(k)+"]+?"})}}return a<n.length&&(o+=n.substr(a)),o&&r.push(o),r}function pa(n){return encodeURI(n).replace(/[\/?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()}))}function da(n,t){for(var e=new Array(n.length),r=0;r<n.length;r++)"object"==typeof n[r]&&(e[r]=new RegExp("^(?:"+n[r].pattern+")$",va(t)));return function(t,r){for(var i="",a=t||{},o=(r||{}).pretty?pa:encodeURIComponent,s=0;s<n.length;s++){var c=n[s];if("string"!=typeof c){var l,u=a[c.name];if(null==u){if(c.optional){c.partial&&(i+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(ra(u)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(u)+"`");if(0===u.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var p=0;p<u.length;p++){if(l=o(u[p]),!e[s].test(l))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(l)+"`");i+=(0===p?c.prefix:c.delimiter)+l}}else{if(l=c.asterisk?encodeURI(u).replace(/[?#]/g,(function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()})):o(u),!e[s].test(l))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+l+'"');i+=c.prefix+l}}else i+=c}return i}}function fa(n){return n.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function ha(n){return n.replace(/([=!:$\/()])/g,"\\$1")}function ma(n,t){return n.keys=t,n}function va(n){return n&&n.sensitive?"":"i"}function ga(n,t,e){ra(t)||(e=t||e,t=[]);for(var r=(e=e||{}).strict,i=!1!==e.end,a="",o=0;o<n.length;o++){var s=n[o];if("string"==typeof s)a+=fa(s);else{var c=fa(s.prefix),l="(?:"+s.pattern+")";t.push(s),s.repeat&&(l+="(?:"+c+l+")*"),a+=l=s.optional?s.partial?c+"("+l+")?":"(?:"+c+"("+l+"))?":c+"("+l+")"}}var u=fa(e.delimiter||"/"),p=a.slice(-u.length)===u;return r||(a=(p?a.slice(0,-u.length):a)+"(?:"+u+"(?=$))?"),a+=i?"$":r&&p?"":"(?="+u+"|$)",ma(new RegExp("^"+a,va(e)),t)}function ba(n,t,e){return ra(t)||(e=t||e,t=[]),e=e||{},n instanceof RegExp?function(n,t){var e=n.source.match(/\((?!\?)/g);if(e)for(var r=0;r<e.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return ma(n,t)}(n,t):ra(n)?function(n,t,e){for(var r=[],i=0;i<n.length;i++)r.push(ba(n[i],t,e).source);return ma(new RegExp("(?:"+r.join("|")+")",va(e)),t)}(n,t,e):function(n,t,e){return ga(ua(n,e),t,e)}(n,t,e)}ia.parse=aa,ia.compile=oa,ia.tokensToFunction=sa,ia.tokensToRegExp=ca;var ya=Object.create(null);function wa(n,t,e){t=t||{};try{var r=ya[n]||(ya[n]=ia.compile(n));return"string"==typeof t.pathMatch&&(t[0]=t.pathMatch),r(t,{pretty:!0})}catch(n){return""}finally{delete t[0]}}function ka(n,t,e,r){var i="string"==typeof n?{path:n}:n;if(i._normalized)return i;if(i.name){var a=(i=Ri({},n)).params;return a&&"object"==typeof a&&(i.params=Ri({},a)),i}if(!i.path&&i.params&&t){(i=Ri({},i))._normalized=!0;var o=Ri(Ri({},t.params),i.params);if(t.name)i.name=t.name,i.params=o;else if(t.matched.length){var s=t.matched[t.matched.length-1].path;i.path=wa(s,o,t.path)}else 0;return i}var c=function(n){var t="",e="",r=n.indexOf("#");r>=0&&(t=n.slice(r),n=n.slice(0,r));var i=n.indexOf("?");return i>=0&&(e=n.slice(i+1),n=n.slice(0,i)),{path:n,query:e,hash:t}}(i.path||""),l=t&&t.path||"/",u=c.path?ta(c.path,l,e||i.append):l,p=function(n,t,e){void 0===t&&(t={});var r,i=e||Fi;try{r=i(n||"")}catch(n){r={}}for(var a in t){var o=t[a];r[a]=Array.isArray(o)?o.map(Ui):Ui(o)}return r}(c.query,i.query,r&&r.options.parseQuery),d=i.hash||c.hash;return d&&"#"!==d.charAt(0)&&(d="#"+d),{_normalized:!0,path:u,query:p,hash:d}}var xa,_a=function(){},Sa={name:"RouterLink",props:{to:{type:[String,Object],required:!0},tag:{type:String,default:"a"},custom:Boolean,exact:Boolean,exactPath:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:{type:String,default:"page"},event:{type:[String,Array],default:"click"}},render:function(n){var t=this,e=this.$router,r=this.$route,i=e.resolve(this.to,r,this.append),a=i.location,o=i.route,s=i.href,c={},l=e.options.linkActiveClass,u=e.options.linkExactActiveClass,p=null==l?"router-link-active":l,d=null==u?"router-link-exact-active":u,f=null==this.activeClass?p:this.activeClass,h=null==this.exactActiveClass?d:this.exactActiveClass,m=o.redirectedFrom?Ji(null,ka(o.redirectedFrom),null,e):o;c[h]=Xi(r,m,this.exactPath),c[f]=this.exact||this.exactPath?c[h]:function(n,t){return 0===n.path.replace(Vi,"/").indexOf(t.path.replace(Vi,"/"))&&(!t.hash||n.hash===t.hash)&&function(n,t){for(var e in t)if(!(e in n))return!1;return!0}(n.query,t.query)}(r,m);var v=c[h]?this.ariaCurrentValue:null,g=function(n){Ta(n)&&(t.replace?e.replace(a,_a):e.push(a,_a))},b={click:Ta};Array.isArray(this.event)?this.event.forEach((function(n){b[n]=g})):b[this.event]=g;var y={class:c},w=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:s,route:o,navigate:g,isActive:c[f],isExactActive:c[h]});if(w){if(1===w.length)return w[0];if(w.length>1||!w.length)return 0===w.length?n():n("span",{},w)}if("a"===this.tag)y.on=b,y.attrs={href:s,"aria-current":v};else{var k=function n(t){var e;if(t)for(var r=0;r<t.length;r++){if("a"===(e=t[r]).tag)return e;if(e.children&&(e=n(e.children)))return e}}(this.$slots.default);if(k){k.isStatic=!1;var x=k.data=Ri({},k.data);for(var _ in x.on=x.on||{},x.on){var S=x.on[_];_ in b&&(x.on[_]=Array.isArray(S)?S:[S])}for(var T in b)T in x.on?x.on[T].push(b[T]):x.on[T]=g;var j=k.data.attrs=Ri({},k.data.attrs);j.href=s,j["aria-current"]=v}else y.on=b}return n(this.tag,y,this.$slots.default)}};function Ta(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey||n.defaultPrevented||void 0!==n.button&&0!==n.button)){if(n.currentTarget&&n.currentTarget.getAttribute){var t=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return n.preventDefault&&n.preventDefault(),!0}}var ja="undefined"!=typeof window;function Ca(n,t,e,r,i){var a=t||[],o=e||Object.create(null),s=r||Object.create(null);n.forEach((function(n){!function n(t,e,r,i,a,o){var s=i.path,c=i.name;0;var l=i.pathToRegexpOptions||{},u=function(n,t,e){e||(n=n.replace(/\/$/,""));if("/"===n[0])return n;if(null==t)return n;return ea(t.path+"/"+n)}(s,a,l.strict);"boolean"==typeof i.caseSensitive&&(l.sensitive=i.caseSensitive);var p={path:u,regex:Ia(u,l),components:i.components||{default:i.component},alias:i.alias?"string"==typeof i.alias?[i.alias]:i.alias:[],instances:{},enteredCbs:{},name:c,parent:a,matchAs:o,redirect:i.redirect,beforeEnter:i.beforeEnter,meta:i.meta||{},props:null==i.props?{}:i.components?i.props:{default:i.props}};i.children&&i.children.forEach((function(i){var a=o?ea(o+"/"+i.path):void 0;n(t,e,r,i,p,a)}));e[p.path]||(t.push(p.path),e[p.path]=p);if(void 0!==i.alias)for(var d=Array.isArray(i.alias)?i.alias:[i.alias],f=0;f<d.length;++f){0;var h={path:d[f],children:i.children};n(t,e,r,h,a,p.path||"/")}c&&(r[c]||(r[c]=p))}(a,o,s,n,i)}));for(var c=0,l=a.length;c<l;c++)"*"===a[c]&&(a.push(a.splice(c,1)[0]),l--,c--);return{pathList:a,pathMap:o,nameMap:s}}function Ia(n,t){return ia(n,[],t)}function Aa(n,t){var e=Ca(n),r=e.pathList,i=e.pathMap,a=e.nameMap;function o(n,e,o){var s=ka(n,e,!1,t),l=s.name;if(l){var u=a[l];if(!u)return c(null,s);var p=u.regex.keys.filter((function(n){return!n.optional})).map((function(n){return n.name}));if("object"!=typeof s.params&&(s.params={}),e&&"object"==typeof e.params)for(var d in e.params)!(d in s.params)&&p.indexOf(d)>-1&&(s.params[d]=e.params[d]);return s.path=wa(u.path,s.params),c(u,s,o)}if(s.path){s.params={};for(var f=0;f<r.length;f++){var h=r[f],m=i[h];if(Oa(m.regex,s.path,s.params))return c(m,s,o)}}return c(null,s)}function s(n,e){var r=n.redirect,i="function"==typeof r?r(Ji(n,e,null,t)):r;if("string"==typeof i&&(i={path:i}),!i||"object"!=typeof i)return c(null,e);var s=i,l=s.name,u=s.path,p=e.query,d=e.hash,f=e.params;if(p=s.hasOwnProperty("query")?s.query:p,d=s.hasOwnProperty("hash")?s.hash:d,f=s.hasOwnProperty("params")?s.params:f,l){a[l];return o({_normalized:!0,name:l,query:p,hash:d,params:f},void 0,e)}if(u){var h=function(n,t){return ta(n,t.parent?t.parent.path:"/",!0)}(u,n);return o({_normalized:!0,path:wa(h,f),query:p,hash:d},void 0,e)}return c(null,e)}function c(n,e,r){return n&&n.redirect?s(n,r||e):n&&n.matchAs?function(n,t,e){var r=o({_normalized:!0,path:wa(e,t.params)});if(r){var i=r.matched,a=i[i.length-1];return t.params=r.params,c(a,t)}return c(null,t)}(0,e,n.matchAs):Ji(n,e,r,t)}return{match:o,addRoute:function(n,t){var e="object"!=typeof n?a[n]:void 0;Ca([t||n],r,i,a,e),e&&e.alias.length&&Ca(e.alias.map((function(n){return{path:n,children:[t]}})),r,i,a,e)},getRoutes:function(){return r.map((function(n){return i[n]}))},addRoutes:function(n){Ca(n,r,i,a)}}}function Oa(n,t,e){var r=t.match(n);if(!r)return!1;if(!e)return!0;for(var i=1,a=r.length;i<a;++i){var o=n.keys[i-1];o&&(e[o.name||"pathMatch"]="string"==typeof r[i]?$i(r[i]):r[i])}return!0}var Ea=ja&&window.performance&&window.performance.now?window.performance:Date;function La(){return Ea.now().toFixed(3)}var za=La();function Ma(){return za}function Ra(n){return za=n}var Pa=Object.create(null);function Ba(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var n=window.location.protocol+"//"+window.location.host,t=window.location.href.replace(n,""),e=Ri({},window.history.state);return e.key=Ma(),window.history.replaceState(e,"",t),window.addEventListener("popstate",$a),function(){window.removeEventListener("popstate",$a)}}function Na(n,t,e,r){if(n.app){var i=n.options.scrollBehavior;i&&n.app.$nextTick((function(){var a=function(){var n=Ma();if(n)return Pa[n]}(),o=i.call(n,t,e,r?a:null);o&&("function"==typeof o.then?o.then((function(n){Ja(n,a)})).catch((function(n){0})):Ja(o,a))}))}}function Da(){var n=Ma();n&&(Pa[n]={x:window.pageXOffset,y:window.pageYOffset})}function $a(n){Da(),n.state&&n.state.key&&Ra(n.state.key)}function Ua(n){return qa(n.x)||qa(n.y)}function Fa(n){return{x:qa(n.x)?n.x:window.pageXOffset,y:qa(n.y)?n.y:window.pageYOffset}}function qa(n){return"number"==typeof n}var Va=/^#\d/;function Ja(n,t){var e,r="object"==typeof n;if(r&&"string"==typeof n.selector){var i=Va.test(n.selector)?document.getElementById(n.selector.slice(1)):document.querySelector(n.selector);if(i){var a=n.offset&&"object"==typeof n.offset?n.offset:{};t=function(n,t){var e=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{x:r.left-e.left-t.x,y:r.top-e.top-t.y}}(i,a={x:qa((e=a).x)?e.x:0,y:qa(e.y)?e.y:0})}else Ua(n)&&(t=Fa(n))}else r&&Ua(n)&&(t=Fa(n));t&&("scrollBehavior"in document.documentElement.style?window.scrollTo({left:t.x,top:t.y,behavior:n.behavior}):window.scrollTo(t.x,t.y))}var Wa,Ga=ja&&((-1===(Wa=window.navigator.userAgent).indexOf("Android 2.")&&-1===Wa.indexOf("Android 4.0")||-1===Wa.indexOf("Mobile Safari")||-1!==Wa.indexOf("Chrome")||-1!==Wa.indexOf("Windows Phone"))&&window.history&&"function"==typeof window.history.pushState);function Ha(n,t){Da();var e=window.history;try{if(t){var r=Ri({},e.state);r.key=Ma(),e.replaceState(r,"",n)}else e.pushState({key:Ra(La())},"",n)}catch(e){window.location[t?"replace":"assign"](n)}}function Ka(n){Ha(n,!0)}function Xa(n,t,e){var r=function(i){i>=n.length?e():n[i]?t(n[i],(function(){r(i+1)})):r(i+1)};r(0)}var Qa={redirected:2,aborted:4,cancelled:8,duplicated:16};function Ya(n,t){return no(n,t,Qa.redirected,'Redirected when going from "'+n.fullPath+'" to "'+function(n){if("string"==typeof n)return n;if("path"in n)return n.path;var t={};return to.forEach((function(e){e in n&&(t[e]=n[e])})),JSON.stringify(t,null,2)}(t)+'" via a navigation guard.')}function Za(n,t){return no(n,t,Qa.cancelled,'Navigation cancelled from "'+n.fullPath+'" to "'+t.fullPath+'" with a new navigation.')}function no(n,t,e,r){var i=new Error(r);return i._isRouter=!0,i.from=n,i.to=t,i.type=e,i}var to=["params","query","hash"];function eo(n){return Object.prototype.toString.call(n).indexOf("Error")>-1}function ro(n,t){return eo(n)&&n._isRouter&&(null==t||n.type===t)}function io(n){return function(t,e,r){var i=!1,a=0,o=null;ao(n,(function(n,t,e,s){if("function"==typeof n&&void 0===n.cid){i=!0,a++;var c,l=co((function(t){var i;((i=t).__esModule||so&&"Module"===i[Symbol.toStringTag])&&(t=t.default),n.resolved="function"==typeof t?t:xa.extend(t),e.components[s]=t,--a<=0&&r()})),u=co((function(n){var t="Failed to resolve async component "+s+": "+n;o||(o=eo(n)?n:new Error(t),r(o))}));try{c=n(l,u)}catch(n){u(n)}if(c)if("function"==typeof c.then)c.then(l,u);else{var p=c.component;p&&"function"==typeof p.then&&p.then(l,u)}}})),i||r()}}function ao(n,t){return oo(n.map((function(n){return Object.keys(n.components).map((function(e){return t(n.components[e],n.instances[e],n,e)}))})))}function oo(n){return Array.prototype.concat.apply([],n)}var so="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function co(n){var t=!1;return function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];if(!t)return t=!0,n.apply(this,e)}}var lo=function(n,t){this.router=n,this.base=function(n){if(!n)if(ja){var t=document.querySelector("base");n=(n=t&&t.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else n="/";"/"!==n.charAt(0)&&(n="/"+n);return n.replace(/\/$/,"")}(t),this.current=Gi,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.listeners=[]};function uo(n,t,e,r){var i=ao(n,(function(n,r,i,a){var o=function(n,t){"function"!=typeof n&&(n=xa.extend(n));return n.options[t]}(n,t);if(o)return Array.isArray(o)?o.map((function(n){return e(n,r,i,a)})):e(o,r,i,a)}));return oo(r?i.reverse():i)}function po(n,t){if(t)return function(){return n.apply(t,arguments)}}lo.prototype.listen=function(n){this.cb=n},lo.prototype.onReady=function(n,t){this.ready?n():(this.readyCbs.push(n),t&&this.readyErrorCbs.push(t))},lo.prototype.onError=function(n){this.errorCbs.push(n)},lo.prototype.transitionTo=function(n,t,e){var r,i=this;try{r=this.router.match(n,this.current)}catch(n){throw this.errorCbs.forEach((function(t){t(n)})),n}var a=this.current;this.confirmTransition(r,(function(){i.updateRoute(r),t&&t(r),i.ensureURL(),i.router.afterHooks.forEach((function(n){n&&n(r,a)})),i.ready||(i.ready=!0,i.readyCbs.forEach((function(n){n(r)})))}),(function(n){e&&e(n),n&&!i.ready&&(ro(n,Qa.redirected)&&a===Gi||(i.ready=!0,i.readyErrorCbs.forEach((function(t){t(n)}))))}))},lo.prototype.confirmTransition=function(n,t,e){var r=this,i=this.current;this.pending=n;var a,o,s=function(n){!ro(n)&&eo(n)&&(r.errorCbs.length?r.errorCbs.forEach((function(t){t(n)})):console.error(n)),e&&e(n)},c=n.matched.length-1,l=i.matched.length-1;if(Xi(n,i)&&c===l&&n.matched[c]===i.matched[l])return this.ensureURL(),n.hash&&Na(this.router,i,n,!1),s(((o=no(a=i,n,Qa.duplicated,'Avoided redundant navigation to current location: "'+a.fullPath+'".')).name="NavigationDuplicated",o));var u=function(n,t){var e,r=Math.max(n.length,t.length);for(e=0;e<r&&n[e]===t[e];e++);return{updated:t.slice(0,e),activated:t.slice(e),deactivated:n.slice(e)}}(this.current.matched,n.matched),p=u.updated,d=u.deactivated,f=u.activated,h=[].concat(function(n){return uo(n,"beforeRouteLeave",po,!0)}(d),this.router.beforeHooks,function(n){return uo(n,"beforeRouteUpdate",po)}(p),f.map((function(n){return n.beforeEnter})),io(f)),m=function(t,e){if(r.pending!==n)return s(Za(i,n));try{t(n,i,(function(t){!1===t?(r.ensureURL(!0),s(function(n,t){return no(n,t,Qa.aborted,'Navigation aborted from "'+n.fullPath+'" to "'+t.fullPath+'" via a navigation guard.')}(i,n))):eo(t)?(r.ensureURL(!0),s(t)):"string"==typeof t||"object"==typeof t&&("string"==typeof t.path||"string"==typeof t.name)?(s(Ya(i,n)),"object"==typeof t&&t.replace?r.replace(t):r.push(t)):e(t)}))}catch(n){s(n)}};Xa(h,m,(function(){Xa(function(n){return uo(n,"beforeRouteEnter",(function(n,t,e,r){return function(n,t,e){return function(r,i,a){return n(r,i,(function(n){"function"==typeof n&&(t.enteredCbs[e]||(t.enteredCbs[e]=[]),t.enteredCbs[e].push(n)),a(n)}))}}(n,e,r)}))}(f).concat(r.router.resolveHooks),m,(function(){if(r.pending!==n)return s(Za(i,n));r.pending=null,t(n),r.router.app&&r.router.app.$nextTick((function(){Yi(n)}))}))}))},lo.prototype.updateRoute=function(n){this.current=n,this.cb&&this.cb(n)},lo.prototype.setupListeners=function(){},lo.prototype.teardown=function(){this.listeners.forEach((function(n){n()})),this.listeners=[],this.current=Gi,this.pending=null};var fo=function(n){function t(t,e){n.call(this,t,e),this._startLocation=ho(this.base)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var t=this.router,e=t.options.scrollBehavior,r=Ga&&e;r&&this.listeners.push(Ba());var i=function(){var e=n.current,i=ho(n.base);n.current===Gi&&i===n._startLocation||n.transitionTo(i,(function(n){r&&Na(t,n,e,!0)}))};window.addEventListener("popstate",i),this.listeners.push((function(){window.removeEventListener("popstate",i)}))}},t.prototype.go=function(n){window.history.go(n)},t.prototype.push=function(n,t,e){var r=this,i=this.current;this.transitionTo(n,(function(n){Ha(ea(r.base+n.fullPath)),Na(r.router,n,i,!1),t&&t(n)}),e)},t.prototype.replace=function(n,t,e){var r=this,i=this.current;this.transitionTo(n,(function(n){Ka(ea(r.base+n.fullPath)),Na(r.router,n,i,!1),t&&t(n)}),e)},t.prototype.ensureURL=function(n){if(ho(this.base)!==this.current.fullPath){var t=ea(this.base+this.current.fullPath);n?Ha(t):Ka(t)}},t.prototype.getCurrentLocation=function(){return ho(this.base)},t}(lo);function ho(n){var t=window.location.pathname,e=t.toLowerCase(),r=n.toLowerCase();return!n||e!==r&&0!==e.indexOf(ea(r+"/"))||(t=t.slice(n.length)),(t||"/")+window.location.search+window.location.hash}var mo=function(n){function t(t,e,r){n.call(this,t,e),r&&function(n){var t=ho(n);if(!/^\/#/.test(t))return window.location.replace(ea(n+"/#"+t)),!0}(this.base)||vo()}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.setupListeners=function(){var n=this;if(!(this.listeners.length>0)){var t=this.router.options.scrollBehavior,e=Ga&&t;e&&this.listeners.push(Ba());var r=function(){var t=n.current;vo()&&n.transitionTo(go(),(function(r){e&&Na(n.router,r,t,!0),Ga||wo(r.fullPath)}))},i=Ga?"popstate":"hashchange";window.addEventListener(i,r),this.listeners.push((function(){window.removeEventListener(i,r)}))}},t.prototype.push=function(n,t,e){var r=this,i=this.current;this.transitionTo(n,(function(n){yo(n.fullPath),Na(r.router,n,i,!1),t&&t(n)}),e)},t.prototype.replace=function(n,t,e){var r=this,i=this.current;this.transitionTo(n,(function(n){wo(n.fullPath),Na(r.router,n,i,!1),t&&t(n)}),e)},t.prototype.go=function(n){window.history.go(n)},t.prototype.ensureURL=function(n){var t=this.current.fullPath;go()!==t&&(n?yo(t):wo(t))},t.prototype.getCurrentLocation=function(){return go()},t}(lo);function vo(){var n=go();return"/"===n.charAt(0)||(wo("/"+n),!1)}function go(){var n=window.location.href,t=n.indexOf("#");return t<0?"":n=n.slice(t+1)}function bo(n){var t=window.location.href,e=t.indexOf("#");return(e>=0?t.slice(0,e):t)+"#"+n}function yo(n){Ga?Ha(bo(n)):window.location.hash=n}function wo(n){Ga?Ka(bo(n)):window.location.replace(bo(n))}var ko=function(n){function t(t,e){n.call(this,t,e),this.stack=[],this.index=-1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.push=function(n,t,e){var r=this;this.transitionTo(n,(function(n){r.stack=r.stack.slice(0,r.index+1).concat(n),r.index++,t&&t(n)}),e)},t.prototype.replace=function(n,t,e){var r=this;this.transitionTo(n,(function(n){r.stack=r.stack.slice(0,r.index).concat(n),t&&t(n)}),e)},t.prototype.go=function(n){var t=this,e=this.index+n;if(!(e<0||e>=this.stack.length)){var r=this.stack[e];this.confirmTransition(r,(function(){var n=t.current;t.index=e,t.updateRoute(r),t.router.afterHooks.forEach((function(t){t&&t(r,n)}))}),(function(n){ro(n,Qa.duplicated)&&(t.index=e)}))}},t.prototype.getCurrentLocation=function(){var n=this.stack[this.stack.length-1];return n?n.fullPath:"/"},t.prototype.ensureURL=function(){},t}(lo),xo=function(n){void 0===n&&(n={}),this.app=null,this.apps=[],this.options=n,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=Aa(n.routes||[],this);var t=n.mode||"hash";switch(this.fallback="history"===t&&!Ga&&!1!==n.fallback,this.fallback&&(t="hash"),ja||(t="abstract"),this.mode=t,t){case"history":this.history=new fo(this,n.base);break;case"hash":this.history=new mo(this,n.base,this.fallback);break;case"abstract":this.history=new ko(this,n.base);break;default:0}},_o={currentRoute:{configurable:!0}};function So(n,t){return n.push(t),function(){var e=n.indexOf(t);e>-1&&n.splice(e,1)}}xo.prototype.match=function(n,t,e){return this.matcher.match(n,t,e)},_o.currentRoute.get=function(){return this.history&&this.history.current},xo.prototype.init=function(n){var t=this;if(this.apps.push(n),n.$once("hook:destroyed",(function(){var e=t.apps.indexOf(n);e>-1&&t.apps.splice(e,1),t.app===n&&(t.app=t.apps[0]||null),t.app||t.history.teardown()})),!this.app){this.app=n;var e=this.history;if(e instanceof fo||e instanceof mo){var r=function(n){e.setupListeners(),function(n){var r=e.current,i=t.options.scrollBehavior;Ga&&i&&"fullPath"in n&&Na(t,n,r,!1)}(n)};e.transitionTo(e.getCurrentLocation(),r,r)}e.listen((function(n){t.apps.forEach((function(t){t._route=n}))}))}},xo.prototype.beforeEach=function(n){return So(this.beforeHooks,n)},xo.prototype.beforeResolve=function(n){return So(this.resolveHooks,n)},xo.prototype.afterEach=function(n){return So(this.afterHooks,n)},xo.prototype.onReady=function(n,t){this.history.onReady(n,t)},xo.prototype.onError=function(n){this.history.onError(n)},xo.prototype.push=function(n,t,e){var r=this;if(!t&&!e&&"undefined"!=typeof Promise)return new Promise((function(t,e){r.history.push(n,t,e)}));this.history.push(n,t,e)},xo.prototype.replace=function(n,t,e){var r=this;if(!t&&!e&&"undefined"!=typeof Promise)return new Promise((function(t,e){r.history.replace(n,t,e)}));this.history.replace(n,t,e)},xo.prototype.go=function(n){this.history.go(n)},xo.prototype.back=function(){this.go(-1)},xo.prototype.forward=function(){this.go(1)},xo.prototype.getMatchedComponents=function(n){var t=n?n.matched?n:this.resolve(n).route:this.currentRoute;return t?[].concat.apply([],t.matched.map((function(n){return Object.keys(n.components).map((function(t){return n.components[t]}))}))):[]},xo.prototype.resolve=function(n,t,e){var r=ka(n,t=t||this.history.current,e,this),i=this.match(r,t),a=i.redirectedFrom||i.fullPath;return{location:r,route:i,href:function(n,t,e){var r="hash"===e?"#"+t:t;return n?ea(n+"/"+r):r}(this.history.base,a,this.mode),normalizedTo:r,resolved:i}},xo.prototype.getRoutes=function(){return this.matcher.getRoutes()},xo.prototype.addRoute=function(n,t){this.matcher.addRoute(n,t),this.history.current!==Gi&&this.history.transitionTo(this.history.getCurrentLocation())},xo.prototype.addRoutes=function(n){this.matcher.addRoutes(n),this.history.current!==Gi&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(xo.prototype,_o),xo.install=function n(t){if(!n.installed||xa!==t){n.installed=!0,xa=t;var e=function(n){return void 0!==n},r=function(n,t){var r=n.$options._parentVnode;e(r)&&e(r=r.data)&&e(r=r.registerRouteInstance)&&r(n,t)};t.mixin({beforeCreate:function(){e(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),t.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,r(this,this)},destroyed:function(){r(this)}}),Object.defineProperty(t.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(t.prototype,"$route",{get:function(){return this._routerRoot._route}}),t.component("RouterView",Zi),t.component("RouterLink",Sa);var i=t.config.optionMergeStrategies;i.beforeRouteEnter=i.beforeRouteLeave=i.beforeRouteUpdate=i.created}},xo.version="3.5.4",xo.isNavigationFailure=ro,xo.NavigationFailureType=Qa,xo.START_LOCATION=Gi,ja&&window.Vue&&window.Vue.use(xo);var To=xo;e(233),e(132),e(282),e(110),e(284),e(26),e(27),e(285);function jo(n){n.locales&&Object.keys(n.locales).forEach((function(t){n.locales[t].path=t})),Object.freeze(n)}var Co=e(60),Io=e(81),Ao=(e(131),e(19),e(46),e(235),e(236),e(38),e(23),{NotFound:function(){return Promise.all([e.e(0),e.e(4)]).then(e.bind(null,501))},Layout:function(){return Promise.all([e.e(0),e.e(2)]).then(e.bind(null,500))}}),Oo={"v-761e5d7e":function(){return e.e(5).then(e.bind(null,502))},"v-64d333aa":function(){return e.e(6).then(e.bind(null,503))},"v-648c7cfe":function(){return e.e(7).then(e.bind(null,504))},"v-c2331f12":function(){return e.e(8).then(e.bind(null,505))},"v-255c09a1":function(){return e.e(9).then(e.bind(null,506))},"v-4721bed4":function(){return e.e(10).then(e.bind(null,507))},"v-062877d6":function(){return e.e(11).then(e.bind(null,508))},"v-c44d2880":function(){return e.e(12).then(e.bind(null,509))},"v-3da84d0d":function(){return e.e(13).then(e.bind(null,510))},"v-4537776d":function(){return e.e(14).then(e.bind(null,511))},"v-536574fe":function(){return e.e(15).then(e.bind(null,512))},"v-bf924ecc":function(){return e.e(16).then(e.bind(null,513))}};function Eo(n){var t=Object.create(null);return function(e){return t[e]||(t[e]=n(e))}}var Lo=/-(\w)/g,zo=Eo((function(n){return n.replace(Lo,(function(n,t){return t?t.toUpperCase():""}))})),Mo=/\B([A-Z])/g,Ro=Eo((function(n){return n.replace(Mo,"-$1").toLowerCase()})),Po=Eo((function(n){return n.charAt(0).toUpperCase()+n.slice(1)}));function Bo(n,t){if(t)return n(t)?n(t):t.includes("-")?n(Po(zo(t))):n(Po(t))||n(Ro(t))}var No=Object.assign({},Ao,Oo),Do=function(n){return No[n]},$o=function(n){return Oo[n]},Uo=function(n){return Ao[n]},Fo=function(n){return Mi.component(n)};function qo(n){return Bo($o,n)}function Vo(n){return Bo(Uo,n)}function Jo(n){return Bo(Do,n)}function Wo(n){return Bo(Fo,n)}function Go(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return Promise.all(t.filter((function(n){return n})).map(function(){var n=Object(i.a)(Object(r.a)().mark((function n(t){var e;return Object(r.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Wo(t)||!Jo(t)){n.next=5;break}return n.next=3,Jo(t)();case 3:e=n.sent,Mi.component(t,e.default);case 5:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()))}function Ho(n,t){"undefined"!=typeof window&&window.__VUEPRESS__&&(window.__VUEPRESS__[n]=t)}var Ko=e(144),Xo=(e(130),e(118),e(83),e(223)),Qo=e.n(Xo),Yo=e(224),Zo=e.n(Yo),ns={created:function(){if(this.siteMeta=this.$site.headTags.filter((function(n){return"meta"===Object(Ko.a)(n,1)[0]})).map((function(n){var t=Object(Ko.a)(n,2);t[0];return t[1]})),this.$ssrContext){var n=this.getMergedMetaTags();this.$ssrContext.title=this.$title,this.$ssrContext.lang=this.$lang,this.$ssrContext.pageMeta=(t=n)?t.map((function(n){var t="<meta";return Object.keys(n).forEach((function(e){t+=" ".concat(e,'="').concat(Zo()(n[e]),'"')})),t+">"})).join("\n    "):"",this.$ssrContext.canonicalLink=es(this.$canonicalUrl)}var t},mounted:function(){this.currentMetaTags=Object(Io.a)(document.querySelectorAll("meta")),this.updateMeta(),this.updateCanonicalLink()},methods:{updateMeta:function(){document.title=this.$title,document.documentElement.lang=this.$lang;var n=this.getMergedMetaTags();this.currentMetaTags=rs(n,this.currentMetaTags)},getMergedMetaTags:function(){var n=this.$page.frontmatter.meta||[];return Qo()([{name:"description",content:this.$description}],n,this.siteMeta,is)},updateCanonicalLink:function(){ts(),this.$canonicalUrl&&document.head.insertAdjacentHTML("beforeend",es(this.$canonicalUrl))}},watch:{$page:function(){this.updateMeta(),this.updateCanonicalLink()}},beforeDestroy:function(){rs(null,this.currentMetaTags),ts()}};function ts(){var n=document.querySelector("link[rel='canonical']");n&&n.remove()}function es(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n?'<link href="'.concat(n,'" rel="canonical" />'):""}function rs(n,t){if(t&&Object(Io.a)(t).filter((function(n){return n.parentNode===document.head})).forEach((function(n){return document.head.removeChild(n)})),n)return n.map((function(n){var t=document.createElement("meta");return Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),document.head.appendChild(t),t}))}function is(n){for(var t=0,e=["name","property","itemprop"];t<e.length;t++){var r=e[t];if(n.hasOwnProperty(r))return n[r]+r}return JSON.stringify(n)}e(146);var as=e(157),os={mounted:function(){window.addEventListener("scroll",this.onScroll)},methods:{onScroll:e.n(as)()((function(){this.setActiveHash()}),300),setActiveHash:function(){for(var n=this,t=[].slice.call(document.querySelectorAll(".sidebar-link")),e=[].slice.call(document.querySelectorAll(".header-anchor")).filter((function(n){return t.some((function(t){return t.hash===n.hash}))})),r=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),i=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),a=window.innerHeight+r,o=0;o<e.length;o++){var s=e[o],c=e[o+1],l=0===o&&0===r||r>=s.parentElement.offsetTop+10&&(!c||r<c.parentElement.offsetTop-10),u=decodeURIComponent(this.$route.hash);if(l&&u!==decodeURIComponent(s.hash)){var p=s;if(a===i)for(var d=o+1;d<e.length;d++)if(u===decodeURIComponent(e[d].hash))return;return this.$vuepress.$set("disableScrollBehavior",!0),void this.$router.replace(decodeURIComponent(p.hash),(function(){n.$nextTick((function(){n.$vuepress.$set("disableScrollBehavior",!1)}))}))}}}},beforeDestroy:function(){window.removeEventListener("scroll",this.onScroll)}},ss=(e(87),e(109)),cs=e.n(ss),ls={mounted:function(){var n=this;cs.a.configure({showSpinner:!1}),this.$router.beforeEach((function(n,t,e){n.path===t.path||Mi.component(n.name)||cs.a.start(),e()})),this.$router.afterEach((function(){cs.a.done(),n.isSidebarOpen=!1}))}};e(85),e(61),e(88),e(388);function us(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}e(111);function ps(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function ds(n,t,e){return t&&ps(n.prototype,t),e&&ps(n,e),Object.defineProperty(n,"prototype",{writable:!1}),n}e(389);var fs=function(){function n(){us(this,n);this.containerEl=document.getElementById("message-container"),this.containerEl||(this.containerEl=document.createElement("div"),this.containerEl.id="message-container",document.body.appendChild(this.containerEl))}return ds(n,[{key:"show",value:function(n){var t=this,e=n.text,r=void 0===e?"":e,i=n.duration,a=void 0===i?3e3:i,o=document.createElement("div");o.className="message move-in",o.innerHTML='\n      <i style="fill: #06a35a;font-size: 14px;display:inline-flex;align-items: center;">\n        <svg style="fill: #06a35a;font-size: 14px;" t="1572421810237" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2323" width="16" height="16"><path d="M822.811993 824.617989c-83.075838 81.99224-188.546032 124.613757-316.049383 127.86455-122.085362-3.250794-223.943563-45.87231-305.935802-127.86455s-124.613757-184.21164-127.86455-305.935802c3.250794-127.503351 45.87231-232.973545 127.86455-316.049383 81.99224-83.075838 184.21164-126.058554 305.935802-129.309347 127.503351 3.250794 232.973545 46.23351 316.049383 129.309347 83.075838 83.075838 126.058554 188.546032 129.309347 316.049383C949.231746 640.406349 905.887831 742.62575 822.811993 824.617989zM432.716755 684.111464c3.973192 3.973192 8.307584 5.779189 13.364374 6.140388 5.05679 0.361199 9.752381-1.444797 13.364374-5.417989l292.571429-287.514638c3.973192-3.973192 5.779189-8.307584 5.779189-13.364374 0-5.05679-1.805996-9.752381-5.779189-13.364374l1.805996 1.805996c-3.973192-3.973192-8.668783-5.779189-14.086772-6.140388-5.417989-0.361199-10.47478 1.444797-14.809171 5.417989l-264.397884 220.33157c-3.973192 3.250794-8.668783 4.695591-14.447972 4.695591-5.779189 0-10.835979-1.444797-15.53157-3.973192l-94.273016-72.962257c-4.334392-3.250794-9.391182-4.334392-14.447972-3.973192s-9.391182 3.250794-12.641975 7.585185l-2.889594 3.973192c-3.250794 4.334392-4.334392 9.391182-3.973192 14.809171 0.722399 5.417989 2.528395 10.11358 5.779189 14.086772L432.716755 684.111464z" p-id="2324"></path></svg>\n      </i>\n      <div class="text">'.concat(r,"</div>\n    "),this.containerEl.appendChild(o),a>0&&setTimeout((function(){t.close(o)}),a)}},{key:"close",value:function(n){n.className=n.className.replace("move-in",""),n.className+="move-out",n.addEventListener("animationend",(function(){n.remove()}))}}]),n}(),hs={mounted:function(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},updated:function(){!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||this.updateCopy()},methods:{updateCopy:function(){var n=this;setTimeout((function(){(['div[class*="language-"] pre','div[class*="aside-code"] aside']instanceof Array||Array.isArray(['div[class*="language-"] pre','div[class*="aside-code"] aside']))&&['div[class*="language-"] pre','div[class*="aside-code"] aside'].forEach((function(t){document.querySelectorAll(t).forEach(n.generateCopyButton)}))}),1e3)},generateCopyButton:function(n){var t=this;if(!n.classList.contains("codecopy-enabled")){var e=document.createElement("i");e.className="code-copy",e.innerHTML='<svg  style="color:#aaa;font-size:14px" t="1572422231464" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3201" width="14" height="14"><path d="M866.461538 39.384615H354.461538c-43.323077 0-78.769231 35.446154-78.76923 78.769231v39.384616h472.615384c43.323077 0 78.769231 35.446154 78.769231 78.76923v551.384616h39.384615c43.323077 0 78.769231-35.446154 78.769231-78.769231V118.153846c0-43.323077-35.446154-78.769231-78.769231-78.769231z m-118.153846 275.692308c0-43.323077-35.446154-78.769231-78.76923-78.769231H157.538462c-43.323077 0-78.769231 35.446154-78.769231 78.769231v590.769231c0 43.323077 35.446154 78.769231 78.769231 78.769231h512c43.323077 0 78.769231-35.446154 78.76923-78.769231V315.076923z m-354.461538 137.846154c0 11.815385-7.876923 19.692308-19.692308 19.692308h-157.538461c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h157.538461c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z m157.538461 315.076923c0 11.815385-7.876923 19.692308-19.692307 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h315.076923c11.815385 0 19.692308 7.876923 19.692307 19.692308v39.384615z m78.769231-157.538462c0 11.815385-7.876923 19.692308-19.692308 19.692308H216.615385c-11.815385 0-19.692308-7.876923-19.692308-19.692308v-39.384615c0-11.815385 7.876923-19.692308 19.692308-19.692308h393.846153c11.815385 0 19.692308 7.876923 19.692308 19.692308v39.384615z" p-id="3202"></path></svg>',e.title="Copy to clipboard",e.addEventListener("click",(function(){t.copyToClipboard(n.innerText)})),n.appendChild(e),n.classList.add("codecopy-enabled")}},copyToClipboard:function(n){var t=document.createElement("textarea");t.value=n,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t);var e=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);t.select(),document.execCommand("copy"),(new fs).show({text:"å¤å¶æå",duration:1e3}),document.body.removeChild(t),e&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(e))}}};e(238),e(84),e(145),e(147),e(391);!function(n,t){void 0===t&&(t={});var e=t.insertAt;if(n&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===e&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(document.createTextNode(n))}}("@media (max-width: 1000px) {\n  .vuepress-plugin-demo-block__h_code {\n    display: none;\n  }\n  .vuepress-plugin-demo-block__app {\n    margin-left: auto !important;\n    margin-right: auto !important;\n  }\n}\n.vuepress-plugin-demo-block__wrapper {\n  margin-top: 10px;\n  border: 1px solid #ebebeb;\n  border-radius: 4px;\n  transition: all 0.2s;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display {\n  height: 400px;\n  display: flex;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__app {\n  width: 300px;\n  border: 1px solid #ebebeb;\n  box-shadow: 1px 1px 3px #ebebeb;\n  margin-right: 5px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code {\n  flex: 1;\n  overflow: auto;\n  height: 100%;\n}\n.vuepress-plugin-demo-block__wrapper.vuepress-plugin-demo-block__horizontal .vuepress-plugin-demo-block__display .vuepress-plugin-demo-block__h_code > pre {\n  overflow: visible;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  max-height: 400px;\n  overflow: auto;\n}\n.vuepress-plugin-demo-block__wrapper div {\n  box-sizing: border-box;\n}\n.vuepress-plugin-demo-block__wrapper:hover {\n  box-shadow: 0 0 11px rgba(33, 33, 33, 0.2);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code {\n  overflow: hidden;\n  height: 0;\n  padding: 0 !important;\n  background-color: #282c34;\n  border-radius: 0 !important;\n  transition: height 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__code pre {\n  margin: 0 !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__display {\n  padding: 20px;\n  border-bottom: 1px solid #ebebeb;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer {\n  position: relative;\n  text-align: center;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__codepen {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer.vuepress-plugin-demo-block__show-link .vuepress-plugin-demo-block__expand::before {\n  border-top: none;\n  border-right: 6px solid transparent;\n  border-bottom: 6px solid #ccc;\n  border-left: 6px solid transparent;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__codepen,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand span,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand {\n  opacity: 1;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover .vuepress-plugin-demo-block__expand::before {\n  border-top-color: #3eaf7c !important;\n  border-bottom-color: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer:hover svg {\n  fill: #3eaf7c !important;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand-text {\n  transition: all 0.5s;\n  opacity: 0;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:nth-last-child(2) {\n  right: 50px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer form:last-child {\n  right: 10px;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button {\n  border-color: transparent;\n  background-color: transparent;\n  font-size: 14px;\n  color: #3eaf7c;\n  cursor: pointer;\n  outline: none;\n  margin: 0;\n  width: 46px;\n  position: relative;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::before {\n  content: attr(data-tip);\n  white-space: nowrap;\n  position: absolute;\n  top: -30px;\n  left: 50%;\n  color: #eee;\n  line-height: 1;\n  z-index: 1000;\n  border-radius: 4px;\n  padding: 6px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  background-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button:hover::after {\n  content: '' !important;\n  display: block;\n  position: absolute;\n  left: 50%;\n  top: -5px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  border: 5px solid transparent;\n  border-top-color: rgba(0, 0, 0, 0.8);\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__button svg {\n  width: 34px;\n  height: 20px;\n  fill: #ccc;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__jsfiddle,\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__codepen {\n  position: absolute;\n  top: 10px;\n  transition: all 0.5s;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand {\n  position: relative;\n  width: 100px;\n  height: 40px;\n  margin: 0;\n  color: #3eaf7c;\n  font-size: 14px;\n  background-color: transparent;\n  border-color: transparent;\n  outline: none;\n  transition: all 0.5s;\n  cursor: pointer;\n}\n.vuepress-plugin-demo-block__wrapper .vuepress-plugin-demo-block__footer .vuepress-plugin-demo-block__expand::before {\n  content: \"\";\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  border-top: 6px solid #ccc;\n  border-right: 6px solid transparent;\n  border-left: 6px solid transparent;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n");var ms={jsLib:[],cssLib:[],jsfiddle:!0,codepen:!0,codepenLayout:"left",codepenJsProcessor:"babel",codepenEditors:"101",horizontal:!1,vue:"https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js",react:"https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js",reactDOM:"https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"},vs={},gs=function(n){return'<div id="app">\n'.concat(n,"\n</div>")},bs=function(n){return window.$VUEPRESS_DEMO_BLOCK&&void 0!==window.$VUEPRESS_DEMO_BLOCK[n]?window.$VUEPRESS_DEMO_BLOCK[n]:ms[n]},ys=function n(t,e,r){var i=document.createElement(t);return e&&Object.keys(e).forEach((function(n){if(n.indexOf("data"))i[n]=e[n];else{var t=n.replace("data","");i.dataset[t]=e[n]}})),r&&r.forEach((function(t){var e=t.tag,r=t.attrs,a=t.children;i.appendChild(n(e,r,a))})),i},ws=function(n,t,e){var r,i=(r=n.querySelectorAll(".".concat(t)),Array.prototype.slice.call(r));return 1!==i.length||e?i:i[0]},ks=function(n,t){var e,r,i=n.match(/<style>([\s\S]+)<\/style>/),a=n.match(/<template>([\s\S]+)<\/template>/),o=n.match(/<script>([\s\S]+)<\/script>/),s={css:i&&i[1].replace(/^\n|\n$/g,""),html:a&&a[1].replace(/^\n|\n$/g,""),js:o&&o[1].replace(/^\n|\n$/g,""),jsLib:t.jsLib||[],cssLib:t.cssLib||[]};s.htmlTpl=gs(s.html),s.jsTpl=(e=s.js,r=e.replace(/export\s+default\s*?\{\n*/,"").replace(/\n*\}\s*$/,"").trim(),"new Vue({\n  el: '#app',\n  ".concat(r,"\n})")),s.script=function(n,t){var e=n.split(/export\s+default/),r="(function() {".concat(e[0]," ; return ").concat(e[1],"})()"),i=window.Babel?window.Babel.transform(r,{presets:["es2015"]}).code:r,a=[eval][0](i);return a.template=t,a}(s.js,s.html);var c=bs("vue");return s.jsLib.unshift(c),s},xs=function(n,t){var e,r=n.match(/<style>([\s\S]+)<\/style>/),i=n.match(/<html>([\s\S]+)<\/html>/),a=n.match(/<script>([\s\S]+)<\/script>/),o={css:r&&r[1].replace(/^\n|\n$/g,""),html:i&&i[1].replace(/^\n|\n$/g,""),js:a&&a[1].replace(/^\n|\n$/g,""),jsLib:t.jsLib||[],cssLib:t.cssLib||[]};return o.htmlTpl=o.html,o.jsTpl=o.js,o.script=(e=o.js,window.Babel?window.Babel.transform(e,{presets:["es2015"]}).code:e),o},_s=function(n){return n=n.replace("export default ","").replace(/App\.__style__(\s*)=(\s*)`([\s\S]*)?`/,""),n+='ReactDOM.render(React.createElement(App), document.getElementById("app"))'};function Ss(){var n=ws(document,"vuepress-plugin-demo-block__wrapper",!0);n.length?n.forEach((function(n){if("true"!==n.dataset.created){n.style.display="block";var t=ws(n,"vuepress-plugin-demo-block__code"),e=ws(n,"vuepress-plugin-demo-block__display"),r=ws(n,"vuepress-plugin-demo-block__footer"),i=ws(e,"vuepress-plugin-demo-block__app"),a=decodeURIComponent(n.dataset.code),o=decodeURIComponent(n.dataset.config),s=decodeURIComponent(n.dataset.type);o=o?JSON.parse(o):{};var c=t.querySelector("div").clientHeight,l="react"===s?function(n,t){var e=(0,window.Babel.transform)(n,{presets:["es2015","react"]}).code,r="(function(exports){var module={};module.exports=exports;".concat(e,";return module.exports.__esModule?module.exports.default:module.exports;})({})"),i=new Function("return ".concat(r))(),a={js:i,css:i.__style__||"",jsLib:t.jsLib||[],cssLib:t.cssLib||[],jsTpl:_s(n),htmlTpl:gs("")},o=bs("react"),s=bs("reactDOM");return a.jsLib.unshift(o,s),a}(a,o):"vanilla"===s?xs(a,o):ks(a,o),u=ys("button",{className:"".concat("vuepress-plugin-demo-block__expand")});if(r.appendChild(u),u.addEventListener("click",Ts.bind(null,u,c,t,r)),bs("jsfiddle")&&r.appendChild(function(n){var t=n.css,e=n.htmlTpl,r=n.jsTpl,i=n.jsLib,a=n.cssLib,o=i.concat(a).concat(bs("cssLib")).concat(bs("jsLib")).join(",");return ys("form",{className:"vuepress-plugin-demo-block__jsfiddle",target:"_blank",action:"https://jsfiddle.net/api/post/library/pure/",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"css",value:t}},{tag:"input",attrs:{type:"hidden",name:"html",value:e}},{tag:"input",attrs:{type:"hidden",name:"js",value:r}},{tag:"input",attrs:{type:"hidden",name:"panel_js",value:3}},{tag:"input",attrs:{type:"hidden",name:"wrap",value:1}},{tag:"input",attrs:{type:"hidden",name:"resources",value:o}},{tag:"button",attrs:{type:"submit",className:"vuepress-plugin-demo-block__button",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088289967" class="icon" style="" viewBox="0 0 1170 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1952" xmlns:xlink="http://www.w3.org/1999/xlink" width="228.515625" height="200"><defs><style type="text/css"></style></defs><path d="M1028.571429 441.142857q63.428571 26.285714 102.571428 83.142857T1170.285714 650.857143q0 93.714286-67.428571 160.285714T940 877.714286q-2.285714 0-6.571429-0.285715t-6-0.285714H232q-97.142857-5.714286-164.571429-71.714286T0 645.142857q0-62.857143 31.428571-116t84-84q-6.857143-22.285714-6.857142-46.857143 0-65.714286 46.857142-112t113.714286-46.285714q54.285714 0 98.285714 33.142857 42.857143-88 127.142858-141.714286t186.571428-53.714285q94.857143 0 174.857143 46T982.571429 248.571429t46.571428 172q0 3.428571-0.285714 10.285714t-0.285714 10.285714zM267.428571 593.142857q0 69.714286 48 110.285714t118.857143 40.571429q78.285714 0 137.142857-56.571429-9.142857-11.428571-27.142857-32.285714T519.428571 626.285714q-38.285714 37.142857-82.285714 37.142857-31.428571 0-53.428571-19.142857T361.714286 594.285714q0-30.285714 22-49.714285t52.285714-19.428572q25.142857 0 48.285714 12t41.714286 31.428572 37.142857 42.857142 39.428572 46.857143 44 42.857143 55.428571 31.428572 69.428571 12q69.142857 0 116.857143-40.857143T936 594.857143q0-69.142857-48-109.714286t-118.285714-40.571428q-81.714286 0-137.714286 55.428571l53.142857 61.714286q37.714286-36.571429 81.142857-36.571429 29.714286 0 52.571429 18.857143t22.857143 48q0 32.571429-21.142857 52.285714t-53.714286 19.714286q-24.571429 0-47.142857-12t-41.142857-31.428571-37.428572-42.857143-39.714286-46.857143-44.285714-42.857143-55.142857-31.428571T434.285714 444.571429q-69.714286 0-118.285714 40.285714T267.428571 593.142857z" p-id="1953"></path></svg>',datatip:"JSFiddle"}}])}(l)),bs("codepen")&&r.appendChild(function(n){var t=n.css,e=n.htmlTpl,r=n.jsTpl,i=n.jsLib,a=n.cssLib,o=JSON.stringify({css:t,html:e,js:r,js_external:i.concat(bs("jsLib")).join(";"),css_external:a.concat(bs("cssLib")).join(";"),layout:bs("codepenLayout"),js_pre_processor:bs("codepenJsProcessor"),editors:bs("codepenEditors")});return ys("form",{className:"vuepress-plugin-demo-block__codepen",target:"_blank",action:"https://codepen.io/pen/define",method:"post"},[{tag:"input",attrs:{type:"hidden",name:"data",value:o}},{tag:"button",attrs:{type:"submit",innerHTML:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1547088271207" class="icon" style="" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1737" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M123.428571 668l344.571429 229.714286v-205.142857L277.142857 565.142857z m-35.428571-82.285714l110.285714-73.714286-110.285714-73.714286v147.428572z m468 312l344.571429-229.714286-153.714286-102.857143-190.857143 127.428572v205.142857z m-44-281.714286l155.428571-104-155.428571-104-155.428571 104zM277.142857 458.857143l190.857143-127.428572V126.285714L123.428571 356z m548.571429 53.142857l110.285714 73.714286V438.285714z m-78.857143-53.142857l153.714286-102.857143-344.571429-229.714286v205.142857z m277.142857-102.857143v312q0 23.428571-19.428571 36.571429l-468 312q-12 7.428571-24.571429 7.428571t-24.571429-7.428571L19.428571 704.571429q-19.428571-13.142857-19.428571-36.571429V356q0-23.428571 19.428571-36.571429L487.428571 7.428571q12-7.428571 24.571429-7.428571t24.571429 7.428571l468 312q19.428571 13.142857 19.428571 36.571429z" p-id="1738"></path></svg>',className:"vuepress-plugin-demo-block__button",datatip:"Codepen"}}])}(l)),void 0!==o.horizontal?o.horizontal:bs("horizontal")){n.classList.add("vuepress-plugin-demo-block__horizontal");var p=t.firstChild.cloneNode(!0);p.classList.add("vuepress-plugin-demo-block__h_code"),e.appendChild(p)}if(l.css&&function(n){if(!vs[n]){var t=ys("style",{innerHTML:n});document.body.appendChild(t),vs[n]=!0}}(l.css),"react"===s)ReactDOM.render(React.createElement(l.js),i);else if("vue"===s){var d=(new(Vue.extend(l.script))).$mount();i.appendChild(d.$el)}else"vanilla"===s&&(i.innerHTML=l.html,new Function("return (function(){".concat(l.script,"})()"))());n.dataset.created="true"}})):setTimeout((function(n){Ss()}),300)}function Ts(n,t,e,r){var i="1"!==n.dataset.isExpand;e.style.height=i?"".concat(t,"px"):0,i?r.classList.add("vuepress-plugin-demo-block__show-link"):r.classList.remove("vuepress-plugin-demo-block__show-link"),n.dataset.isExpand=i?"1":"0"}var js={mounted:function(){window.$VUEPRESS_DEMO_BLOCK={jsfiddle:!1,codepen:!0,horizontal:!1},Ss()},updated:function(){Ss()}},Cs=(e(227),"auto"),Is="zoom-in",As="zoom-out",Os="grab",Es="move";function Ls(n,t,e){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i={passive:!1};r?n.addEventListener(t,e,i):n.removeEventListener(t,e,i)}function zs(n,t){if(n){var e=new Image;e.onload=function(){t&&t(e)},e.src=n}}function Ms(n){return n.dataset.original?n.dataset.original:"A"===n.parentNode.tagName?n.parentNode.getAttribute("href"):null}function Rs(n,t,e){!function(n){var t=Ps,e=Bs;if(n.transition){var r=n.transition;delete n.transition,n[t]=r}if(n.transform){var i=n.transform;delete n.transform,n[e]=i}}(t);var r=n.style,i={};for(var a in t)e&&(i[a]=r[a]||""),r[a]=t[a];return i}var Ps="transition",Bs="transform",Ns="transform",Ds="transitionend";var $s=function(){},Us={enableGrab:!0,preloadImage:!1,closeOnWindowResize:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,zIndex:998,customSize:null,onOpen:$s,onClose:$s,onGrab:$s,onMove:$s,onRelease:$s,onBeforeOpen:$s,onBeforeClose:$s,onBeforeGrab:$s,onBeforeRelease:$s,onImageLoading:$s,onImageLoaded:$s},Fs={init:function(n){var t,e;t=this,e=n,Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach((function(n){t[n]=t[n].bind(e)}))},click:function(n){if(n.preventDefault(),Vs(n))return window.open(this.target.srcOriginal||n.currentTarget.src,"_blank");this.shown?this.released?this.close():this.release():this.open(n.currentTarget)},scroll:function(){var n=document.documentElement||document.body.parentNode||document.body,t=window.pageXOffset||n.scrollLeft,e=window.pageYOffset||n.scrollTop;null===this.lastScrollPosition&&(this.lastScrollPosition={x:t,y:e});var r=this.lastScrollPosition.x-t,i=this.lastScrollPosition.y-e,a=this.options.scrollThreshold;(Math.abs(i)>=a||Math.abs(r)>=a)&&(this.lastScrollPosition=null,this.close())},keydown:function(n){(function(n){return"Escape"===(n.key||n.code)||27===n.keyCode})(n)&&(this.released?this.close():this.release(this.close))},mousedown:function(n){if(qs(n)&&!Vs(n)){n.preventDefault();var t=n.clientX,e=n.clientY;this.pressTimer=setTimeout(function(){this.grab(t,e)}.bind(this),200)}},mousemove:function(n){this.released||this.move(n.clientX,n.clientY)},mouseup:function(n){qs(n)&&!Vs(n)&&(clearTimeout(this.pressTimer),this.released?this.close():this.release())},touchstart:function(n){n.preventDefault();var t=n.touches[0],e=t.clientX,r=t.clientY;this.pressTimer=setTimeout(function(){this.grab(e,r)}.bind(this),200)},touchmove:function(n){if(!this.released){var t=n.touches[0],e=t.clientX,r=t.clientY;this.move(e,r)}},touchend:function(n){(function(n){n.targetTouches.length})(n)||(clearTimeout(this.pressTimer),this.released?this.close():this.release())},clickOverlay:function(){this.close()},resizeWindow:function(){this.close()}};function qs(n){return 0===n.button}function Vs(n){return n.metaKey||n.ctrlKey}var Js={init:function(n){this.el=document.createElement("div"),this.instance=n,this.parent=document.body,Rs(this.el,{position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0}),this.updateStyle(n.options),Ls(this.el,"click",n.handler.clickOverlay.bind(n))},updateStyle:function(n){Rs(this.el,{zIndex:n.zIndex,backgroundColor:n.bgColor,transition:"opacity\n        "+n.transitionDuration+"s\n        "+n.transitionTimingFunction})},insert:function(){this.parent.appendChild(this.el)},remove:function(){this.parent.removeChild(this.el)},fadeIn:function(){this.el.offsetWidth,this.el.style.opacity=this.instance.options.bgOpacity},fadeOut:function(){this.el.style.opacity=0}},Ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Gs=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),Hs=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Ks={init:function(n,t){this.el=n,this.instance=t,this.srcThumbnail=this.el.getAttribute("src"),this.srcset=this.el.getAttribute("srcset"),this.srcOriginal=Ms(this.el),this.rect=this.el.getBoundingClientRect(),this.translate=null,this.scale=null,this.styleOpen=null,this.styleClose=null},zoomIn:function(){var n=this.instance.options,t=n.zIndex,e=n.enableGrab,r=n.transitionDuration,i=n.transitionTimingFunction;this.translate=this.calculateTranslate(),this.scale=this.calculateScale(),this.styleOpen={position:"relative",zIndex:t+1,cursor:e?Os:As,transition:Ns+"\n        "+r+"s\n        "+i,transform:"translate3d("+this.translate.x+"px, "+this.translate.y+"px, 0px)\n        scale("+this.scale.x+","+this.scale.y+")",height:this.rect.height+"px",width:this.rect.width+"px"},this.el.offsetWidth,this.styleClose=Rs(this.el,this.styleOpen,!0)},zoomOut:function(){this.el.offsetWidth,Rs(this.el,{transform:"none"})},grab:function(n,t,e){var r=Xs(),i=r.x-n,a=r.y-t;Rs(this.el,{cursor:Es,transform:"translate3d(\n        "+(this.translate.x+i)+"px, "+(this.translate.y+a)+"px, 0px)\n        scale("+(this.scale.x+e)+","+(this.scale.y+e)+")"})},move:function(n,t,e){var r=Xs(),i=r.x-n,a=r.y-t;Rs(this.el,{transition:Ns,transform:"translate3d(\n        "+(this.translate.x+i)+"px, "+(this.translate.y+a)+"px, 0px)\n        scale("+(this.scale.x+e)+","+(this.scale.y+e)+")"})},restoreCloseStyle:function(){Rs(this.el,this.styleClose)},restoreOpenStyle:function(){Rs(this.el,this.styleOpen)},upgradeSource:function(){if(this.srcOriginal){var n=this.el.parentNode;this.srcset&&this.el.removeAttribute("srcset");var t=this.el.cloneNode(!1);t.setAttribute("src",this.srcOriginal),t.style.position="fixed",t.style.visibility="hidden",n.appendChild(t),setTimeout(function(){this.el.setAttribute("src",this.srcOriginal),n.removeChild(t)}.bind(this),50)}},downgradeSource:function(){this.srcOriginal&&(this.srcset&&this.el.setAttribute("srcset",this.srcset),this.el.setAttribute("src",this.srcThumbnail))},calculateTranslate:function(){var n=Xs(),t=this.rect.left+this.rect.width/2,e=this.rect.top+this.rect.height/2;return{x:n.x-t,y:n.y-e}},calculateScale:function(){var n=this.el.dataset,t=n.zoomingHeight,e=n.zoomingWidth,r=this.instance.options,i=r.customSize,a=r.scaleBase;if(!i&&t&&e)return{x:e/this.rect.width,y:t/this.rect.height};if(i&&"object"===(void 0===i?"undefined":Ws(i)))return{x:i.width/this.rect.width,y:i.height/this.rect.height};var o=this.rect.width/2,s=this.rect.height/2,c=Xs(),l={x:c.x-o,y:c.y-s},u=l.x/o,p=l.y/s,d=a+Math.min(u,p);if(i&&"string"==typeof i){var f=e||this.el.naturalWidth,h=t||this.el.naturalHeight,m=parseFloat(i)*f/(100*this.rect.width),v=parseFloat(i)*h/(100*this.rect.height);if(d>m||d>v)return{x:m,y:v}}return{x:d,y:d}}};function Xs(){var n=document.documentElement;return{x:Math.min(n.clientWidth,window.innerWidth)/2,y:Math.min(n.clientHeight,window.innerHeight)/2}}function Qs(n,t,e){["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"].forEach((function(r){Ls(n,r,t[r],e)}))}var Ys=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.target=Object.create(Ks),this.overlay=Object.create(Js),this.handler=Object.create(Fs),this.body=document.body,this.shown=!1,this.lock=!1,this.released=!0,this.lastScrollPosition=null,this.pressTimer=null,this.options=Hs({},Us,t),this.overlay.init(this),this.handler.init(this)}return Gs(n,[{key:"listen",value:function(n){if("string"==typeof n)for(var t=document.querySelectorAll(n),e=t.length;e--;)this.listen(t[e]);else"IMG"===n.tagName&&(n.style.cursor=Is,Ls(n,"click",this.handler.click),this.options.preloadImage&&zs(Ms(n)));return this}},{key:"config",value:function(n){return n?(Hs(this.options,n),this.overlay.updateStyle(this.options),this):this.options}},{key:"open",value:function(n){var t=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.onOpen;if(!this.shown&&!this.lock){var r="string"==typeof n?document.querySelector(n):n;if("IMG"===r.tagName){if(this.options.onBeforeOpen(r),this.target.init(r,this),!this.options.preloadImage){var i=this.target.srcOriginal;null!=i&&(this.options.onImageLoading(r),zs(i,this.options.onImageLoaded))}this.shown=!0,this.lock=!0,this.target.zoomIn(),this.overlay.insert(),this.overlay.fadeIn(),Ls(document,"scroll",this.handler.scroll),Ls(document,"keydown",this.handler.keydown),this.options.closeOnWindowResize&&Ls(window,"resize",this.handler.resizeWindow);var a=function n(){Ls(r,Ds,n,!1),t.lock=!1,t.target.upgradeSource(),t.options.enableGrab&&Qs(document,t.handler,!0),e(r)};return Ls(r,Ds,a),this}}}},{key:"close",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onClose;if(this.shown&&!this.lock){var e=this.target.el;this.options.onBeforeClose(e),this.lock=!0,this.body.style.cursor=Cs,this.overlay.fadeOut(),this.target.zoomOut(),Ls(document,"scroll",this.handler.scroll,!1),Ls(document,"keydown",this.handler.keydown,!1),this.options.closeOnWindowResize&&Ls(window,"resize",this.handler.resizeWindow,!1);var r=function r(){Ls(e,Ds,r,!1),n.shown=!1,n.lock=!1,n.target.downgradeSource(),n.options.enableGrab&&Qs(document,n.handler,!1),n.target.restoreCloseStyle(),n.overlay.remove(),t(e)};return Ls(e,Ds,r),this}}},{key:"grab",value:function(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onGrab;if(this.shown&&!this.lock){var i=this.target.el;this.options.onBeforeGrab(i),this.released=!1,this.target.grab(n,t,e);var a=function n(){Ls(i,Ds,n,!1),r(i)};return Ls(i,Ds,a),this}}},{key:"move",value:function(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.options.onMove;if(this.shown&&!this.lock){this.released=!1,this.body.style.cursor=Es,this.target.move(n,t,e);var i=this.target.el,a=function n(){Ls(i,Ds,n,!1),r(i)};return Ls(i,Ds,a),this}}},{key:"release",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onRelease;if(this.shown&&!this.lock){var e=this.target.el;this.options.onBeforeRelease(e),this.lock=!0,this.body.style.cursor=Cs,this.target.restoreOpenStyle();var r=function r(){Ls(e,Ds,r,!1),n.lock=!1,n.released=!0,t(e)};return Ls(e,Ds,r),this}}}]),n}(),Zs=".theme-vdoing-content img:not(.no-zoom)",nc=JSON.parse('{"bgColor":"rgba(0,0,0,0.6)"}'),tc=Number("500"),ec=function(){function n(){us(this,n),this.instance=new Ys(nc)}return ds(n,[{key:"update",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zs;"undefined"!=typeof window&&this.instance.listen(n)}},{key:"updateDelay",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zs,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tc;setTimeout((function(){return n.update(t)}),e)}}]),n}(),rc=[ns,os,ls,hs,js,{watch:{"$page.path":function(){void 0!==this.$vuepress.zooming&&this.$vuepress.zooming.updateDelay()}},mounted:function(){this.$vuepress.zooming=new ec,this.$vuepress.zooming.updateDelay()}}],ic={name:"GlobalLayout",computed:{layout:function(){var n=this.getLayout();return Ho("layout",n),Mi.component(n)}},methods:{getLayout:function(){if(this.$page.path){var n=this.$page.frontmatter.layout;return n&&(this.$vuepress.getLayoutAsyncComponent(n)||this.$vuepress.getVueComponent(n))?n:"Layout"}return"NotFound"}}},ac=e(33),oc=Object(ac.a)(ic,(function(){var n=this.$createElement;return(this._self._c||n)(this.layout,{tag:"component"})}),[],!1,null,null,null).exports;!function(n,t,e){var r;switch(t){case"components":n[t]||(n[t]={}),Object.assign(n[t],e);break;case"mixins":n[t]||(n[t]=[]),(r=n[t]).push.apply(r,Object(Io.a)(e));break;default:throw new Error("Unknown option name.")}}(oc,"mixins",rc);var sc=[{name:"v-761e5d7e",path:"/pages/dcff10/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-761e5d7e").then(e)}},{path:"/pages/dcff10/index.html",redirect:"/pages/dcff10/"},{path:"/01.Java/JVM.html",redirect:"/pages/dcff10/"},{name:"v-64d333aa",path:"/pages/f9a6a6/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-64d333aa").then(e)}},{path:"/pages/f9a6a6/index.html",redirect:"/pages/f9a6a6/"},{path:"/01.Java/Javaåºç¡.html",redirect:"/pages/f9a6a6/"},{name:"v-648c7cfe",path:"/pages/f2ec12/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-648c7cfe").then(e)}},{path:"/pages/f2ec12/index.html",redirect:"/pages/f2ec12/"},{path:"/01.Java/Javaå¹¶å.html",redirect:"/pages/f2ec12/"},{name:"v-c2331f12",path:"/pages/3dacb0/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-c2331f12").then(e)}},{path:"/pages/3dacb0/index.html",redirect:"/pages/3dacb0/"},{path:"/01.Java/Javaéå.html",redirect:"/pages/3dacb0/"},{name:"v-255c09a1",path:"/pages/b825b8/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-255c09a1").then(e)}},{path:"/pages/b825b8/index.html",redirect:"/pages/b825b8/"},{path:"/01.Java/NIO.html",redirect:"/pages/b825b8/"},{name:"v-4721bed4",path:"/pages/f4d6a4/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-4721bed4").then(e)}},{path:"/pages/f4d6a4/index.html",redirect:"/pages/f4d6a4/"},{path:"/02.æ°æ®åº/ES.html",redirect:"/pages/f4d6a4/"},{name:"v-062877d6",path:"/pages/fa91e2/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-062877d6").then(e)}},{path:"/pages/fa91e2/index.html",redirect:"/pages/fa91e2/"},{path:"/02.æ°æ®åº/MogoDB.html",redirect:"/pages/fa91e2/"},{name:"v-c44d2880",path:"/pages/7e2298/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-c44d2880").then(e)}},{path:"/pages/7e2298/index.html",redirect:"/pages/7e2298/"},{path:"/02.æ°æ®åº/MySQL.html",redirect:"/pages/7e2298/"},{name:"v-3da84d0d",path:"/pages/7e5d5d/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-3da84d0d").then(e)}},{path:"/pages/7e5d5d/index.html",redirect:"/pages/7e5d5d/"},{path:"/03.è®¡ç®æºåºç¡/MybastisPlus.html",redirect:"/pages/7e5d5d/"},{name:"v-4537776d",path:"/pages/4501c4/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-4537776d").then(e)}},{path:"/pages/4501c4/index.html",redirect:"/pages/4501c4/"},{path:"/03.è®¡ç®æºåºç¡/SpringBoot.html",redirect:"/pages/4501c4/"},{name:"v-536574fe",path:"/archives/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-536574fe").then(e)}},{path:"/archives/index.html",redirect:"/archives/"},{path:"/@pages/archivesPage.html",redirect:"/archives/"},{name:"v-bf924ecc",path:"/",component:oc,beforeEnter:function(n,t,e){Go("Layout","v-bf924ecc").then(e)}},{path:"/index.html",redirect:"/"},{path:"*",component:oc}],cc={title:"Jerry's Binlog",description:"Write the Code. Change the World.",base:"/notes/",headTags:[["link",{rel:"icon",href:"/notes/img/favicon.ico"}],["meta",{name:"keywords",content:"qianyizzz,wxy"}],["meta",{name:"theme-color",content:"#11a8cd"}]],pages:[{title:"JVM",frontmatter:{title:"JVM",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/dcff10/"},regularPath:"/01.Java/JVM.html",relativePath:"01.Java/JVM.md",key:"v-761e5d7e",path:"/pages/dcff10/",headers:[{level:2,title:"ä¸ãä»ä¹æ¯JVM",slug:"ä¸ãä»ä¹æ¯jvm",normalizedTitle:"ä¸ãä»ä¹æ¯jvm",charIndex:2},{level:3,title:"å®ä¹",slug:"å®ä¹",normalizedTitle:"å®ä¹",charIndex:15},{level:3,title:"å¥½å¤",slug:"å¥½å¤",normalizedTitle:"å¥½å¤",charIndex:73},{level:3,title:"æ¯è¾",slug:"æ¯è¾",normalizedTitle:"æ¯è¾",charIndex:123},{level:2,title:"äºãåå­ç»æ",slug:"äºãåå­ç»æ",normalizedTitle:"äºãåå­ç»æ",charIndex:148},{level:3,title:"æ´ä½æ¶æ",slug:"æ´ä½æ¶æ",normalizedTitle:"æ´ä½æ¶æ",charIndex:159},{level:3,title:"1ãç¨åºè®¡æ°å¨",slug:"_1ãç¨åºè®¡æ°å¨",normalizedTitle:"1ãç¨åºè®¡æ°å¨",charIndex:170},{level:3,title:"2ãèææºæ ",slug:"_2ãèææºæ ",normalizedTitle:"2ãèææºæ ",charIndex:360},{level:3,title:"3ãæ¬å°æ¹æ³æ ",slug:"_3ãæ¬å°æ¹æ³æ ",normalizedTitle:"3ãæ¬å°æ¹æ³æ ",charIndex:1357},{level:3,title:"4ãå ",slug:"_4ãå ",normalizedTitle:"4ãå ",charIndex:1443},{level:3,title:"5ãæ¹æ³åº",slug:"_5ãæ¹æ³åº",normalizedTitle:"5ãæ¹æ³åº",charIndex:1629},{level:3,title:"6ãç´æ¥åå­",slug:"_6ãç´æ¥åå­",normalizedTitle:"6ãç´æ¥åå­",charIndex:7953},{level:2,title:"ä¸ãåå¾åæ¶",slug:"ä¸ãåå¾åæ¶",normalizedTitle:"ä¸ãåå¾åæ¶",charIndex:10420},{level:3,title:"1ãå¦ä½å¤æ­å¯¹è±¡å¯ä»¥åæ¶",slug:"_1ãå¦ä½å¤æ­å¯¹è±¡å¯ä»¥åæ¶",normalizedTitle:"1ãå¦ä½å¤æ­å¯¹è±¡å¯ä»¥åæ¶",charIndex:10431},{level:3,title:"2ãåå¾åæ¶ç®æ³",slug:"_2ãåå¾åæ¶ç®æ³",normalizedTitle:"2ãåå¾åæ¶ç®æ³",charIndex:12668},{level:3,title:"3ãåä»£åæ¶",slug:"_3ãåä»£åæ¶",normalizedTitle:"3ãåä»£åæ¶",charIndex:13150},{level:3,title:"4ãåå¾åæ¶å¨",slug:"_4ãåå¾åæ¶å¨",normalizedTitle:"4ãåå¾åæ¶å¨",charIndex:13738},{level:3,title:"5ãGC è°ä¼",slug:"_5ãgc-è°ä¼",normalizedTitle:"5ãgc è°ä¼",charIndex:17485},{level:2,title:"åãç±»å è½½ä¸å­èç ææ¯",slug:"åãç±»å è½½ä¸å­èç ææ¯",normalizedTitle:"åãç±»å è½½ä¸å­èç ææ¯",charIndex:18210},{level:3,title:"1ãç±»æä»¶ç»æ",slug:"_1ãç±»æä»¶ç»æ",normalizedTitle:"1ãç±»æä»¶ç»æ",charIndex:18228},{level:3,title:"2ãå­èç æä»¤",slug:"_2ãå­èç æä»¤",normalizedTitle:"2ãå­èç æä»¤",charIndex:21467},{level:3,title:"3ãç¼è¯æå¤ç",slug:"_3ãç¼è¯æå¤ç",normalizedTitle:"3ãç¼è¯æå¤ç",charIndex:37406},{level:3,title:"4ãç±»å è½½é¶æ®µ",slug:"_4ãç±»å è½½é¶æ®µ",normalizedTitle:"4ãç±»å è½½é¶æ®µ",charIndex:46647},{level:3,title:"5ãç±»å è½½å¨",slug:"_5ãç±»å è½½å¨",normalizedTitle:"5ãç±»å è½½å¨",charIndex:48801},{level:3,title:"6ãè¿è¡æä¼å",slug:"_6ãè¿è¡æä¼å",normalizedTitle:"6ãè¿è¡æä¼å",charIndex:51867},{level:2,title:"äºãåå­æ¨¡å",slug:"äºãåå­æ¨¡å",normalizedTitle:"äºãåå­æ¨¡å",charIndex:57281}],headersStr:"ä¸ãä»ä¹æ¯JVM å®ä¹ å¥½å¤ æ¯è¾ äºãåå­ç»æ æ´ä½æ¶æ 1ãç¨åºè®¡æ°å¨ 2ãèææºæ  3ãæ¬å°æ¹æ³æ  4ãå  5ãæ¹æ³åº 6ãç´æ¥åå­ ä¸ãåå¾åæ¶ 1ãå¦ä½å¤æ­å¯¹è±¡å¯ä»¥åæ¶ 2ãåå¾åæ¶ç®æ³ 3ãåä»£åæ¶ 4ãåå¾åæ¶å¨ 5ãGC è°ä¼ åãç±»å è½½ä¸å­èç ææ¯ 1ãç±»æä»¶ç»æ 2ãå­èç æä»¤ 3ãç¼è¯æå¤ç 4ãç±»å è½½é¶æ®µ 5ãç±»å è½½å¨ 6ãè¿è¡æä¼å äºãåå­æ¨¡å",content:'# ä¸ãä»ä¹æ¯JVM\n\n\n# å®ä¹\n\nJava Virtual Machineï¼JAVAç¨åºçè¿è¡ç¯å¢ï¼JAVAäºè¿å¶å­èç çè¿è¡ç¯å¢ï¼\n\n\n# å¥½å¤\n\n * ä¸æ¬¡ç¼åï¼å°å¤è¿è¡\n * èªå¨åå­ç®¡çï¼åå¾åæ¶æºå¶\n * æ°ç»ä¸æ è¶çæ£æ¥\n\n\n# æ¯è¾\n\nJVM JRE JDKçåºå«\n\n\n\n\n# äºãåå­ç»æ\n\n\n# æ´ä½æ¶æ\n\n\n\n\n# 1ãç¨åºè®¡æ°å¨\n\n# ä½ç¨\n\nç¨äºä¿å­JVMä¸­ä¸ä¸æ¡æè¦æ§è¡çæä»¤çå°å\n\n# ç¹ç¹\n\n * çº¿ç¨ç§æ\n   * CPUä¼ä¸ºæ¯ä¸ªçº¿ç¨åéæ¶é´çï¼å½å½åçº¿ç¨çæ¶é´çä½¿ç¨å®ä»¥åï¼CPUå°±ä¼å»æ§è¡å¦ä¸ä¸ªçº¿ç¨ä¸­çä»£ç \n   * ç¨åºè®¡æ°å¨æ¯æ¯ä¸ªçº¿ç¨æç§æçï¼å½å¦ä¸ä¸ªçº¿ç¨çæ¶é´çç¨å®ï¼åè¿åæ¥æ§è¡å½åçº¿ç¨çä»£ç æ¶ï¼éè¿ç¨åºè®¡æ°å¨å¯ä»¥ç¥éåºè¯¥æ§è¡åªä¸å¥æä»¤\n * ä¸ä¼å­å¨åå­æº¢åº\n\n\n# 2ãèææºæ \n\n# å®ä¹\n\n * æ¯ä¸ªçº¿ç¨è¿è¡éè¦çåå­ç©ºé´ï¼ç§°ä¸ºèææºæ \n * æ¯ä¸ªæ ç±å¤ä¸ªæ å¸§ç»æï¼å¯¹åºçæ¯æ¬¡è°ç¨æ¹æ³æ¶æå ç¨çåå­\n * æ¯ä¸ªçº¿ç¨åªè½æä¸ä¸ªæ´»å¨æ å¸§ï¼å¯¹åºçå½åæ­£å¨æ§è¡çæ¹æ³\n\n# æ¼ç¤º\n\nä»£ç \n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tmethod1();\n\t}\n\n\tprivate static void method1() {\n\t\tmethod2(1, 2);\n\t}\n\n\tprivate static int method2(int a, int b) {\n\t\tint c = a + b;\n\t\treturn c;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n\nå¨æ§å¶å°ä¸­å¯ä»¥çå°ï¼ä¸»ç±»ä¸­çæ¹æ³å¨è¿å¥èææºæ çæ¶åï¼ç¬¦åæ çç¹ç¹\n\n# é®é¢è¾¨æ\n\n * åå¾åæ¶æ¯å¦æ¶åæ åå­ï¼\n   * ä¸éè¦ãå ä¸ºèææºæ ä¸­æ¯ç±ä¸ä¸ªä¸ªæ å¸§ç»æçï¼å¨æ¹æ³æ§è¡å®æ¯åï¼å¯¹åºçæ å¸§å°±ä¼è¢«å¼¹åºæ ãæä»¥æ ééè¿åå¾åæ¶æºå¶å»åæ¶åå­ã\n * æ åå­çåéè¶å¤§è¶å¥½åï¼\n   * ä¸æ¯ãå ä¸ºç©çåå­æ¯ä¸å®çï¼æ åå­è¶å¤§ï¼å¯ä»¥æ¯ææ´å¤çéå½è°ç¨ï¼ä½æ¯å¯æ§è¡ççº¿ç¨æ°å°±ä¼è¶å°ã\n * æ¹æ³åçå±é¨åéæ¯å¦æ¯çº¿ç¨å®å¨çï¼\n   * å¦ææ¹æ³åå±é¨åéæ²¡æéç¦»æ¹æ³çä½ç¨èå´ï¼åæ¯çº¿ç¨å®å¨ç\n   * å¦æå¦æå±é¨åéå¼ç¨äºå¯¹è±¡ï¼å¹¶éç¦»äºæ¹æ³çä½ç¨èå´ï¼åéè¦èèçº¿ç¨å®å¨é®é¢\n\n# åå­æº¢åº\n\nJava.lang.stackOverflowError æ åå­æº¢åº\n\nåçåå \n\n * èææºæ ä¸­ï¼æ å¸§è¿å¤ï¼æ ééå½ï¼\n * æ¯ä¸ªæ å¸§æå ç¨è¿å¤§\n\n# çº¿ç¨è¿è¡è¯æ­\n\nCPUå ç¨è¿é«\n\n * Linuxç¯å¢ä¸è¿è¡æäºç¨åºçæ¶åï¼å¯è½å¯¼è´CPUçå ç¨è¿é«ï¼è¿æ¶éè¦å®ä½å ç¨CPUè¿é«ççº¿ç¨\n   * topå½ä»¤ï¼æ¥çæ¯åªä¸ªè¿ç¨å ç¨CPUè¿é«\n   * ps H -eo pid, tidï¼çº¿ç¨idï¼, %cpu | grep åæéè¿topæ¥å°çè¿ç¨å· éè¿pså½ä»¤è¿ä¸æ­¥æ¥çæ¯åªä¸ªçº¿ç¨å ç¨CPUè¿é«\n   * jstack è¿ç¨id éè¿æ¥çè¿ç¨ä¸­ççº¿ç¨çnidï¼åæéè¿pså½ä»¤çå°çtidæ¥å¯¹æ¯å®ä½ï¼æ³¨æjstackæ¥æ¾åºççº¿ç¨idæ¯16è¿å¶çï¼éè¦è½¬æ¢\n\n\n# 3ãæ¬å°æ¹æ³æ \n\nä¸äºå¸¦ænativeå³é®å­çæ¹æ³å°±æ¯éè¦JAVAå»è°ç¨æ¬å°çCæèC++æ¹æ³ï¼å ä¸ºJAVAææ¶åæ²¡æ³ç´æ¥åæä½ç³»ç»åºå±äº¤äºï¼æä»¥éè¦ç¨å°æ¬å°æ¹æ³\n\n\n# 4ãå \n\n# å®ä¹\n\néè¿newå³é®å­åå»ºçå¯¹è±¡é½ä¼è¢«æ¾å¨å åå­\n\n# ç¹ç¹\n\n * ææçº¿ç¨å±äº«ï¼å åå­ä¸­çå¯¹è±¡é½éè¦èèçº¿ç¨å®å¨é®é¢\n * æåå¾åæ¶æºå¶\n\n# å åå­æº¢åº\n\njava.lang.OutofMemoryError ï¼java heap space. å åå­æº¢åº\n\n# å åå­è¯æ­\n\njps\n\njmap\n\njconsole\n\njvirsalvm\n\n\n# 5ãæ¹æ³åº\n\n# ç»æ\n\n\n\n# åå­æº¢åº\n\n * 1.8ä»¥åä¼å¯¼è´æ°¸ä¹ä»£åå­æº¢åº\n * 1.8ä»¥åä¼å¯¼è´åç©ºé´åå­æº¢åº\n\n# å¸¸éæ± \n\näºè¿å¶å­èç çç»æï¼ç±»çåºæ¬ä¿¡æ¯ãå¸¸éæ± ãç±»çæ¹æ³å®ä¹ï¼åå«äºèææºæä»¤ï¼\n\néè¿åç¼è¯æ¥æ¥çç±»çä¿¡æ¯\n\n * è·å¾å¯¹åºç±»ç.classæä»¶\n   \n   * å¨JDKå¯¹åºçbinç®å½ä¸è¿è¡cmdï¼ä¹å¯ä»¥å¨IDEAæ§å¶å°è¾å¥\n     \n     \n   \n   * è¾å¥ javac å¯¹åºç±»çç»å¯¹è·¯å¾\n     \n     F:\\JAVA\\JDK8.0\\bin>javac F:\\Thread_study\\src\\com\\nyima\\JVM\\day01\\Main.java\n     \n     \n     1\n     \n     \n     è¾å¥å®æåï¼å¯¹åºçç®å½ä¸å°±ä¼åºç°ç±»ç.classæä»¶\n\n * å¨æ§å¶å°è¾å¥ javap -v ç±»çç»å¯¹è·¯å¾\n   \n   javap -v F:\\Thread_study\\src\\com\\nyima\\JVM\\day01\\Main.class\n   \n   \n   1\n   \n\n * ç¶åè½å¨æ§å¶å°çå°åç¼è¯ä»¥åç±»çä¿¡æ¯äº\n   \n   * ç±»çåºæ¬ä¿¡æ¯\n     \n     \n   \n   * å¸¸éæ± \n     \n     \n     \n     \n   \n   * èææºä¸­æ§è¡ç¼è¯çæ¹æ³ï¼æ¡åçæ¯çæ­£ç¼è¯æ§è¡çåå®¹ï¼#å·çåå®¹éè¦å¨å¸¸éæ± ä¸­æ¥æ¾ï¼\n     \n     \n\n# è¿è¡æ¶å¸¸éæ± \n\n * å¸¸éæ± \n   * å°±æ¯ä¸å¼ è¡¨ï¼å¦ä¸å¾ä¸­çconstant poolï¼ï¼èææºæä»¤æ ¹æ®è¿å¼ å¸¸éè¡¨æ¾å°è¦æ§è¡çç±»åãæ¹æ³åãåæ°ç±»åãå­é¢éä¿¡æ¯\n * è¿è¡æ¶å¸¸éæ± \n   * å¸¸éæ± æ¯*.classæä»¶ä¸­çï¼å½è¯¥ç±»è¢«å è½½ä»¥åï¼å®çå¸¸éæ± ä¿¡æ¯å°±ä¼æ¾å¥è¿è¡æ¶å¸¸éæ± ï¼å¹¶æéé¢çç¬¦å·å°ååä¸ºçå®å°å\n\n# å¸¸éæ± ä¸ä¸²æ± çå³ç³»\n\n# ä¸²æ± StringTable\n\nç¹å¾\n\n * å¸¸éæ± ä¸­çå­ç¬¦ä¸²ä»æ¯ç¬¦å·ï¼åªæå¨è¢«ç¨å°æ¶æä¼è½¬åä¸ºå¯¹è±¡\n * å©ç¨ä¸²æ± çæºå¶ï¼æ¥é¿åéå¤åå»ºå­ç¬¦ä¸²å¯¹è±¡\n * å­ç¬¦ä¸²åéæ¼æ¥çåçæ¯StringBuilder\n * å­ç¬¦ä¸²å¸¸éæ¼æ¥çåçæ¯ç¼è¯å¨ä¼å\n * å¯ä»¥ä½¿ç¨internæ¹æ³ï¼ä¸»å¨å°ä¸²æ± ä¸­è¿æ²¡æçå­ç¬¦ä¸²å¯¹è±¡æ¾å¥ä¸²æ± ä¸­\n * æ³¨æï¼æ è®ºæ¯ä¸²æ± è¿æ¯å éé¢çå­ç¬¦ä¸²ï¼é½æ¯å¯¹è±¡\n\nç¨æ¥æ¾å­ç¬¦ä¸²å¯¹è±¡ä¸éé¢çåç´ ä¸éå¤\n\npublic class StringTableStudy {\n\tpublic static void main(String[] args) {\n\t\tString a = "a"; \n\t\tString b = "b";\n\t\tString ab = "ab";\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¸¸éæ± ä¸­çä¿¡æ¯ï¼é½ä¼è¢«å è½½å°è¿è¡æ¶å¸¸éæ± ä¸­ï¼ä½è¿æ¯a b ab ä»æ¯å¸¸éæ± ä¸­çç¬¦å·ï¼è¿æ²¡ææä¸ºjavaå­ç¬¦ä¸²\n\n0: ldc           #2                  // String a\n2: astore_1\n3: ldc           #3                  // String b\n5: astore_2\n6: ldc           #4                  // String ab\n8: astore_3\n9: return\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå½æ§è¡å° ldc #2 æ¶ï¼ä¼æç¬¦å· a åä¸º âaâ å­ç¬¦ä¸²å¯¹è±¡ï¼å¹¶æ¾å¥ä¸²æ± ä¸­ï¼hashtableç»æ ä¸å¯æ©å®¹ï¼\n\nå½æ§è¡å° ldc #3 æ¶ï¼ä¼æç¬¦å· b åä¸º âbâ å­ç¬¦ä¸²å¯¹è±¡ï¼å¹¶æ¾å¥ä¸²æ± ä¸­\n\nå½æ§è¡å° ldc #4 æ¶ï¼ä¼æç¬¦å· ab åä¸º âabâ å­ç¬¦ä¸²å¯¹è±¡ï¼å¹¶æ¾å¥ä¸²æ± ä¸­\n\næç»StringTable [âaâ, âbâ, âabâ]\n\næ³¨æï¼å­ç¬¦ä¸²å¯¹è±¡çåå»ºé½æ¯ææ°çï¼åªæå½è¿è¡å°é£ä¸è¡å­ç¬¦ä¸²ä¸å¨ä¸²æ± ä¸­ä¸å­å¨çæ¶åï¼å¦ ldc #2ï¼æ¶ï¼è¯¥å­ç¬¦ä¸²æä¼è¢«åå»ºå¹¶æ¾å¥ä¸²æ± ä¸­ã\n\nä½¿ç¨æ¼æ¥å­ç¬¦ä¸²åéå¯¹è±¡åå»ºå­ç¬¦ä¸²çè¿ç¨\n\npublic class StringTableStudy {\n\tpublic static void main(String[] args) {\n\t\tString a = "a";\n\t\tString b = "b";\n\t\tString ab = "ab";\n\t\t//æ¼æ¥å­ç¬¦ä¸²å¯¹è±¡æ¥åå»ºæ°çå­ç¬¦ä¸²\n\t\tString ab2 = a+b; \n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nåç¼è¯åçç»æ\n\n\t Code:\n      stack=2, locals=5, args_size=1\n         0: ldc           #2                  // String a\n         2: astore_1\n         3: ldc           #3                  // String b\n         5: astore_2\n         6: ldc           #4                  // String ab\n         8: astore_3\n         9: new           #5                  // class java/lang/StringBuilder\n        12: dup\n        13: invokespecial #6                  // Method java/lang/StringBuilder."<init>":()V\n        16: aload_1\n        17: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String\n;)Ljava/lang/StringBuilder;\n        20: aload_2\n        21: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String\n;)Ljava/lang/StringBuilder;\n        24: invokevirtual #8                  // Method java/lang/StringBuilder.toString:()Ljava/lang/Str\ning;\n        27: astore        4\n        29: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\néè¿æ¼æ¥çæ¹å¼æ¥åå»ºå­ç¬¦ä¸²çè¿ç¨æ¯ï¼StringBuilder().append(âaâ).append(âbâ).toString()\n\næåçtoStringæ¹æ³çè¿åå¼æ¯ä¸ä¸ªæ°çå­ç¬¦ä¸²ï¼ä½å­ç¬¦ä¸²çå¼åæ¼æ¥çå­ç¬¦ä¸²ä¸è´ï¼ä½æ¯ä¸¤ä¸ªä¸åçå­ç¬¦ä¸²ï¼ä¸ä¸ªå­å¨äºä¸²æ± ä¹ä¸­ï¼ä¸ä¸ªå­å¨äºå åå­ä¹ä¸­\n\nString ab = "ab";\nString ab2 = a+b;\n//ç»æä¸ºfalse,å ä¸ºabæ¯å­å¨äºä¸²æ± ä¹ä¸­ï¼ab2æ¯ç±StringBufferçtoStringæ¹æ³æè¿åçä¸ä¸ªå¯¹è±¡ï¼å­å¨äºå åå­ä¹ä¸­\nSystem.out.println(ab == ab2);\n\n\n1\n2\n3\n4\n\n\nä½¿ç¨æ¼æ¥å­ç¬¦ä¸²å¸¸éå¯¹è±¡çæ¹æ³åå»ºå­ç¬¦ä¸²\n\npublic class StringTableStudy {\n\tpublic static void main(String[] args) {\n\t\tString a = "a";\n\t\tString b = "b";\n\t\tString ab = "ab";\n\t\tString ab2 = a+b;\n\t\t//ä½¿ç¨æ¼æ¥å­ç¬¦ä¸²çæ¹æ³åå»ºå­ç¬¦ä¸²\n\t\tString ab3 = "a" + "b";\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nåç¼è¯åçç»æ\n\n \t  Code:\n      stack=2, locals=6, args_size=1\n         0: ldc           #2                  // String a\n         2: astore_1\n         3: ldc           #3                  // String b\n         5: astore_2\n         6: ldc           #4                  // String ab\n         8: astore_3\n         9: new           #5                  // class java/lang/StringBuilder\n        12: dup\n        13: invokespecial #6                  // Method java/lang/StringBuilder."<init>":()V\n        16: aload_1\n        17: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String\n;)Ljava/lang/StringBuilder;\n        20: aload_2\n        21: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String\n;)Ljava/lang/StringBuilder;\n        24: invokevirtual #8                  // Method java/lang/StringBuilder.toString:()Ljava/lang/Str\ning;\n        27: astore        4\n        //ab3åå§åæ¶ç´æ¥ä»ä¸²æ± ä¸­è·åå­ç¬¦ä¸²\n        29: ldc           #4                  // String ab\n        31: astore        5\n        33: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n * ä½¿ç¨æ¼æ¥å­ç¬¦ä¸²å¸¸éçæ¹æ³æ¥åå»ºæ°çå­ç¬¦ä¸²æ¶ï¼å ä¸ºåå®¹æ¯å¸¸éï¼javacå¨ç¼è¯æä¼è¿è¡ä¼åï¼ç»æå·²å¨ç¼è¯æç¡®å®ä¸ºabï¼èåå»ºabçæ¶åå·²ç»å¨ä¸²æ± ä¸­æ¾å¥äºâabâï¼æä»¥ab3ç´æ¥ä»ä¸²æ± ä¸­è·åå¼ï¼æä»¥è¿è¡çæä½å ab = âabâ ä¸è´ã\n * ä½¿ç¨æ¼æ¥å­ç¬¦ä¸²åéçæ¹æ³æ¥åå»ºæ°çå­ç¬¦ä¸²æ¶ï¼å ä¸ºåå®¹æ¯åéï¼åªè½å¨è¿è¡æç¡®å®å®çå¼ï¼æä»¥éè¦ä½¿ç¨StringBuilderæ¥åå»º\n\n# internæ¹æ³ 1.8\n\nè°ç¨å­ç¬¦ä¸²å¯¹è±¡çinternæ¹æ³ï¼ä¼å°è¯¥å­ç¬¦ä¸²å¯¹è±¡å°è¯æ¾å¥å°ä¸²æ± ä¸­\n\n * å¦æä¸²æ± ä¸­æ²¡æè¯¥å­ç¬¦ä¸²å¯¹è±¡ï¼åæ¾å¥æå\n * å¦ææè¯¥å­ç¬¦ä¸²å¯¹è±¡ï¼åæ¾å¥å¤±è´¥\n\næ è®ºæ¾å¥æ¯å¦æåï¼é½ä¼è¿åä¸²æ± ä¸­çå­ç¬¦ä¸²å¯¹è±¡\n\næ³¨æï¼æ­¤æ¶å¦æè°ç¨internæ¹æ³æåï¼å åå­ä¸ä¸²æ± ä¸­çå­ç¬¦ä¸²å¯¹è±¡æ¯åä¸ä¸ªå¯¹è±¡ï¼å¦æå¤±è´¥ï¼åä¸æ¯åä¸ä¸ªå¯¹è±¡\n\nä¾1\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\t//"a" "b" è¢«æ¾å¥ä¸²æ± ä¸­ï¼stråå­å¨äºå åå­ä¹ä¸­\n\t\tString str = new String("a") + new String("b");\n\t\t//è°ç¨strçinternæ¹æ³ï¼è¿æ¶ä¸²æ± ä¸­æ²¡æ"ab"ï¼åä¼å°è¯¥å­ç¬¦ä¸²å¯¹è±¡æ¾å¥å°ä¸²æ± ä¸­ï¼æ­¤æ¶å åå­ä¸ä¸²æ± ä¸­ç"ab"æ¯åä¸ä¸ªå¯¹è±¡\n\t\tString st2 = str.intern();\n\t\t//ç»str3èµå¼ï¼å ä¸ºæ­¤æ¶ä¸²æ± ä¸­å·²æ"ab"ï¼åç´æ¥å°ä¸²æ± ä¸­çåå®¹è¿å\n\t\tString str3 = "ab";\n\t\t//å ä¸ºå åå­ä¸ä¸²æ± ä¸­ç"ab"æ¯åä¸ä¸ªå¯¹è±¡ï¼æä»¥ä»¥ä¸ä¸¤æ¡è¯­å¥æå°çé½ä¸ºtrue\n\t\tSystem.out.println(str == st2);\n\t\tSystem.out.println(str == str3);\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¾2\n\npublic class Main {\n\tpublic static void main(String[] args) {\n        //æ­¤å¤åå»ºå­ç¬¦ä¸²å¯¹è±¡"ab"ï¼å ä¸ºä¸²æ± ä¸­è¿æ²¡æ"ab"ï¼æä»¥å°å¶æ¾å¥ä¸²æ± ä¸­\n\t\tString str3 = "ab";\n        //"a" "b" è¢«æ¾å¥ä¸²æ± ä¸­ï¼stråå­å¨äºå åå­ä¹ä¸­\n\t\tString str = new String("a") + new String("b");\n        //æ­¤æ¶å ä¸ºå¨åå»ºstr3æ¶ï¼"ab"å·²å­å¨ä¸ä¸²æ± ä¸­ï¼æä»¥æ¾å¥å¤±è´¥ï¼ä½æ¯ä¼è¿åä¸²æ± ä¸­ç"ab"\n\t\tString str2 = str.intern();\n        //false\n\t\tSystem.out.println(str == str2);\n        //false\n\t\tSystem.out.println(str == str3);\n        //true\n\t\tSystem.out.println(str2 == str3);\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n# internæ¹æ³ 1.6\n\nè°ç¨å­ç¬¦ä¸²å¯¹è±¡çinternæ¹æ³ï¼ä¼å°è¯¥å­ç¬¦ä¸²å¯¹è±¡å°è¯æ¾å¥å°ä¸²æ± ä¸­\n\n * å¦æä¸²æ± ä¸­æ²¡æè¯¥å­ç¬¦ä¸²å¯¹è±¡ï¼ä¼å°è¯¥å­ç¬¦ä¸²å¯¹è±¡å¤å¶ä¸ä»½ï¼åæ¾å¥å°ä¸²æ± ä¸­\n * å¦ææè¯¥å­ç¬¦ä¸²å¯¹è±¡ï¼åæ¾å¥å¤±è´¥\n\næ è®ºæ¾å¥æ¯å¦æåï¼é½ä¼è¿åä¸²æ± ä¸­çå­ç¬¦ä¸²å¯¹è±¡\n\næ³¨æï¼æ­¤æ¶æ è®ºè°ç¨internæ¹æ³æåä¸å¦ï¼ä¸²æ± ä¸­çå­ç¬¦ä¸²å¯¹è±¡åå åå­ä¸­çå­ç¬¦ä¸²å¯¹è±¡é½ä¸æ¯åä¸ä¸ªå¯¹è±¡\n\n# StringTable åå¾åæ¶\n\nStringTableå¨åå­ç´§å¼ æ¶ï¼ä¼åçåå¾åæ¶\n\n# StringTableè°ä¼\n\n * å ä¸ºStringTableæ¯ç±HashTableå®ç°çï¼æä»¥å¯ä»¥éå½å¢å HashTableæ¡¶çä¸ªæ°ï¼æ¥åå°å­ç¬¦ä¸²æ¾å¥ä¸²æ± æéè¦çæ¶é´\n   \n   -XX:StringTableSize=xxxx\n   \n   \n   1\n   \n\n * èèæ¯å¦éè¦å°å­ç¬¦ä¸²å¯¹è±¡å¥æ± \n   \n   å¯ä»¥éè¿internæ¹æ³åå°éå¤å¥æ± \n\n\n# 6ãç´æ¥åå­\n\n * å±äºæä½ç³»ç»ï¼å¸¸è§äºNIOæä½æ¶ï¼ç¨äºæ°æ®ç¼å²åº\n * åéåæ¶ææ¬è¾é«ï¼ä½è¯»åæ§è½é«\n * ä¸åJVMåå­åæ¶ç®¡ç\n\n# æä»¶è¯»åæµç¨\n\n\n\nä½¿ç¨äºDirectBuffer\n\n\n\nç´æ¥åå­æ¯æä½ç³»ç»åJavaä»£ç é½å¯ä»¥è®¿é®çä¸ååºåï¼æ éå°ä»£ç ä»ç³»ç»åå­å¤å¶å°Javaå åå­ï¼ä»èæé«äºæç\n\n# éæ¾åç\n\nç´æ¥åå­çåæ¶ä¸æ¯éè¿JVMçåå¾åæ¶æ¥éæ¾çï¼èæ¯éè¿unsafe.freeMemoryæ¥æå¨éæ¾\n\néè¿\n\n//éè¿ByteBufferç³è¯·1Mçç´æ¥åå­\nByteBuffer byteBuffer = ByteBuffer.allocateDirect(_1M);\n\n\n1\n2\n\n\nç³è¯·ç´æ¥åå­ï¼ä½JVMå¹¶ä¸è½åæ¶ç´æ¥åå­ä¸­çåå®¹ï¼å®æ¯å¦ä½å®ç°åæ¶çå¢ï¼\n\nallocateDirectçå®ç°\n\npublic static ByteBuffer allocateDirect(int capacity) {\n    return new DirectByteBuffer(capacity);\n}\n\n\n1\n2\n3\n\n\nDirectByteBufferç±»\n\nDirectByteBuffer(int cap) {   // package-private\n   \n    super(-1, 0, cap, cap);\n    boolean pa = VM.isDirectMemoryPageAligned();\n    int ps = Bits.pageSize();\n    long size = Math.max(1L, (long)cap + (pa ? ps : 0));\n    Bits.reserveMemory(size, cap);\n\n    long base = 0;\n    try {\n        base = unsafe.allocateMemory(size); //ç³è¯·åå­\n    } catch (OutOfMemoryError x) {\n        Bits.unreserveMemory(size, cap);\n        throw x;\n    }\n    unsafe.setMemory(base, size, (byte) 0);\n    if (pa && (base % ps != 0)) {\n        // Round up to page boundary\n        address = base + ps - (base & (ps - 1));\n    } else {\n        address = base;\n    }\n    cleaner = Cleaner.create(this, new Deallocator(base, size, cap)); //éè¿èå¼ç¨ï¼æ¥å®ç°ç´æ¥åå­çéæ¾ï¼thisä¸ºèå¼ç¨çå®éå¯¹è±¡\n    att = null;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nè¿éè°ç¨äºä¸ä¸ªCleanerçcreateæ¹æ³ï¼ä¸åå°çº¿ç¨è¿ä¼å¯¹èå¼ç¨çå¯¹è±¡çæµï¼å¦æèå¼ç¨çå®éå¯¹è±¡ï¼è¿éæ¯DirectByteBufferï¼è¢«åæ¶ä»¥åï¼å°±ä¼è°ç¨Cleanerçcleanæ¹æ³ï¼æ¥æ¸é¤ç´æ¥åå­ä¸­å ç¨çåå­\n\npublic void clean() {\n       if (remove(this)) {\n           try {\n               this.thunk.run(); //è°ç¨runæ¹æ³\n           } catch (final Throwable var2) {\n               AccessController.doPrivileged(new PrivilegedAction<Void>() {\n                   public Void run() {\n                       if (System.err != null) {\n                           (new Error("Cleaner terminated abnormally", var2)).printStackTrace();\n                       }\n\n                       System.exit(1);\n                       return null;\n                   }\n               });\n           }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¯¹åºå¯¹è±¡çrunæ¹æ³\n\npublic void run() {\n    if (address == 0) {\n        // Paranoia\n        return;\n    }\n    unsafe.freeMemory(address); //éæ¾ç´æ¥åå­ä¸­å ç¨çåå­\n    address = 0;\n    Bits.unreserveMemory(size, capacity);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# ç´æ¥åå­çåæ¶æºå¶æ»ç»\n\n * ä½¿ç¨äºUnsafeç±»æ¥å®æç´æ¥åå­çåéåæ¶ï¼åæ¶éè¦ä¸»å¨è°ç¨freeMemoryæ¹æ³\n * ByteBufferçå®ç°åé¨ä½¿ç¨äºCleanerï¼èå¼ç¨ï¼æ¥æ£æµByteBufferãä¸æ¦ByteBufferè¢«åå¾åæ¶ï¼é£ä¹ä¼ç±ReferenceHandleræ¥è°ç¨Cleanerçcleanæ¹æ³è°ç¨freeMemoryæ¥éæ¾åå­\n\n\n# ä¸ãåå¾åæ¶\n\n\n# 1ãå¦ä½å¤æ­å¯¹è±¡å¯ä»¥åæ¶\n\n# å¼ç¨è®¡æ°æ³\n\nå¼ç«¯ï¼å¾ªç¯å¼ç¨æ¶ï¼ä¸¤ä¸ªå¯¹è±¡çè®¡æ°é½ä¸º1ï¼å¯¼è´ä¸¤ä¸ªå¯¹è±¡é½æ æ³è¢«éæ¾\n\n\n\n# å¯è¾¾æ§åæç®æ³\n\n * JVMä¸­çåå¾åæ¶å¨éè¿å¯è¾¾æ§åææ¥æ¢ç´¢ææå­æ´»çå¯¹è±¡\n * æ«æå ä¸­çå¯¹è±¡ï¼çè½å¦æ²¿çGC Rootå¯¹è±¡ä¸ºèµ·ç¹çå¼ç¨é¾æ¾å°è¯¥å¯¹è±¡ï¼å¦ææ¾ä¸å°ï¼åè¡¨ç¤ºå¯ä»¥åæ¶\n * å¯ä»¥ä½ä¸ºGC Rootçå¯¹è±¡\n   * èææºæ ï¼æ å¸§ä¸­çæ¬å°åéè¡¨ï¼ä¸­å¼ç¨çå¯¹è±¡ã\n   * æ¹æ³åºä¸­ç±»éæå±æ§å¼ç¨çå¯¹è±¡\n   * æ¹æ³åºä¸­å¸¸éå¼ç¨çå¯¹è±¡\n   * æ¬å°æ¹æ³æ ä¸­JNIï¼å³ä¸è¬è¯´çNativeæ¹æ³ï¼å¼ç¨çå¯¹è±¡\n\n# äºç§å¼ç¨\n\n\n\n# å¼ºå¼ç¨\n\nåªæGC Rooté½ä¸å¼ç¨è¯¥å¯¹è±¡æ¶ï¼æä¼åæ¶å¼ºå¼ç¨å¯¹è±¡\n\n * å¦ä¸å¾BãCå¯¹è±¡é½ä¸å¼ç¨A1å¯¹è±¡æ¶ï¼A1å¯¹è±¡æä¼è¢«åæ¶\n\n# è½¯å¼ç¨\n\nå½GC Rootæåè½¯å¼ç¨å¯¹è±¡æ¶ï¼å¨åå­ä¸è¶³æ¶ï¼ä¼åæ¶è½¯å¼ç¨æå¼ç¨çå¯¹è±¡\n\n * å¦ä¸å¾å¦æBå¯¹è±¡ä¸åå¼ç¨A2å¯¹è±¡ä¸åå­ä¸è¶³æ¶ï¼è½¯å¼ç¨æå¼ç¨çA2å¯¹è±¡å°±ä¼è¢«åæ¶\n\n# è½¯å¼ç¨çä½¿ç¨\n\npublic class Demo1 {\n\tpublic static void main(String[] args) {\n\t\tfinal int _4M = 4*1024*1024;\n\t\t//ä½¿ç¨è½¯å¼ç¨å¯¹è±¡ liståSoftReferenceæ¯å¼ºå¼ç¨ï¼èSoftReferenceåbyteæ°ç»åæ¯è½¯å¼ç¨\n\t\tList<SoftReference<byte[]>> list = new ArrayList<>();\n\t\tSoftReference<byte[]> ref= new SoftReference<>(new byte[_4M]);\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¦æå¨åå¾åæ¶æ¶åç°åå­ä¸è¶³ï¼å¨åæ¶è½¯å¼ç¨ææåçå¯¹è±¡æ¶ï¼è½¯å¼ç¨æ¬èº«ä¸ä¼è¢«æ¸ç\n\nå¦ææ³è¦æ¸çè½¯å¼ç¨ï¼éè¦ä½¿ç¨å¼ç¨éå\n\npublic class Demo1 {\n\tpublic static void main(String[] args) {\n\t\tfinal int _4M = 4*1024*1024;\n\t\t//ä½¿ç¨å¼ç¨éåï¼ç¨äºç§»é¤å¼ç¨ä¸ºç©ºçè½¯å¼ç¨å¯¹è±¡\n\t\tReferenceQueue<byte[]> queue = new ReferenceQueue<>();\n\t\t//ä½¿ç¨è½¯å¼ç¨å¯¹è±¡ liståSoftReferenceæ¯å¼ºå¼ç¨ï¼èSoftReferenceåbyteæ°ç»åæ¯è½¯å¼ç¨\n\t\tList<SoftReference<byte[]>> list = new ArrayList<>();\n\t\tSoftReference<byte[]> ref= new SoftReference<>(new byte[_4M]);\n\n\t\t//éåå¼ç¨éåï¼å¦ææåç´ ï¼åç§»é¤\n\t\tReference<? extends byte[]> poll = queue.poll();\n\t\twhile(poll != null) {\n\t\t\t//å¼ç¨éåä¸ä¸ºç©ºï¼åä»éåä¸­ç§»é¤è¯¥åç´ \n\t\t\tlist.remove(poll);\n\t\t\t//ç§»å¨å°å¼ç¨éåä¸­çä¸ä¸ä¸ªåç´ \n\t\t\tpoll = queue.poll();\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n**å¤§æ¦æè·¯ä¸ºï¼**æ¥çå¼ç¨éåä¸­ææ è½¯å¼ç¨ï¼å¦ææï¼åå°è¯¥è½¯å¼ç¨ä»å­æ¾å®çéåä¸­ç§»é¤ï¼è¿éä¸ºä¸ä¸ªlistéåï¼\n\n# å¼±å¼ç¨\n\nåªæå¼±å¼ç¨å¼ç¨è¯¥å¯¹è±¡æ¶ï¼å¨åå¾åæ¶æ¶ï¼æ è®ºåå­æ¯å¦åè¶³ï¼é½ä¼åæ¶å¼±å¼ç¨æå¼ç¨çå¯¹è±¡\n\n * å¦ä¸å¾å¦æBå¯¹è±¡ä¸åå¼ç¨A3å¯¹è±¡ï¼åA3å¯¹è±¡ä¼è¢«åæ¶\n\nå¼±å¼ç¨çä½¿ç¨åè½¯å¼ç¨ç±»ä¼¼ï¼åªæ¯å° SoftReference æ¢ä¸ºäº WeakReference\n\n# èå¼ç¨\n\nå½èå¼ç¨å¯¹è±¡æå¼ç¨çå¯¹è±¡è¢«åæ¶ä»¥åï¼èå¼ç¨å¯¹è±¡å°±ä¼è¢«æ¾å¥å¼ç¨éåä¸­ï¼è°ç¨èå¼ç¨çæ¹æ³\n\n * èå¼ç¨çä¸ä¸ªä½ç°æ¯éæ¾ç´æ¥åå­æåéçåå­ï¼å½å¼ç¨çå¯¹è±¡ByteBufferè¢«åå¾åæ¶ä»¥åï¼èå¼ç¨å¯¹è±¡Cleanerå°±ä¼è¢«æ¾å¥å¼ç¨éåä¸­ï¼ç¶åè°ç¨Cleanerçcleanæ¹æ³æ¥éæ¾ç´æ¥åå­\n * å¦ä¸å¾ï¼Bå¯¹è±¡ä¸åå¼ç¨ByteBufferå¯¹è±¡ï¼ByteBufferå°±ä¼è¢«åæ¶ãä½æ¯ç´æ¥åå­ä¸­çåå­è¿æªè¢«åæ¶ãè¿æ¶éè¦å°èå¼ç¨å¯¹è±¡Cleaneræ¾å¥å¼ç¨éåä¸­ï¼ç¶åè°ç¨å®çcleanæ¹æ³æ¥éæ¾ç´æ¥åå­\n\n# ç»ç»å¨å¼ç¨\n\nææçç±»é½ç»§æ¿èªObjectç±»ï¼Objectç±»æä¸ä¸ªfinalizeæ¹æ³ãå½æä¸ªå¯¹è±¡ä¸åè¢«å¶ä»çå¯¹è±¡æå¼ç¨æ¶ï¼ä¼åå°ç»ç»å¨å¼ç¨å¯¹è±¡æ¾å¥å¼ç¨éåä¸­ï¼ç¶åæ ¹æ®ç»ç»å¨å¼ç¨å¯¹è±¡æ¾å°å®æå¼ç¨çå¯¹è±¡ï¼ç¶åè°ç¨è¯¥å¯¹è±¡çfinalizeæ¹æ³ãè°ç¨ä»¥åï¼è¯¥å¯¹è±¡å°±å¯ä»¥è¢«åå¾åæ¶äº\n\n * å¦ä¸å¾ï¼Bå¯¹è±¡ä¸åå¼ç¨A4å¯¹è±¡ãè¿æ¯ç»ç»å¨å¯¹è±¡å°±ä¼è¢«æ¾å¥å¼ç¨éåä¸­ï¼å¼ç¨éåä¼æ ¹æ®å®ï¼æ¾å°å®æå¼ç¨çå¯¹è±¡ãç¶åè°ç¨è¢«å¼ç¨å¯¹è±¡çfinalizeæ¹æ³ãè°ç¨ä»¥åï¼è¯¥å¯¹è±¡å°±å¯ä»¥è¢«åå¾åæ¶äº\n\n# å¼ç¨éå\n\n * è½¯å¼ç¨åå¼±å¼ç¨å¯ä»¥éåå¼ç¨éå\n   * å¨å¼±å¼ç¨åèå¼ç¨æå¼ç¨çå¯¹è±¡è¢«åæ¶ä»¥åï¼ä¼å°è¿äºå¼ç¨æ¾å¥å¼ç¨éåä¸­ï¼æ¹ä¾¿ä¸èµ·åæ¶è¿äºè½¯/å¼±å¼ç¨å¯¹è±¡\n * èå¼ç¨åç»ç»å¨å¼ç¨å¿é¡»éåå¼ç¨éå\n   * èå¼ç¨åç»ç»å¨å¼ç¨å¨ä½¿ç¨æ¶ä¼å³èä¸ä¸ªå¼ç¨éå\n\n\n# 2ãåå¾åæ¶ç®æ³\n\n# æ è®°-æ¸é¤\n\n\n\nå®ä¹ï¼æ è®°æ¸é¤ç®æ³é¡¾åæä¹ï¼æ¯æå¨èææºæ§è¡åå¾åæ¶çè¿ç¨ä¸­ï¼åéç¨æ è®°ç®æ³ç¡®å®å¯åæ¶å¯¹è±¡ï¼ç¶ååå¾æ¶éå¨æ ¹æ®æ è¯æ¸é¤ç¸åºçåå®¹ï¼ç»å åå­è¾åºç¸åºçç©ºé´\n\n * è¿éçè¾åºåå­ç©ºé´å¹¶ä¸æ¯å°åå­ç©ºé´çå­èæ¸0ï¼èæ¯è®°å½ä¸è¿æ®µåå­çèµ·å§ç»æå°åï¼ä¸æ¬¡åéåå­çæ¶åï¼ä¼ç´æ¥è¦çè¿æ®µåå­\n\nç¼ºç¹ï¼å®¹æäº§çå¤§éçåå­ç¢çï¼å¯è½æ æ³æ»¡è¶³å¤§å¯¹è±¡çåå­åéï¼ä¸æ¦å¯¼è´æ æ³åéå¯¹è±¡ï¼é£å°±ä¼å¯¼è´jvmå¯å¨gcï¼ä¸æ¦å¯å¨gcï¼æä»¬çåºç¨ç¨åºå°±ä¼æåï¼è¿å°±å¯¼è´åºç¨çååºéåº¦åæ¢\n\n# æ è®°-æ´ç\n\n\n\næ è®°-æ´ç ä¼å°ä¸è¢«GC Rootå¼ç¨çå¯¹è±¡åæ¶ï¼æ¸æ¥å¶å ç¨çåå­ç©ºé´ãç¶åæ´çå©ä½çå¯¹è±¡ï¼å¯ä»¥ææé¿åå åå­ç¢çèå¯¼è´çé®é¢ï¼ä½æ¯å ä¸ºæ´ä½éè¦æ¶èä¸å®çæ¶é´ï¼æä»¥æçè¾ä½\n\n# å¤å¶\n\n\n\n\n\n\n\n\n\nå°åå­åä¸ºç­å¤§å°çä¸¤ä¸ªåºåï¼FROMåTOï¼TOä¸­ä¸ºç©ºï¼ãåå°è¢«GC Rootå¼ç¨çå¯¹è±¡ä»FROMæ¾å¥TOä¸­ï¼ååæ¶ä¸è¢«GC Rootå¼ç¨çå¯¹è±¡ãç¶åäº¤æ¢FROMåTOãè¿æ ·ä¹å¯ä»¥é¿ååå­ç¢ççé®é¢ï¼ä½æ¯ä¼å ç¨ååçåå­ç©ºé´ã\n\n\n# 3ãåä»£åæ¶\n\n\n\n# åæ¶æµç¨\n\næ°åå»ºçå¯¹è±¡é½è¢«æ¾å¨äºæ°çä»£çä¼ç¸å­ä¸­\n\n\n\nå½ä¼ç¸å­ä¸­çåå­ä¸è¶³æ¶ï¼å°±ä¼è¿è¡ä¸æ¬¡åå¾åæ¶ï¼è¿æ¶çåæ¶å«å Minor GC\n\nMinor GC ä¼å°ä¼ç¸å­åå¹¸å­åºFROMå­æ´»çå¯¹è±¡åå¤å¶å° å¹¸å­åº TOä¸­ï¼ å¹¶è®©å¶å¯¿å½å 1ï¼åäº¤æ¢ä¸¤ä¸ªå¹¸å­åº\n\n\n\n\n\n\n\nåæ¬¡åå»ºå¯¹è±¡ï¼è¥æ°çä»£çä¼ç¸å­åæ»¡äºï¼åä¼åæ¬¡è§¦å Minor GCï¼ä¼è§¦å stop the worldï¼ æåå¶ä»ç¨æ·çº¿ç¨ï¼åªè®©åå¾åæ¶çº¿ç¨å·¥ä½ï¼ï¼è¿æ¶ä¸ä»ä¼åæ¶ä¼ç¸å­ä¸­çåå¾ï¼è¿ä¼åæ¶å¹¸å­åºä¸­çåå¾ï¼åå°æ´»è·å¯¹è±¡å¤å¶å°å¹¸å­åºTOä¸­ãåæ¶ä»¥åä¼äº¤æ¢ä¸¤ä¸ªå¹¸å­åºï¼å¹¶è®©å¹¸å­åºä¸­çå¯¹è±¡å¯¿å½å 1\n\n\n\nå¦æå¹¸å­åºä¸­çå¯¹è±¡çå¯¿å½è¶è¿æä¸ªéå¼ï¼æå¤§ä¸º15ï¼4bitï¼ï¼å°±ä¼è¢«æ¾å¥èå¹´ä»£ä¸­\n\n\n\nå¦ææ°çä»£èå¹´ä»£ä¸­çåå­é½æ»¡äºï¼å°±ä¼åè§¦åMinor GCï¼åè§¦åFull GCï¼æ«ææ°çä»£åèå¹´ä»£ä¸­ææä¸åä½¿ç¨çå¯¹è±¡å¹¶åæ¶\n\n# GC åæ\n\n# å¤§å¯¹è±¡å¤çç­ç¥\n\nå½éå°ä¸ä¸ªè¾å¤§çå¯¹è±¡æ¶ï¼å°±ç®æ°çä»£çä¼ç¸å­ä¸ºç©ºï¼ä¹æ æ³å®¹çº³è¯¥å¯¹è±¡æ¶ï¼ä¼å°è¯¥å¯¹è±¡ç´æ¥æåä¸ºèå¹´ä»£\n\n# çº¿ç¨åå­æº¢åº\n\næä¸ªçº¿ç¨çåå­æº¢åºäºèæå¼å¸¸ï¼out of memoryï¼ï¼ä¸ä¼è®©å¶ä»ççº¿ç¨ç»æè¿è¡\n\nè¿æ¯å ä¸ºå½ä¸ä¸ªçº¿ç¨æåºOOMå¼å¸¸åï¼å®æå æ®çåå­èµæºä¼å¨é¨è¢«éæ¾æï¼ä»èä¸ä¼å½±åå¶ä»çº¿ç¨çè¿è¡ï¼è¿ç¨ä¾ç¶æ­£å¸¸\n\n\n# 4ãåå¾åæ¶å¨\n\n# ç¸å³æ¦å¿µ\n\nå¹¶è¡æ¶éï¼æå¤æ¡åå¾æ¶éçº¿ç¨å¹¶è¡å·¥ä½ï¼ä½æ­¤æ¶ç¨æ·çº¿ç¨ä»å¤äºç­å¾ç¶æã\n\nå¹¶åæ¶éï¼æç¨æ·çº¿ç¨ä¸åå¾æ¶éçº¿ç¨åæ¶å·¥ä½ï¼ä¸ä¸å®æ¯å¹¶è¡çå¯è½ä¼äº¤æ¿æ§è¡ï¼ãç¨æ·ç¨åºå¨ç»§ç»­è¿è¡ï¼èåå¾æ¶éç¨åºè¿è¡å¨å¦ä¸ä¸ªCPUä¸\n\nååéï¼å³CPUç¨äºè¿è¡ç¨æ·ä»£ç çæ¶é´ä¸CPUæ»æ¶èæ¶é´çæ¯å¼ï¼ååé = è¿è¡ç¨æ·ä»£ç æ¶é´ / ( è¿è¡ç¨æ·ä»£ç æ¶é´ + åå¾æ¶éæ¶é´ )ï¼ï¼ä¹å°±æ¯ãä¾å¦ï¼èææºå±è¿è¡100åéï¼åå¾æ¶éå¨è±æ1åéï¼é£ä¹ååéå°±æ¯99%\n\n# ä¸²è¡\n\n * åçº¿ç¨\n * åå­è¾å°ï¼ä¸ªäººçµèï¼CPUæ ¸æ°è¾å°ï¼\n\n\n\nå®å¨ç¹ï¼è®©å¶ä»çº¿ç¨é½å¨è¿ä¸ªç¹åä¸æ¥ï¼ä»¥ååå¾åæ¶æ¶ç§»å¨å¯¹è±¡å°åï¼ä½¿å¾å¶ä»çº¿ç¨æ¾ä¸å°è¢«ç§»å¨çå¯¹è±¡\n\nå ä¸ºæ¯ä¸²è¡çï¼æä»¥åªæä¸ä¸ªåå¾åæ¶çº¿ç¨ãä¸å¨è¯¥çº¿ç¨æ§è¡åæ¶å·¥ä½æ¶ï¼å¶ä»çº¿ç¨è¿å¥é»å¡ç¶æ\n\n# Serial æ¶éå¨\n\nSerialæ¶éå¨æ¯æåºæ¬çãåå±åå²ææ ä¹çæ¶éå¨\n\nç¹ç¹ï¼åçº¿ç¨ãç®åé«æï¼ä¸å¶ä»æ¶éå¨çåçº¿ç¨ç¸æ¯ï¼ï¼éç¨å¤å¶ç®æ³ãå¯¹äºéå®åä¸ªCPUçç¯å¢æ¥è¯´ï¼Serialæ¶éå¨ç±äºæ²¡æçº¿ç¨äº¤äºçå¼éï¼ä¸å¿ååå¾æ¶éèªç¶å¯ä»¥è·å¾æé«çåçº¿ç¨ææºæçãæ¶éå¨è¿è¡åå¾åæ¶æ¶ï¼å¿é¡»æåå¶ä»ææçå·¥ä½çº¿ç¨ï¼ç´å°å®ç»æï¼Stop The Worldï¼\n\n# ParNew æ¶éå¨\n\nParNewæ¶éå¨å¶å®å°±æ¯Serialæ¶éå¨çå¤çº¿ç¨çæ¬\n\nç¹ç¹ï¼å¤çº¿ç¨ãParNewæ¶éå¨é»è®¤å¼å¯çæ¶éçº¿ç¨æ°ä¸CPUçæ°éç¸åï¼å¨CPUéå¸¸å¤çç¯å¢ä¸­ï¼å¯ä»¥ä½¿ç¨-XX:ParallelGCThreadsåæ°æ¥éå¶åå¾æ¶éççº¿ç¨æ°ãåSerialæ¶éå¨ä¸æ ·å­å¨Stop The Worldé®é¢\n\n# Serial Old æ¶éå¨\n\nSerial Oldæ¯Serialæ¶éå¨çèå¹´ä»£çæ¬\n\nç¹ç¹ï¼åæ ·æ¯åçº¿ç¨æ¶éå¨ï¼éç¨æ è®°-æ´çç®æ³\n\n# ååéä¼å\n\n * å¤çº¿ç¨\n * å åå­è¾å¤§ï¼å¤æ ¸CPU\n * åä½æ¶é´åï¼STWï¼stop the worldï¼åæå¶ä»ææå·¥ä½çº¿ç¨ï¼æ¶é´æç­\n * JDK1.8é»è®¤ä½¿ç¨çåå¾åæ¶å¨\n\n\n\n# Parallel Scavenge æ¶éå¨\n\nä¸ååéå³ç³»å¯åï¼æä¹ç§°ä¸ºååéä¼åæ¶éå¨\n\nç¹ç¹ï¼å±äºæ°çä»£æ¶éå¨ä¹æ¯éç¨å¤å¶ç®æ³çæ¶éå¨ï¼ç¨å°äºæ°çä»£çå¹¸å­åºï¼ï¼åæ¯å¹¶è¡çå¤çº¿ç¨æ¶éå¨ï¼ä¸ParNewæ¶éå¨ç±»ä¼¼ï¼\n\nè¯¥æ¶éå¨çç®æ æ¯è¾¾å°ä¸ä¸ªå¯æ§å¶çååéãè¿æä¸ä¸ªå¼å¾å³æ³¨çç¹æ¯ï¼GCèªéåºè°èç­ç¥ï¼ä¸ParNewæ¶éå¨æéè¦çä¸ä¸ªåºå«ï¼\n\nGCèªéåºè°èç­ç¥ï¼Parallel Scavengeæ¶éå¨å¯è®¾ç½®-XX:+UseAdptiveSizePolicyåæ°ãå½å¼å³æå¼æ¶ä¸éè¦æå¨æå®æ°çä»£çå¤§å°ï¼-Xmnï¼ãEdenä¸Survivoråºçæ¯ä¾ï¼-XX:SurvivorRationï¼ãæåèå¹´ä»£çå¯¹è±¡å¹´é¾ï¼-XX:PretenureSizeThresholdï¼ç­ï¼èææºä¼æ ¹æ®ç³»ç»çè¿è¡ç¶åµæ¶éæ§è½çæ§ä¿¡æ¯ï¼å¨æè®¾ç½®è¿äºåæ°ä»¥æä¾æä¼çåé¡¿æ¶é´åæé«çååéï¼è¿ç§è°èæ¹å¼ç§°ä¸ºGCçèªéåºè°èç­ç¥ã\n\nParallel Scavengeæ¶éå¨ä½¿ç¨ä¸¤ä¸ªåæ°æ§å¶ååéï¼\n\n * XX:MaxGCPauseMillis æ§å¶æå¤§çåå¾æ¶éåé¡¿æ¶é´\n * XX:GCRatio ç´æ¥è®¾ç½®ååéçå¤§å°\n\n# Parallel Old æ¶éå¨\n\næ¯Parallel Scavengeæ¶éå¨çèå¹´ä»£çæ¬\n\nç¹ç¹ï¼å¤çº¿ç¨ï¼éç¨æ è®°-æ´çç®æ³ï¼èå¹´ä»£æ²¡æå¹¸å­åºï¼\n\n# ååºæ¶é´ä¼å\n\n * å¤çº¿ç¨\n * å åå­è¾å¤§ï¼å¤æ ¸CPU\n * å°½å¯è½è®©åæ¬¡STWæ¶é´åç­ï¼å°½éä¸å½±åå¶ä»çº¿ç¨è¿è¡ï¼\n\n\n\n# CMS æ¶éå¨\n\nConcurrent Mark Sweepï¼ä¸ç§ä»¥è·åæç­åæ¶åé¡¿æ¶é´ä¸ºç®æ çèå¹´ä»£æ¶éå¨\n\nç¹ç¹ï¼åºäºæ è®°-æ¸é¤ç®æ³å®ç°ãå¹¶åæ¶éãä½åé¡¿ï¼ä½æ¯ä¼äº§çåå­ç¢ç\n\nåºç¨åºæ¯ï¼éç¨äºæ³¨éæå¡çååºéåº¦ï¼å¸æç³»ç»åé¡¿æ¶é´æç­ï¼ç»ç¨æ·å¸¦æ¥æ´å¥½çä½éªç­åºæ¯ä¸ãå¦webç¨åºãb/sæå¡\n\nCMSæ¶éå¨çè¿è¡è¿ç¨åä¸ºä¸å4æ­¥ï¼\n\nåå§æ è®°ï¼æ è®°GC Rootsè½ç´æ¥å°çå¯¹è±¡ãéåº¦å¾å¿«ä½æ¯ä»å­å¨Stop The Worldé®é¢\n\nå¹¶åæ è®°ï¼è¿è¡GC Roots Tracing çè¿ç¨ï¼æ¾åºå­æ´»å¯¹è±¡ä¸ç¨æ·çº¿ç¨å¯å¹¶åæ§è¡\n\néæ°æ è®°ï¼ä¸ºäºä¿®æ­£å¹¶åæ è®°æé´å ç¨æ·ç¨åºç»§ç»­è¿è¡èå¯¼è´æ è®°äº§çåå¨çé£ä¸é¨åå¯¹è±¡çæ è®°è®°å½ãä»ç¶å­å¨Stop The Worldé®é¢\n\nå¹¶åæ¸é¤ï¼å¯¹æ è®°çå¯¹è±¡è¿è¡æ¸é¤åæ¶\n\nCMSæ¶éå¨çåå­åæ¶è¿ç¨æ¯ä¸ç¨æ·çº¿ç¨ä¸èµ·å¹¶åæ§è¡ç\n\n# G1\n\n# å®ä¹ï¼\n\nGarbage First\n\nJDK 9ä»¥åé»è®¤ä½¿ç¨ï¼èä¸æ¿ä»£äºCMS æ¶éå¨\n\n\n\n# éç¨åºæ¯\n\n * åæ¶æ³¨éååéåä½å»¶è¿ï¼ååºæ¶é´ï¼\n * è¶å¤§å åå­ï¼åå­å¤§çï¼ï¼ä¼å°å åå­ååä¸ºå¤ä¸ªå¤§å°ç¸ç­çåºå\n * æ´ä½ä¸æ¯æ è®°-æ´çç®æ³ï¼ä¸¤ä¸ªåºåä¹é´æ¯å¤å¶ç®æ³\n\nç¸å³åæ°ï¼JDK8 å¹¶ä¸æ¯é»è®¤å¼å¯çï¼æéè¦åæ°å¼å¯\n\n\n\n# G1åå¾åæ¶é¶æ®µ\n\n\n\næ°çä»£ä¼ç¸å­åå¾åæ¶ââ>åå­ä¸è¶³ï¼æ°çä»£åæ¶+å¹¶åæ è®°ââ>åæ¶æ°çä»£ä¼ç¸å­ãå¹¸å­åºãèå¹´ä»£åå­ââ>æ°çä»£ä¼ç¸å­åå¾åæ¶(éæ°å¼å§)\n\n# Young Collection\n\nååºç®æ³region\n\nåä»£æ¯æå¯¹è±¡ççå½å¨æååï¼ååºåæ¯å°å ç©ºé´ååè¿ç»­å ä¸ªä¸åå°åºé´ï¼æ¯ä¸ä¸ªå°åºé´ç¬ç«åæ¶ï¼å¯ä»¥æ§å¶ä¸æ¬¡åæ¶å¤å°ä¸ªå°åºé´ï¼æ¹ä¾¿æ§å¶ GC äº§ççåé¡¿æ¶é´\n\nEï¼ä¼ç¸å­ Sï¼å¹¸å­åº Oï¼èå¹´ä»£\n\n * ä¼STW\n\n\n\n\n\n\n\n# Young Collection + CM\n\nCMï¼å¹¶åæ è®°\n\n * å¨ Young GC æ¶ä¼å¯¹ GC Root è¿è¡åå§æ è®°\n * å¨èå¹´ä»£å ç¨å åå­çæ¯ä¾è¾¾å°éå¼æ¶ï¼å¯¹è¿è¡å¹¶åæ è®°ï¼ä¸ä¼STWï¼ï¼éå¼å¯ä»¥æ ¹æ®ç¨æ·æ¥è¿è¡è®¾å®\n\n\n\n# Mixed Collection\n\nä¼å¯¹E S O è¿è¡å¨é¢çåæ¶\n\n * æç»æ è®°\n * æ·è´å­æ´»\n\n-XX:MaxGCPauseMills:xxx ç¨äºæå®æé¿çåé¡¿æ¶é´\n\né®ï¼ä¸ºä»ä¹æçèå¹´ä»£è¢«æ·è´äºï¼æçæ²¡æ·è´ï¼\n\nå ä¸ºæå®äºæå¤§åé¡¿æ¶é´ï¼å¦æå¯¹ææèå¹´ä»£é½è¿è¡åæ¶ï¼èæ¶å¯è½è¿é«ãä¸ºäºä¿è¯æ¶é´ä¸è¶è¿è®¾å®çåé¡¿æ¶é´ï¼ä¼åæ¶ææä»·å¼çèå¹´ä»£ï¼åæ¶åï¼è½å¤å¾å°æ´å¤åå­ï¼\n\n\n\n# Full GC\n\nG1å¨èå¹´ä»£åå­ä¸è¶³æ¶ï¼èå¹´ä»£æå åå­è¶è¿éå¼ï¼\n\n * å¦æåå¾äº§çéåº¦æ¢äºåå¾åæ¶éåº¦ï¼ä¸ä¼è§¦åFull GCï¼è¿æ¯å¹¶åå°è¿è¡æ¸ç\n * å¦æåå¾äº§çéåº¦å¿«äºåå¾åæ¶éåº¦ï¼ä¾¿ä¼è§¦åFull GC\n\n# Young Collection è·¨ä»£å¼ç¨\n\n * æ°çä»£åæ¶çè·¨ä»£å¼ç¨ï¼èå¹´ä»£å¼ç¨æ°çä»£ï¼é®é¢\n\n\n\n * å¡è¡¨ä¸Remembered Set\n   * Remembered Set å­å¨äºEä¸­ï¼ç¨äºä¿å­æ°çä»£å¯¹è±¡å¯¹åºçèå¡\n     * èå¡ï¼Oè¢«ååä¸ºå¤ä¸ªåºåï¼ä¸ä¸ªåºå512Kï¼ï¼å¦æè¯¥åºåå¼ç¨äºæ°çä»£å¯¹è±¡ï¼åè¯¥åºåè¢«ç§°ä¸ºèå¡\n * å¨å¼ç¨åæ´æ¶éè¿post-write barried + dirty card queue\n * concurrent refinement threads æ´æ° Remembered Set\n\n\n\n# Remark\n\néæ°æ è®°é¶æ®µ\n\nå¨åå¾åæ¶æ¶ï¼æ¶éå¨å¤çå¯¹è±¡çè¿ç¨ä¸­\n\né»è²ï¼å·²è¢«å¤çï¼éè¦ä¿çç ç°è²ï¼æ­£å¨å¤çä¸­ç ç½è²ï¼è¿æªå¤çç\n\n\n\nä½æ¯å¨å¹¶åæ è®°è¿ç¨ä¸­ï¼æå¯è½Aè¢«å¤çäºä»¥åæªå¼ç¨Cï¼ä½è¯¥å¤çè¿ç¨è¿æªç»æï¼å¨å¤çè¿ç¨ç»æä¹åAå¼ç¨äºCï¼è¿æ¶å°±ä¼ç¨å°remark\n\nè¿ç¨å¦ä¸\n\n * ä¹åCæªè¢«å¼ç¨ï¼è¿æ¶Aå¼ç¨äºCï¼å°±ä¼ç»Cå ä¸ä¸ªåå±éï¼åå±éçæä»¤ä¼è¢«æ§è¡ï¼å°Cæ¾å¥ä¸ä¸ªéåå½ä¸­ï¼å¹¶å°Cåä¸º å¤çä¸­ ç¶æ\n * å¨å¹¶åæ è®°é¶æ®µç»æä»¥åï¼éæ°æ è®°é¶æ®µä¼STWï¼ç¶åå°æ¾å¨è¯¥éåä¸­çå¯¹è±¡éæ°å¤çï¼åç°æå¼ºå¼ç¨å¼ç¨å®ï¼å°±ä¼å¤çå®\n\n\n\n# JDK 8u20 å­ç¬¦ä¸²å»é\n\nè¿ç¨\n\n * å°æææ°åéçå­ç¬¦ä¸²ï¼åºå±æ¯char[]ï¼æ¾å¥ä¸ä¸ªéå\n * å½æ°çä»£åæ¶æ¶ï¼G1å¹¶åæ£æ¥æ¯å¦æéå¤çå­ç¬¦ä¸²\n * å¦æå­ç¬¦ä¸²çå¼ä¸æ ·ï¼å°±è®©ä»ä»¬å¼ç¨åä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡\n * æ³¨æï¼å¶ä¸String.internçåºå«\n   * internå³æ³¨çæ¯å­ç¬¦ä¸²å¯¹è±¡\n   * å­ç¬¦ä¸²å»éå³æ³¨çæ¯char[]\n   * å¨JVMåé¨ï¼ä½¿ç¨äºä¸åçå­ç¬¦ä¸²æ \n\nä¼ç¹ä¸ç¼ºç¹\n\n * èçäºå¤§éåå­\n * æ°çä»£åæ¶æ¶é´ç¥å¾®å¢å ï¼å¯¼è´ç¥å¾®å¤å ç¨CPU\n\n# JDK 8u40 å¹¶åæ è®°ç±»å¸è½½\n\nå¨å¹¶åæ è®°é¶æ®µç»æä»¥åï¼å°±è½ç¥éåªäºç±»ä¸åè¢«ä½¿ç¨ãå¦æä¸ä¸ªç±»å è½½å¨çææç±»é½ä¸å¨ä½¿ç¨ï¼åå¸è½½å®æå è½½çææç±»\n\n# JDK 8u60 åæ¶å·¨åå¯¹è±¡\n\n * ä¸ä¸ªå¯¹è±¡å¤§äºregionçä¸åæ¶ï¼å°±ç§°ä¸ºå·¨åå¯¹è±¡\n * G1ä¸ä¼å¯¹å·¨åå¯¹è±¡è¿è¡æ·è´\n * åæ¶æ¶è¢«ä¼åèè\n * G1ä¼è·è¸ªèå¹´ä»£ææincomingå¼ç¨ï¼å¦æèå¹´ä»£incomingå¼ç¨ä¸º0çå·¨åå¯¹è±¡å°±å¯ä»¥å¨æ°çä»£åå¾åæ¶æ¶å¤çæ\n\n\n\n\n# 5ãGC è°ä¼\n\næ¥çèææºåæ°å½ä»¤\n\n"F:\\JAVA\\JDK8.0\\bin\\java" -XX:+PrintFlagsFinal -version | findstr "GC"\n\n\n1\n\n\nå¯ä»¥æ ¹æ®åæ°å»æ¥è¯¢å·ä½çä¿¡æ¯\n\n# è°ä¼é¢å\n\n * åå­\n * éç«äº\n * CPUå ç¨\n * IO\n * GC\n\n# ç¡®å®ç®æ \n\nä½å»¶è¿/é«ååéï¼ éæ©åéçGC\n\n * CMS G1 ZGC\n * ParallelGC\n * Zing\n\n# æå¿«çGCæ¯ä¸åçGC\n\né¦åæé¤åå°å ä¸ºèªèº«ç¼åçä»£ç èå¼åçåå­é®é¢\n\n * æ¥çFull GCååçåå­å ç¨ï¼èèä»¥ä¸å ä¸ªé®é¢\n   * æ°æ®æ¯ä¸æ¯å¤ªå¤ï¼\n   * æ°æ®è¡¨ç¤ºæ¯å¦å¤ªèè¿\n     * å¯¹è±¡å¾\n     * å¯¹è±¡å¤§å°\n   * æ¯å¦å­å¨åå­æ³æ¼\n\n# æ°çä»£è°ä¼\n\n * æ°çä»£çç¹ç¹\n   * ææçnewæä½åéåå­é½æ¯éå¸¸å»ä»·ç\n     * TLAB\n   * æ­»äº¡å¯¹è±¡åæ¶é¶ä»£ä»·\n   * å¤§é¨åå¯¹è±¡ç¨è¿å³æ­»ï¼æçå¤æ­»ï¼\n   * MInor GC æç¨æ¶é´è¿å°äºFull GC\n * æ°çä»£åå­è¶å¤§è¶å¥½ä¹ï¼\n   * ä¸æ¯\n     * æ°çä»£åå­å¤ªå°ï¼é¢ç¹è§¦åMinor GCï¼ä¼STWï¼ä¼ä½¿å¾ååéä¸é\n     * æ°çä»£åå­å¤ªå¤§ï¼èå¹´ä»£åå­å æ¯ææéä½ï¼ä¼æ´é¢ç¹å°è§¦åFull GCãèä¸è§¦åMinor GCæ¶ï¼æ¸çæ°çä»£æè±è´¹çæ¶é´ä¼æ´é¿\n   * æ°çä»£åå­è®¾ç½®ä¸ºåå®¹çº³[å¹¶åé*(è¯·æ±-ååº)]çæ°æ®ä¸ºå®\n\n# å¹¸å­åºè°ä¼\n\n * å¹¸å­åºéè¦è½å¤ä¿å­ å½åæ´»è·å¯¹è±¡+éè¦æåçå¯¹è±¡\n * æåéå¼éç½®å¾å½ï¼è®©é¿æ¶é´å­æ´»çå¯¹è±¡å°½å¿«æå\n\n# èå¹´ä»£è°ä¼\n\n\n# åãç±»å è½½ä¸å­èç ææ¯\n\n\n\n\n# 1ãç±»æä»¶ç»æ\n\né¦åè·å¾.classå­èç æä»¶\n\næ¹æ³ï¼\n\n * å¨ææ¬ææ¡£éåå¥javaä»£ç ï¼æä»¶åä¸ç±»åä¸è´ï¼ï¼å°æä»¶ç±»åæ¹ä¸º.java\n * javaç»ç«¯ä¸­ï¼æ§è¡javac X:...\\XXX.java\n\n\n\nä»¥ä¸æ¯å­èç æä»¶\n\n0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09 \n0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b 07 \n0000040 00 1c 01 00 06 3c 69 6e 69 74 3e 01 00 03 28 29 \n0000060 56 01 00 04 43 6f 64 65 01 00 0f 4c 69 6e 65 4e \n0000100 75 6d 62 65 72 54 61 62 6c 65 01 00 12 4c 6f 63 \n0000120 61 6c 56 61 72 69 61 62 6c 65 54 61 62 6c 65 01 \n0000140 00 04 74 68 69 73 01 00 1d 4c 63 6e 2f 69 74 63 \n0000160 61 73 74 2f 6a 76 6d 2f 74 35 2f 48 65 6c 6c 6f \n0000200 57 6f 72 6c 64 3b 01 00 04 6d 61 69 6e 01 00 16 \n0000220 28 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 \n0000240 69 6e 67 3b 29 56 01 00 04 61 72 67 73 01 00 13 \n0000260 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 \n0000300 6e 67 3b 01 00 10 4d 65 74 68 6f 64 50 61 72 61 \n0000320 6d 65 74 65 72 73 01 00 0a 53 6f 75 72 63 65 46 \n0000340 69 6c 65 01 00 0f 48 65 6c 6c 6f 57 6f 72 6c 64\n0000360 2e 6a 61 76 61 0c 00 07 00 08 07 00 1d 0c 00 1e \n0000400 00 1f 01 00 0b 68 65 6c 6c 6f 20 77 6f 72 6c 64 \n0000420 07 00 20 0c 00 21 00 22 01 00 1b 63 6e 2f 69 74 \n0000440 63 61 73 74 2f 6a 76 6d 2f 74 35 2f 48 65 6c 6c \n0000460 6f 57 6f 72 6c 64 01 00 10 6a 61 76 61 2f 6c 61 \n0000500 6e 67 2f 4f 62 6a 65 63 74 01 00 10 6a 61 76 61 \n0000520 2f 6c 61 6e 67 2f 53 79 73 74 65 6d 01 00 03 6f \n0000540 75 74 01 00 15 4c 6a 61 76 61 2f 69 6f 2f 50 72 \n0000560 69 6e 74 53 74 72 65 61 6d 3b 01 00 13 6a 61 76 \n0000600 61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d \n0000620 01 00 07 70 72 69 6e 74 6c 6e 01 00 15 28 4c 6a \n0000640 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b \n0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 00 01 \n0000700 00 07 00 08 00 01 00 09 00 00 00 2f 00 01 00 01 \n0000720 00 00 00 05 2a b7 00 01 b1 00 00 00 02 00 0a 00 \n0000740 00 00 06 00 01 00 00 00 04 00 0b 00 00 00 0c 00 \n0000760 01 00 00 00 05 00 0c 00 0d 00 00 00 09 00 0e 00 \n0001000 0f 00 02 00 09 00 00 00 37 00 02 00 01 00 00 00 \n0001020 09 b2 00 02 12 03 b6 00 04 b1 00 00 00 02 00 0a \n0001040 00 00 00 0a 00 02 00 00 00 06 00 08 00 07 00 0b \n0001060 00 00 00 0c 00 01 00 00 00 09 00 10 00 11 00 00 \n0001100 00 12 00 00 00 05 01 00 10 00 00 00 01 00 13 00 \n0001120 00 00 02 00 14\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n\n\næ ¹æ® JVM è§èï¼ç±»æä»¶ç»æå¦ä¸\n\nu4 \t\t\t magic\nu2             minor_version;    \nu2             major_version;    \nu2             constant_pool_count;    \ncp_info        constant_pool[constant_pool_count-1];    \nu2             access_flags;    \nu2             this_class;    \nu2             super_class;   \nu2             interfaces_count;    \nu2             interfaces[interfaces_count];   \nu2             fields_count;    \nfield_info     fields[fields_count];   \nu2             methods_count;    \nmethod_info    methods[methods_count];    \nu2             attributes_count;    \nattribute_info attributes[attributes_count];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n# é­æ°\n\nu4 magic\n\nå¯¹åºå­èç æä»¶ç0~3ä¸ªå­è\n\n0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09\n\n# çæ¬\n\nu2 minor_version;\n\nu2 major_version;\n\n0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09\n\n34H = 52ï¼ä»£è¡¨JDK8\n\n# å¸¸éæ± \n\nè§èµææä»¶\n\nâ¦ç¥\n\n\n# 2ãå­èç æä»¤\n\nå¯åè\n\nhttps://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5\n\n# javapå·¥å·\n\nOracle æä¾äº javap å·¥å·æ¥åç¼è¯ class æä»¶\n\njavap -v F:\\Thread_study\\src\\com\\nyima\\JVM\\day01\\Main.class\nF:\\Thread_study>javap -v F:\\Thread_study\\src\\com\\nyima\\JVM\\day5\\Demo1.class\nClassfile /F:/Thread_study/src/com/nyima/JVM/day5/Demo1.class\n  Last modified 2020-6-6; size 434 bytes\n  MD5 checksum df1dce65bf6fb0b4c1de318051f4a67e\n  Compiled from "Demo1.java"\npublic class com.nyima.JVM.day5.Demo1\n  minor version: 0\n  major version: 52\n  flags: ACC_PUBLIC, ACC_SUPER\nConstant pool:\n   #1 = Methodref          #6.#15         // java/lang/Object."<init>":()V\n   #2 = Fieldref           #16.#17        // java/lang/System.out:Ljava/io/PrintStream;\n   #3 = String             #18            // hello world\n   #4 = Methodref          #19.#20        // java/io/PrintStream.println:(Ljava/lang/String;)V\n   #5 = Class              #21            // com/nyima/JVM/day5/Demo1\n   #6 = Class              #22            // java/lang/Object\n   #7 = Utf8               <init>\n   #8 = Utf8               ()V\n   #9 = Utf8               Code\n  #10 = Utf8               LineNumberTable\n  #11 = Utf8               main\n  #12 = Utf8               ([Ljava/lang/String;)V\n  #13 = Utf8               SourceFile\n  #14 = Utf8               Demo1.java\n  #15 = NameAndType        #7:#8          // "<init>":()V\n  #16 = Class              #23            // java/lang/System\n  #17 = NameAndType        #24:#25        // out:Ljava/io/PrintStream;\n  #18 = Utf8               hello world\n  #19 = Class              #26            // java/io/PrintStream\n  #20 = NameAndType        #27:#28        // println:(Ljava/lang/String;)V\n  #21 = Utf8               com/nyima/JVM/day5/Demo1\n  #22 = Utf8               java/lang/Object\n  #23 = Utf8               java/lang/System\n  #24 = Utf8               out\n  #25 = Utf8               Ljava/io/PrintStream;\n  #26 = Utf8               java/io/PrintStream\n  #27 = Utf8               println\n  #28 = Utf8               (Ljava/lang/String;)V\n{\n  public com.nyima.JVM.day5.Demo1();\n    descriptor: ()V\n    flags: ACC_PUBLIC\n    Code:\n      stack=1, locals=1, args_size=1\n         0: aload_0\n         1: invokespecial #1                  // Method java/lang/Object."<init>":()V\n         4: return\n      LineNumberTable:\n        line 7: 0\n\n  public static void main(java.lang.String[]);\n    descriptor: ([Ljava/lang/String;)V\n    flags: ACC_PUBLIC, ACC_STATIC\n    Code:\n      stack=2, locals=1, args_size=1\n         0: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;\n         3: ldc           #3                  // String hello world\n         5: invokevirtual #4                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V\n\n         8: return\n      LineNumberTable:\n        line 9: 0\n        line 10: 8\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n\n\n# å¾è§£æ¹æ³æ§è¡æµç¨\n\nä»£ç \n\npublic class Demo3_1 {    \n\tpublic static void main(String[] args) {        \n\t\tint a = 10;        \n\t\tint b = Short.MAX_VALUE + 1;        \n\t\tint c = a + b;        \n\t\tSystem.out.println(c);   \n    } \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¸¸éæ± è½½å¥è¿è¡æ¶å¸¸éæ± \n\nå¸¸éæ± ä¹å±äºæ¹æ³åºï¼åªä¸è¿è¿éåç¬æåºæ¥äº\n\n\n\næ¹æ³å­èç è½½å¥æ¹æ³åº\n\nï¼stack=2ï¼locals=4ï¼ å¯¹åºæä½æ°æ æ2ä¸ªç©ºé´ï¼æ¯ä¸ªç©ºé´4ä¸ªå­èï¼ï¼å±é¨åéè¡¨ä¸­æ4ä¸ªæ§½ä½\n\n\n\næ§è¡å¼æå¼å§æ§è¡å­èç \n\nbipush 10\n\n * å°ä¸ä¸ª byte åå¥æä½æ°æ \n   \n   ï¼å¶é¿åº¦ä¼è¡¥é½ 4 ä¸ªå­èï¼ï¼ç±»ä¼¼çæä»¤è¿æ\n   \n   * sipush å°ä¸ä¸ª short åå¥æä½æ°æ ï¼å¶é¿åº¦ä¼è¡¥é½ 4 ä¸ªå­èï¼\n   * ldc å°ä¸ä¸ª int åå¥æä½æ°æ \n   * ldc2_w å°ä¸ä¸ª long åå¥æä½æ°æ ï¼åä¸¤æ¬¡åå¥ï¼å ä¸º long æ¯ 8 ä¸ªå­èï¼\n   * è¿éå°çæ°å­é½æ¯åå­èç æä»¤å­å¨ä¸èµ·ï¼è¶è¿ short èå´çæ°å­å­å¥äºå¸¸éæ± \n\n\n\nistore 1\n\nå°æä½æ°æ æ é¡¶åç´ å¼¹åºï¼æ¾å¥å±é¨åéè¡¨çslot 1ä¸­\n\nå¯¹åºä»£ç ä¸­ç\n\na = 10\n\n\n1\n\n\n\n\n\n\nldc #3\n\nè¯»åè¿è¡æ¶å¸¸éæ± ä¸­#3ï¼å³32768(è¶è¿shortæå¤§å¼èå´çæ°ä¼è¢«æ¾å°è¿è¡æ¶å¸¸éæ± ä¸­)ï¼å°å¶å è½½å°æä½æ°æ ä¸­\n\næ³¨æ Short.MAX_VALUE æ¯ 32767ï¼æä»¥ 32768 = Short.MAX_VALUE + 1 å®éæ¯å¨ç¼è¯æé´è®¡ç®å¥½ç\n\n\n\nistore 2\n\nå°æä½æ°æ ä¸­çåç´ å¼¹åºï¼æ¾å°å±é¨åéè¡¨ç2å·ä½ç½®\n\n\n\n\n\niload1 iload2\n\nå°å±é¨åéè¡¨ä¸­1å·ä½ç½®å2å·ä½ç½®çåç´ æ¾å¥æä½æ°æ ä¸­\n\n * å ä¸ºåªè½å¨æä½æ°æ ä¸­æ§è¡è¿ç®æä½\n\n\n\n\n\niadd\n\nå°æä½æ°æ ä¸­çä¸¤ä¸ªåç´ å¼¹åºæ å¹¶ç¸å ï¼ç»æå¨åå¥æä½æ°æ ä¸­\n\n\n\n\n\nistore 3\n\nå°æä½æ°æ ä¸­çåç´ å¼¹åºï¼æ¾å¥å±é¨åéè¡¨ç3å·ä½ç½®\n\n\n\n\n\ngetstatic #4\n\nå¨è¿è¡æ¶å¸¸éæ± ä¸­æ¾å°#4ï¼åç°æ¯ä¸ä¸ªå¯¹è±¡\n\nå¨å åå­ä¸­æ¾å°è¯¥å¯¹è±¡ï¼å¹¶å°å¶å¼ç¨æ¾å¥æä½æ°æ ä¸­\n\n\n\n\n\niload 3\n\nå°å±é¨åéè¡¨ä¸­3å·ä½ç½®çåç´ åå¥æä½æ°æ ä¸­\n\n\n\ninvokevirtual 5\n\næ¾å°å¸¸éæ±  #5 é¡¹ï¼å®ä½å°æ¹æ³åº java/io/PrintStream.println:(I)V æ¹æ³\n\nçææ°çæ å¸§ï¼åé localsãstackç­ï¼\n\nä¼ éåæ°ï¼æ§è¡æ°æ å¸§ä¸­çå­èç \n\n\n\næ§è¡å®æ¯ï¼å¼¹åºæ å¸§\n\næ¸é¤ main æä½æ°æ åå®¹\n\n\n\nreturn å®æ main æ¹æ³è°ç¨ï¼å¼¹åº main æ å¸§ï¼ç¨åºç»æ\n\n# éè¿å­èç æä»¤æ¥åæé®é¢\n\nä»£ç \n\npublic class Demo2 {\n\tpublic static void main(String[] args) {\n\t\tint i=0;\n\t\tint x=0;\n\t\twhile(i<10) {\n\t\t\tx = x++;\n\t\t\ti++;\n\t\t}\n\t\tSystem.out.println(x); //æ¥è¿ä¸º0\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸ºä»ä¹æç»çxç»æä¸º0å¢ï¼ éè¿åæå­èç æä»¤å³å¯ç¥æ\n\nCode:\n     stack=2, locals=3, args_size=1\t//æä½æ°æ åé2ä¸ªç©ºé´ï¼å±é¨åéè¡¨åé3ä¸ªç©ºé´\n        0: iconst_0\t//åå¤ä¸ä¸ªå¸¸æ°0\n        1: istore_1\t//å°å¸¸æ°0æ¾å¥å±é¨åéè¡¨ç1å·æ§½ä½ i=0\n        2: iconst_0\t//åå¤ä¸ä¸ªå¸¸æ°0\n        3: istore_2\t//å°å¸¸æ°0æ¾å¥å±é¨åéç2å·æ§½ä½ x=0\t\n        4: iload_1\t\t//å°å±é¨åéè¡¨1å·æ§½ä½çæ°æ¾å¥æä½æ°æ ä¸­\n        5: bipush        10\t//å°æ°å­10æ¾å¥æä½æ°æ ä¸­ï¼æ­¤æ¶æä½æ°æ ä¸­æ2ä¸ªæ°\n        7: if_icmpge     21\t//æ¯è¾æä½æ°æ ä¸­çä¸¤ä¸ªæ°ï¼å¦æä¸é¢çæ°å¤§äºä¸é¢çæ°ï¼å°±è·³è½¬å°21ãè¿éçæ¯è¾æ¯å°ä¸¤ä¸ªæ°ååæ³ãå ä¸ºæ¶åè¿ç®æä½ï¼æä»¥ä¼å°ä¸¤ä¸ªæ°å¼¹åºæä½æ°æ æ¥è¿è¡è¿ç®ãè¿ç®ç»æåæä½æ°æ ä¸ºç©º\n       10: iload_2\t\t//å°å±é¨åé2å·æ§½ä½çæ°æ¾å¥æä½æ°æ ä¸­ï¼æ¾å¥çå¼æ¯0\n       11: iinc          2, 1\t//å°å±é¨åé2å·æ§½ä½çæ°å 1ï¼èªå¢åï¼æ§½ä½ä¸­çå¼ä¸º1\n       14: istore_2\t//å°æä½æ°æ ä¸­çæ°æ¾å¥å°å±é¨åéè¡¨ç2å·æ§½ä½ï¼2å·æ§½ä½çå¼ååä¸ºäº0\n       15: iinc          1, 1 //1å·æ§½ä½çå¼èªå¢1\n       18: goto          4 //è·³è½¬å°ç¬¬4æ¡æä»¤\n       21: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;\n       24: iload_2\n       25: invokevirtual #3                  // Method java/io/PrintStream.println:(I)V\n       28: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n# æé æ¹æ³\n\n# cinit()V\n\npublic class Demo3 {\n\tstatic int i = 10;\n\n\tstatic {\n\t\ti = 20;\n\t}\n\n\tstatic {\n\t\ti = 30;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tSystem.out.println(i); //ç»æä¸º30\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nç¼è¯å¨ä¼æä»ä¸è³ä¸çé¡ºåºï¼æ¶éææ static éæä»£ç ååéææåèµå¼çä»£ç ï¼åå¹¶ä¸ºä¸ä¸ªç¹æ®çæ¹æ³ cinit()V ï¼\n\nstack=1, locals=0, args_size=0\n         0: bipush        10\n         2: putstatic     #3                  // Field i:I\n         5: bipush        20\n         7: putstatic     #3                  // Field i:I\n        10: bipush        30\n        12: putstatic     #3                  // Field i:I\n        15: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n# init()V\n\npublic class Demo4 {\n\tprivate String a = "s1";\n\n\t{\n\t\tb = 20;\n\t}\n\n\tprivate int b = 10;\n\n\t{\n\t\ta = "s2";\n\t}\n\n\tpublic Demo4(String a, int b) {\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tDemo4 d = new Demo4("s3", 30);\n\t\tSystem.out.println(d.a);\n\t\tSystem.out.println(d.b);\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nç¼è¯å¨ä¼æä»ä¸è³ä¸çé¡ºåºï¼æ¶éææ {} ä»£ç ååæååéèµå¼çä»£ç ï¼å½¢ææ°çæé æ¹æ³ï¼ä½åå§æé æ¹æ³åçä»£ç æ»æ¯å¨å\n\nCode:\n     stack=2, locals=3, args_size=3\n        0: aload_0\n        1: invokespecial #1                  // Method java/lang/Object."<init>":()V\n        4: aload_0\n        5: ldc           #2                  // String s1\n        7: putfield      #3                  // Field a:Ljava/lang/String;\n       10: aload_0\n       11: bipush        20\n       13: putfield      #4                  // Field b:I\n       16: aload_0\n       17: bipush        10\n       19: putfield      #4                  // Field b:I\n       22: aload_0\n       23: ldc           #5                  // String s2\n       25: putfield      #3                  // Field a:Ljava/lang/String;\n       //åå§æé æ¹æ³å¨æåæ§è¡\n       28: aload_0\n       29: aload_1\n       30: putfield      #3                  // Field a:Ljava/lang/String;\n       33: aload_0\n       34: iload_2\n       35: putfield      #4                  // Field b:I\n       38: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n# æ¹æ³è°ç¨\n\npublic class Demo5 {\n\tpublic Demo5() {\n\n\t}\n\n\tprivate void test1() {\n\n\t}\n\n\tprivate final void test2() {\n\n\t}\n\n\tpublic void test3() {\n\n\t}\n\n\tpublic static void test4() {\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tDemo5 demo5 = new Demo5();\n\t\tdemo5.test1();\n\t\tdemo5.test2();\n\t\tdemo5.test3();\n\t\tDemo5.test4();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸åæ¹æ³å¨è°ç¨æ¶ï¼å¯¹åºçèææºæä»¤ææåºå«\n\n * ç§æãæé ãè¢«finalä¿®é¥°çæ¹æ³ï¼å¨è°ç¨æ¶é½ä½¿ç¨invokespecialæä»¤\n * æ®éæåæ¹æ³å¨è°ç¨æ¶ï¼ä½¿ç¨invokespecialæä»¤ãå ä¸ºç¼è¯æé´æ æ³ç¡®å®è¯¥æ¹æ³çåå®¹ï¼åªæå¨è¿è¡æé´æè½ç¡®å®\n * éææ¹æ³å¨è°ç¨æ¶ä½¿ç¨invokestaticæä»¤\n\nCode:\n      stack=2, locals=2, args_size=1\n         0: new           #2                  // class com/nyima/JVM/day5/Demo5 \n         3: dup\n         4: invokespecial #3                  // Method "<init>":()V\n         7: astore_1\n         8: aload_1\n         9: invokespecial #4                  // Method test1:()V\n        12: aload_1\n        13: invokespecial #5                  // Method test2:()V\n        16: aload_1\n        17: invokevirtual #6                  // Method test3:()V\n        20: invokestatic  #7                  // Method test4:()V\n        23: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n * new æ¯åå»ºãå¯¹è±¡ãï¼ç»å¯¹è±¡åéå åå­ï¼æ§è¡æåä¼å°ãå¯¹è±¡å¼ç¨ãåå¥æä½æ°æ \n * dup æ¯èµå¼æä½æ°æ æ é¡¶çåå®¹ï¼æ¬ä¾å³ä¸ºãå¯¹è±¡å¼ç¨ãï¼ä¸ºä»ä¹éè¦ä¸¤ä»½å¼ç¨å¢ï¼ä¸ä¸ªæ¯è¦éå invokespecial è°ç¨è¯¥å¯¹è±¡çæé æ¹æ³ âinitâð¦)V ï¼ä¼æ¶èææ é¡¶ä¸ä¸ªå¼ç¨ï¼ï¼å¦ä¸ä¸ªè¦ éå astore_1 èµå¼ç»å±é¨åé\n * ç»æ¹æ³ï¼ï¬nalï¼ï¼ç§ææ¹æ³ï¼privateï¼ï¼æé æ¹æ³é½æ¯ç± invokespecial æä»¤æ¥è°ç¨ï¼å±äºéæç»å®\n * æ®éæåæ¹æ³æ¯ç± invokevirtual è°ç¨ï¼å±äºå¨æç»å®ï¼å³æ¯æå¤æ æåæ¹æ³ä¸éææ¹æ³è°ç¨çå¦ä¸ä¸ªåºå«æ¯ï¼æ§è¡æ¹æ³åæ¯å¦éè¦ãå¯¹è±¡å¼ç¨ã\n\n# å¤æåç\n\nå ä¸ºæ®éæåæ¹æ³éè¦å¨è¿è¡æ¶æè½ç¡®å®å·ä½çåå®¹ï¼æä»¥èææºéè¦è°ç¨invokevirtualæä»¤\n\nå¨æ§è¡invokevirtualæä»¤æ¶ï¼ç»åäºä»¥ä¸å ä¸ªæ­¥éª¤\n\n * åéè¿æ å¸§ä¸­å¯¹è±¡çå¼ç¨æ¾å°å¯¹è±¡\n * åæå¯¹è±¡å¤´ï¼æ¾å°å¯¹è±¡å®éçClass\n * Classç»æä¸­ævtable\n * æ¥è¯¢vtableæ¾å°æ¹æ³çå·ä½å°å\n * æ§è¡æ¹æ³çå­èç \n\n# å¼å¸¸å¤ç\n\n# try-catch\n\npublic class Demo1 {\n\tpublic static void main(String[] args) {\n\t\tint i = 0;\n\t\ttry {\n\t\t\ti = 10;\n\t\t}catch (Exception e) {\n\t\t\ti = 20;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¯¹åºå­èç æä»¤\n\nCode:\n     stack=1, locals=3, args_size=1\n        0: iconst_0\n        1: istore_1\n        2: bipush        10\n        4: istore_1\n        5: goto          12\n        8: astore_2\n        9: bipush        20\n       11: istore_1\n       12: return\n     //å¤åºæ¥ä¸ä¸ªå¼å¸¸è¡¨\n     Exception table:\n        from    to  target type\n            2     5     8   Class java/lang/Exception\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n * å¯ä»¥çå°å¤åºæ¥ä¸ä¸ª Exception table çç»æï¼[from, to) æ¯åé­åå¼ï¼ä¹å°±æ¯æ£æµ2~4è¡ï¼çæ£æµèå´ï¼ä¸æ¦è¿ä¸ªèå´åçå­èç æ§è¡åºç°å¼å¸¸ï¼åéè¿ type å¹éå¼å¸¸ç±»åï¼å¦æä¸è´ï¼è¿å¥ target ææç¤ºè¡å·\n * 8è¡çå­èç æä»¤ astore_2 æ¯å°å¼å¸¸å¯¹è±¡å¼ç¨å­å¥å±é¨åéè¡¨ç2å·ä½ç½®ï¼ä¸ºeï¼\n\n# å¤ä¸ªsingle-catch\n\npublic class Demo1 {\n\tpublic static void main(String[] args) {\n\t\tint i = 0;\n\t\ttry {\n\t\t\ti = 10;\n\t\t}catch (ArithmeticException e) {\n\t\t\ti = 20;\n\t\t}catch (Exception e) {\n\t\t\ti = 30;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¯¹åºçå­èç \n\nCode:\n     stack=1, locals=3, args_size=1\n        0: iconst_0\n        1: istore_1\n        2: bipush        10\n        4: istore_1\n        5: goto          19\n        8: astore_2\n        9: bipush        20\n       11: istore_1\n       12: goto          19\n       15: astore_2\n       16: bipush        30\n       18: istore_1\n       19: return\n     Exception table:\n        from    to  target type\n            2     5     8   Class java/lang/ArithmeticException\n            2     5    15   Class java/lang/Exception\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n * å ä¸ºå¼å¸¸åºç°æ¶ï¼åªè½è¿å¥ Exception table ä¸­ä¸ä¸ªåæ¯ï¼æä»¥å±é¨åéè¡¨ slot 2 ä½ç½®è¢«å±ç¨\n\n# finally\n\npublic class Demo2 {\n\tpublic static void main(String[] args) {\n\t\tint i = 0;\n\t\ttry {\n\t\t\ti = 10;\n\t\t} catch (Exception e) {\n\t\t\ti = 20;\n\t\t} finally {\n\t\t\ti = 30;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¯¹åºå­èç \n\nCode:\n     stack=1, locals=4, args_size=1\n        0: iconst_0\n        1: istore_1\n        //tryå\n        2: bipush        10\n        4: istore_1\n        //tryåæ§è¡å®åï¼ä¼æ§è¡finally    \n        5: bipush        30\n        7: istore_1\n        8: goto          27\n       //catchå     \n       11: astore_2 //å¼å¸¸ä¿¡æ¯æ¾å¥å±é¨åéè¡¨ç2å·æ§½ä½\n       12: bipush        20\n       14: istore_1\n       //catchåæ§è¡å®åï¼ä¼æ§è¡finally        \n       15: bipush        30\n       17: istore_1\n       18: goto          27\n       //åºç°å¼å¸¸ï¼ä½æªè¢«Exceptionæè·ï¼ä¼æåºå¶ä»å¼å¸¸ï¼è¿æ¶ä¹éè¦æ§è¡finallyåä¸­çä»£ç    \n       21: astore_3\n       22: bipush        30\n       24: istore_1\n       25: aload_3\n       26: athrow  //æåºå¼å¸¸\n       27: return\n     Exception table:\n        from    to  target type\n            2     5    11   Class java/lang/Exception\n            2     5    21   any\n           11    15    21   any\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\nå¯ä»¥çå° ï¬nally ä¸­çä»£ç è¢«å¤å¶äº 3 ä»½ï¼åå«æ¾å¥ try æµç¨ï¼catch æµç¨ä»¥å catchå©ä½çå¼å¸¸ç±»åæµç¨\n\næ³¨æï¼è½ç¶ä»å­èç æä»¤çæ¥ï¼æ¯ä¸ªåä¸­é½æfinallyåï¼ä½æ¯finallyåä¸­çä»£ç åªä¼è¢«æ§è¡ä¸æ¬¡\n\n# finallyä¸­çreturn\n\npublic class Demo3 {\n\tpublic static void main(String[] args) {\n\t\tint i = Demo3.test();\n        //ç»æä¸º20\n\t\tSystem.out.println(i);\n\t}\n\n\tpublic static int test() {\n\t\tint i;\n\t\ttry {\n\t\t\ti = 10;\n\t\t\treturn i;\n\t\t} finally {\n\t\t\ti = 20;\n\t\t\treturn i;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nå¯¹åºå­èç \n\nCode:\n     stack=1, locals=3, args_size=0\n        0: bipush        10\n        2: istore_0\n        3: iload_0\n        4: istore_1  //æå­è¿åå¼\n        5: bipush        20\n        7: istore_0\n        8: iload_0\n        9: ireturn\t//ireturnä¼è¿åæä½æ°æ é¡¶çæ´åå¼20\n       //å¦æåºç°å¼å¸¸ï¼è¿æ¯ä¼æ§è¡finallyåä¸­çåå®¹ï¼æ²¡ææåºå¼å¸¸\n       10: astore_2\n       11: bipush        20\n       13: istore_0\n       14: iload_0\n       15: ireturn\t//è¿éæ²¡æathrowäºï¼ä¹å°±æ¯å¦æå¨finallyåä¸­å¦ææè¿åæä½çè¯ï¼ä¸tryåä¸­åºç°å¼å¸¸ï¼ä¼åæå¼å¸¸ï¼\n     Exception table:\n        from    to  target type\n            0     5    10   any\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n * ç±äº ï¬nally ä¸­ç ireturn è¢«æå¥äºææå¯è½çæµç¨ï¼å æ­¤è¿åç»æè¯å®ä»¥ï¬nallyçä¸ºå\n * è³äºå­èç ä¸­ç¬¬ 2 è¡ï¼ä¼¼ä¹æ²¡å¥ç¨ï¼ä¸çä¸ªä¼ç¬ï¼çä¸ä¸ªä¾å­\n * è·ä¸ä¾ä¸­ç ï¬nally ç¸æ¯ï¼åç°æ²¡æ athrow äºï¼è¿åè¯æä»¬ï¼å¦æå¨ ï¬nally ä¸­åºç°äº returnï¼ä¼åæå¼å¸¸\n * æä»¥ä¸è¦å¨finallyä¸­è¿è¡è¿åæä½\n\n# è¢«åæçå¼å¸¸\n\npublic class Demo3 {\n   public static void main(String[] args) {\n      int i = Demo3.test();\n      //æç»ç»æä¸º20\n      System.out.println(i);\n   }\n\n   public static int test() {\n      int i;\n      try {\n         i = 10;\n         //è¿éåºè¯¥ä¼æåºå¼å¸¸\n         i = i/0;\n         return i;\n      } finally {\n         i = 20;\n         return i;\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¼åç°æå°ç»æä¸º20ï¼å¹¶æªæåºå¼å¸¸\n\n# finallyä¸å¸¦return\n\npublic class Demo4 {\n\tpublic static void main(String[] args) {\n\t\tint i = Demo4.test();\n\t\tSystem.out.println(i);\n\t}\n\n\tpublic static int test() {\n\t\tint i = 10;\n\t\ttry {\n\t\t\treturn i;\n\t\t} finally {\n\t\t\ti = 20;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¯¹åºå­èç \n\nCode:\n     stack=1, locals=3, args_size=0\n        0: bipush        10\n        2: istore_0 //èµå¼ç»i 10\n        3: iload_0\t//å è½½å°æä½æ°æ é¡¶\n        4: istore_1 //å è½½å°å±é¨åéè¡¨ç1å·ä½ç½®\n        5: bipush        20\n        7: istore_0 //èµå¼ç»i 20\n        8: iload_1 //å è½½å±é¨åéè¡¨1å·ä½ç½®çæ°10å°æä½æ°æ \n        9: ireturn //è¿åæä½æ°æ é¡¶åç´  10\n       10: astore_2\n       11: bipush        20\n       13: istore_0\n       14: aload_2 //å è½½å¼å¸¸\n       15: athrow //æåºå¼å¸¸\n     Exception table:\n        from    to  target type\n            3     5    10   any\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n# Synchronized\n\npublic class Demo5 {\n\tpublic static void main(String[] args) {\n\t\tint i = 10;\n\t\tLock lock = new Lock();\n\t\tsynchronized (lock) {\n\t\t\tSystem.out.println(i);\n\t\t}\n\t}\n}\n\nclass Lock{}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¯¹åºå­èç \n\nCode:\n     stack=2, locals=5, args_size=1\n        0: bipush        10\n        2: istore_1\n        3: new           #2                  // class com/nyima/JVM/day06/Lock\n        6: dup //å¤å¶ä¸ä»½ï¼æ¾å°æä½æ°æ é¡¶ï¼ç¨äºæé å½æ°æ¶è\n        7: invokespecial #3                  // Method com/nyima/JVM/day06/Lock."<init>":()V\n       10: astore_2 //å©ä¸çä¸ä»½æ¾å°å±é¨åéè¡¨ç2å·ä½ç½®\n       11: aload_2 //å è½½å°æä½æ°æ \n       12: dup //å¤å¶ä¸ä»½ï¼æ¾å°æä½æ°æ ï¼ç¨äºå éæ¶æ¶è\n       13: astore_3 //å°æä½æ°æ é¡¶åç´ å¼¹åºï¼æå­å°å±é¨åéè¡¨çä¸å·æ§½ä½ãè¿æ¶æä½æ°æ ä¸­æä¸ä»½å¯¹è±¡çå¼ç¨\n       14: monitorenter //å é\n       //éä½åä»£ç åä¸­çæä½    \n       15: getstatic     #4                  // Field java/lang/System.out:Ljava/io/PrintStream;\n       18: iload_1\n       19: invokevirtual #5                  // Method java/io/PrintStream.println:(I)V\n       //å è½½å±é¨åéè¡¨ä¸­ä¸å·æ§½ä½å¯¹è±¡çå¼ç¨ï¼ç¨äºè§£é    \n       22: aload_3    \n       23: monitorexit //è§£é\n       24: goto          34\n       //å¼å¸¸æä½    \n       27: astore        4\n       29: aload_3\n       30: monitorexit //è§£é\n       31: aload         4\n       33: athrow\n       34: return\n     //å¯ä»¥çåºï¼æ è®ºä½æ¶åºç°å¼å¸¸ï¼é½ä¼è·³è½¬å°27è¡ï¼å°å¼å¸¸æ¾å¥å±é¨åéä¸­ï¼å¹¶è¿è¡è§£éæä½ï¼ç¶åå è½½å¼å¸¸å¹¶æåºå¼å¸¸ã      \n     Exception table:\n        from    to  target type\n           15    24    27   any\n           27    31    27   any\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\n\n# 3ãç¼è¯æå¤ç\n\næè°ç è¯­æ³ç³ ï¼å¶å®å°±æ¯æ java ç¼è¯å¨æ *.java æºç ç¼è¯ä¸º *.class å­èç çè¿ç¨ä¸­ï¼èªå¨çæåè½¬æ¢çä¸äºä»£ç ï¼ä¸»è¦æ¯ä¸ºäºåè½»ç¨åºåçè´æï¼ç®æ¯ java ç¼è¯å¨ç»æä»¬çä¸ä¸ªé¢å¤ç¦å©\n\næ³¨æï¼ä»¥ä¸ä»£ç çåæï¼åå©äº javap å·¥å·ï¼idea çåç¼è¯åè½ï¼idea æä»¶ jclasslib ç­å·¥å·ãå¦å¤ï¼ ç¼è¯å¨è½¬æ¢çç»æç´æ¥å°±æ¯ class å­èç ï¼åªæ¯ä¸ºäºä¾¿äºéè¯»ï¼ç»åºäº å ä¹ç­ä»· ç java æºç æ¹å¼ï¼å¹¶ä¸æ¯ç¼è¯å¨è¿ä¼è½¬æ¢åºä¸­é´ç java æºç ï¼åè®°ã\n\n# é»è®¤æé å½æ°\n\npublic class Candy1 {\n\n}\n\n\n1\n2\n3\n\n\nç»è¿ç¼è¯æä¼åå\n\npublic class Candy1 {\n   //è¿ä¸ªæ åæé å¨æ¯javaç¼è¯å¨å¸®æä»¬å ä¸ç\n   public Candy1() {\n      //å³è°ç¨ç¶ç±» Object çæ åæé æ¹æ³ï¼å³è°ç¨ java/lang/Object." <init>":()V\n      super();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# èªå¨æè£ç®±\n\nåºæ¬ç±»ååå¶åè£ç±»åçç¸äºè½¬æ¢è¿ç¨ï¼ç§°ä¸ºæè£ç®±\n\nå¨JDK 5ä»¥åï¼å®ä»¬çè½¬æ¢å¯ä»¥å¨ç¼è¯æèªå¨å®æ\n\npublic class Demo2 {\n   public static void main(String[] args) {\n      Integer x = 1;\n      int y = x;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nè½¬æ¢è¿ç¨å¦ä¸\n\npublic class Demo2 {\n   public static void main(String[] args) {\n      //åºæ¬ç±»åèµå¼ç»åè£ç±»åï¼ç§°ä¸ºè£ç®±\n      Integer x = Integer.valueOf(1);\n      //åè£ç±»åèµå¼ç»åºæ¬ç±»åï¼ç§°è°æç®±\n      int y = x.intValue();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n# æ³åéååå¼\n\næ³åä¹æ¯å¨ JDK 5 å¼å§å å¥çç¹æ§ï¼ä½ java å¨ç¼è¯æ³åä»£ç åä¼æ§è¡ æ³åæ¦é¤ çå¨ä½ï¼å³æ³åä¿¡æ¯å¨ç¼è¯ä¸ºå­èç ä¹åå°±ä¸¢å¤±äºï¼å®éçç±»åé½å½åäº Object ç±»åæ¥å¤çï¼\n\npublic class Demo3 {\n   public static void main(String[] args) {\n      List<Integer> list = new ArrayList<>();\n      list.add(10);\n      Integer x = list.get(0);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¯¹åºå­èç \n\nCode:\n    stack=2, locals=3, args_size=1\n       0: new           #2                  // class java/util/ArrayList\n       3: dup\n       4: invokespecial #3                  // Method java/util/ArrayList."<init>":()V\n       7: astore_1\n       8: aload_1\n       9: bipush        10\n      11: invokestatic  #4                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;\n      //è¿éè¿è¡äºæ³åæ¦é¤ï¼å®éè°ç¨çæ¯add(Objcet o)\n      14: invokeinterface #5,  2            // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z\n\n      19: pop\n      20: aload_1\n      21: iconst_0\n      //è¿éä¹è¿è¡äºæ³åæ¦é¤ï¼å®éè°ç¨çæ¯get(Object o)   \n      22: invokeinterface #6,  2            // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;\n//è¿éè¿è¡äºç±»åè½¬æ¢ï¼å°Objectè½¬æ¢æäºInteger\n      27: checkcast     #7                  // class java/lang/Integer\n      30: astore_2\n      31: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\næä»¥è°ç¨getå½æ°åå¼æ¶ï¼æä¸ä¸ªç±»åè½¬æ¢çæä½\n\nInteger x = (Integer) list.get(0);\n\n\n1\n\n\nå¦æè¦å°è¿åç»æèµå¼ç»ä¸ä¸ªintç±»åçåéï¼åè¿æèªå¨æç®±çæä½\n\nint x = (Integer) list.get(0).intValue();\n\n\n1\n\n\n# å¯ååæ°\n\npublic class Demo4 {\n   public static void foo(String... args) {\n      //å°argsèµå¼ç»arrï¼å¯ä»¥çåºString...å®éå°±æ¯String[] \n      String[] arr = args;\n      System.out.println(arr.length);\n   }\n\n   public static void main(String[] args) {\n      foo("hello", "world");\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¯ååæ° Stringâ¦ args å¶å®æ¯ä¸ä¸ª String[] args ï¼ä»ä»£ç ä¸­çèµå¼è¯­å¥ä¸­å°±å¯ä»¥çåºæ¥ã å æ · java ç¼è¯å¨ä¼å¨ç¼è¯æé´å°ä¸è¿°ä»£ç åæ¢ä¸ºï¼\n\npublic class Demo4 {\n   public Demo4 {}\n\n    \n   public static void foo(String[] args) {\n      String[] arr = args;\n      System.out.println(arr.length);\n   }\n\n   public static void main(String[] args) {\n      foo(new String[]{"hello", "world"});\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\næ³¨æï¼å¦æè°ç¨çæ¯foo()ï¼å³æªä¼ éåæ°æ¶ï¼ç­ä»·ä»£ç ä¸ºfoo(new String[]{})ï¼åå»ºäºä¸ä¸ªç©ºæ°ç»ï¼èä¸æ¯ç´æ¥ä¼ éçnull\n\n# foreach\n\npublic class Demo5 {\n\tpublic static void main(String[] args) {\n        //æ°ç»èµåå¼çç®ååæ³ä¹æ¯ä¸ç§è¯­æ³ç³ã\n\t\tint[] arr = {1, 2, 3, 4, 5};\n\t\tfor(int x : arr) {\n\t\t\tSystem.out.println(x);\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nç¼è¯å¨ä¼å¸®æä»¬è½¬æ¢ä¸º\n\npublic class Demo5 {\n    public Demo5 {}\n\n\tpublic static void main(String[] args) {\n\t\tint[] arr = new int[]{1, 2, 3, 4, 5};\n\t\tfor(int i=0; i<arr.length; ++i) {\n\t\t\tint x = arr[i];\n\t\t\tSystem.out.println(x);\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦ææ¯éåä½¿ç¨foreach\n\npublic class Demo5 {\n   public static void main(String[] args) {\n      List<Integer> list = Arrays.asList(1, 2, 3, 4, 5);\n      for (Integer x : list) {\n         System.out.println(x);\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\néåè¦ä½¿ç¨foreachï¼éè¦è¯¥éåç±»å®ç°äºIterableæ¥å£ï¼å ä¸ºéåçéåéè¦ç¨å°è¿­ä»£å¨Iterator\n\npublic class Demo5 {\n    public Demo5 {}\n    \n   public static void main(String[] args) {\n      List<Integer> list = Arrays.asList(1, 2, 3, 4, 5);\n      //è·å¾è¯¥éåçè¿­ä»£å¨\n      Iterator<Integer> iterator = list.iterator();\n      while(iterator.hasNext()) {\n         Integer x = iterator.next();\n         System.out.println(x);\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n# switchå­ç¬¦ä¸²\n\npublic class Demo6 {\n   public static void main(String[] args) {\n      String str = "hello";\n      switch (str) {\n         case "hello" :\n            System.out.println("h");\n            break;\n         case "world" :\n            System.out.println("w");\n            break;\n         default:\n            break;\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¨ç¼è¯å¨ä¸­æ§è¡çæä½\n\npublic class Demo6 {\n   public Demo6() {\n      \n   }\n   public static void main(String[] args) {\n      String str = "hello";\n      int x = -1;\n      //éè¿å­ç¬¦ä¸²çhashCode+valueæ¥å¤æ­æ¯å¦å¹é\n      switch (str.hashCode()) {\n         //helloçhashCode\n         case 99162322 :\n            //åæ¬¡æ¯è¾ï¼å ä¸ºå­ç¬¦ä¸²çhashCodeæå¯è½ç¸ç­\n            if(str.equals("hello")) {\n               x = 0;\n            }\n            break;\n         //worldçhashCode\n         case 11331880 :\n            if(str.equals("world")) {\n               x = 1;\n            }\n            break;\n         default:\n            break;\n      }\n\n      //ç¨ç¬¬äºä¸ªswitchå¨è¿è¡è¾åºå¤æ­\n      switch (x) {\n         case 0:\n            System.out.println("h");\n            break;\n         case 1:\n            System.out.println("w");\n            break;\n         default:\n            break;\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n\n\nè¿ç¨è¯´æï¼\n\n * å¨ç¼è¯æé´ï¼åä¸ªçswitchè¢«åä¸ºäºä¸¤ä¸ª\n   * ç¬¬ä¸ä¸ªç¨æ¥å¹éå­ç¬¦ä¸²ï¼å¹¶ç»xèµå¼\n     * å­ç¬¦ä¸²çå¹éç¨å°äºå­ç¬¦ä¸²çhashCodeï¼è¿ç¨å°äºequalsæ¹æ³\n     * ä½¿ç¨hashCodeæ¯ä¸ºäºæé«æ¯è¾æçï¼ä½¿ç¨equalsæ¯é²æ­¢æhashCodeå²çªï¼å¦BMåC.ï¼\n   * ç¬¬äºä¸ªç¨æ¥æ ¹æ®xçå¼æ¥å³å®è¾åºè¯­å¥\n\n# switchæä¸¾\n\npublic class Demo7 {\n   public static void main(String[] args) {\n      SEX sex = SEX.MALE;\n      switch (sex) {\n         case MALE:\n            System.out.println("man");\n            break;\n         case FEMALE:\n            System.out.println("woman");\n            break;\n         default:\n            break;\n      }\n   }\n}\n\nenum SEX {\n   MALE, FEMALE;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nç¼è¯å¨ä¸­æ§è¡çä»£ç å¦ä¸\n\npublic class Demo7 {\n   /**     \n    * å®ä¹ä¸ä¸ªåæç±»ï¼ä» jvm ä½¿ç¨ï¼å¯¹æä»¬ä¸å¯è§ï¼     \n    * ç¨æ¥æ å°æä¸¾ç ordinal ä¸æ°ç»åç´ çå³ç³»     \n    * æä¸¾ç ordinal è¡¨ç¤ºæä¸¾å¯¹è±¡çåºå·ï¼ä» 0 å¼å§     \n    * å³ MALE ç ordinal()=0ï¼FEMALE ç ordinal()=1     \n    */ \n   static class $MAP {\n      //æ°ç»å¤§å°å³ä¸ºæä¸¾åç´ ä¸ªæ°ï¼éé¢å­æ¾äºcaseç¨äºæ¯è¾çæ°å­\n      static int[] map = new int[2];\n      static {\n         //ordinalå³æä¸¾åç´ å¯¹åºæå¨çä½ç½®ï¼MALEä¸º0ï¼FEMALEä¸º1\n         map[SEX.MALE.ordinal()] = 1;\n         map[SEX.FEMALE.ordinal()] = 2;\n      }\n   }\n\n   public static void main(String[] args) {\n      SEX sex = SEX.MALE;\n      //å°å¯¹åºä½ç½®æä¸¾åç´ çå¼èµç»xï¼ç¨äºcaseæä½\n      int x = $MAP.map[sex.ordinal()];\n      switch (x) {\n         case 1:\n            System.out.println("man");\n            break;\n         case 2:\n            System.out.println("woman");\n            break;\n         default:\n            break;\n      }\n   }\n}\n\nenum SEX {\n   MALE, FEMALE;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n\n\n# æä¸¾ç±»\n\nenum SEX {\n   MALE, FEMALE;\n}\n\n\n1\n2\n3\n\n\nè½¬æ¢åçä»£ç \n\npublic final class Sex extends Enum<Sex> {   \n   //å¯¹åºæä¸¾ç±»ä¸­çåç´ \n   public static final Sex MALE;    \n   public static final Sex FEMALE;    \n   private static final Sex[] $VALUES;\n   \n    static {       \n    \t//è°ç¨æé å½æ°ï¼ä¼ å¥æä¸¾åç´ çå¼åordinal\n    \tMALE = new Sex("MALE", 0);    \n        FEMALE = new Sex("FEMALE", 1);   \n        $VALUES = new Sex[]{MALE, FEMALE}; \n   }\n \t\n   //è°ç¨ç¶ç±»ä¸­çæ¹æ³\n    private Sex(String name, int ordinal) {     \n        super(name, ordinal);    \n    }\n   \n    public static Sex[] values() {  \n        return $VALUES.clone();  \n    }\n    public static Sex valueOf(String name) { \n        return Enum.valueOf(Sex.class, name);  \n    } \n   \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n# å¿ååé¨ç±»\n\npublic class Demo8 {\n   public static void main(String[] args) {\n      Runnable runnable = new Runnable() {\n         @Override\n         public void run() {\n            System.out.println("running...");\n         }\n      };\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nè½¬æ¢åçä»£ç \n\npublic class Demo8 {\n   public static void main(String[] args) {\n      //ç¨é¢å¤åå»ºçç±»æ¥åå»ºå¿ååé¨ç±»å¯¹è±¡\n      Runnable runnable = new Demo8$1();\n   }\n}\n\n//åå»ºäºä¸ä¸ªé¢å¤çç±»ï¼å®ç°äºRunnableæ¥å£\nfinal class Demo8$1 implements Runnable {\n   public Demo8$1() {}\n\n   @Override\n   public void run() {\n      System.out.println("running...");\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¦æå¿ååé¨ç±»ä¸­å¼ç¨äºå±é¨åé\n\npublic class Demo8 {\n   public static void main(String[] args) {\n      int x = 1;\n      Runnable runnable = new Runnable() {\n         @Override\n         public void run() {\n            System.out.println(x);\n         }\n      };\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nè½¬ååä»£ç \n\npublic class Demo8 {\n   public static void main(String[] args) {\n      int x = 1;\n      Runnable runnable = new Runnable() {\n         @Override\n         public void run() {\n            System.out.println(x);\n         }\n      };\n   }\n}\n\nfinal class Demo8$1 implements Runnable {\n   //å¤åå»ºäºä¸ä¸ªåé\n   int val$x;\n   //åä¸ºäºæåæé å¨\n   public Demo8$1(int x) {\n      this.val$x = x;\n   }\n\n   @Override\n   public void run() {\n      System.out.println(val$x);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n\n# 4ãç±»å è½½é¶æ®µ\n\n# å è½½\n\n * å°ç±»çå­èç è½½å¥\n   \n   æ¹æ³åº\n   \n   ï¼1.8åä¸ºåç©ºé´ï¼å¨æ¬å°åå­ä¸­ï¼ä¸­ï¼åé¨éç¨ C++ ç instanceKlass æè¿° java ç±»ï¼å®çéè¦ ï¬eld æï¼\n   \n   * _java_mirror å³ java çç±»éåï¼ä¾å¦å¯¹ String æ¥è¯´ï¼å®çéåç±»å°±æ¯ String.classï¼ä½ç¨æ¯æ klass æ´é²ç» java ä½¿ç¨\n   * _super å³ç¶ç±»\n   * _ï¬elds å³æååé\n   * _methods å³æ¹æ³\n   * _constants å³å¸¸éæ± \n   * _class_loader å³ç±»å è½½å¨\n   * _vtable èæ¹æ³è¡¨\n   * _itable æ¥å£æ¹æ³\n\n * å¦æè¿ä¸ªç±»è¿æç¶ç±»æ²¡æå è½½ï¼åå è½½ç¶ç±»\n\n * å è½½åé¾æ¥å¯è½æ¯äº¤æ¿è¿è¡ç\n\n\n\n * instanceKlassä¿å­å¨æ¹æ³åºãJDK 8ä»¥åï¼æ¹æ³åºä½äºåç©ºé´ä¸­ï¼èåç©ºé´åä½äºæ¬å°åå­ä¸­\n * _java_mirroråæ¯ä¿å­å¨å åå­ä¸­\n * InstanceKlasså*.class(JAVAéåç±»)äºç¸ä¿å­äºå¯¹æ¹çå°å\n * ç±»çå¯¹è±¡å¨å¯¹è±¡å¤´ä¸­ä¿å­äº*.classçå°åãè®©å¯¹è±¡å¯ä»¥éè¿å¶æ¾å°æ¹æ³åºä¸­çinstanceKlassï¼ä»èè·åç±»çåç§ä¿¡æ¯\n\n# é¾æ¥\n\n# éªè¯\n\néªè¯ç±»æ¯å¦ç¬¦å JVMè§èï¼å®å¨æ§æ£æ¥\n\n# åå¤\n\nä¸º static åéåéç©ºé´ï¼è®¾ç½®é»è®¤å¼\n\n * staticåéå¨JDK 7ä»¥åæ¯å­å¨ä¸instanceKlassæ«å°¾ãä½å¨JDK 7ä»¥åå°±å­å¨å¨_java_mirroræ«å°¾äº\n * staticåéå¨åéç©ºé´åèµå¼æ¯å¨ä¸¤ä¸ªé¶æ®µå®æçãåéç©ºé´å¨åå¤é¶æ®µå®æï¼èµå¼å¨åå§åé¶æ®µå®æ\n * å¦æ static åéæ¯ ï¬nal çåºæ¬ç±»åï¼ä»¥åå­ç¬¦ä¸²å¸¸éï¼é£ä¹ç¼è¯é¶æ®µå¼å°±ç¡®å®äºï¼èµå¼å¨åå¤é¶æ®µå®æ\n * å¦æ static åéæ¯ ï¬nal çï¼ä½å±äºå¼ç¨ç±»åï¼é£ä¹èµå¼ä¹ä¼å¨åå§åé¶æ®µå®æ\n\n# è§£æ\n\nHSDBçä½¿ç¨\n\n * åè·å¾è¦æ¥ççè¿ç¨ID\n\njps\n\n\n1\n\n * æå¼HSDB\n\njava -cp F:\\JAVA\\JDK8.0\\lib\\sa-jdi.jar sun.jvm.hotspot.HSDB\n\n\n1\n\n * è¿è¡æ¶å¯è½ä¼æ¥éï¼æ¯å ä¸ºç¼ºå°ä¸ä¸ª.dllçæä»¶ï¼æä»¬å¨JDKçå®è£ç®å½ä¸­æ¾å°è¯¥æä»¶ï¼å¤å¶å°ç¼ºå¤±çæä»¶ä¸å³å¯\n\n\n\n * å®ä½éè¦çè¿ç¨\n\n\n\n\n\nè§£æçå«ä¹\n\nå°å¸¸éæ± ä¸­çç¬¦å·å¼ç¨è§£æä¸ºç´æ¥å¼ç¨\n\n * æªè§£ææ¶ï¼å¸¸éæ± ä¸­ççå°çå¯¹è±¡ä»æ¯ç¬¦å·ï¼æªçæ­£çå­å¨äºåå­ä¸­\n\npublic class Demo1 {\n   public static void main(String[] args) throws IOException, ClassNotFoundException {\n      ClassLoader loader = Demo1.class.getClassLoader();\n      //åªå è½½ä¸è§£æ\n      Class<?> c = loader.loadClass("com.nyima.JVM.day8.C");\n      //ç¨äºé»å¡ä¸»çº¿ç¨\n      System.in.read();\n   }\n}\n\nclass C {\n   D d = new D();\n}\n\nclass D {\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n * æå¼HSDB\n   * å¯ä»¥çå°æ­¤æ¶åªå è½½äºç±»C\n\n\n\næ¥çç±»Cçå¸¸éæ± ï¼å¯ä»¥çå°ç±»Dæªè¢«è§£æï¼åªæ¯å­å¨äºå¸¸éæ± ä¸­çç¬¦å·\n\n\n\n * è§£æä»¥åï¼ä¼å°å¸¸éæ± ä¸­çç¬¦å·å¼ç¨è§£æä¸ºç´æ¥å¼ç¨\n   \n   * å¯ä»¥çå°ï¼æ­¤æ¶å·²å è½½å¹¶è§£æäºç±»Cåç±»D\n   \n   \n\n\n\n# åå§å\n\nåå§åé¶æ®µå°±æ¯æ§è¡ç±»æé å¨clinit()æ¹æ³çè¿ç¨ï¼èææºä¼ä¿è¯è¿ä¸ªç±»çãæé æ¹æ³ãççº¿ç¨å®å¨\n\n * clinit()æ¹æ³æ¯ç±ç¼è¯å¨èªå¨æ¶éç±»ä¸­çææç±»åéçèµå¼å¨ä½åéæè¯­å¥åï¼static{}åï¼ä¸­çè¯­å¥åå¹¶äº§çç\n\næ³¨æ\n\nç¼è¯å¨æ¶éçé¡ºåºæ¯ç±è¯­å¥å¨æºæä»¶ä¸­åºç°çé¡ºåºå³å®çï¼éæè¯­å¥åä¸­åªè½è®¿é®å°å®ä¹å¨éæè¯­å¥åä¹åçåéï¼å®ä¹å¨å®ä¹åçåéï¼å¨åé¢çéæè¯­å¥åå¯ä»¥èµå¼ï¼ä½æ¯ä¸è½è®¿é®ï¼å¦\n\n\n\n# åçæ¶æº\n\nç±»çåå§åçææ°çï¼ä»¥ä¸æåµä¼åå§å\n\n * main æ¹æ³æå¨çç±»ï¼æ»ä¼è¢«é¦ååå§å\n * é¦æ¬¡è®¿é®è¿ä¸ªç±»çéæåéæéææ¹æ³æ¶\n * å­ç±»åå§åï¼å¦æç¶ç±»è¿æ²¡åå§åï¼ä¼å¼å\n * å­ç±»è®¿é®ç¶ç±»çéæåéï¼åªä¼è§¦åç¶ç±»çåå§å\n * Class.forName\n * new ä¼å¯¼è´åå§å\n\nä»¥ä¸æåµä¸ä¼åå§å\n\n * è®¿é®ç±»ç static ï¬nal éæå¸¸éï¼åºæ¬ç±»ååå­ç¬¦ä¸²ï¼\n * ç±»å¯¹è±¡.class ä¸ä¼è§¦ååå§å\n * åå»ºè¯¥ç±»å¯¹è±¡çæ°ç»\n * ç±»å è½½å¨ç.loadClassæ¹æ³\n * Class.forNamedçåæ°2ä¸ºfalseæ¶\n\néªè¯ç±»æ¯å¦è¢«åå§åï¼å¯ä»¥çæ¹ç±»çéæä»£ç åæ¯å¦è¢«æ§è¡\n\n\n# 5ãç±»å è½½å¨\n\nJavaèææºè®¾è®¡å¢éæææç±»å è½½é¶æ®µä¸­ç**âéè¿ä¸ä¸ªç±»çå¨éå®åæ¥è·åæè¿°è¯¥ç±»çäºè¿å¶å­èæµâè¿ä¸ªå¨ä½æ¾å°Javaèææºå¤é¨å»å®ç°ï¼ä»¥ä¾¿è®©åºç¨ç¨åºèªå·±å³å®å¦ä½å»è·åæéçç±»ãå®ç°è¿ä¸ªå¨ä½çä»£ç è¢«ç§°ä¸ºâç±»å è½½å¨â**ï¼ClassLoaderï¼\n\n# ç±»ä¸ç±»å è½½å¨\n\nç±»å è½½å¨è½ç¶åªç¨äºå®ç°ç±»çå è½½å¨ä½ï¼ä½å®å¨Javaç¨åºä¸­èµ·å°çä½ç¨å´è¿è¶ç±»å è½½é¶æ®µ\n\nå¯¹äºä»»æä¸ä¸ªç±»ï¼é½å¿é¡»ç±å è½½å®çç±»å è½½å¨åè¿ä¸ªç±»æ¬èº«ä¸èµ·å±åç¡®ç«å¶å¨Javaèææºä¸­çå¯ä¸æ§ï¼æ¯ä¸ä¸ªç±»å è½½å¨ï¼é½æ¥æä¸ä¸ªç¬ç«çç±»åç§°ç©ºé´ãè¿å¥è¯å¯ä»¥è¡¨è¾¾å¾æ´éä¿ä¸äºï¼æ¯è¾ä¸¤ä¸ªç±»æ¯å¦âç¸ç­âï¼åªæå¨è¿ä¸¤ä¸ªç±»æ¯ç±åä¸ä¸ªç±»å è½½å¨å è½½çåæä¸æææä¹ï¼å¦åï¼å³ä½¿è¿ä¸¤ä¸ªç±»æ¥æºäºåä¸ä¸ªClassæä»¶ï¼è¢«åä¸ä¸ªJavaèææºå è½½ï¼åªè¦å è½½å®ä»¬çç±»å è½½å¨ä¸åï¼é£è¿ä¸¤ä¸ªç±»å°±å¿å®ä¸ç¸ç­\n\nä»¥JDK 8ä¸ºä¾\n\nåç§°                                  å è½½çç±»                    è¯´æ\nBootstrap ClassLoaderï¼å¯å¨ç±»å è½½å¨ï¼       JAVA_HOME/jre/lib       æ æ³ç´æ¥è®¿é®\nExtension ClassLoader(æå±ç±»å è½½å¨)       JAVA_HOME/jre/lib/ext   ä¸çº§ä¸ºBootstrapï¼æ¾ç¤ºä¸ºnull\nApplication ClassLoader(åºç¨ç¨åºç±»å è½½å¨)   classpath               ä¸çº§ä¸ºExtension\nèªå®ä¹ç±»å è½½å¨                             èªå®ä¹                     ä¸çº§ä¸ºApplication\n\n# å¯å¨ç±»å è½½å¨\n\nå¯éè¿å¨æ§å¶å°è¾å¥æä»¤ï¼ä½¿å¾ç±»è¢«å¯å¨ç±»å å¨å è½½\n\n# æå±ç±»å è½½å¨\n\nå¦æclasspathåJAVA_HOME/jre/lib/ext ä¸æååç±»ï¼å è½½æ¶ä¼ä½¿ç¨æå±ç±»å è½½å¨å è½½ãå½åºç¨ç¨åºç±»å è½½å¨åç°æå±ç±»å è½½å¨å·²å°è¯¥ååç±»å è½½è¿äºï¼åä¸ä¼åæ¬¡å è½½\n\n# åäº²å§æ´¾æ¨¡å¼\n\nåäº²å§æ´¾æ¨¡å¼ï¼å³è°ç¨ç±»å è½½å¨ClassLoader ç loadClass æ¹æ³æ¶ï¼æ¥æ¾ç±»çè§å\n\nloadClassæºç \n\nprotected Class<?> loadClass(String name, boolean resolve)\n    throws ClassNotFoundException\n{\n    synchronized (getClassLoadingLock(name)) {\n        // é¦åæ¥æ¾è¯¥ç±»æ¯å¦å·²ç»è¢«è¯¥ç±»å è½½å¨å è½½è¿äº\n        Class<?> c = findLoadedClass(name);\n        //å¦ææ²¡æè¢«å è½½è¿\n        if (c == null) {\n            long t0 = System.nanoTime();\n            try {\n                //çæ¯å¦è¢«å®çä¸çº§å è½½å¨å è½½è¿äº Extensionçä¸çº§æ¯Bootstarpï¼ä½å®æ¾ç¤ºä¸ºnull\n                if (parent != null) {\n                    c = parent.loadClass(name, false);\n                } else {\n                    //çæ¯å¦è¢«å¯å¨ç±»å è½½å¨å è½½è¿\n                    c = findBootstrapClassOrNull(name);\n                }\n            } catch (ClassNotFoundException e) {\n                // ClassNotFoundException thrown if class not found\n                // from the non-null parent class loader\n                //æè·å¼å¸¸ï¼ä½ä¸åä»»ä½å¤ç\n            }\n\n            if (c == null) {\n                //å¦æè¿æ¯æ²¡ææ¾å°ï¼åè®©æå±ç±»å è½½å¨è°ç¨findClassæ¹æ³å»æ¾å°è¯¥ç±»ï¼å¦æè¿æ¯æ²¡æ¾å°ï¼å°±æåºå¼å¸¸\n                //ç¶åè®©åºç¨ç±»å è½½å¨å»æ¾classpathä¸æ¾è¯¥ç±»\n                long t1 = System.nanoTime();\n                c = findClass(name);\n\n                // è®°å½æ¶é´\n                sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);\n                sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);\n                sun.misc.PerfCounter.getFindClasses().increment();\n            }\n        }\n        if (resolve) {\n            resolveClass(c);\n        }\n        return c;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n\n\n# èªå®ä¹ç±»å è½½å¨\n\n# ä½¿ç¨åºæ¯\n\n * æ³å è½½é classpath éæè·¯å¾ä¸­çç±»æä»¶\n * éè¿æ¥å£æ¥ä½¿ç¨å®ç°ï¼å¸æè§£è¦æ¶ï¼å¸¸ç¨å¨æ¡æ¶è®¾è®¡\n * è¿äºç±»å¸æäºä»¥éç¦»ï¼ä¸ååºç¨çååç±»é½å¯ä»¥å è½½ï¼ä¸å²çªï¼å¸¸è§äº tomcat å®¹å¨\n\n# æ­¥éª¤\n\n * ç»§æ¿ClassLoaderç¶ç±»\n * è¦éµä»åäº²å§æ´¾æºå¶ï¼éå ï¬ndClass æ¹æ³\n   * ä¸æ¯éåloadClassæ¹æ³ï¼å¦åä¸ä¼èµ°åäº²å§æ´¾æºå¶\n * è¯»åç±»æä»¶çå­èç \n * è°ç¨ç¶ç±»ç deï¬neClass æ¹æ³æ¥å è½½ç±»\n * ä½¿ç¨èè°ç¨è¯¥ç±»å è½½å¨ç loadClass æ¹æ³\n\n# ç ´ååäº²å§æ´¾æ¨¡å¼\n\n * åäº²å§æ´¾æ¨¡åçç¬¬ä¸æ¬¡âè¢«ç ´åâå¶å®åçå¨åäº²å§æ´¾æ¨¡ååºç°ä¹åââå³JDK1.2é¢ä¸ä»¥åçâè¿å¤âæ¶ä»£\n   * å»ºè®®ç¨æ·éåfindClass()æ¹æ³ï¼å¨ç±»å è½½å¨ä¸­çloadClass()æ¹æ³ä¸­ä¹ä¼è°ç¨è¯¥æ¹æ³\n * åäº²å§æ´¾æ¨¡åçç¬¬äºæ¬¡âè¢«ç ´åâæ¯ç±è¿ä¸ªæ¨¡åèªèº«çç¼ºé·å¯¼è´ç\n   * å¦ææåºç¡ç±»ååè¦è°ç¨åç¨æ·çä»£ç ï¼æ­¤æ¶ä¹ä¼ç ´ååäº²å§æ´¾æ¨¡å¼\n * åäº²å§æ´¾æ¨¡åçç¬¬ä¸æ¬¡âè¢«ç ´åâæ¯ç±äºç¨æ·å¯¹ç¨åºå¨ææ§çè¿½æ±èå¯¼è´ç\n   * è¿éæè¯´çâå¨ææ§âæçæ¯ä¸äºéå¸¸âç­âé¨çåè¯ï¼ä»£ç ç­æ¿æ¢ï¼Hot Swapï¼ãæ¨¡åç­é¨ç½²ï¼Hot Deploymentï¼ç­\n\n\n# 6ãè¿è¡æä¼å\n\n# åå±ç¼è¯\n\nJVM å°æ§è¡ç¶æåæäº 5 ä¸ªå±æ¬¡ï¼\n\n * 0å±ï¼è§£éæ§è¡ï¼ç¨è§£éå¨å°å­èç ç¿»è¯ä¸ºæºå¨ç \n * 1å±ï¼ä½¿ç¨ C1 å³æ¶ç¼è¯å¨ç¼è¯æ§è¡ï¼ä¸å¸¦ proï¬lingï¼\n * 2å±ï¼ä½¿ç¨ C1 å³æ¶ç¼è¯å¨ç¼è¯æ§è¡ï¼å¸¦åºæ¬çprofilingï¼\n * 3å±ï¼ä½¿ç¨ C1 å³æ¶ç¼è¯å¨ç¼è¯æ§è¡ï¼å¸¦å®å¨çprofilingï¼\n * 4å±ï¼ä½¿ç¨ C2 å³æ¶ç¼è¯å¨ç¼è¯æ§è¡\n\nproï¬ling æ¯æå¨è¿è¡è¿ç¨ä¸­æ¶éä¸äºç¨åºæ§è¡ç¶æçæ°æ®ï¼ä¾å¦ãæ¹æ³çè°ç¨æ¬¡æ°ãï¼ãå¾ªç¯ç åè¾¹æ¬¡æ°ãç­\n\n# å³æ¶ç¼è¯å¨ï¼JITï¼ä¸è§£éå¨çåºå«\n\n * è§£éå¨\n   * å°å­èç è§£éä¸ºæºå¨ç ï¼ä¸æ¬¡å³ä½¿éå°ç¸åçå­èç ï¼ä»ä¼æ§è¡éå¤çè§£é\n   * æ¯å°å­èç è§£éä¸ºéå¯¹ææå¹³å°é½éç¨çæºå¨ç \n * å³æ¶ç¼è¯å¨\n   * å°ä¸äºå­èç ç¼è¯ä¸ºæºå¨ç ï¼å¹¶å­å¥ Code Cacheï¼ä¸æ¬¡éå°ç¸åçä»£ç ï¼ç´æ¥æ§è¡ï¼æ éåç¼è¯\n   * æ ¹æ®å¹³å°ç±»åï¼çæå¹³å°ç¹å®çæºå¨ç \n\nå¯¹äºå¤§é¨åçä¸å¸¸ç¨çä»£ç ï¼æä»¬æ éèè´¹æ¶é´å°å¶ç¼è¯ææºå¨ç ï¼èæ¯éåè§£éæ§è¡çæ¹å¼è¿è¡ï¼å¦ä¸æ¹é¢ï¼å¯¹äºä»å æ®å°é¨åçç­ç¹ä»£ç ï¼æä»¬åå¯ä»¥å°å¶ç¼è¯ææºå¨ç ï¼ä»¥è¾¾å°çæ³çè¿è¡éåº¦ã æ§è¡æçä¸ç®åæ¯è¾ä¸ä¸ Interpreter < C1 < C2ï¼æ»çç®æ æ¯åç°ç­ç¹ä»£ç ï¼hotspotåç§°çç± æ¥ï¼ï¼å¹¶ä¼åè¿äºç­ç¹ä»£ç \n\n# éé¸åæ\n\néé¸åæï¼Escape Analysisï¼ç®åæ¥è®²å°±æ¯ï¼Java Hotspot èææºå¯ä»¥åææ°åå»ºå¯¹è±¡çä½¿ç¨èå´ï¼å¹¶å³å®æ¯å¦å¨ Java å ä¸åéåå­çä¸é¡¹ææ¯\n\néé¸åæç JVM åæ°å¦ä¸ï¼\n\n * å¼å¯éé¸åæï¼-XX:+DoEscapeAnalysis\n * å³é­éé¸åæï¼-XX:-DoEscapeAnalysis\n * æ¾ç¤ºåæç»æï¼-XX:+PrintEscapeAnalysis\n\néé¸åæææ¯å¨ Java SE 6u23+ å¼å§æ¯æï¼å¹¶é»è®¤è®¾ç½®ä¸ºå¯ç¨ç¶æï¼å¯ä»¥ä¸ç¨é¢å¤å è¿ä¸ªåæ°\n\nå¯¹è±¡éé¸ç¶æ\n\nå¨å±éé¸ï¼GlobalEscapeï¼\n\n * å³ä¸ä¸ªå¯¹è±¡çä½ç¨èå´éåºäºå½åæ¹æ³æèå½åçº¿ç¨ï¼æä»¥ä¸å ç§åºæ¯ï¼\n   * å¯¹è±¡æ¯ä¸ä¸ªéæåé\n   * å¯¹è±¡æ¯ä¸ä¸ªå·²ç»åçéé¸çå¯¹è±¡\n   * å¯¹è±¡ä½ä¸ºå½åæ¹æ³çè¿åå¼\n\nåæ°éé¸ï¼ArgEscapeï¼\n\n * å³ä¸ä¸ªå¯¹è±¡è¢«ä½ä¸ºæ¹æ³åæ°ä¼ éæèè¢«åæ°å¼ç¨ï¼ä½å¨è°ç¨è¿ç¨ä¸­ä¸ä¼åçå¨å±éé¸ï¼è¿ä¸ªç¶ææ¯éè¿è¢«è°æ¹æ³çå­èç ç¡®å®ç\n\næ²¡æéé¸\n\n * å³æ¹æ³ä¸­çå¯¹è±¡æ²¡æåçéé¸\n\néé¸åæä¼å\n\néå¯¹ä¸é¢ç¬¬ä¸ç¹ï¼å½ä¸ä¸ªå¯¹è±¡æ²¡æéé¸æ¶ï¼å¯ä»¥å¾å°ä»¥ä¸å ä¸ªèææºçä¼å\n\néæ¶é¤\n\næä»¬ç¥éçº¿ç¨åæ­¥éæ¯éå¸¸çºç²æ§è½çï¼å½ç¼è¯å¨ç¡®å®å½åå¯¹è±¡åªæå½åçº¿ç¨ä½¿ç¨ï¼é£ä¹å°±ä¼ç§»é¤è¯¥å¯¹è±¡çåæ­¥é\n\nä¾å¦ï¼StringBuffer å Vector é½æ¯ç¨ synchronized ä¿®é¥°çº¿ç¨å®å¨çï¼ä½å¤§é¨åæåµä¸ï¼å®ä»¬é½åªæ¯å¨å½åçº¿ç¨ä¸­ç¨å°ï¼è¿æ ·ç¼è¯å¨å°±ä¼ä¼åç§»é¤æè¿äºéæä½\n\néæ¶é¤ç JVM åæ°å¦ä¸ï¼\n\n * å¼å¯éæ¶é¤ï¼-XX:+EliminateLocks\n * å³é­éæ¶é¤ï¼-XX:-EliminateLocks\n\néæ¶é¤å¨ JDK8 ä¸­é½æ¯é»è®¤å¼å¯çï¼å¹¶ä¸éæ¶é¤é½è¦å»ºç«å¨éé¸åæçåºç¡ä¸\n\næ éæ¿æ¢\n\né¦åè¦æç½æ éåèåéï¼åºç¡ç±»ååå¯¹è±¡çå¼ç¨å¯ä»¥çè§£ä¸ºæ éï¼å®ä»¬ä¸è½è¢«è¿ä¸æ­¥åè§£ãèè½è¢«è¿ä¸æ­¥åè§£çéå°±æ¯èåéï¼æ¯å¦ï¼å¯¹è±¡\n\nå¯¹è±¡æ¯èåéï¼å®åå¯ä»¥è¢«è¿ä¸æ­¥åè§£ææ éï¼å°å¶æååéåè§£ä¸ºåæ£çåéï¼è¿å°±å«åæ éæ¿æ¢ã\n\nè¿æ ·ï¼å¦æä¸ä¸ªå¯¹è±¡æ²¡æåçéé¸ï¼é£åæ ¹å°±ä¸ç¨åå»ºå®ï¼åªä¼å¨æ æèå¯å­å¨ä¸åå»ºå®ç¨å°çæåæ éï¼èçäºåå­ç©ºé´ï¼ä¹æåäºåºç¨ç¨åºæ§è½\n\næ éæ¿æ¢ç JVM åæ°å¦ä¸ï¼\n\n * å¼å¯æ éæ¿æ¢ï¼-XX:+EliminateAllocations\n * å³é­æ éæ¿æ¢ï¼-XX:-EliminateAllocations\n * æ¾ç¤ºæ éæ¿æ¢è¯¦æï¼-XX:+PrintEliminateAllocations\n\næ éæ¿æ¢åæ ·å¨ JDK8 ä¸­é½æ¯é»è®¤å¼å¯çï¼å¹¶ä¸é½è¦å»ºç«å¨éé¸åæçåºç¡ä¸\n\næ ä¸åé\n\nå½å¯¹è±¡æ²¡æåçéé¸æ¶ï¼è¯¥å¯¹è±¡å°±å¯ä»¥éè¿æ éæ¿æ¢åè§£ææåæ éåéå¨æ åå­ä¸­ï¼åæ¹æ³ççå½å¨æä¸è´ï¼éçæ å¸§åºæ æ¶éæ¯ï¼åå°äº GC ååï¼æé«äºåºç¨ç¨åºæ§è½\n\n# æ¹æ³åè\n\n# åèå½æ°\n\nåèå½æ°å°±æ¯å¨ç¨åºç¼è¯æ¶ï¼ç¼è¯å¨å°ç¨åºä¸­åºç°çåèå½æ°çè°ç¨è¡¨è¾¾å¼ç¨åèå½æ°çå½æ°ä½æ¥ç´æ¥è¿è¡æ¿æ¢\n\n# JVMåèå½æ°\n\nC++æ¯å¦ä¸ºåèå½æ°ç±èªå·±å³å®ï¼Javaç±ç¼è¯å¨å³å®ãJavaä¸æ¯æç´æ¥å£°æä¸ºåèå½æ°çï¼å¦ææ³è®©ä»åèï¼ä½ åªè½å¤åç¼è¯å¨æåºè¯·æ±: å³é®å­finalä¿®é¥° ç¨æ¥ææé£ä¸ªå½æ°æ¯å¸æè¢«JVMåèçï¼å¦\n\npublic final void doSomething() {  \n        // to do something  \n}\n\n\n1\n2\n3\n\n\næ»çæ¥è¯´ï¼ä¸è¬çå½æ°é½ä¸ä¼è¢«å½ååèå½æ°ï¼åªæå£°æäºfinalåï¼ç¼è¯å¨æä¼èèæ¯ä¸æ¯è¦æä½ çå½æ°åæåèå½æ°\n\nJVMåå»ºæè®¸å¤è¿è¡æ¶ä¼åãé¦åç­æ¹æ³æ´å©äºJVMæ¨æ­ãæµç¨æ´ææ¾ï¼ä½ç¨åæ´ç­ï¼å¯ä½ç¨ä¹æ´ææ¾ãå¦ææ¯é¿æ¹æ³JVMå¯è½ç´æ¥å°±è·ªäºã\n\nç¬¬äºä¸ªåå åæ´éè¦ï¼æ¹æ³åè\n\nå¦æJVMçæµå°ä¸äºå°æ¹æ³è¢«é¢ç¹çæ§è¡ï¼å®ä¼ææ¹æ³çè°ç¨æ¿æ¢ææ¹æ³ä½æ¬èº«ï¼å¦ï¼\n\nprivate int add4(int x1, int x2, int x3, int x4) { \n\t\t//è¿éè°ç¨äºadd2æ¹æ³\n        return add2(x1, x2) + add2(x3, x4);  \n    }  \n\n    private int add2(int x1, int x2) {  \n        return x1 + x2;  \n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ¹æ³è°ç¨è¢«æ¿æ¢å\n\nprivate int add4(int x1, int x2, int x3, int x4) {  \n    \t//è¢«æ¿æ¢ä¸ºäºæ¹æ³æ¬èº«\n        return x1 + x2 + x3 + x4;  \n    }\n\n\n1\n2\n3\n4\n\n\n# åå°ä¼å\n\npublic class Reflect1 {\n   public static void foo() {\n      System.out.println("foo...");\n   }\n\n   public static void main(String[] args) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {\n      Method foo = Demo3.class.getMethod("foo");\n      for(int i = 0; i<=16; i++) {\n         foo.invoke(null);\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nfoo.invoke åé¢ 0 ~ 15 æ¬¡è°ç¨ä½¿ç¨çæ¯ MethodAccessor ç NativeMethodAccessorImpl å®ç°\n\ninvokeæ¹æ³æºç \n\n@CallerSensitive\npublic Object invoke(Object obj, Object... args)\n    throws IllegalAccessException, IllegalArgumentException,\n       InvocationTargetException\n{\n    if (!override) {\n        if (!Reflection.quickCheckMemberAccess(clazz, modifiers)) {\n            Class<?> caller = Reflection.getCallerClass();\n            checkAccess(caller, clazz, obj, modifiers);\n        }\n    }\n    //MethodAccessoræ¯ä¸ä¸ªæ¥å£ï¼æ3ä¸ªå®ç°ç±»ï¼å¶ä¸­æä¸ä¸ªæ¯æ½è±¡ç±»\n    MethodAccessor ma = methodAccessor;             // read volatile\n    if (ma == null) {\n        ma = acquireMethodAccessor();\n    }\n    return ma.invoke(obj, args);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\nä¼ç±DelegatingMehodAccessorImplå»è°ç¨NativeMethodAccessorImpl\n\nNativeMethodAccessorImplæºç \n\nclass NativeMethodAccessorImpl extends MethodAccessorImpl {\n    private final Method method;\n    private DelegatingMethodAccessorImpl parent;\n    private int numInvocations;\n\n    NativeMethodAccessorImpl(Method var1) {\n        this.method = var1;\n    }\n\t\n\t//æ¯æ¬¡è¿è¡åå°è°ç¨ï¼ä¼è®©numInvocationä¸ReflectionFactory.inflationThresholdçå¼ï¼15ï¼è¿è¡æ¯è¾ï¼å¹¶ä½¿ä½¿å¾numInvocationçå¼å ä¸\n\t//å¦ænumInvocation>ReflectionFactory.inflationThresholdï¼åä¼è°ç¨æ¬å°æ¹æ³invoke0æ¹æ³\n    public Object invoke(Object var1, Object[] var2) throws IllegalArgumentException, InvocationTargetException {\n        if (++this.numInvocations > ReflectionFactory.inflationThreshold() && !ReflectUtil.isVMAnonymousClass(this.method.getDeclaringClass())) {\n            MethodAccessorImpl var3 = (MethodAccessorImpl)(new MethodAccessorGenerator()).generateMethod(this.method.getDeclaringClass(), this.method.getName(), this.method.getParameterTypes(), this.method.getReturnType(), this.method.getExceptionTypes(), this.method.getModifiers());\n            this.parent.setDelegate(var3);\n        }\n\n        return invoke0(this.method, var1, var2);\n    }\n\n    void setParent(DelegatingMethodAccessorImpl var1) {\n        this.parent = var1;\n    }\n\n    private static native Object invoke0(Method var0, Object var1, Object[] var2);\n}\n//ReflectionFactory.inflationThreshold()æ¹æ³çè¿åå¼\nprivate static int inflationThreshold = 15;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n * ä¸å¼å§ifæ¡ä»¶ä¸æ»¡è¶³ï¼å°±ä¼è°ç¨æ¬å°æ¹æ³invoke0\n * éçnumInvocationçå¢å¤§ï¼å½å®å¤§äºReflectionFactory.inflationThresholdçå¼16æ¶ï¼å°±ä¼æ¬å°æ¹æ³è®¿é®å¨æ¿æ¢ä¸ºä¸ä¸ªè¿è¡æ¶å¨æçæçè®¿é®å¨ï¼æ¥æé«æç\n   * è¿æ¶ä¼ä»åå°è°ç¨åä¸ºæ­£å¸¸è°ç¨ï¼å³ç´æ¥è°ç¨ Reflect1.foo()\n\n\n\n\n# äºãåå­æ¨¡å\n\nåå¾JUC',normalizedContent:'# ä¸ãä»ä¹æ¯jvm\n\n\n# å®ä¹\n\njava virtual machineï¼javaç¨åºçè¿è¡ç¯å¢ï¼javaäºè¿å¶å­èç çè¿è¡ç¯å¢ï¼\n\n\n# å¥½å¤\n\n * ä¸æ¬¡ç¼åï¼å°å¤è¿è¡\n * èªå¨åå­ç®¡çï¼åå¾åæ¶æºå¶\n * æ°ç»ä¸æ è¶çæ£æ¥\n\n\n# æ¯è¾\n\njvm jre jdkçåºå«\n\n\n\n\n# äºãåå­ç»æ\n\n\n# æ´ä½æ¶æ\n\n\n\n\n# 1ãç¨åºè®¡æ°å¨\n\n# ä½ç¨\n\nç¨äºä¿å­jvmä¸­ä¸ä¸æ¡æè¦æ§è¡çæä»¤çå°å\n\n# ç¹ç¹\n\n * çº¿ç¨ç§æ\n   * cpuä¼ä¸ºæ¯ä¸ªçº¿ç¨åéæ¶é´çï¼å½å½åçº¿ç¨çæ¶é´çä½¿ç¨å®ä»¥åï¼cpuå°±ä¼å»æ§è¡å¦ä¸ä¸ªçº¿ç¨ä¸­çä»£ç \n   * ç¨åºè®¡æ°å¨æ¯æ¯ä¸ªçº¿ç¨æç§æçï¼å½å¦ä¸ä¸ªçº¿ç¨çæ¶é´çç¨å®ï¼åè¿åæ¥æ§è¡å½åçº¿ç¨çä»£ç æ¶ï¼éè¿ç¨åºè®¡æ°å¨å¯ä»¥ç¥éåºè¯¥æ§è¡åªä¸å¥æä»¤\n * ä¸ä¼å­å¨åå­æº¢åº\n\n\n# 2ãèææºæ \n\n# å®ä¹\n\n * æ¯ä¸ªçº¿ç¨è¿è¡éè¦çåå­ç©ºé´ï¼ç§°ä¸ºèææºæ \n * æ¯ä¸ªæ ç±å¤ä¸ªæ å¸§ç»æï¼å¯¹åºçæ¯æ¬¡è°ç¨æ¹æ³æ¶æå ç¨çåå­\n * æ¯ä¸ªçº¿ç¨åªè½æä¸ä¸ªæ´»å¨æ å¸§ï¼å¯¹åºçå½åæ­£å¨æ§è¡çæ¹æ³\n\n# æ¼ç¤º\n\nä»£ç \n\npublic class main {\n\tpublic static void main(string[] args) {\n\t\tmethod1();\n\t}\n\n\tprivate static void method1() {\n\t\tmethod2(1, 2);\n\t}\n\n\tprivate static int method2(int a, int b) {\n\t\tint c = a + b;\n\t\treturn c;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n\nå¨æ§å¶å°ä¸­å¯ä»¥çå°ï¼ä¸»ç±»ä¸­çæ¹æ³å¨è¿å¥èææºæ çæ¶åï¼ç¬¦åæ çç¹ç¹\n\n# é®é¢è¾¨æ\n\n * åå¾åæ¶æ¯å¦æ¶åæ åå­ï¼\n   * ä¸éè¦ãå ä¸ºèææºæ ä¸­æ¯ç±ä¸ä¸ªä¸ªæ å¸§ç»æçï¼å¨æ¹æ³æ§è¡å®æ¯åï¼å¯¹åºçæ å¸§å°±ä¼è¢«å¼¹åºæ ãæä»¥æ ééè¿åå¾åæ¶æºå¶å»åæ¶åå­ã\n * æ åå­çåéè¶å¤§è¶å¥½åï¼\n   * ä¸æ¯ãå ä¸ºç©çåå­æ¯ä¸å®çï¼æ åå­è¶å¤§ï¼å¯ä»¥æ¯ææ´å¤çéå½è°ç¨ï¼ä½æ¯å¯æ§è¡ççº¿ç¨æ°å°±ä¼è¶å°ã\n * æ¹æ³åçå±é¨åéæ¯å¦æ¯çº¿ç¨å®å¨çï¼\n   * å¦ææ¹æ³åå±é¨åéæ²¡æéç¦»æ¹æ³çä½ç¨èå´ï¼åæ¯çº¿ç¨å®å¨ç\n   * å¦æå¦æå±é¨åéå¼ç¨äºå¯¹è±¡ï¼å¹¶éç¦»äºæ¹æ³çä½ç¨èå´ï¼åéè¦èèçº¿ç¨å®å¨é®é¢\n\n# åå­æº¢åº\n\njava.lang.stackoverflowerror æ åå­æº¢åº\n\nåçåå \n\n * èææºæ ä¸­ï¼æ å¸§è¿å¤ï¼æ ééå½ï¼\n * æ¯ä¸ªæ å¸§æå ç¨è¿å¤§\n\n# çº¿ç¨è¿è¡è¯æ­\n\ncpuå ç¨è¿é«\n\n * linuxç¯å¢ä¸è¿è¡æäºç¨åºçæ¶åï¼å¯è½å¯¼è´cpuçå ç¨è¿é«ï¼è¿æ¶éè¦å®ä½å ç¨cpuè¿é«ççº¿ç¨\n   * topå½ä»¤ï¼æ¥çæ¯åªä¸ªè¿ç¨å ç¨cpuè¿é«\n   * ps h -eo pid, tidï¼çº¿ç¨idï¼, %cpu | grep åæéè¿topæ¥å°çè¿ç¨å· éè¿pså½ä»¤è¿ä¸æ­¥æ¥çæ¯åªä¸ªçº¿ç¨å ç¨cpuè¿é«\n   * jstack è¿ç¨id éè¿æ¥çè¿ç¨ä¸­ççº¿ç¨çnidï¼åæéè¿pså½ä»¤çå°çtidæ¥å¯¹æ¯å®ä½ï¼æ³¨æjstackæ¥æ¾åºççº¿ç¨idæ¯16è¿å¶çï¼éè¦è½¬æ¢\n\n\n# 3ãæ¬å°æ¹æ³æ \n\nä¸äºå¸¦ænativeå³é®å­çæ¹æ³å°±æ¯éè¦javaå»è°ç¨æ¬å°çcæèc++æ¹æ³ï¼å ä¸ºjavaææ¶åæ²¡æ³ç´æ¥åæä½ç³»ç»åºå±äº¤äºï¼æä»¥éè¦ç¨å°æ¬å°æ¹æ³\n\n\n# 4ãå \n\n# å®ä¹\n\néè¿newå³é®å­åå»ºçå¯¹è±¡é½ä¼è¢«æ¾å¨å åå­\n\n# ç¹ç¹\n\n * ææçº¿ç¨å±äº«ï¼å åå­ä¸­çå¯¹è±¡é½éè¦èèçº¿ç¨å®å¨é®é¢\n * æåå¾åæ¶æºå¶\n\n# å åå­æº¢åº\n\njava.lang.outofmemoryerror ï¼java heap space. å åå­æº¢åº\n\n# å åå­è¯æ­\n\njps\n\njmap\n\njconsole\n\njvirsalvm\n\n\n# 5ãæ¹æ³åº\n\n# ç»æ\n\n\n\n# åå­æº¢åº\n\n * 1.8ä»¥åä¼å¯¼è´æ°¸ä¹ä»£åå­æº¢åº\n * 1.8ä»¥åä¼å¯¼è´åç©ºé´åå­æº¢åº\n\n# å¸¸éæ± \n\näºè¿å¶å­èç çç»æï¼ç±»çåºæ¬ä¿¡æ¯ãå¸¸éæ± ãç±»çæ¹æ³å®ä¹ï¼åå«äºèææºæä»¤ï¼\n\néè¿åç¼è¯æ¥æ¥çç±»çä¿¡æ¯\n\n * è·å¾å¯¹åºç±»ç.classæä»¶\n   \n   * å¨jdkå¯¹åºçbinç®å½ä¸è¿è¡cmdï¼ä¹å¯ä»¥å¨ideaæ§å¶å°è¾å¥\n     \n     \n   \n   * è¾å¥ javac å¯¹åºç±»çç»å¯¹è·¯å¾\n     \n     f:\\java\\jdk8.0\\bin>javac f:\\thread_study\\src\\com\\nyima\\jvm\\day01\\main.java\n     \n     \n     1\n     \n     \n     è¾å¥å®æåï¼å¯¹åºçç®å½ä¸å°±ä¼åºç°ç±»ç.classæä»¶\n\n * å¨æ§å¶å°è¾å¥ javap -v ç±»çç»å¯¹è·¯å¾\n   \n   javap -v f:\\thread_study\\src\\com\\nyima\\jvm\\day01\\main.class\n   \n   \n   1\n   \n\n * ç¶åè½å¨æ§å¶å°çå°åç¼è¯ä»¥åç±»çä¿¡æ¯äº\n   \n   * ç±»çåºæ¬ä¿¡æ¯\n     \n     \n   \n   * å¸¸éæ± \n     \n     \n     \n     \n   \n   * èææºä¸­æ§è¡ç¼è¯çæ¹æ³ï¼æ¡åçæ¯çæ­£ç¼è¯æ§è¡çåå®¹ï¼#å·çåå®¹éè¦å¨å¸¸éæ± ä¸­æ¥æ¾ï¼\n     \n     \n\n# è¿è¡æ¶å¸¸éæ± \n\n * å¸¸éæ± \n   * å°±æ¯ä¸å¼ è¡¨ï¼å¦ä¸å¾ä¸­çconstant poolï¼ï¼èææºæä»¤æ ¹æ®è¿å¼ å¸¸éè¡¨æ¾å°è¦æ§è¡çç±»åãæ¹æ³åãåæ°ç±»åãå­é¢éä¿¡æ¯\n * è¿è¡æ¶å¸¸éæ± \n   * å¸¸éæ± æ¯*.classæä»¶ä¸­çï¼å½è¯¥ç±»è¢«å è½½ä»¥åï¼å®çå¸¸éæ± ä¿¡æ¯å°±ä¼æ¾å¥è¿è¡æ¶å¸¸éæ± ï¼å¹¶æéé¢çç¬¦å·å°ååä¸ºçå®å°å\n\n# å¸¸éæ± ä¸ä¸²æ± çå³ç³»\n\n# ä¸²æ± stringtable\n\nç¹å¾\n\n * å¸¸éæ± ä¸­çå­ç¬¦ä¸²ä»æ¯ç¬¦å·ï¼åªæå¨è¢«ç¨å°æ¶æä¼è½¬åä¸ºå¯¹è±¡\n * å©ç¨ä¸²æ± çæºå¶ï¼æ¥é¿åéå¤åå»ºå­ç¬¦ä¸²å¯¹è±¡\n * å­ç¬¦ä¸²åéæ¼æ¥çåçæ¯stringbuilder\n * å­ç¬¦ä¸²å¸¸éæ¼æ¥çåçæ¯ç¼è¯å¨ä¼å\n * å¯ä»¥ä½¿ç¨internæ¹æ³ï¼ä¸»å¨å°ä¸²æ± ä¸­è¿æ²¡æçå­ç¬¦ä¸²å¯¹è±¡æ¾å¥ä¸²æ± ä¸­\n * æ³¨æï¼æ è®ºæ¯ä¸²æ± è¿æ¯å éé¢çå­ç¬¦ä¸²ï¼é½æ¯å¯¹è±¡\n\nç¨æ¥æ¾å­ç¬¦ä¸²å¯¹è±¡ä¸éé¢çåç´ ä¸éå¤\n\npublic class stringtablestudy {\n\tpublic static void main(string[] args) {\n\t\tstring a = "a"; \n\t\tstring b = "b";\n\t\tstring ab = "ab";\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¸¸éæ± ä¸­çä¿¡æ¯ï¼é½ä¼è¢«å è½½å°è¿è¡æ¶å¸¸éæ± ä¸­ï¼ä½è¿æ¯a b ab ä»æ¯å¸¸éæ± ä¸­çç¬¦å·ï¼è¿æ²¡ææä¸ºjavaå­ç¬¦ä¸²\n\n0: ldc           #2                  // string a\n2: astore_1\n3: ldc           #3                  // string b\n5: astore_2\n6: ldc           #4                  // string ab\n8: astore_3\n9: return\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå½æ§è¡å° ldc #2 æ¶ï¼ä¼æç¬¦å· a åä¸º âaâ å­ç¬¦ä¸²å¯¹è±¡ï¼å¹¶æ¾å¥ä¸²æ± ä¸­ï¼hashtableç»æ ä¸å¯æ©å®¹ï¼\n\nå½æ§è¡å° ldc #3 æ¶ï¼ä¼æç¬¦å· b åä¸º âbâ å­ç¬¦ä¸²å¯¹è±¡ï¼å¹¶æ¾å¥ä¸²æ± ä¸­\n\nå½æ§è¡å° ldc #4 æ¶ï¼ä¼æç¬¦å· ab åä¸º âabâ å­ç¬¦ä¸²å¯¹è±¡ï¼å¹¶æ¾å¥ä¸²æ± ä¸­\n\næç»stringtable [âaâ, âbâ, âabâ]\n\næ³¨æï¼å­ç¬¦ä¸²å¯¹è±¡çåå»ºé½æ¯ææ°çï¼åªæå½è¿è¡å°é£ä¸è¡å­ç¬¦ä¸²ä¸å¨ä¸²æ± ä¸­ä¸å­å¨çæ¶åï¼å¦ ldc #2ï¼æ¶ï¼è¯¥å­ç¬¦ä¸²æä¼è¢«åå»ºå¹¶æ¾å¥ä¸²æ± ä¸­ã\n\nä½¿ç¨æ¼æ¥å­ç¬¦ä¸²åéå¯¹è±¡åå»ºå­ç¬¦ä¸²çè¿ç¨\n\npublic class stringtablestudy {\n\tpublic static void main(string[] args) {\n\t\tstring a = "a";\n\t\tstring b = "b";\n\t\tstring ab = "ab";\n\t\t//æ¼æ¥å­ç¬¦ä¸²å¯¹è±¡æ¥åå»ºæ°çå­ç¬¦ä¸²\n\t\tstring ab2 = a+b; \n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nåç¼è¯åçç»æ\n\n\t code:\n      stack=2, locals=5, args_size=1\n         0: ldc           #2                  // string a\n         2: astore_1\n         3: ldc           #3                  // string b\n         5: astore_2\n         6: ldc           #4                  // string ab\n         8: astore_3\n         9: new           #5                  // class java/lang/stringbuilder\n        12: dup\n        13: invokespecial #6                  // method java/lang/stringbuilder."<init>":()v\n        16: aload_1\n        17: invokevirtual #7                  // method java/lang/stringbuilder.append:(ljava/lang/string\n;)ljava/lang/stringbuilder;\n        20: aload_2\n        21: invokevirtual #7                  // method java/lang/stringbuilder.append:(ljava/lang/string\n;)ljava/lang/stringbuilder;\n        24: invokevirtual #8                  // method java/lang/stringbuilder.tostring:()ljava/lang/str\ning;\n        27: astore        4\n        29: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\néè¿æ¼æ¥çæ¹å¼æ¥åå»ºå­ç¬¦ä¸²çè¿ç¨æ¯ï¼stringbuilder().append(âaâ).append(âbâ).tostring()\n\næåçtostringæ¹æ³çè¿åå¼æ¯ä¸ä¸ªæ°çå­ç¬¦ä¸²ï¼ä½å­ç¬¦ä¸²çå¼åæ¼æ¥çå­ç¬¦ä¸²ä¸è´ï¼ä½æ¯ä¸¤ä¸ªä¸åçå­ç¬¦ä¸²ï¼ä¸ä¸ªå­å¨äºä¸²æ± ä¹ä¸­ï¼ä¸ä¸ªå­å¨äºå åå­ä¹ä¸­\n\nstring ab = "ab";\nstring ab2 = a+b;\n//ç»æä¸ºfalse,å ä¸ºabæ¯å­å¨äºä¸²æ± ä¹ä¸­ï¼ab2æ¯ç±stringbufferçtostringæ¹æ³æè¿åçä¸ä¸ªå¯¹è±¡ï¼å­å¨äºå åå­ä¹ä¸­\nsystem.out.println(ab == ab2);\n\n\n1\n2\n3\n4\n\n\nä½¿ç¨æ¼æ¥å­ç¬¦ä¸²å¸¸éå¯¹è±¡çæ¹æ³åå»ºå­ç¬¦ä¸²\n\npublic class stringtablestudy {\n\tpublic static void main(string[] args) {\n\t\tstring a = "a";\n\t\tstring b = "b";\n\t\tstring ab = "ab";\n\t\tstring ab2 = a+b;\n\t\t//ä½¿ç¨æ¼æ¥å­ç¬¦ä¸²çæ¹æ³åå»ºå­ç¬¦ä¸²\n\t\tstring ab3 = "a" + "b";\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nåç¼è¯åçç»æ\n\n \t  code:\n      stack=2, locals=6, args_size=1\n         0: ldc           #2                  // string a\n         2: astore_1\n         3: ldc           #3                  // string b\n         5: astore_2\n         6: ldc           #4                  // string ab\n         8: astore_3\n         9: new           #5                  // class java/lang/stringbuilder\n        12: dup\n        13: invokespecial #6                  // method java/lang/stringbuilder."<init>":()v\n        16: aload_1\n        17: invokevirtual #7                  // method java/lang/stringbuilder.append:(ljava/lang/string\n;)ljava/lang/stringbuilder;\n        20: aload_2\n        21: invokevirtual #7                  // method java/lang/stringbuilder.append:(ljava/lang/string\n;)ljava/lang/stringbuilder;\n        24: invokevirtual #8                  // method java/lang/stringbuilder.tostring:()ljava/lang/str\ning;\n        27: astore        4\n        //ab3åå§åæ¶ç´æ¥ä»ä¸²æ± ä¸­è·åå­ç¬¦ä¸²\n        29: ldc           #4                  // string ab\n        31: astore        5\n        33: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n * ä½¿ç¨æ¼æ¥å­ç¬¦ä¸²å¸¸éçæ¹æ³æ¥åå»ºæ°çå­ç¬¦ä¸²æ¶ï¼å ä¸ºåå®¹æ¯å¸¸éï¼javacå¨ç¼è¯æä¼è¿è¡ä¼åï¼ç»æå·²å¨ç¼è¯æç¡®å®ä¸ºabï¼èåå»ºabçæ¶åå·²ç»å¨ä¸²æ± ä¸­æ¾å¥äºâabâï¼æä»¥ab3ç´æ¥ä»ä¸²æ± ä¸­è·åå¼ï¼æä»¥è¿è¡çæä½å ab = âabâ ä¸è´ã\n * ä½¿ç¨æ¼æ¥å­ç¬¦ä¸²åéçæ¹æ³æ¥åå»ºæ°çå­ç¬¦ä¸²æ¶ï¼å ä¸ºåå®¹æ¯åéï¼åªè½å¨è¿è¡æç¡®å®å®çå¼ï¼æä»¥éè¦ä½¿ç¨stringbuilderæ¥åå»º\n\n# internæ¹æ³ 1.8\n\nè°ç¨å­ç¬¦ä¸²å¯¹è±¡çinternæ¹æ³ï¼ä¼å°è¯¥å­ç¬¦ä¸²å¯¹è±¡å°è¯æ¾å¥å°ä¸²æ± ä¸­\n\n * å¦æä¸²æ± ä¸­æ²¡æè¯¥å­ç¬¦ä¸²å¯¹è±¡ï¼åæ¾å¥æå\n * å¦ææè¯¥å­ç¬¦ä¸²å¯¹è±¡ï¼åæ¾å¥å¤±è´¥\n\næ è®ºæ¾å¥æ¯å¦æåï¼é½ä¼è¿åä¸²æ± ä¸­çå­ç¬¦ä¸²å¯¹è±¡\n\næ³¨æï¼æ­¤æ¶å¦æè°ç¨internæ¹æ³æåï¼å åå­ä¸ä¸²æ± ä¸­çå­ç¬¦ä¸²å¯¹è±¡æ¯åä¸ä¸ªå¯¹è±¡ï¼å¦æå¤±è´¥ï¼åä¸æ¯åä¸ä¸ªå¯¹è±¡\n\nä¾1\n\npublic class main {\n\tpublic static void main(string[] args) {\n\t\t//"a" "b" è¢«æ¾å¥ä¸²æ± ä¸­ï¼stråå­å¨äºå åå­ä¹ä¸­\n\t\tstring str = new string("a") + new string("b");\n\t\t//è°ç¨strçinternæ¹æ³ï¼è¿æ¶ä¸²æ± ä¸­æ²¡æ"ab"ï¼åä¼å°è¯¥å­ç¬¦ä¸²å¯¹è±¡æ¾å¥å°ä¸²æ± ä¸­ï¼æ­¤æ¶å åå­ä¸ä¸²æ± ä¸­ç"ab"æ¯åä¸ä¸ªå¯¹è±¡\n\t\tstring st2 = str.intern();\n\t\t//ç»str3èµå¼ï¼å ä¸ºæ­¤æ¶ä¸²æ± ä¸­å·²æ"ab"ï¼åç´æ¥å°ä¸²æ± ä¸­çåå®¹è¿å\n\t\tstring str3 = "ab";\n\t\t//å ä¸ºå åå­ä¸ä¸²æ± ä¸­ç"ab"æ¯åä¸ä¸ªå¯¹è±¡ï¼æä»¥ä»¥ä¸ä¸¤æ¡è¯­å¥æå°çé½ä¸ºtrue\n\t\tsystem.out.println(str == st2);\n\t\tsystem.out.println(str == str3);\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\nä¾2\n\npublic class main {\n\tpublic static void main(string[] args) {\n        //æ­¤å¤åå»ºå­ç¬¦ä¸²å¯¹è±¡"ab"ï¼å ä¸ºä¸²æ± ä¸­è¿æ²¡æ"ab"ï¼æä»¥å°å¶æ¾å¥ä¸²æ± ä¸­\n\t\tstring str3 = "ab";\n        //"a" "b" è¢«æ¾å¥ä¸²æ± ä¸­ï¼stråå­å¨äºå åå­ä¹ä¸­\n\t\tstring str = new string("a") + new string("b");\n        //æ­¤æ¶å ä¸ºå¨åå»ºstr3æ¶ï¼"ab"å·²å­å¨ä¸ä¸²æ± ä¸­ï¼æä»¥æ¾å¥å¤±è´¥ï¼ä½æ¯ä¼è¿åä¸²æ± ä¸­ç"ab"\n\t\tstring str2 = str.intern();\n        //false\n\t\tsystem.out.println(str == str2);\n        //false\n\t\tsystem.out.println(str == str3);\n        //true\n\t\tsystem.out.println(str2 == str3);\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n# internæ¹æ³ 1.6\n\nè°ç¨å­ç¬¦ä¸²å¯¹è±¡çinternæ¹æ³ï¼ä¼å°è¯¥å­ç¬¦ä¸²å¯¹è±¡å°è¯æ¾å¥å°ä¸²æ± ä¸­\n\n * å¦æä¸²æ± ä¸­æ²¡æè¯¥å­ç¬¦ä¸²å¯¹è±¡ï¼ä¼å°è¯¥å­ç¬¦ä¸²å¯¹è±¡å¤å¶ä¸ä»½ï¼åæ¾å¥å°ä¸²æ± ä¸­\n * å¦ææè¯¥å­ç¬¦ä¸²å¯¹è±¡ï¼åæ¾å¥å¤±è´¥\n\næ è®ºæ¾å¥æ¯å¦æåï¼é½ä¼è¿åä¸²æ± ä¸­çå­ç¬¦ä¸²å¯¹è±¡\n\næ³¨æï¼æ­¤æ¶æ è®ºè°ç¨internæ¹æ³æåä¸å¦ï¼ä¸²æ± ä¸­çå­ç¬¦ä¸²å¯¹è±¡åå åå­ä¸­çå­ç¬¦ä¸²å¯¹è±¡é½ä¸æ¯åä¸ä¸ªå¯¹è±¡\n\n# stringtable åå¾åæ¶\n\nstringtableå¨åå­ç´§å¼ æ¶ï¼ä¼åçåå¾åæ¶\n\n# stringtableè°ä¼\n\n * å ä¸ºstringtableæ¯ç±hashtableå®ç°çï¼æä»¥å¯ä»¥éå½å¢å hashtableæ¡¶çä¸ªæ°ï¼æ¥åå°å­ç¬¦ä¸²æ¾å¥ä¸²æ± æéè¦çæ¶é´\n   \n   -xx:stringtablesize=xxxx\n   \n   \n   1\n   \n\n * èèæ¯å¦éè¦å°å­ç¬¦ä¸²å¯¹è±¡å¥æ± \n   \n   å¯ä»¥éè¿internæ¹æ³åå°éå¤å¥æ± \n\n\n# 6ãç´æ¥åå­\n\n * å±äºæä½ç³»ç»ï¼å¸¸è§äºnioæä½æ¶ï¼ç¨äºæ°æ®ç¼å²åº\n * åéåæ¶ææ¬è¾é«ï¼ä½è¯»åæ§è½é«\n * ä¸åjvmåå­åæ¶ç®¡ç\n\n# æä»¶è¯»åæµç¨\n\n\n\nä½¿ç¨äºdirectbuffer\n\n\n\nç´æ¥åå­æ¯æä½ç³»ç»åjavaä»£ç é½å¯ä»¥è®¿é®çä¸ååºåï¼æ éå°ä»£ç ä»ç³»ç»åå­å¤å¶å°javaå åå­ï¼ä»èæé«äºæç\n\n# éæ¾åç\n\nç´æ¥åå­çåæ¶ä¸æ¯éè¿jvmçåå¾åæ¶æ¥éæ¾çï¼èæ¯éè¿unsafe.freememoryæ¥æå¨éæ¾\n\néè¿\n\n//éè¿bytebufferç³è¯·1mçç´æ¥åå­\nbytebuffer bytebuffer = bytebuffer.allocatedirect(_1m);\n\n\n1\n2\n\n\nç³è¯·ç´æ¥åå­ï¼ä½jvmå¹¶ä¸è½åæ¶ç´æ¥åå­ä¸­çåå®¹ï¼å®æ¯å¦ä½å®ç°åæ¶çå¢ï¼\n\nallocatedirectçå®ç°\n\npublic static bytebuffer allocatedirect(int capacity) {\n    return new directbytebuffer(capacity);\n}\n\n\n1\n2\n3\n\n\ndirectbytebufferç±»\n\ndirectbytebuffer(int cap) {   // package-private\n   \n    super(-1, 0, cap, cap);\n    boolean pa = vm.isdirectmemorypagealigned();\n    int ps = bits.pagesize();\n    long size = math.max(1l, (long)cap + (pa ? ps : 0));\n    bits.reservememory(size, cap);\n\n    long base = 0;\n    try {\n        base = unsafe.allocatememory(size); //ç³è¯·åå­\n    } catch (outofmemoryerror x) {\n        bits.unreservememory(size, cap);\n        throw x;\n    }\n    unsafe.setmemory(base, size, (byte) 0);\n    if (pa && (base % ps != 0)) {\n        // round up to page boundary\n        address = base + ps - (base & (ps - 1));\n    } else {\n        address = base;\n    }\n    cleaner = cleaner.create(this, new deallocator(base, size, cap)); //éè¿èå¼ç¨ï¼æ¥å®ç°ç´æ¥åå­çéæ¾ï¼thisä¸ºèå¼ç¨çå®éå¯¹è±¡\n    att = null;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\nè¿éè°ç¨äºä¸ä¸ªcleanerçcreateæ¹æ³ï¼ä¸åå°çº¿ç¨è¿ä¼å¯¹èå¼ç¨çå¯¹è±¡çæµï¼å¦æèå¼ç¨çå®éå¯¹è±¡ï¼è¿éæ¯directbytebufferï¼è¢«åæ¶ä»¥åï¼å°±ä¼è°ç¨cleanerçcleanæ¹æ³ï¼æ¥æ¸é¤ç´æ¥åå­ä¸­å ç¨çåå­\n\npublic void clean() {\n       if (remove(this)) {\n           try {\n               this.thunk.run(); //è°ç¨runæ¹æ³\n           } catch (final throwable var2) {\n               accesscontroller.doprivileged(new privilegedaction<void>() {\n                   public void run() {\n                       if (system.err != null) {\n                           (new error("cleaner terminated abnormally", var2)).printstacktrace();\n                       }\n\n                       system.exit(1);\n                       return null;\n                   }\n               });\n           }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¯¹åºå¯¹è±¡çrunæ¹æ³\n\npublic void run() {\n    if (address == 0) {\n        // paranoia\n        return;\n    }\n    unsafe.freememory(address); //éæ¾ç´æ¥åå­ä¸­å ç¨çåå­\n    address = 0;\n    bits.unreservememory(size, capacity);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n# ç´æ¥åå­çåæ¶æºå¶æ»ç»\n\n * ä½¿ç¨äºunsafeç±»æ¥å®æç´æ¥åå­çåéåæ¶ï¼åæ¶éè¦ä¸»å¨è°ç¨freememoryæ¹æ³\n * bytebufferçå®ç°åé¨ä½¿ç¨äºcleanerï¼èå¼ç¨ï¼æ¥æ£æµbytebufferãä¸æ¦bytebufferè¢«åå¾åæ¶ï¼é£ä¹ä¼ç±referencehandleræ¥è°ç¨cleanerçcleanæ¹æ³è°ç¨freememoryæ¥éæ¾åå­\n\n\n# ä¸ãåå¾åæ¶\n\n\n# 1ãå¦ä½å¤æ­å¯¹è±¡å¯ä»¥åæ¶\n\n# å¼ç¨è®¡æ°æ³\n\nå¼ç«¯ï¼å¾ªç¯å¼ç¨æ¶ï¼ä¸¤ä¸ªå¯¹è±¡çè®¡æ°é½ä¸º1ï¼å¯¼è´ä¸¤ä¸ªå¯¹è±¡é½æ æ³è¢«éæ¾\n\n\n\n# å¯è¾¾æ§åæç®æ³\n\n * jvmä¸­çåå¾åæ¶å¨éè¿å¯è¾¾æ§åææ¥æ¢ç´¢ææå­æ´»çå¯¹è±¡\n * æ«æå ä¸­çå¯¹è±¡ï¼çè½å¦æ²¿çgc rootå¯¹è±¡ä¸ºèµ·ç¹çå¼ç¨é¾æ¾å°è¯¥å¯¹è±¡ï¼å¦ææ¾ä¸å°ï¼åè¡¨ç¤ºå¯ä»¥åæ¶\n * å¯ä»¥ä½ä¸ºgc rootçå¯¹è±¡\n   * èææºæ ï¼æ å¸§ä¸­çæ¬å°åéè¡¨ï¼ä¸­å¼ç¨çå¯¹è±¡ã\n   * æ¹æ³åºä¸­ç±»éæå±æ§å¼ç¨çå¯¹è±¡\n   * æ¹æ³åºä¸­å¸¸éå¼ç¨çå¯¹è±¡\n   * æ¬å°æ¹æ³æ ä¸­jniï¼å³ä¸è¬è¯´çnativeæ¹æ³ï¼å¼ç¨çå¯¹è±¡\n\n# äºç§å¼ç¨\n\n\n\n# å¼ºå¼ç¨\n\nåªægc rooté½ä¸å¼ç¨è¯¥å¯¹è±¡æ¶ï¼æä¼åæ¶å¼ºå¼ç¨å¯¹è±¡\n\n * å¦ä¸å¾bãcå¯¹è±¡é½ä¸å¼ç¨a1å¯¹è±¡æ¶ï¼a1å¯¹è±¡æä¼è¢«åæ¶\n\n# è½¯å¼ç¨\n\nå½gc rootæåè½¯å¼ç¨å¯¹è±¡æ¶ï¼å¨åå­ä¸è¶³æ¶ï¼ä¼åæ¶è½¯å¼ç¨æå¼ç¨çå¯¹è±¡\n\n * å¦ä¸å¾å¦æbå¯¹è±¡ä¸åå¼ç¨a2å¯¹è±¡ä¸åå­ä¸è¶³æ¶ï¼è½¯å¼ç¨æå¼ç¨ça2å¯¹è±¡å°±ä¼è¢«åæ¶\n\n# è½¯å¼ç¨çä½¿ç¨\n\npublic class demo1 {\n\tpublic static void main(string[] args) {\n\t\tfinal int _4m = 4*1024*1024;\n\t\t//ä½¿ç¨è½¯å¼ç¨å¯¹è±¡ liståsoftreferenceæ¯å¼ºå¼ç¨ï¼èsoftreferenceåbyteæ°ç»åæ¯è½¯å¼ç¨\n\t\tlist<softreference<byte[]>> list = new arraylist<>();\n\t\tsoftreference<byte[]> ref= new softreference<>(new byte[_4m]);\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¦æå¨åå¾åæ¶æ¶åç°åå­ä¸è¶³ï¼å¨åæ¶è½¯å¼ç¨ææåçå¯¹è±¡æ¶ï¼è½¯å¼ç¨æ¬èº«ä¸ä¼è¢«æ¸ç\n\nå¦ææ³è¦æ¸çè½¯å¼ç¨ï¼éè¦ä½¿ç¨å¼ç¨éå\n\npublic class demo1 {\n\tpublic static void main(string[] args) {\n\t\tfinal int _4m = 4*1024*1024;\n\t\t//ä½¿ç¨å¼ç¨éåï¼ç¨äºç§»é¤å¼ç¨ä¸ºç©ºçè½¯å¼ç¨å¯¹è±¡\n\t\treferencequeue<byte[]> queue = new referencequeue<>();\n\t\t//ä½¿ç¨è½¯å¼ç¨å¯¹è±¡ liståsoftreferenceæ¯å¼ºå¼ç¨ï¼èsoftreferenceåbyteæ°ç»åæ¯è½¯å¼ç¨\n\t\tlist<softreference<byte[]>> list = new arraylist<>();\n\t\tsoftreference<byte[]> ref= new softreference<>(new byte[_4m]);\n\n\t\t//éåå¼ç¨éåï¼å¦ææåç´ ï¼åç§»é¤\n\t\treference<? extends byte[]> poll = queue.poll();\n\t\twhile(poll != null) {\n\t\t\t//å¼ç¨éåä¸ä¸ºç©ºï¼åä»éåä¸­ç§»é¤è¯¥åç´ \n\t\t\tlist.remove(poll);\n\t\t\t//ç§»å¨å°å¼ç¨éåä¸­çä¸ä¸ä¸ªåç´ \n\t\t\tpoll = queue.poll();\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n**å¤§æ¦æè·¯ä¸ºï¼**æ¥çå¼ç¨éåä¸­ææ è½¯å¼ç¨ï¼å¦ææï¼åå°è¯¥è½¯å¼ç¨ä»å­æ¾å®çéåä¸­ç§»é¤ï¼è¿éä¸ºä¸ä¸ªlistéåï¼\n\n# å¼±å¼ç¨\n\nåªæå¼±å¼ç¨å¼ç¨è¯¥å¯¹è±¡æ¶ï¼å¨åå¾åæ¶æ¶ï¼æ è®ºåå­æ¯å¦åè¶³ï¼é½ä¼åæ¶å¼±å¼ç¨æå¼ç¨çå¯¹è±¡\n\n * å¦ä¸å¾å¦æbå¯¹è±¡ä¸åå¼ç¨a3å¯¹è±¡ï¼åa3å¯¹è±¡ä¼è¢«åæ¶\n\nå¼±å¼ç¨çä½¿ç¨åè½¯å¼ç¨ç±»ä¼¼ï¼åªæ¯å° softreference æ¢ä¸ºäº weakreference\n\n# èå¼ç¨\n\nå½èå¼ç¨å¯¹è±¡æå¼ç¨çå¯¹è±¡è¢«åæ¶ä»¥åï¼èå¼ç¨å¯¹è±¡å°±ä¼è¢«æ¾å¥å¼ç¨éåä¸­ï¼è°ç¨èå¼ç¨çæ¹æ³\n\n * èå¼ç¨çä¸ä¸ªä½ç°æ¯éæ¾ç´æ¥åå­æåéçåå­ï¼å½å¼ç¨çå¯¹è±¡bytebufferè¢«åå¾åæ¶ä»¥åï¼èå¼ç¨å¯¹è±¡cleanerå°±ä¼è¢«æ¾å¥å¼ç¨éåä¸­ï¼ç¶åè°ç¨cleanerçcleanæ¹æ³æ¥éæ¾ç´æ¥åå­\n * å¦ä¸å¾ï¼bå¯¹è±¡ä¸åå¼ç¨bytebufferå¯¹è±¡ï¼bytebufferå°±ä¼è¢«åæ¶ãä½æ¯ç´æ¥åå­ä¸­çåå­è¿æªè¢«åæ¶ãè¿æ¶éè¦å°èå¼ç¨å¯¹è±¡cleaneræ¾å¥å¼ç¨éåä¸­ï¼ç¶åè°ç¨å®çcleanæ¹æ³æ¥éæ¾ç´æ¥åå­\n\n# ç»ç»å¨å¼ç¨\n\nææçç±»é½ç»§æ¿èªobjectç±»ï¼objectç±»æä¸ä¸ªfinalizeæ¹æ³ãå½æä¸ªå¯¹è±¡ä¸åè¢«å¶ä»çå¯¹è±¡æå¼ç¨æ¶ï¼ä¼åå°ç»ç»å¨å¼ç¨å¯¹è±¡æ¾å¥å¼ç¨éåä¸­ï¼ç¶åæ ¹æ®ç»ç»å¨å¼ç¨å¯¹è±¡æ¾å°å®æå¼ç¨çå¯¹è±¡ï¼ç¶åè°ç¨è¯¥å¯¹è±¡çfinalizeæ¹æ³ãè°ç¨ä»¥åï¼è¯¥å¯¹è±¡å°±å¯ä»¥è¢«åå¾åæ¶äº\n\n * å¦ä¸å¾ï¼bå¯¹è±¡ä¸åå¼ç¨a4å¯¹è±¡ãè¿æ¯ç»ç»å¨å¯¹è±¡å°±ä¼è¢«æ¾å¥å¼ç¨éåä¸­ï¼å¼ç¨éåä¼æ ¹æ®å®ï¼æ¾å°å®æå¼ç¨çå¯¹è±¡ãç¶åè°ç¨è¢«å¼ç¨å¯¹è±¡çfinalizeæ¹æ³ãè°ç¨ä»¥åï¼è¯¥å¯¹è±¡å°±å¯ä»¥è¢«åå¾åæ¶äº\n\n# å¼ç¨éå\n\n * è½¯å¼ç¨åå¼±å¼ç¨å¯ä»¥éåå¼ç¨éå\n   * å¨å¼±å¼ç¨åèå¼ç¨æå¼ç¨çå¯¹è±¡è¢«åæ¶ä»¥åï¼ä¼å°è¿äºå¼ç¨æ¾å¥å¼ç¨éåä¸­ï¼æ¹ä¾¿ä¸èµ·åæ¶è¿äºè½¯/å¼±å¼ç¨å¯¹è±¡\n * èå¼ç¨åç»ç»å¨å¼ç¨å¿é¡»éåå¼ç¨éå\n   * èå¼ç¨åç»ç»å¨å¼ç¨å¨ä½¿ç¨æ¶ä¼å³èä¸ä¸ªå¼ç¨éå\n\n\n# 2ãåå¾åæ¶ç®æ³\n\n# æ è®°-æ¸é¤\n\n\n\nå®ä¹ï¼æ è®°æ¸é¤ç®æ³é¡¾åæä¹ï¼æ¯æå¨èææºæ§è¡åå¾åæ¶çè¿ç¨ä¸­ï¼åéç¨æ è®°ç®æ³ç¡®å®å¯åæ¶å¯¹è±¡ï¼ç¶ååå¾æ¶éå¨æ ¹æ®æ è¯æ¸é¤ç¸åºçåå®¹ï¼ç»å åå­è¾åºç¸åºçç©ºé´\n\n * è¿éçè¾åºåå­ç©ºé´å¹¶ä¸æ¯å°åå­ç©ºé´çå­èæ¸0ï¼èæ¯è®°å½ä¸è¿æ®µåå­çèµ·å§ç»æå°åï¼ä¸æ¬¡åéåå­çæ¶åï¼ä¼ç´æ¥è¦çè¿æ®µåå­\n\nç¼ºç¹ï¼å®¹æäº§çå¤§éçåå­ç¢çï¼å¯è½æ æ³æ»¡è¶³å¤§å¯¹è±¡çåå­åéï¼ä¸æ¦å¯¼è´æ æ³åéå¯¹è±¡ï¼é£å°±ä¼å¯¼è´jvmå¯å¨gcï¼ä¸æ¦å¯å¨gcï¼æä»¬çåºç¨ç¨åºå°±ä¼æåï¼è¿å°±å¯¼è´åºç¨çååºéåº¦åæ¢\n\n# æ è®°-æ´ç\n\n\n\næ è®°-æ´ç ä¼å°ä¸è¢«gc rootå¼ç¨çå¯¹è±¡åæ¶ï¼æ¸æ¥å¶å ç¨çåå­ç©ºé´ãç¶åæ´çå©ä½çå¯¹è±¡ï¼å¯ä»¥ææé¿åå åå­ç¢çèå¯¼è´çé®é¢ï¼ä½æ¯å ä¸ºæ´ä½éè¦æ¶èä¸å®çæ¶é´ï¼æä»¥æçè¾ä½\n\n# å¤å¶\n\n\n\n\n\n\n\n\n\nå°åå­åä¸ºç­å¤§å°çä¸¤ä¸ªåºåï¼fromåtoï¼toä¸­ä¸ºç©ºï¼ãåå°è¢«gc rootå¼ç¨çå¯¹è±¡ä»fromæ¾å¥toä¸­ï¼ååæ¶ä¸è¢«gc rootå¼ç¨çå¯¹è±¡ãç¶åäº¤æ¢fromåtoãè¿æ ·ä¹å¯ä»¥é¿ååå­ç¢ççé®é¢ï¼ä½æ¯ä¼å ç¨ååçåå­ç©ºé´ã\n\n\n# 3ãåä»£åæ¶\n\n\n\n# åæ¶æµç¨\n\næ°åå»ºçå¯¹è±¡é½è¢«æ¾å¨äºæ°çä»£çä¼ç¸å­ä¸­\n\n\n\nå½ä¼ç¸å­ä¸­çåå­ä¸è¶³æ¶ï¼å°±ä¼è¿è¡ä¸æ¬¡åå¾åæ¶ï¼è¿æ¶çåæ¶å«å minor gc\n\nminor gc ä¼å°ä¼ç¸å­åå¹¸å­åºfromå­æ´»çå¯¹è±¡åå¤å¶å° å¹¸å­åº toä¸­ï¼ å¹¶è®©å¶å¯¿å½å 1ï¼åäº¤æ¢ä¸¤ä¸ªå¹¸å­åº\n\n\n\n\n\n\n\nåæ¬¡åå»ºå¯¹è±¡ï¼è¥æ°çä»£çä¼ç¸å­åæ»¡äºï¼åä¼åæ¬¡è§¦å minor gcï¼ä¼è§¦å stop the worldï¼ æåå¶ä»ç¨æ·çº¿ç¨ï¼åªè®©åå¾åæ¶çº¿ç¨å·¥ä½ï¼ï¼è¿æ¶ä¸ä»ä¼åæ¶ä¼ç¸å­ä¸­çåå¾ï¼è¿ä¼åæ¶å¹¸å­åºä¸­çåå¾ï¼åå°æ´»è·å¯¹è±¡å¤å¶å°å¹¸å­åºtoä¸­ãåæ¶ä»¥åä¼äº¤æ¢ä¸¤ä¸ªå¹¸å­åºï¼å¹¶è®©å¹¸å­åºä¸­çå¯¹è±¡å¯¿å½å 1\n\n\n\nå¦æå¹¸å­åºä¸­çå¯¹è±¡çå¯¿å½è¶è¿æä¸ªéå¼ï¼æå¤§ä¸º15ï¼4bitï¼ï¼å°±ä¼è¢«æ¾å¥èå¹´ä»£ä¸­\n\n\n\nå¦ææ°çä»£èå¹´ä»£ä¸­çåå­é½æ»¡äºï¼å°±ä¼åè§¦åminor gcï¼åè§¦åfull gcï¼æ«ææ°çä»£åèå¹´ä»£ä¸­ææä¸åä½¿ç¨çå¯¹è±¡å¹¶åæ¶\n\n# gc åæ\n\n# å¤§å¯¹è±¡å¤çç­ç¥\n\nå½éå°ä¸ä¸ªè¾å¤§çå¯¹è±¡æ¶ï¼å°±ç®æ°çä»£çä¼ç¸å­ä¸ºç©ºï¼ä¹æ æ³å®¹çº³è¯¥å¯¹è±¡æ¶ï¼ä¼å°è¯¥å¯¹è±¡ç´æ¥æåä¸ºèå¹´ä»£\n\n# çº¿ç¨åå­æº¢åº\n\næä¸ªçº¿ç¨çåå­æº¢åºäºèæå¼å¸¸ï¼out of memoryï¼ï¼ä¸ä¼è®©å¶ä»ççº¿ç¨ç»æè¿è¡\n\nè¿æ¯å ä¸ºå½ä¸ä¸ªçº¿ç¨æåºoomå¼å¸¸åï¼å®æå æ®çåå­èµæºä¼å¨é¨è¢«éæ¾æï¼ä»èä¸ä¼å½±åå¶ä»çº¿ç¨çè¿è¡ï¼è¿ç¨ä¾ç¶æ­£å¸¸\n\n\n# 4ãåå¾åæ¶å¨\n\n# ç¸å³æ¦å¿µ\n\nå¹¶è¡æ¶éï¼æå¤æ¡åå¾æ¶éçº¿ç¨å¹¶è¡å·¥ä½ï¼ä½æ­¤æ¶ç¨æ·çº¿ç¨ä»å¤äºç­å¾ç¶æã\n\nå¹¶åæ¶éï¼æç¨æ·çº¿ç¨ä¸åå¾æ¶éçº¿ç¨åæ¶å·¥ä½ï¼ä¸ä¸å®æ¯å¹¶è¡çå¯è½ä¼äº¤æ¿æ§è¡ï¼ãç¨æ·ç¨åºå¨ç»§ç»­è¿è¡ï¼èåå¾æ¶éç¨åºè¿è¡å¨å¦ä¸ä¸ªcpuä¸\n\nååéï¼å³cpuç¨äºè¿è¡ç¨æ·ä»£ç çæ¶é´ä¸cpuæ»æ¶èæ¶é´çæ¯å¼ï¼ååé = è¿è¡ç¨æ·ä»£ç æ¶é´ / ( è¿è¡ç¨æ·ä»£ç æ¶é´ + åå¾æ¶éæ¶é´ )ï¼ï¼ä¹å°±æ¯ãä¾å¦ï¼èææºå±è¿è¡100åéï¼åå¾æ¶éå¨è±æ1åéï¼é£ä¹ååéå°±æ¯99%\n\n# ä¸²è¡\n\n * åçº¿ç¨\n * åå­è¾å°ï¼ä¸ªäººçµèï¼cpuæ ¸æ°è¾å°ï¼\n\n\n\nå®å¨ç¹ï¼è®©å¶ä»çº¿ç¨é½å¨è¿ä¸ªç¹åä¸æ¥ï¼ä»¥ååå¾åæ¶æ¶ç§»å¨å¯¹è±¡å°åï¼ä½¿å¾å¶ä»çº¿ç¨æ¾ä¸å°è¢«ç§»å¨çå¯¹è±¡\n\nå ä¸ºæ¯ä¸²è¡çï¼æä»¥åªæä¸ä¸ªåå¾åæ¶çº¿ç¨ãä¸å¨è¯¥çº¿ç¨æ§è¡åæ¶å·¥ä½æ¶ï¼å¶ä»çº¿ç¨è¿å¥é»å¡ç¶æ\n\n# serial æ¶éå¨\n\nserialæ¶éå¨æ¯æåºæ¬çãåå±åå²ææ ä¹çæ¶éå¨\n\nç¹ç¹ï¼åçº¿ç¨ãç®åé«æï¼ä¸å¶ä»æ¶éå¨çåçº¿ç¨ç¸æ¯ï¼ï¼éç¨å¤å¶ç®æ³ãå¯¹äºéå®åä¸ªcpuçç¯å¢æ¥è¯´ï¼serialæ¶éå¨ç±äºæ²¡æçº¿ç¨äº¤äºçå¼éï¼ä¸å¿ååå¾æ¶éèªç¶å¯ä»¥è·å¾æé«çåçº¿ç¨ææºæçãæ¶éå¨è¿è¡åå¾åæ¶æ¶ï¼å¿é¡»æåå¶ä»ææçå·¥ä½çº¿ç¨ï¼ç´å°å®ç»æï¼stop the worldï¼\n\n# parnew æ¶éå¨\n\nparnewæ¶éå¨å¶å®å°±æ¯serialæ¶éå¨çå¤çº¿ç¨çæ¬\n\nç¹ç¹ï¼å¤çº¿ç¨ãparnewæ¶éå¨é»è®¤å¼å¯çæ¶éçº¿ç¨æ°ä¸cpuçæ°éç¸åï¼å¨cpuéå¸¸å¤çç¯å¢ä¸­ï¼å¯ä»¥ä½¿ç¨-xx:parallelgcthreadsåæ°æ¥éå¶åå¾æ¶éççº¿ç¨æ°ãåserialæ¶éå¨ä¸æ ·å­å¨stop the worldé®é¢\n\n# serial old æ¶éå¨\n\nserial oldæ¯serialæ¶éå¨çèå¹´ä»£çæ¬\n\nç¹ç¹ï¼åæ ·æ¯åçº¿ç¨æ¶éå¨ï¼éç¨æ è®°-æ´çç®æ³\n\n# ååéä¼å\n\n * å¤çº¿ç¨\n * å åå­è¾å¤§ï¼å¤æ ¸cpu\n * åä½æ¶é´åï¼stwï¼stop the worldï¼åæå¶ä»ææå·¥ä½çº¿ç¨ï¼æ¶é´æç­\n * jdk1.8é»è®¤ä½¿ç¨çåå¾åæ¶å¨\n\n\n\n# parallel scavenge æ¶éå¨\n\nä¸ååéå³ç³»å¯åï¼æä¹ç§°ä¸ºååéä¼åæ¶éå¨\n\nç¹ç¹ï¼å±äºæ°çä»£æ¶éå¨ä¹æ¯éç¨å¤å¶ç®æ³çæ¶éå¨ï¼ç¨å°äºæ°çä»£çå¹¸å­åºï¼ï¼åæ¯å¹¶è¡çå¤çº¿ç¨æ¶éå¨ï¼ä¸parnewæ¶éå¨ç±»ä¼¼ï¼\n\nè¯¥æ¶éå¨çç®æ æ¯è¾¾å°ä¸ä¸ªå¯æ§å¶çååéãè¿æä¸ä¸ªå¼å¾å³æ³¨çç¹æ¯ï¼gcèªéåºè°èç­ç¥ï¼ä¸parnewæ¶éå¨æéè¦çä¸ä¸ªåºå«ï¼\n\ngcèªéåºè°èç­ç¥ï¼parallel scavengeæ¶éå¨å¯è®¾ç½®-xx:+useadptivesizepolicyåæ°ãå½å¼å³æå¼æ¶ä¸éè¦æå¨æå®æ°çä»£çå¤§å°ï¼-xmnï¼ãedenä¸survivoråºçæ¯ä¾ï¼-xx:survivorrationï¼ãæåèå¹´ä»£çå¯¹è±¡å¹´é¾ï¼-xx:pretenuresizethresholdï¼ç­ï¼èææºä¼æ ¹æ®ç³»ç»çè¿è¡ç¶åµæ¶éæ§è½çæ§ä¿¡æ¯ï¼å¨æè®¾ç½®è¿äºåæ°ä»¥æä¾æä¼çåé¡¿æ¶é´åæé«çååéï¼è¿ç§è°èæ¹å¼ç§°ä¸ºgcçèªéåºè°èç­ç¥ã\n\nparallel scavengeæ¶éå¨ä½¿ç¨ä¸¤ä¸ªåæ°æ§å¶ååéï¼\n\n * xx:maxgcpausemillis æ§å¶æå¤§çåå¾æ¶éåé¡¿æ¶é´\n * xx:gcratio ç´æ¥è®¾ç½®ååéçå¤§å°\n\n# parallel old æ¶éå¨\n\næ¯parallel scavengeæ¶éå¨çèå¹´ä»£çæ¬\n\nç¹ç¹ï¼å¤çº¿ç¨ï¼éç¨æ è®°-æ´çç®æ³ï¼èå¹´ä»£æ²¡æå¹¸å­åºï¼\n\n# ååºæ¶é´ä¼å\n\n * å¤çº¿ç¨\n * å åå­è¾å¤§ï¼å¤æ ¸cpu\n * å°½å¯è½è®©åæ¬¡stwæ¶é´åç­ï¼å°½éä¸å½±åå¶ä»çº¿ç¨è¿è¡ï¼\n\n\n\n# cms æ¶éå¨\n\nconcurrent mark sweepï¼ä¸ç§ä»¥è·åæç­åæ¶åé¡¿æ¶é´ä¸ºç®æ çèå¹´ä»£æ¶éå¨\n\nç¹ç¹ï¼åºäºæ è®°-æ¸é¤ç®æ³å®ç°ãå¹¶åæ¶éãä½åé¡¿ï¼ä½æ¯ä¼äº§çåå­ç¢ç\n\nåºç¨åºæ¯ï¼éç¨äºæ³¨éæå¡çååºéåº¦ï¼å¸æç³»ç»åé¡¿æ¶é´æç­ï¼ç»ç¨æ·å¸¦æ¥æ´å¥½çä½éªç­åºæ¯ä¸ãå¦webç¨åºãb/sæå¡\n\ncmsæ¶éå¨çè¿è¡è¿ç¨åä¸ºä¸å4æ­¥ï¼\n\nåå§æ è®°ï¼æ è®°gc rootsè½ç´æ¥å°çå¯¹è±¡ãéåº¦å¾å¿«ä½æ¯ä»å­å¨stop the worldé®é¢\n\nå¹¶åæ è®°ï¼è¿è¡gc roots tracing çè¿ç¨ï¼æ¾åºå­æ´»å¯¹è±¡ä¸ç¨æ·çº¿ç¨å¯å¹¶åæ§è¡\n\néæ°æ è®°ï¼ä¸ºäºä¿®æ­£å¹¶åæ è®°æé´å ç¨æ·ç¨åºç»§ç»­è¿è¡èå¯¼è´æ è®°äº§çåå¨çé£ä¸é¨åå¯¹è±¡çæ è®°è®°å½ãä»ç¶å­å¨stop the worldé®é¢\n\nå¹¶åæ¸é¤ï¼å¯¹æ è®°çå¯¹è±¡è¿è¡æ¸é¤åæ¶\n\ncmsæ¶éå¨çåå­åæ¶è¿ç¨æ¯ä¸ç¨æ·çº¿ç¨ä¸èµ·å¹¶åæ§è¡ç\n\n# g1\n\n# å®ä¹ï¼\n\ngarbage first\n\njdk 9ä»¥åé»è®¤ä½¿ç¨ï¼èä¸æ¿ä»£äºcms æ¶éå¨\n\n\n\n# éç¨åºæ¯\n\n * åæ¶æ³¨éååéåä½å»¶è¿ï¼ååºæ¶é´ï¼\n * è¶å¤§å åå­ï¼åå­å¤§çï¼ï¼ä¼å°å åå­ååä¸ºå¤ä¸ªå¤§å°ç¸ç­çåºå\n * æ´ä½ä¸æ¯æ è®°-æ´çç®æ³ï¼ä¸¤ä¸ªåºåä¹é´æ¯å¤å¶ç®æ³\n\nç¸å³åæ°ï¼jdk8 å¹¶ä¸æ¯é»è®¤å¼å¯çï¼æéè¦åæ°å¼å¯\n\n\n\n# g1åå¾åæ¶é¶æ®µ\n\n\n\næ°çä»£ä¼ç¸å­åå¾åæ¶ââ>åå­ä¸è¶³ï¼æ°çä»£åæ¶+å¹¶åæ è®°ââ>åæ¶æ°çä»£ä¼ç¸å­ãå¹¸å­åºãèå¹´ä»£åå­ââ>æ°çä»£ä¼ç¸å­åå¾åæ¶(éæ°å¼å§)\n\n# young collection\n\nååºç®æ³region\n\nåä»£æ¯æå¯¹è±¡ççå½å¨æååï¼ååºåæ¯å°å ç©ºé´ååè¿ç»­å ä¸ªä¸åå°åºé´ï¼æ¯ä¸ä¸ªå°åºé´ç¬ç«åæ¶ï¼å¯ä»¥æ§å¶ä¸æ¬¡åæ¶å¤å°ä¸ªå°åºé´ï¼æ¹ä¾¿æ§å¶ gc äº§ççåé¡¿æ¶é´\n\neï¼ä¼ç¸å­ sï¼å¹¸å­åº oï¼èå¹´ä»£\n\n * ä¼stw\n\n\n\n\n\n\n\n# young collection + cm\n\ncmï¼å¹¶åæ è®°\n\n * å¨ young gc æ¶ä¼å¯¹ gc root è¿è¡åå§æ è®°\n * å¨èå¹´ä»£å ç¨å åå­çæ¯ä¾è¾¾å°éå¼æ¶ï¼å¯¹è¿è¡å¹¶åæ è®°ï¼ä¸ä¼stwï¼ï¼éå¼å¯ä»¥æ ¹æ®ç¨æ·æ¥è¿è¡è®¾å®\n\n\n\n# mixed collection\n\nä¼å¯¹e s o è¿è¡å¨é¢çåæ¶\n\n * æç»æ è®°\n * æ·è´å­æ´»\n\n-xx:maxgcpausemills:xxx ç¨äºæå®æé¿çåé¡¿æ¶é´\n\né®ï¼ä¸ºä»ä¹æçèå¹´ä»£è¢«æ·è´äºï¼æçæ²¡æ·è´ï¼\n\nå ä¸ºæå®äºæå¤§åé¡¿æ¶é´ï¼å¦æå¯¹ææèå¹´ä»£é½è¿è¡åæ¶ï¼èæ¶å¯è½è¿é«ãä¸ºäºä¿è¯æ¶é´ä¸è¶è¿è®¾å®çåé¡¿æ¶é´ï¼ä¼åæ¶ææä»·å¼çèå¹´ä»£ï¼åæ¶åï¼è½å¤å¾å°æ´å¤åå­ï¼\n\n\n\n# full gc\n\ng1å¨èå¹´ä»£åå­ä¸è¶³æ¶ï¼èå¹´ä»£æå åå­è¶è¿éå¼ï¼\n\n * å¦æåå¾äº§çéåº¦æ¢äºåå¾åæ¶éåº¦ï¼ä¸ä¼è§¦åfull gcï¼è¿æ¯å¹¶åå°è¿è¡æ¸ç\n * å¦æåå¾äº§çéåº¦å¿«äºåå¾åæ¶éåº¦ï¼ä¾¿ä¼è§¦åfull gc\n\n# young collection è·¨ä»£å¼ç¨\n\n * æ°çä»£åæ¶çè·¨ä»£å¼ç¨ï¼èå¹´ä»£å¼ç¨æ°çä»£ï¼é®é¢\n\n\n\n * å¡è¡¨ä¸remembered set\n   * remembered set å­å¨äºeä¸­ï¼ç¨äºä¿å­æ°çä»£å¯¹è±¡å¯¹åºçèå¡\n     * èå¡ï¼oè¢«ååä¸ºå¤ä¸ªåºåï¼ä¸ä¸ªåºå512kï¼ï¼å¦æè¯¥åºåå¼ç¨äºæ°çä»£å¯¹è±¡ï¼åè¯¥åºåè¢«ç§°ä¸ºèå¡\n * å¨å¼ç¨åæ´æ¶éè¿post-write barried + dirty card queue\n * concurrent refinement threads æ´æ° remembered set\n\n\n\n# remark\n\néæ°æ è®°é¶æ®µ\n\nå¨åå¾åæ¶æ¶ï¼æ¶éå¨å¤çå¯¹è±¡çè¿ç¨ä¸­\n\né»è²ï¼å·²è¢«å¤çï¼éè¦ä¿çç ç°è²ï¼æ­£å¨å¤çä¸­ç ç½è²ï¼è¿æªå¤çç\n\n\n\nä½æ¯å¨å¹¶åæ è®°è¿ç¨ä¸­ï¼æå¯è½aè¢«å¤çäºä»¥åæªå¼ç¨cï¼ä½è¯¥å¤çè¿ç¨è¿æªç»æï¼å¨å¤çè¿ç¨ç»æä¹åaå¼ç¨äºcï¼è¿æ¶å°±ä¼ç¨å°remark\n\nè¿ç¨å¦ä¸\n\n * ä¹åcæªè¢«å¼ç¨ï¼è¿æ¶aå¼ç¨äºcï¼å°±ä¼ç»cå ä¸ä¸ªåå±éï¼åå±éçæä»¤ä¼è¢«æ§è¡ï¼å°cæ¾å¥ä¸ä¸ªéåå½ä¸­ï¼å¹¶å°cåä¸º å¤çä¸­ ç¶æ\n * å¨å¹¶åæ è®°é¶æ®µç»æä»¥åï¼éæ°æ è®°é¶æ®µä¼stwï¼ç¶åå°æ¾å¨è¯¥éåä¸­çå¯¹è±¡éæ°å¤çï¼åç°æå¼ºå¼ç¨å¼ç¨å®ï¼å°±ä¼å¤çå®\n\n\n\n# jdk 8u20 å­ç¬¦ä¸²å»é\n\nè¿ç¨\n\n * å°æææ°åéçå­ç¬¦ä¸²ï¼åºå±æ¯char[]ï¼æ¾å¥ä¸ä¸ªéå\n * å½æ°çä»£åæ¶æ¶ï¼g1å¹¶åæ£æ¥æ¯å¦æéå¤çå­ç¬¦ä¸²\n * å¦æå­ç¬¦ä¸²çå¼ä¸æ ·ï¼å°±è®©ä»ä»¬å¼ç¨åä¸ä¸ªå­ç¬¦ä¸²å¯¹è±¡\n * æ³¨æï¼å¶ä¸string.internçåºå«\n   * internå³æ³¨çæ¯å­ç¬¦ä¸²å¯¹è±¡\n   * å­ç¬¦ä¸²å»éå³æ³¨çæ¯char[]\n   * å¨jvmåé¨ï¼ä½¿ç¨äºä¸åçå­ç¬¦ä¸²æ \n\nä¼ç¹ä¸ç¼ºç¹\n\n * èçäºå¤§éåå­\n * æ°çä»£åæ¶æ¶é´ç¥å¾®å¢å ï¼å¯¼è´ç¥å¾®å¤å ç¨cpu\n\n# jdk 8u40 å¹¶åæ è®°ç±»å¸è½½\n\nå¨å¹¶åæ è®°é¶æ®µç»æä»¥åï¼å°±è½ç¥éåªäºç±»ä¸åè¢«ä½¿ç¨ãå¦æä¸ä¸ªç±»å è½½å¨çææç±»é½ä¸å¨ä½¿ç¨ï¼åå¸è½½å®æå è½½çææç±»\n\n# jdk 8u60 åæ¶å·¨åå¯¹è±¡\n\n * ä¸ä¸ªå¯¹è±¡å¤§äºregionçä¸åæ¶ï¼å°±ç§°ä¸ºå·¨åå¯¹è±¡\n * g1ä¸ä¼å¯¹å·¨åå¯¹è±¡è¿è¡æ·è´\n * åæ¶æ¶è¢«ä¼åèè\n * g1ä¼è·è¸ªèå¹´ä»£ææincomingå¼ç¨ï¼å¦æèå¹´ä»£incomingå¼ç¨ä¸º0çå·¨åå¯¹è±¡å°±å¯ä»¥å¨æ°çä»£åå¾åæ¶æ¶å¤çæ\n\n\n\n\n# 5ãgc è°ä¼\n\næ¥çèææºåæ°å½ä»¤\n\n"f:\\java\\jdk8.0\\bin\\java" -xx:+printflagsfinal -version | findstr "gc"\n\n\n1\n\n\nå¯ä»¥æ ¹æ®åæ°å»æ¥è¯¢å·ä½çä¿¡æ¯\n\n# è°ä¼é¢å\n\n * åå­\n * éç«äº\n * cpuå ç¨\n * io\n * gc\n\n# ç¡®å®ç®æ \n\nä½å»¶è¿/é«ååéï¼ éæ©åéçgc\n\n * cms g1 zgc\n * parallelgc\n * zing\n\n# æå¿«çgcæ¯ä¸åçgc\n\né¦åæé¤åå°å ä¸ºèªèº«ç¼åçä»£ç èå¼åçåå­é®é¢\n\n * æ¥çfull gcååçåå­å ç¨ï¼èèä»¥ä¸å ä¸ªé®é¢\n   * æ°æ®æ¯ä¸æ¯å¤ªå¤ï¼\n   * æ°æ®è¡¨ç¤ºæ¯å¦å¤ªèè¿\n     * å¯¹è±¡å¾\n     * å¯¹è±¡å¤§å°\n   * æ¯å¦å­å¨åå­æ³æ¼\n\n# æ°çä»£è°ä¼\n\n * æ°çä»£çç¹ç¹\n   * ææçnewæä½åéåå­é½æ¯éå¸¸å»ä»·ç\n     * tlab\n   * æ­»äº¡å¯¹è±¡åæ¶é¶ä»£ä»·\n   * å¤§é¨åå¯¹è±¡ç¨è¿å³æ­»ï¼æçå¤æ­»ï¼\n   * minor gc æç¨æ¶é´è¿å°äºfull gc\n * æ°çä»£åå­è¶å¤§è¶å¥½ä¹ï¼\n   * ä¸æ¯\n     * æ°çä»£åå­å¤ªå°ï¼é¢ç¹è§¦åminor gcï¼ä¼stwï¼ä¼ä½¿å¾ååéä¸é\n     * æ°çä»£åå­å¤ªå¤§ï¼èå¹´ä»£åå­å æ¯ææéä½ï¼ä¼æ´é¢ç¹å°è§¦åfull gcãèä¸è§¦åminor gcæ¶ï¼æ¸çæ°çä»£æè±è´¹çæ¶é´ä¼æ´é¿\n   * æ°çä»£åå­è®¾ç½®ä¸ºåå®¹çº³[å¹¶åé*(è¯·æ±-ååº)]çæ°æ®ä¸ºå®\n\n# å¹¸å­åºè°ä¼\n\n * å¹¸å­åºéè¦è½å¤ä¿å­ å½åæ´»è·å¯¹è±¡+éè¦æåçå¯¹è±¡\n * æåéå¼éç½®å¾å½ï¼è®©é¿æ¶é´å­æ´»çå¯¹è±¡å°½å¿«æå\n\n# èå¹´ä»£è°ä¼\n\n\n# åãç±»å è½½ä¸å­èç ææ¯\n\n\n\n\n# 1ãç±»æä»¶ç»æ\n\né¦åè·å¾.classå­èç æä»¶\n\næ¹æ³ï¼\n\n * å¨ææ¬ææ¡£éåå¥javaä»£ç ï¼æä»¶åä¸ç±»åä¸è´ï¼ï¼å°æä»¶ç±»åæ¹ä¸º.java\n * javaç»ç«¯ä¸­ï¼æ§è¡javac x:...\\xxx.java\n\n\n\nä»¥ä¸æ¯å­èç æä»¶\n\n0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09 \n0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b 07 \n0000040 00 1c 01 00 06 3c 69 6e 69 74 3e 01 00 03 28 29 \n0000060 56 01 00 04 43 6f 64 65 01 00 0f 4c 69 6e 65 4e \n0000100 75 6d 62 65 72 54 61 62 6c 65 01 00 12 4c 6f 63 \n0000120 61 6c 56 61 72 69 61 62 6c 65 54 61 62 6c 65 01 \n0000140 00 04 74 68 69 73 01 00 1d 4c 63 6e 2f 69 74 63 \n0000160 61 73 74 2f 6a 76 6d 2f 74 35 2f 48 65 6c 6c 6f \n0000200 57 6f 72 6c 64 3b 01 00 04 6d 61 69 6e 01 00 16 \n0000220 28 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 \n0000240 69 6e 67 3b 29 56 01 00 04 61 72 67 73 01 00 13 \n0000260 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 \n0000300 6e 67 3b 01 00 10 4d 65 74 68 6f 64 50 61 72 61 \n0000320 6d 65 74 65 72 73 01 00 0a 53 6f 75 72 63 65 46 \n0000340 69 6c 65 01 00 0f 48 65 6c 6c 6f 57 6f 72 6c 64\n0000360 2e 6a 61 76 61 0c 00 07 00 08 07 00 1d 0c 00 1e \n0000400 00 1f 01 00 0b 68 65 6c 6c 6f 20 77 6f 72 6c 64 \n0000420 07 00 20 0c 00 21 00 22 01 00 1b 63 6e 2f 69 74 \n0000440 63 61 73 74 2f 6a 76 6d 2f 74 35 2f 48 65 6c 6c \n0000460 6f 57 6f 72 6c 64 01 00 10 6a 61 76 61 2f 6c 61 \n0000500 6e 67 2f 4f 62 6a 65 63 74 01 00 10 6a 61 76 61 \n0000520 2f 6c 61 6e 67 2f 53 79 73 74 65 6d 01 00 03 6f \n0000540 75 74 01 00 15 4c 6a 61 76 61 2f 69 6f 2f 50 72 \n0000560 69 6e 74 53 74 72 65 61 6d 3b 01 00 13 6a 61 76 \n0000600 61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d \n0000620 01 00 07 70 72 69 6e 74 6c 6e 01 00 15 28 4c 6a \n0000640 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b \n0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 00 01 \n0000700 00 07 00 08 00 01 00 09 00 00 00 2f 00 01 00 01 \n0000720 00 00 00 05 2a b7 00 01 b1 00 00 00 02 00 0a 00 \n0000740 00 00 06 00 01 00 00 00 04 00 0b 00 00 00 0c 00 \n0000760 01 00 00 00 05 00 0c 00 0d 00 00 00 09 00 0e 00 \n0001000 0f 00 02 00 09 00 00 00 37 00 02 00 01 00 00 00 \n0001020 09 b2 00 02 12 03 b6 00 04 b1 00 00 00 02 00 0a \n0001040 00 00 00 0a 00 02 00 00 00 06 00 08 00 07 00 0b \n0001060 00 00 00 0c 00 01 00 00 00 09 00 10 00 11 00 00 \n0001100 00 12 00 00 00 05 01 00 10 00 00 00 01 00 13 00 \n0001120 00 00 02 00 14\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n\n\næ ¹æ® jvm è§èï¼ç±»æä»¶ç»æå¦ä¸\n\nu4 \t\t\t magic\nu2             minor_version;    \nu2             major_version;    \nu2             constant_pool_count;    \ncp_info        constant_pool[constant_pool_count-1];    \nu2             access_flags;    \nu2             this_class;    \nu2             super_class;   \nu2             interfaces_count;    \nu2             interfaces[interfaces_count];   \nu2             fields_count;    \nfield_info     fields[fields_count];   \nu2             methods_count;    \nmethod_info    methods[methods_count];    \nu2             attributes_count;    \nattribute_info attributes[attributes_count];\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n# é­æ°\n\nu4 magic\n\nå¯¹åºå­èç æä»¶ç0~3ä¸ªå­è\n\n0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09\n\n# çæ¬\n\nu2 minor_version;\n\nu2 major_version;\n\n0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09\n\n34h = 52ï¼ä»£è¡¨jdk8\n\n# å¸¸éæ± \n\nè§èµææä»¶\n\nâ¦ç¥\n\n\n# 2ãå­èç æä»¤\n\nå¯åè\n\nhttps://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5\n\n# javapå·¥å·\n\noracle æä¾äº javap å·¥å·æ¥åç¼è¯ class æä»¶\n\njavap -v f:\\thread_study\\src\\com\\nyima\\jvm\\day01\\main.class\nf:\\thread_study>javap -v f:\\thread_study\\src\\com\\nyima\\jvm\\day5\\demo1.class\nclassfile /f:/thread_study/src/com/nyima/jvm/day5/demo1.class\n  last modified 2020-6-6; size 434 bytes\n  md5 checksum df1dce65bf6fb0b4c1de318051f4a67e\n  compiled from "demo1.java"\npublic class com.nyima.jvm.day5.demo1\n  minor version: 0\n  major version: 52\n  flags: acc_public, acc_super\nconstant pool:\n   #1 = methodref          #6.#15         // java/lang/object."<init>":()v\n   #2 = fieldref           #16.#17        // java/lang/system.out:ljava/io/printstream;\n   #3 = string             #18            // hello world\n   #4 = methodref          #19.#20        // java/io/printstream.println:(ljava/lang/string;)v\n   #5 = class              #21            // com/nyima/jvm/day5/demo1\n   #6 = class              #22            // java/lang/object\n   #7 = utf8               <init>\n   #8 = utf8               ()v\n   #9 = utf8               code\n  #10 = utf8               linenumbertable\n  #11 = utf8               main\n  #12 = utf8               ([ljava/lang/string;)v\n  #13 = utf8               sourcefile\n  #14 = utf8               demo1.java\n  #15 = nameandtype        #7:#8          // "<init>":()v\n  #16 = class              #23            // java/lang/system\n  #17 = nameandtype        #24:#25        // out:ljava/io/printstream;\n  #18 = utf8               hello world\n  #19 = class              #26            // java/io/printstream\n  #20 = nameandtype        #27:#28        // println:(ljava/lang/string;)v\n  #21 = utf8               com/nyima/jvm/day5/demo1\n  #22 = utf8               java/lang/object\n  #23 = utf8               java/lang/system\n  #24 = utf8               out\n  #25 = utf8               ljava/io/printstream;\n  #26 = utf8               java/io/printstream\n  #27 = utf8               println\n  #28 = utf8               (ljava/lang/string;)v\n{\n  public com.nyima.jvm.day5.demo1();\n    descriptor: ()v\n    flags: acc_public\n    code:\n      stack=1, locals=1, args_size=1\n         0: aload_0\n         1: invokespecial #1                  // method java/lang/object."<init>":()v\n         4: return\n      linenumbertable:\n        line 7: 0\n\n  public static void main(java.lang.string[]);\n    descriptor: ([ljava/lang/string;)v\n    flags: acc_public, acc_static\n    code:\n      stack=2, locals=1, args_size=1\n         0: getstatic     #2                  // field java/lang/system.out:ljava/io/printstream;\n         3: ldc           #3                  // string hello world\n         5: invokevirtual #4                  // method java/io/printstream.println:(ljava/lang/string;)v\n\n         8: return\n      linenumbertable:\n        line 9: 0\n        line 10: 8\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n\n\n# å¾è§£æ¹æ³æ§è¡æµç¨\n\nä»£ç \n\npublic class demo3_1 {    \n\tpublic static void main(string[] args) {        \n\t\tint a = 10;        \n\t\tint b = short.max_value + 1;        \n\t\tint c = a + b;        \n\t\tsystem.out.println(c);   \n    } \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nå¸¸éæ± è½½å¥è¿è¡æ¶å¸¸éæ± \n\nå¸¸éæ± ä¹å±äºæ¹æ³åºï¼åªä¸è¿è¿éåç¬æåºæ¥äº\n\n\n\næ¹æ³å­èç è½½å¥æ¹æ³åº\n\nï¼stack=2ï¼locals=4ï¼ å¯¹åºæä½æ°æ æ2ä¸ªç©ºé´ï¼æ¯ä¸ªç©ºé´4ä¸ªå­èï¼ï¼å±é¨åéè¡¨ä¸­æ4ä¸ªæ§½ä½\n\n\n\næ§è¡å¼æå¼å§æ§è¡å­èç \n\nbipush 10\n\n * å°ä¸ä¸ª byte åå¥æä½æ°æ \n   \n   ï¼å¶é¿åº¦ä¼è¡¥é½ 4 ä¸ªå­èï¼ï¼ç±»ä¼¼çæä»¤è¿æ\n   \n   * sipush å°ä¸ä¸ª short åå¥æä½æ°æ ï¼å¶é¿åº¦ä¼è¡¥é½ 4 ä¸ªå­èï¼\n   * ldc å°ä¸ä¸ª int åå¥æä½æ°æ \n   * ldc2_w å°ä¸ä¸ª long åå¥æä½æ°æ ï¼åä¸¤æ¬¡åå¥ï¼å ä¸º long æ¯ 8 ä¸ªå­èï¼\n   * è¿éå°çæ°å­é½æ¯åå­èç æä»¤å­å¨ä¸èµ·ï¼è¶è¿ short èå´çæ°å­å­å¥äºå¸¸éæ± \n\n\n\nistore 1\n\nå°æä½æ°æ æ é¡¶åç´ å¼¹åºï¼æ¾å¥å±é¨åéè¡¨çslot 1ä¸­\n\nå¯¹åºä»£ç ä¸­ç\n\na = 10\n\n\n1\n\n\n\n\n\n\nldc #3\n\nè¯»åè¿è¡æ¶å¸¸éæ± ä¸­#3ï¼å³32768(è¶è¿shortæå¤§å¼èå´çæ°ä¼è¢«æ¾å°è¿è¡æ¶å¸¸éæ± ä¸­)ï¼å°å¶å è½½å°æä½æ°æ ä¸­\n\næ³¨æ short.max_value æ¯ 32767ï¼æä»¥ 32768 = short.max_value + 1 å®éæ¯å¨ç¼è¯æé´è®¡ç®å¥½ç\n\n\n\nistore 2\n\nå°æä½æ°æ ä¸­çåç´ å¼¹åºï¼æ¾å°å±é¨åéè¡¨ç2å·ä½ç½®\n\n\n\n\n\niload1 iload2\n\nå°å±é¨åéè¡¨ä¸­1å·ä½ç½®å2å·ä½ç½®çåç´ æ¾å¥æä½æ°æ ä¸­\n\n * å ä¸ºåªè½å¨æä½æ°æ ä¸­æ§è¡è¿ç®æä½\n\n\n\n\n\niadd\n\nå°æä½æ°æ ä¸­çä¸¤ä¸ªåç´ å¼¹åºæ å¹¶ç¸å ï¼ç»æå¨åå¥æä½æ°æ ä¸­\n\n\n\n\n\nistore 3\n\nå°æä½æ°æ ä¸­çåç´ å¼¹åºï¼æ¾å¥å±é¨åéè¡¨ç3å·ä½ç½®\n\n\n\n\n\ngetstatic #4\n\nå¨è¿è¡æ¶å¸¸éæ± ä¸­æ¾å°#4ï¼åç°æ¯ä¸ä¸ªå¯¹è±¡\n\nå¨å åå­ä¸­æ¾å°è¯¥å¯¹è±¡ï¼å¹¶å°å¶å¼ç¨æ¾å¥æä½æ°æ ä¸­\n\n\n\n\n\niload 3\n\nå°å±é¨åéè¡¨ä¸­3å·ä½ç½®çåç´ åå¥æä½æ°æ ä¸­\n\n\n\ninvokevirtual 5\n\næ¾å°å¸¸éæ±  #5 é¡¹ï¼å®ä½å°æ¹æ³åº java/io/printstream.println:(i)v æ¹æ³\n\nçææ°çæ å¸§ï¼åé localsãstackç­ï¼\n\nä¼ éåæ°ï¼æ§è¡æ°æ å¸§ä¸­çå­èç \n\n\n\næ§è¡å®æ¯ï¼å¼¹åºæ å¸§\n\næ¸é¤ main æä½æ°æ åå®¹\n\n\n\nreturn å®æ main æ¹æ³è°ç¨ï¼å¼¹åº main æ å¸§ï¼ç¨åºç»æ\n\n# éè¿å­èç æä»¤æ¥åæé®é¢\n\nä»£ç \n\npublic class demo2 {\n\tpublic static void main(string[] args) {\n\t\tint i=0;\n\t\tint x=0;\n\t\twhile(i<10) {\n\t\t\tx = x++;\n\t\t\ti++;\n\t\t}\n\t\tsystem.out.println(x); //æ¥è¿ä¸º0\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nä¸ºä»ä¹æç»çxç»æä¸º0å¢ï¼ éè¿åæå­èç æä»¤å³å¯ç¥æ\n\ncode:\n     stack=2, locals=3, args_size=1\t//æä½æ°æ åé2ä¸ªç©ºé´ï¼å±é¨åéè¡¨åé3ä¸ªç©ºé´\n        0: iconst_0\t//åå¤ä¸ä¸ªå¸¸æ°0\n        1: istore_1\t//å°å¸¸æ°0æ¾å¥å±é¨åéè¡¨ç1å·æ§½ä½ i=0\n        2: iconst_0\t//åå¤ä¸ä¸ªå¸¸æ°0\n        3: istore_2\t//å°å¸¸æ°0æ¾å¥å±é¨åéç2å·æ§½ä½ x=0\t\n        4: iload_1\t\t//å°å±é¨åéè¡¨1å·æ§½ä½çæ°æ¾å¥æä½æ°æ ä¸­\n        5: bipush        10\t//å°æ°å­10æ¾å¥æä½æ°æ ä¸­ï¼æ­¤æ¶æä½æ°æ ä¸­æ2ä¸ªæ°\n        7: if_icmpge     21\t//æ¯è¾æä½æ°æ ä¸­çä¸¤ä¸ªæ°ï¼å¦æä¸é¢çæ°å¤§äºä¸é¢çæ°ï¼å°±è·³è½¬å°21ãè¿éçæ¯è¾æ¯å°ä¸¤ä¸ªæ°ååæ³ãå ä¸ºæ¶åè¿ç®æä½ï¼æä»¥ä¼å°ä¸¤ä¸ªæ°å¼¹åºæä½æ°æ æ¥è¿è¡è¿ç®ãè¿ç®ç»æåæä½æ°æ ä¸ºç©º\n       10: iload_2\t\t//å°å±é¨åé2å·æ§½ä½çæ°æ¾å¥æä½æ°æ ä¸­ï¼æ¾å¥çå¼æ¯0\n       11: iinc          2, 1\t//å°å±é¨åé2å·æ§½ä½çæ°å 1ï¼èªå¢åï¼æ§½ä½ä¸­çå¼ä¸º1\n       14: istore_2\t//å°æä½æ°æ ä¸­çæ°æ¾å¥å°å±é¨åéè¡¨ç2å·æ§½ä½ï¼2å·æ§½ä½çå¼ååä¸ºäº0\n       15: iinc          1, 1 //1å·æ§½ä½çå¼èªå¢1\n       18: goto          4 //è·³è½¬å°ç¬¬4æ¡æä»¤\n       21: getstatic     #2                  // field java/lang/system.out:ljava/io/printstream;\n       24: iload_2\n       25: invokevirtual #3                  // method java/io/printstream.println:(i)v\n       28: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n# æé æ¹æ³\n\n# cinit()v\n\npublic class demo3 {\n\tstatic int i = 10;\n\n\tstatic {\n\t\ti = 20;\n\t}\n\n\tstatic {\n\t\ti = 30;\n\t}\n\n\tpublic static void main(string[] args) {\n\t\tsystem.out.println(i); //ç»æä¸º30\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nç¼è¯å¨ä¼æä»ä¸è³ä¸çé¡ºåºï¼æ¶éææ static éæä»£ç ååéææåèµå¼çä»£ç ï¼åå¹¶ä¸ºä¸ä¸ªç¹æ®çæ¹æ³ cinit()v ï¼\n\nstack=1, locals=0, args_size=0\n         0: bipush        10\n         2: putstatic     #3                  // field i:i\n         5: bipush        20\n         7: putstatic     #3                  // field i:i\n        10: bipush        30\n        12: putstatic     #3                  // field i:i\n        15: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n# init()v\n\npublic class demo4 {\n\tprivate string a = "s1";\n\n\t{\n\t\tb = 20;\n\t}\n\n\tprivate int b = 10;\n\n\t{\n\t\ta = "s2";\n\t}\n\n\tpublic demo4(string a, int b) {\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t}\n\n\tpublic static void main(string[] args) {\n\t\tdemo4 d = new demo4("s3", 30);\n\t\tsystem.out.println(d.a);\n\t\tsystem.out.println(d.b);\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nç¼è¯å¨ä¼æä»ä¸è³ä¸çé¡ºåºï¼æ¶éææ {} ä»£ç ååæååéèµå¼çä»£ç ï¼å½¢ææ°çæé æ¹æ³ï¼ä½åå§æé æ¹æ³åçä»£ç æ»æ¯å¨å\n\ncode:\n     stack=2, locals=3, args_size=3\n        0: aload_0\n        1: invokespecial #1                  // method java/lang/object."<init>":()v\n        4: aload_0\n        5: ldc           #2                  // string s1\n        7: putfield      #3                  // field a:ljava/lang/string;\n       10: aload_0\n       11: bipush        20\n       13: putfield      #4                  // field b:i\n       16: aload_0\n       17: bipush        10\n       19: putfield      #4                  // field b:i\n       22: aload_0\n       23: ldc           #5                  // string s2\n       25: putfield      #3                  // field a:ljava/lang/string;\n       //åå§æé æ¹æ³å¨æåæ§è¡\n       28: aload_0\n       29: aload_1\n       30: putfield      #3                  // field a:ljava/lang/string;\n       33: aload_0\n       34: iload_2\n       35: putfield      #4                  // field b:i\n       38: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n# æ¹æ³è°ç¨\n\npublic class demo5 {\n\tpublic demo5() {\n\n\t}\n\n\tprivate void test1() {\n\n\t}\n\n\tprivate final void test2() {\n\n\t}\n\n\tpublic void test3() {\n\n\t}\n\n\tpublic static void test4() {\n\n\t}\n\n\tpublic static void main(string[] args) {\n\t\tdemo5 demo5 = new demo5();\n\t\tdemo5.test1();\n\t\tdemo5.test2();\n\t\tdemo5.test3();\n\t\tdemo5.test4();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nä¸åæ¹æ³å¨è°ç¨æ¶ï¼å¯¹åºçèææºæä»¤ææåºå«\n\n * ç§æãæé ãè¢«finalä¿®é¥°çæ¹æ³ï¼å¨è°ç¨æ¶é½ä½¿ç¨invokespecialæä»¤\n * æ®éæåæ¹æ³å¨è°ç¨æ¶ï¼ä½¿ç¨invokespecialæä»¤ãå ä¸ºç¼è¯æé´æ æ³ç¡®å®è¯¥æ¹æ³çåå®¹ï¼åªæå¨è¿è¡æé´æè½ç¡®å®\n * éææ¹æ³å¨è°ç¨æ¶ä½¿ç¨invokestaticæä»¤\n\ncode:\n      stack=2, locals=2, args_size=1\n         0: new           #2                  // class com/nyima/jvm/day5/demo5 \n         3: dup\n         4: invokespecial #3                  // method "<init>":()v\n         7: astore_1\n         8: aload_1\n         9: invokespecial #4                  // method test1:()v\n        12: aload_1\n        13: invokespecial #5                  // method test2:()v\n        16: aload_1\n        17: invokevirtual #6                  // method test3:()v\n        20: invokestatic  #7                  // method test4:()v\n        23: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n * new æ¯åå»ºãå¯¹è±¡ãï¼ç»å¯¹è±¡åéå åå­ï¼æ§è¡æåä¼å°ãå¯¹è±¡å¼ç¨ãåå¥æä½æ°æ \n * dup æ¯èµå¼æä½æ°æ æ é¡¶çåå®¹ï¼æ¬ä¾å³ä¸ºãå¯¹è±¡å¼ç¨ãï¼ä¸ºä»ä¹éè¦ä¸¤ä»½å¼ç¨å¢ï¼ä¸ä¸ªæ¯è¦éå invokespecial è°ç¨è¯¥å¯¹è±¡çæé æ¹æ³ âinitâð¦)v ï¼ä¼æ¶èææ é¡¶ä¸ä¸ªå¼ç¨ï¼ï¼å¦ä¸ä¸ªè¦ éå astore_1 èµå¼ç»å±é¨åé\n * ç»æ¹æ³ï¼ï¬nalï¼ï¼ç§ææ¹æ³ï¼privateï¼ï¼æé æ¹æ³é½æ¯ç± invokespecial æä»¤æ¥è°ç¨ï¼å±äºéæç»å®\n * æ®éæåæ¹æ³æ¯ç± invokevirtual è°ç¨ï¼å±äºå¨æç»å®ï¼å³æ¯æå¤æ æåæ¹æ³ä¸éææ¹æ³è°ç¨çå¦ä¸ä¸ªåºå«æ¯ï¼æ§è¡æ¹æ³åæ¯å¦éè¦ãå¯¹è±¡å¼ç¨ã\n\n# å¤æåç\n\nå ä¸ºæ®éæåæ¹æ³éè¦å¨è¿è¡æ¶æè½ç¡®å®å·ä½çåå®¹ï¼æä»¥èææºéè¦è°ç¨invokevirtualæä»¤\n\nå¨æ§è¡invokevirtualæä»¤æ¶ï¼ç»åäºä»¥ä¸å ä¸ªæ­¥éª¤\n\n * åéè¿æ å¸§ä¸­å¯¹è±¡çå¼ç¨æ¾å°å¯¹è±¡\n * åæå¯¹è±¡å¤´ï¼æ¾å°å¯¹è±¡å®éçclass\n * classç»æä¸­ævtable\n * æ¥è¯¢vtableæ¾å°æ¹æ³çå·ä½å°å\n * æ§è¡æ¹æ³çå­èç \n\n# å¼å¸¸å¤ç\n\n# try-catch\n\npublic class demo1 {\n\tpublic static void main(string[] args) {\n\t\tint i = 0;\n\t\ttry {\n\t\t\ti = 10;\n\t\t}catch (exception e) {\n\t\t\ti = 20;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nå¯¹åºå­èç æä»¤\n\ncode:\n     stack=1, locals=3, args_size=1\n        0: iconst_0\n        1: istore_1\n        2: bipush        10\n        4: istore_1\n        5: goto          12\n        8: astore_2\n        9: bipush        20\n       11: istore_1\n       12: return\n     //å¤åºæ¥ä¸ä¸ªå¼å¸¸è¡¨\n     exception table:\n        from    to  target type\n            2     5     8   class java/lang/exception\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n * å¯ä»¥çå°å¤åºæ¥ä¸ä¸ª exception table çç»æï¼[from, to) æ¯åé­åå¼ï¼ä¹å°±æ¯æ£æµ2~4è¡ï¼çæ£æµèå´ï¼ä¸æ¦è¿ä¸ªèå´åçå­èç æ§è¡åºç°å¼å¸¸ï¼åéè¿ type å¹éå¼å¸¸ç±»åï¼å¦æä¸è´ï¼è¿å¥ target ææç¤ºè¡å·\n * 8è¡çå­èç æä»¤ astore_2 æ¯å°å¼å¸¸å¯¹è±¡å¼ç¨å­å¥å±é¨åéè¡¨ç2å·ä½ç½®ï¼ä¸ºeï¼\n\n# å¤ä¸ªsingle-catch\n\npublic class demo1 {\n\tpublic static void main(string[] args) {\n\t\tint i = 0;\n\t\ttry {\n\t\t\ti = 10;\n\t\t}catch (arithmeticexception e) {\n\t\t\ti = 20;\n\t\t}catch (exception e) {\n\t\t\ti = 30;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¯¹åºçå­èç \n\ncode:\n     stack=1, locals=3, args_size=1\n        0: iconst_0\n        1: istore_1\n        2: bipush        10\n        4: istore_1\n        5: goto          19\n        8: astore_2\n        9: bipush        20\n       11: istore_1\n       12: goto          19\n       15: astore_2\n       16: bipush        30\n       18: istore_1\n       19: return\n     exception table:\n        from    to  target type\n            2     5     8   class java/lang/arithmeticexception\n            2     5    15   class java/lang/exception\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n * å ä¸ºå¼å¸¸åºç°æ¶ï¼åªè½è¿å¥ exception table ä¸­ä¸ä¸ªåæ¯ï¼æä»¥å±é¨åéè¡¨ slot 2 ä½ç½®è¢«å±ç¨\n\n# finally\n\npublic class demo2 {\n\tpublic static void main(string[] args) {\n\t\tint i = 0;\n\t\ttry {\n\t\t\ti = 10;\n\t\t} catch (exception e) {\n\t\t\ti = 20;\n\t\t} finally {\n\t\t\ti = 30;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nå¯¹åºå­èç \n\ncode:\n     stack=1, locals=4, args_size=1\n        0: iconst_0\n        1: istore_1\n        //tryå\n        2: bipush        10\n        4: istore_1\n        //tryåæ§è¡å®åï¼ä¼æ§è¡finally    \n        5: bipush        30\n        7: istore_1\n        8: goto          27\n       //catchå     \n       11: astore_2 //å¼å¸¸ä¿¡æ¯æ¾å¥å±é¨åéè¡¨ç2å·æ§½ä½\n       12: bipush        20\n       14: istore_1\n       //catchåæ§è¡å®åï¼ä¼æ§è¡finally        \n       15: bipush        30\n       17: istore_1\n       18: goto          27\n       //åºç°å¼å¸¸ï¼ä½æªè¢«exceptionæè·ï¼ä¼æåºå¶ä»å¼å¸¸ï¼è¿æ¶ä¹éè¦æ§è¡finallyåä¸­çä»£ç    \n       21: astore_3\n       22: bipush        30\n       24: istore_1\n       25: aload_3\n       26: athrow  //æåºå¼å¸¸\n       27: return\n     exception table:\n        from    to  target type\n            2     5    11   class java/lang/exception\n            2     5    21   any\n           11    15    21   any\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\nå¯ä»¥çå° ï¬nally ä¸­çä»£ç è¢«å¤å¶äº 3 ä»½ï¼åå«æ¾å¥ try æµç¨ï¼catch æµç¨ä»¥å catchå©ä½çå¼å¸¸ç±»åæµç¨\n\næ³¨æï¼è½ç¶ä»å­èç æä»¤çæ¥ï¼æ¯ä¸ªåä¸­é½æfinallyåï¼ä½æ¯finallyåä¸­çä»£ç åªä¼è¢«æ§è¡ä¸æ¬¡\n\n# finallyä¸­çreturn\n\npublic class demo3 {\n\tpublic static void main(string[] args) {\n\t\tint i = demo3.test();\n        //ç»æä¸º20\n\t\tsystem.out.println(i);\n\t}\n\n\tpublic static int test() {\n\t\tint i;\n\t\ttry {\n\t\t\ti = 10;\n\t\t\treturn i;\n\t\t} finally {\n\t\t\ti = 20;\n\t\t\treturn i;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nå¯¹åºå­èç \n\ncode:\n     stack=1, locals=3, args_size=0\n        0: bipush        10\n        2: istore_0\n        3: iload_0\n        4: istore_1  //æå­è¿åå¼\n        5: bipush        20\n        7: istore_0\n        8: iload_0\n        9: ireturn\t//ireturnä¼è¿åæä½æ°æ é¡¶çæ´åå¼20\n       //å¦æåºç°å¼å¸¸ï¼è¿æ¯ä¼æ§è¡finallyåä¸­çåå®¹ï¼æ²¡ææåºå¼å¸¸\n       10: astore_2\n       11: bipush        20\n       13: istore_0\n       14: iload_0\n       15: ireturn\t//è¿éæ²¡æathrowäºï¼ä¹å°±æ¯å¦æå¨finallyåä¸­å¦ææè¿åæä½çè¯ï¼ä¸tryåä¸­åºç°å¼å¸¸ï¼ä¼åæå¼å¸¸ï¼\n     exception table:\n        from    to  target type\n            0     5    10   any\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n * ç±äº ï¬nally ä¸­ç ireturn è¢«æå¥äºææå¯è½çæµç¨ï¼å æ­¤è¿åç»æè¯å®ä»¥ï¬nallyçä¸ºå\n * è³äºå­èç ä¸­ç¬¬ 2 è¡ï¼ä¼¼ä¹æ²¡å¥ç¨ï¼ä¸çä¸ªä¼ç¬ï¼çä¸ä¸ªä¾å­\n * è·ä¸ä¾ä¸­ç ï¬nally ç¸æ¯ï¼åç°æ²¡æ athrow äºï¼è¿åè¯æä»¬ï¼å¦æå¨ ï¬nally ä¸­åºç°äº returnï¼ä¼åæå¼å¸¸\n * æä»¥ä¸è¦å¨finallyä¸­è¿è¡è¿åæä½\n\n# è¢«åæçå¼å¸¸\n\npublic class demo3 {\n   public static void main(string[] args) {\n      int i = demo3.test();\n      //æç»ç»æä¸º20\n      system.out.println(i);\n   }\n\n   public static int test() {\n      int i;\n      try {\n         i = 10;\n         //è¿éåºè¯¥ä¼æåºå¼å¸¸\n         i = i/0;\n         return i;\n      } finally {\n         i = 20;\n         return i;\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nä¼åç°æå°ç»æä¸º20ï¼å¹¶æªæåºå¼å¸¸\n\n# finallyä¸å¸¦return\n\npublic class demo4 {\n\tpublic static void main(string[] args) {\n\t\tint i = demo4.test();\n\t\tsystem.out.println(i);\n\t}\n\n\tpublic static int test() {\n\t\tint i = 10;\n\t\ttry {\n\t\t\treturn i;\n\t\t} finally {\n\t\t\ti = 20;\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¯¹åºå­èç \n\ncode:\n     stack=1, locals=3, args_size=0\n        0: bipush        10\n        2: istore_0 //èµå¼ç»i 10\n        3: iload_0\t//å è½½å°æä½æ°æ é¡¶\n        4: istore_1 //å è½½å°å±é¨åéè¡¨ç1å·ä½ç½®\n        5: bipush        20\n        7: istore_0 //èµå¼ç»i 20\n        8: iload_1 //å è½½å±é¨åéè¡¨1å·ä½ç½®çæ°10å°æä½æ°æ \n        9: ireturn //è¿åæä½æ°æ é¡¶åç´  10\n       10: astore_2\n       11: bipush        20\n       13: istore_0\n       14: aload_2 //å è½½å¼å¸¸\n       15: athrow //æåºå¼å¸¸\n     exception table:\n        from    to  target type\n            3     5    10   any\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n# synchronized\n\npublic class demo5 {\n\tpublic static void main(string[] args) {\n\t\tint i = 10;\n\t\tlock lock = new lock();\n\t\tsynchronized (lock) {\n\t\t\tsystem.out.println(i);\n\t\t}\n\t}\n}\n\nclass lock{}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¯¹åºå­èç \n\ncode:\n     stack=2, locals=5, args_size=1\n        0: bipush        10\n        2: istore_1\n        3: new           #2                  // class com/nyima/jvm/day06/lock\n        6: dup //å¤å¶ä¸ä»½ï¼æ¾å°æä½æ°æ é¡¶ï¼ç¨äºæé å½æ°æ¶è\n        7: invokespecial #3                  // method com/nyima/jvm/day06/lock."<init>":()v\n       10: astore_2 //å©ä¸çä¸ä»½æ¾å°å±é¨åéè¡¨ç2å·ä½ç½®\n       11: aload_2 //å è½½å°æä½æ°æ \n       12: dup //å¤å¶ä¸ä»½ï¼æ¾å°æä½æ°æ ï¼ç¨äºå éæ¶æ¶è\n       13: astore_3 //å°æä½æ°æ é¡¶åç´ å¼¹åºï¼æå­å°å±é¨åéè¡¨çä¸å·æ§½ä½ãè¿æ¶æä½æ°æ ä¸­æä¸ä»½å¯¹è±¡çå¼ç¨\n       14: monitorenter //å é\n       //éä½åä»£ç åä¸­çæä½    \n       15: getstatic     #4                  // field java/lang/system.out:ljava/io/printstream;\n       18: iload_1\n       19: invokevirtual #5                  // method java/io/printstream.println:(i)v\n       //å è½½å±é¨åéè¡¨ä¸­ä¸å·æ§½ä½å¯¹è±¡çå¼ç¨ï¼ç¨äºè§£é    \n       22: aload_3    \n       23: monitorexit //è§£é\n       24: goto          34\n       //å¼å¸¸æä½    \n       27: astore        4\n       29: aload_3\n       30: monitorexit //è§£é\n       31: aload         4\n       33: athrow\n       34: return\n     //å¯ä»¥çåºï¼æ è®ºä½æ¶åºç°å¼å¸¸ï¼é½ä¼è·³è½¬å°27è¡ï¼å°å¼å¸¸æ¾å¥å±é¨åéä¸­ï¼å¹¶è¿è¡è§£éæä½ï¼ç¶åå è½½å¼å¸¸å¹¶æåºå¼å¸¸ã      \n     exception table:\n        from    to  target type\n           15    24    27   any\n           27    31    27   any\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\n\n# 3ãç¼è¯æå¤ç\n\næè°ç è¯­æ³ç³ ï¼å¶å®å°±æ¯æ java ç¼è¯å¨æ *.java æºç ç¼è¯ä¸º *.class å­èç çè¿ç¨ä¸­ï¼èªå¨çæåè½¬æ¢çä¸äºä»£ç ï¼ä¸»è¦æ¯ä¸ºäºåè½»ç¨åºåçè´æï¼ç®æ¯ java ç¼è¯å¨ç»æä»¬çä¸ä¸ªé¢å¤ç¦å©\n\næ³¨æï¼ä»¥ä¸ä»£ç çåæï¼åå©äº javap å·¥å·ï¼idea çåç¼è¯åè½ï¼idea æä»¶ jclasslib ç­å·¥å·ãå¦å¤ï¼ ç¼è¯å¨è½¬æ¢çç»æç´æ¥å°±æ¯ class å­èç ï¼åªæ¯ä¸ºäºä¾¿äºéè¯»ï¼ç»åºäº å ä¹ç­ä»· ç java æºç æ¹å¼ï¼å¹¶ä¸æ¯ç¼è¯å¨è¿ä¼è½¬æ¢åºä¸­é´ç java æºç ï¼åè®°ã\n\n# é»è®¤æé å½æ°\n\npublic class candy1 {\n\n}\n\n\n1\n2\n3\n\n\nç»è¿ç¼è¯æä¼åå\n\npublic class candy1 {\n   //è¿ä¸ªæ åæé å¨æ¯javaç¼è¯å¨å¸®æä»¬å ä¸ç\n   public candy1() {\n      //å³è°ç¨ç¶ç±» object çæ åæé æ¹æ³ï¼å³è°ç¨ java/lang/object." <init>":()v\n      super();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# èªå¨æè£ç®±\n\nåºæ¬ç±»ååå¶åè£ç±»åçç¸äºè½¬æ¢è¿ç¨ï¼ç§°ä¸ºæè£ç®±\n\nå¨jdk 5ä»¥åï¼å®ä»¬çè½¬æ¢å¯ä»¥å¨ç¼è¯æèªå¨å®æ\n\npublic class demo2 {\n   public static void main(string[] args) {\n      integer x = 1;\n      int y = x;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\nè½¬æ¢è¿ç¨å¦ä¸\n\npublic class demo2 {\n   public static void main(string[] args) {\n      //åºæ¬ç±»åèµå¼ç»åè£ç±»åï¼ç§°ä¸ºè£ç®±\n      integer x = integer.valueof(1);\n      //åè£ç±»åèµå¼ç»åºæ¬ç±»åï¼ç§°è°æç®±\n      int y = x.intvalue();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\n# æ³åéååå¼\n\næ³åä¹æ¯å¨ jdk 5 å¼å§å å¥çç¹æ§ï¼ä½ java å¨ç¼è¯æ³åä»£ç åä¼æ§è¡ æ³åæ¦é¤ çå¨ä½ï¼å³æ³åä¿¡æ¯å¨ç¼è¯ä¸ºå­èç ä¹åå°±ä¸¢å¤±äºï¼å®éçç±»åé½å½åäº object ç±»åæ¥å¤çï¼\n\npublic class demo3 {\n   public static void main(string[] args) {\n      list<integer> list = new arraylist<>();\n      list.add(10);\n      integer x = list.get(0);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nå¯¹åºå­èç \n\ncode:\n    stack=2, locals=3, args_size=1\n       0: new           #2                  // class java/util/arraylist\n       3: dup\n       4: invokespecial #3                  // method java/util/arraylist."<init>":()v\n       7: astore_1\n       8: aload_1\n       9: bipush        10\n      11: invokestatic  #4                  // method java/lang/integer.valueof:(i)ljava/lang/integer;\n      //è¿éè¿è¡äºæ³åæ¦é¤ï¼å®éè°ç¨çæ¯add(objcet o)\n      14: invokeinterface #5,  2            // interfacemethod java/util/list.add:(ljava/lang/object;)z\n\n      19: pop\n      20: aload_1\n      21: iconst_0\n      //è¿éä¹è¿è¡äºæ³åæ¦é¤ï¼å®éè°ç¨çæ¯get(object o)   \n      22: invokeinterface #6,  2            // interfacemethod java/util/list.get:(i)ljava/lang/object;\n//è¿éè¿è¡äºç±»åè½¬æ¢ï¼å°objectè½¬æ¢æäºinteger\n      27: checkcast     #7                  // class java/lang/integer\n      30: astore_2\n      31: return\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\næä»¥è°ç¨getå½æ°åå¼æ¶ï¼æä¸ä¸ªç±»åè½¬æ¢çæä½\n\ninteger x = (integer) list.get(0);\n\n\n1\n\n\nå¦æè¦å°è¿åç»æèµå¼ç»ä¸ä¸ªintç±»åçåéï¼åè¿æèªå¨æç®±çæä½\n\nint x = (integer) list.get(0).intvalue();\n\n\n1\n\n\n# å¯ååæ°\n\npublic class demo4 {\n   public static void foo(string... args) {\n      //å°argsèµå¼ç»arrï¼å¯ä»¥çåºstring...å®éå°±æ¯string[] \n      string[] arr = args;\n      system.out.println(arr.length);\n   }\n\n   public static void main(string[] args) {\n      foo("hello", "world");\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¯ååæ° stringâ¦ args å¶å®æ¯ä¸ä¸ª string[] args ï¼ä»ä»£ç ä¸­çèµå¼è¯­å¥ä¸­å°±å¯ä»¥çåºæ¥ã å æ · java ç¼è¯å¨ä¼å¨ç¼è¯æé´å°ä¸è¿°ä»£ç åæ¢ä¸ºï¼\n\npublic class demo4 {\n   public demo4 {}\n\n    \n   public static void foo(string[] args) {\n      string[] arr = args;\n      system.out.println(arr.length);\n   }\n\n   public static void main(string[] args) {\n      foo(new string[]{"hello", "world"});\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\næ³¨æï¼å¦æè°ç¨çæ¯foo()ï¼å³æªä¼ éåæ°æ¶ï¼ç­ä»·ä»£ç ä¸ºfoo(new string[]{})ï¼åå»ºäºä¸ä¸ªç©ºæ°ç»ï¼èä¸æ¯ç´æ¥ä¼ éçnull\n\n# foreach\n\npublic class demo5 {\n\tpublic static void main(string[] args) {\n        //æ°ç»èµåå¼çç®ååæ³ä¹æ¯ä¸ç§è¯­æ³ç³ã\n\t\tint[] arr = {1, 2, 3, 4, 5};\n\t\tfor(int x : arr) {\n\t\t\tsystem.out.println(x);\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\nç¼è¯å¨ä¼å¸®æä»¬è½¬æ¢ä¸º\n\npublic class demo5 {\n    public demo5 {}\n\n\tpublic static void main(string[] args) {\n\t\tint[] arr = new int[]{1, 2, 3, 4, 5};\n\t\tfor(int i=0; i<arr.length; ++i) {\n\t\t\tint x = arr[i];\n\t\t\tsystem.out.println(x);\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nå¦ææ¯éåä½¿ç¨foreach\n\npublic class demo5 {\n   public static void main(string[] args) {\n      list<integer> list = arrays.aslist(1, 2, 3, 4, 5);\n      for (integer x : list) {\n         system.out.println(x);\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\néåè¦ä½¿ç¨foreachï¼éè¦è¯¥éåç±»å®ç°äºiterableæ¥å£ï¼å ä¸ºéåçéåéè¦ç¨å°è¿­ä»£å¨iterator\n\npublic class demo5 {\n    public demo5 {}\n    \n   public static void main(string[] args) {\n      list<integer> list = arrays.aslist(1, 2, 3, 4, 5);\n      //è·å¾è¯¥éåçè¿­ä»£å¨\n      iterator<integer> iterator = list.iterator();\n      while(iterator.hasnext()) {\n         integer x = iterator.next();\n         system.out.println(x);\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n# switchå­ç¬¦ä¸²\n\npublic class demo6 {\n   public static void main(string[] args) {\n      string str = "hello";\n      switch (str) {\n         case "hello" :\n            system.out.println("h");\n            break;\n         case "world" :\n            system.out.println("w");\n            break;\n         default:\n            break;\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¨ç¼è¯å¨ä¸­æ§è¡çæä½\n\npublic class demo6 {\n   public demo6() {\n      \n   }\n   public static void main(string[] args) {\n      string str = "hello";\n      int x = -1;\n      //éè¿å­ç¬¦ä¸²çhashcode+valueæ¥å¤æ­æ¯å¦å¹é\n      switch (str.hashcode()) {\n         //helloçhashcode\n         case 99162322 :\n            //åæ¬¡æ¯è¾ï¼å ä¸ºå­ç¬¦ä¸²çhashcodeæå¯è½ç¸ç­\n            if(str.equals("hello")) {\n               x = 0;\n            }\n            break;\n         //worldçhashcode\n         case 11331880 :\n            if(str.equals("world")) {\n               x = 1;\n            }\n            break;\n         default:\n            break;\n      }\n\n      //ç¨ç¬¬äºä¸ªswitchå¨è¿è¡è¾åºå¤æ­\n      switch (x) {\n         case 0:\n            system.out.println("h");\n            break;\n         case 1:\n            system.out.println("w");\n            break;\n         default:\n            break;\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n\n\nè¿ç¨è¯´æï¼\n\n * å¨ç¼è¯æé´ï¼åä¸ªçswitchè¢«åä¸ºäºä¸¤ä¸ª\n   * ç¬¬ä¸ä¸ªç¨æ¥å¹éå­ç¬¦ä¸²ï¼å¹¶ç»xèµå¼\n     * å­ç¬¦ä¸²çå¹éç¨å°äºå­ç¬¦ä¸²çhashcodeï¼è¿ç¨å°äºequalsæ¹æ³\n     * ä½¿ç¨hashcodeæ¯ä¸ºäºæé«æ¯è¾æçï¼ä½¿ç¨equalsæ¯é²æ­¢æhashcodeå²çªï¼å¦bmåc.ï¼\n   * ç¬¬äºä¸ªç¨æ¥æ ¹æ®xçå¼æ¥å³å®è¾åºè¯­å¥\n\n# switchæä¸¾\n\npublic class demo7 {\n   public static void main(string[] args) {\n      sex sex = sex.male;\n      switch (sex) {\n         case male:\n            system.out.println("man");\n            break;\n         case female:\n            system.out.println("woman");\n            break;\n         default:\n            break;\n      }\n   }\n}\n\nenum sex {\n   male, female;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\nç¼è¯å¨ä¸­æ§è¡çä»£ç å¦ä¸\n\npublic class demo7 {\n   /**     \n    * å®ä¹ä¸ä¸ªåæç±»ï¼ä» jvm ä½¿ç¨ï¼å¯¹æä»¬ä¸å¯è§ï¼     \n    * ç¨æ¥æ å°æä¸¾ç ordinal ä¸æ°ç»åç´ çå³ç³»     \n    * æä¸¾ç ordinal è¡¨ç¤ºæä¸¾å¯¹è±¡çåºå·ï¼ä» 0 å¼å§     \n    * å³ male ç ordinal()=0ï¼female ç ordinal()=1     \n    */ \n   static class $map {\n      //æ°ç»å¤§å°å³ä¸ºæä¸¾åç´ ä¸ªæ°ï¼éé¢å­æ¾äºcaseç¨äºæ¯è¾çæ°å­\n      static int[] map = new int[2];\n      static {\n         //ordinalå³æä¸¾åç´ å¯¹åºæå¨çä½ç½®ï¼maleä¸º0ï¼femaleä¸º1\n         map[sex.male.ordinal()] = 1;\n         map[sex.female.ordinal()] = 2;\n      }\n   }\n\n   public static void main(string[] args) {\n      sex sex = sex.male;\n      //å°å¯¹åºä½ç½®æä¸¾åç´ çå¼èµç»xï¼ç¨äºcaseæä½\n      int x = $map.map[sex.ordinal()];\n      switch (x) {\n         case 1:\n            system.out.println("man");\n            break;\n         case 2:\n            system.out.println("woman");\n            break;\n         default:\n            break;\n      }\n   }\n}\n\nenum sex {\n   male, female;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n\n\n# æä¸¾ç±»\n\nenum sex {\n   male, female;\n}\n\n\n1\n2\n3\n\n\nè½¬æ¢åçä»£ç \n\npublic final class sex extends enum<sex> {   \n   //å¯¹åºæä¸¾ç±»ä¸­çåç´ \n   public static final sex male;    \n   public static final sex female;    \n   private static final sex[] $values;\n   \n    static {       \n    \t//è°ç¨æé å½æ°ï¼ä¼ å¥æä¸¾åç´ çå¼åordinal\n    \tmale = new sex("male", 0);    \n        female = new sex("female", 1);   \n        $values = new sex[]{male, female}; \n   }\n \t\n   //è°ç¨ç¶ç±»ä¸­çæ¹æ³\n    private sex(string name, int ordinal) {     \n        super(name, ordinal);    \n    }\n   \n    public static sex[] values() {  \n        return $values.clone();  \n    }\n    public static sex valueof(string name) { \n        return enum.valueof(sex.class, name);  \n    } \n   \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n# å¿ååé¨ç±»\n\npublic class demo8 {\n   public static void main(string[] args) {\n      runnable runnable = new runnable() {\n         @override\n         public void run() {\n            system.out.println("running...");\n         }\n      };\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nè½¬æ¢åçä»£ç \n\npublic class demo8 {\n   public static void main(string[] args) {\n      //ç¨é¢å¤åå»ºçç±»æ¥åå»ºå¿ååé¨ç±»å¯¹è±¡\n      runnable runnable = new demo8$1();\n   }\n}\n\n//åå»ºäºä¸ä¸ªé¢å¤çç±»ï¼å®ç°äºrunnableæ¥å£\nfinal class demo8$1 implements runnable {\n   public demo8$1() {}\n\n   @override\n   public void run() {\n      system.out.println("running...");\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nå¦æå¿ååé¨ç±»ä¸­å¼ç¨äºå±é¨åé\n\npublic class demo8 {\n   public static void main(string[] args) {\n      int x = 1;\n      runnable runnable = new runnable() {\n         @override\n         public void run() {\n            system.out.println(x);\n         }\n      };\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nè½¬ååä»£ç \n\npublic class demo8 {\n   public static void main(string[] args) {\n      int x = 1;\n      runnable runnable = new runnable() {\n         @override\n         public void run() {\n            system.out.println(x);\n         }\n      };\n   }\n}\n\nfinal class demo8$1 implements runnable {\n   //å¤åå»ºäºä¸ä¸ªåé\n   int val$x;\n   //åä¸ºäºæåæé å¨\n   public demo8$1(int x) {\n      this.val$x = x;\n   }\n\n   @override\n   public void run() {\n      system.out.println(val$x);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n\n\n\n# 4ãç±»å è½½é¶æ®µ\n\n# å è½½\n\n * å°ç±»çå­èç è½½å¥\n   \n   æ¹æ³åº\n   \n   ï¼1.8åä¸ºåç©ºé´ï¼å¨æ¬å°åå­ä¸­ï¼ä¸­ï¼åé¨éç¨ c++ ç instanceklass æè¿° java ç±»ï¼å®çéè¦ ï¬eld æï¼\n   \n   * _java_mirror å³ java çç±»éåï¼ä¾å¦å¯¹ string æ¥è¯´ï¼å®çéåç±»å°±æ¯ string.classï¼ä½ç¨æ¯æ klass æ´é²ç» java ä½¿ç¨\n   * _super å³ç¶ç±»\n   * _ï¬elds å³æååé\n   * _methods å³æ¹æ³\n   * _constants å³å¸¸éæ± \n   * _class_loader å³ç±»å è½½å¨\n   * _vtable èæ¹æ³è¡¨\n   * _itable æ¥å£æ¹æ³\n\n * å¦æè¿ä¸ªç±»è¿æç¶ç±»æ²¡æå è½½ï¼åå è½½ç¶ç±»\n\n * å è½½åé¾æ¥å¯è½æ¯äº¤æ¿è¿è¡ç\n\n\n\n * instanceklassä¿å­å¨æ¹æ³åºãjdk 8ä»¥åï¼æ¹æ³åºä½äºåç©ºé´ä¸­ï¼èåç©ºé´åä½äºæ¬å°åå­ä¸­\n * _java_mirroråæ¯ä¿å­å¨å åå­ä¸­\n * instanceklasså*.class(javaéåç±»)äºç¸ä¿å­äºå¯¹æ¹çå°å\n * ç±»çå¯¹è±¡å¨å¯¹è±¡å¤´ä¸­ä¿å­äº*.classçå°åãè®©å¯¹è±¡å¯ä»¥éè¿å¶æ¾å°æ¹æ³åºä¸­çinstanceklassï¼ä»èè·åç±»çåç§ä¿¡æ¯\n\n# é¾æ¥\n\n# éªè¯\n\néªè¯ç±»æ¯å¦ç¬¦å jvmè§èï¼å®å¨æ§æ£æ¥\n\n# åå¤\n\nä¸º static åéåéç©ºé´ï¼è®¾ç½®é»è®¤å¼\n\n * staticåéå¨jdk 7ä»¥åæ¯å­å¨ä¸instanceklassæ«å°¾ãä½å¨jdk 7ä»¥åå°±å­å¨å¨_java_mirroræ«å°¾äº\n * staticåéå¨åéç©ºé´åèµå¼æ¯å¨ä¸¤ä¸ªé¶æ®µå®æçãåéç©ºé´å¨åå¤é¶æ®µå®æï¼èµå¼å¨åå§åé¶æ®µå®æ\n * å¦æ static åéæ¯ ï¬nal çåºæ¬ç±»åï¼ä»¥åå­ç¬¦ä¸²å¸¸éï¼é£ä¹ç¼è¯é¶æ®µå¼å°±ç¡®å®äºï¼èµå¼å¨åå¤é¶æ®µå®æ\n * å¦æ static åéæ¯ ï¬nal çï¼ä½å±äºå¼ç¨ç±»åï¼é£ä¹èµå¼ä¹ä¼å¨åå§åé¶æ®µå®æ\n\n# è§£æ\n\nhsdbçä½¿ç¨\n\n * åè·å¾è¦æ¥ççè¿ç¨id\n\njps\n\n\n1\n\n * æå¼hsdb\n\njava -cp f:\\java\\jdk8.0\\lib\\sa-jdi.jar sun.jvm.hotspot.hsdb\n\n\n1\n\n * è¿è¡æ¶å¯è½ä¼æ¥éï¼æ¯å ä¸ºç¼ºå°ä¸ä¸ª.dllçæä»¶ï¼æä»¬å¨jdkçå®è£ç®å½ä¸­æ¾å°è¯¥æä»¶ï¼å¤å¶å°ç¼ºå¤±çæä»¶ä¸å³å¯\n\n\n\n * å®ä½éè¦çè¿ç¨\n\n\n\n\n\nè§£æçå«ä¹\n\nå°å¸¸éæ± ä¸­çç¬¦å·å¼ç¨è§£æä¸ºç´æ¥å¼ç¨\n\n * æªè§£ææ¶ï¼å¸¸éæ± ä¸­ççå°çå¯¹è±¡ä»æ¯ç¬¦å·ï¼æªçæ­£çå­å¨äºåå­ä¸­\n\npublic class demo1 {\n   public static void main(string[] args) throws ioexception, classnotfoundexception {\n      classloader loader = demo1.class.getclassloader();\n      //åªå è½½ä¸è§£æ\n      class<?> c = loader.loadclass("com.nyima.jvm.day8.c");\n      //ç¨äºé»å¡ä¸»çº¿ç¨\n      system.in.read();\n   }\n}\n\nclass c {\n   d d = new d();\n}\n\nclass d {\n\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n * æå¼hsdb\n   * å¯ä»¥çå°æ­¤æ¶åªå è½½äºç±»c\n\n\n\næ¥çç±»cçå¸¸éæ± ï¼å¯ä»¥çå°ç±»dæªè¢«è§£æï¼åªæ¯å­å¨äºå¸¸éæ± ä¸­çç¬¦å·\n\n\n\n * è§£æä»¥åï¼ä¼å°å¸¸éæ± ä¸­çç¬¦å·å¼ç¨è§£æä¸ºç´æ¥å¼ç¨\n   \n   * å¯ä»¥çå°ï¼æ­¤æ¶å·²å è½½å¹¶è§£æäºç±»cåç±»d\n   \n   \n\n\n\n# åå§å\n\nåå§åé¶æ®µå°±æ¯æ§è¡ç±»æé å¨clinit()æ¹æ³çè¿ç¨ï¼èææºä¼ä¿è¯è¿ä¸ªç±»çãæé æ¹æ³ãççº¿ç¨å®å¨\n\n * clinit()æ¹æ³æ¯ç±ç¼è¯å¨èªå¨æ¶éç±»ä¸­çææç±»åéçèµå¼å¨ä½åéæè¯­å¥åï¼static{}åï¼ä¸­çè¯­å¥åå¹¶äº§çç\n\næ³¨æ\n\nç¼è¯å¨æ¶éçé¡ºåºæ¯ç±è¯­å¥å¨æºæä»¶ä¸­åºç°çé¡ºåºå³å®çï¼éæè¯­å¥åä¸­åªè½è®¿é®å°å®ä¹å¨éæè¯­å¥åä¹åçåéï¼å®ä¹å¨å®ä¹åçåéï¼å¨åé¢çéæè¯­å¥åå¯ä»¥èµå¼ï¼ä½æ¯ä¸è½è®¿é®ï¼å¦\n\n\n\n# åçæ¶æº\n\nç±»çåå§åçææ°çï¼ä»¥ä¸æåµä¼åå§å\n\n * main æ¹æ³æå¨çç±»ï¼æ»ä¼è¢«é¦ååå§å\n * é¦æ¬¡è®¿é®è¿ä¸ªç±»çéæåéæéææ¹æ³æ¶\n * å­ç±»åå§åï¼å¦æç¶ç±»è¿æ²¡åå§åï¼ä¼å¼å\n * å­ç±»è®¿é®ç¶ç±»çéæåéï¼åªä¼è§¦åç¶ç±»çåå§å\n * class.forname\n * new ä¼å¯¼è´åå§å\n\nä»¥ä¸æåµä¸ä¼åå§å\n\n * è®¿é®ç±»ç static ï¬nal éæå¸¸éï¼åºæ¬ç±»ååå­ç¬¦ä¸²ï¼\n * ç±»å¯¹è±¡.class ä¸ä¼è§¦ååå§å\n * åå»ºè¯¥ç±»å¯¹è±¡çæ°ç»\n * ç±»å è½½å¨ç.loadclassæ¹æ³\n * class.fornamedçåæ°2ä¸ºfalseæ¶\n\néªè¯ç±»æ¯å¦è¢«åå§åï¼å¯ä»¥çæ¹ç±»çéæä»£ç åæ¯å¦è¢«æ§è¡\n\n\n# 5ãç±»å è½½å¨\n\njavaèææºè®¾è®¡å¢éæææç±»å è½½é¶æ®µä¸­ç**âéè¿ä¸ä¸ªç±»çå¨éå®åæ¥è·åæè¿°è¯¥ç±»çäºè¿å¶å­èæµâè¿ä¸ªå¨ä½æ¾å°javaèææºå¤é¨å»å®ç°ï¼ä»¥ä¾¿è®©åºç¨ç¨åºèªå·±å³å®å¦ä½å»è·åæéçç±»ãå®ç°è¿ä¸ªå¨ä½çä»£ç è¢«ç§°ä¸ºâç±»å è½½å¨â**ï¼classloaderï¼\n\n# ç±»ä¸ç±»å è½½å¨\n\nç±»å è½½å¨è½ç¶åªç¨äºå®ç°ç±»çå è½½å¨ä½ï¼ä½å®å¨javaç¨åºä¸­èµ·å°çä½ç¨å´è¿è¶ç±»å è½½é¶æ®µ\n\nå¯¹äºä»»æä¸ä¸ªç±»ï¼é½å¿é¡»ç±å è½½å®çç±»å è½½å¨åè¿ä¸ªç±»æ¬èº«ä¸èµ·å±åç¡®ç«å¶å¨javaèææºä¸­çå¯ä¸æ§ï¼æ¯ä¸ä¸ªç±»å è½½å¨ï¼é½æ¥æä¸ä¸ªç¬ç«çç±»åç§°ç©ºé´ãè¿å¥è¯å¯ä»¥è¡¨è¾¾å¾æ´éä¿ä¸äºï¼æ¯è¾ä¸¤ä¸ªç±»æ¯å¦âç¸ç­âï¼åªæå¨è¿ä¸¤ä¸ªç±»æ¯ç±åä¸ä¸ªç±»å è½½å¨å è½½çåæä¸æææä¹ï¼å¦åï¼å³ä½¿è¿ä¸¤ä¸ªç±»æ¥æºäºåä¸ä¸ªclassæä»¶ï¼è¢«åä¸ä¸ªjavaèææºå è½½ï¼åªè¦å è½½å®ä»¬çç±»å è½½å¨ä¸åï¼é£è¿ä¸¤ä¸ªç±»å°±å¿å®ä¸ç¸ç­\n\nä»¥jdk 8ä¸ºä¾\n\nåç§°                                  å è½½çç±»                    è¯´æ\nbootstrap classloaderï¼å¯å¨ç±»å è½½å¨ï¼       java_home/jre/lib       æ æ³ç´æ¥è®¿é®\nextension classloader(æå±ç±»å è½½å¨)       java_home/jre/lib/ext   ä¸çº§ä¸ºbootstrapï¼æ¾ç¤ºä¸ºnull\napplication classloader(åºç¨ç¨åºç±»å è½½å¨)   classpath               ä¸çº§ä¸ºextension\nèªå®ä¹ç±»å è½½å¨                             èªå®ä¹                     ä¸çº§ä¸ºapplication\n\n# å¯å¨ç±»å è½½å¨\n\nå¯éè¿å¨æ§å¶å°è¾å¥æä»¤ï¼ä½¿å¾ç±»è¢«å¯å¨ç±»å å¨å è½½\n\n# æå±ç±»å è½½å¨\n\nå¦æclasspathåjava_home/jre/lib/ext ä¸æååç±»ï¼å è½½æ¶ä¼ä½¿ç¨æå±ç±»å è½½å¨å è½½ãå½åºç¨ç¨åºç±»å è½½å¨åç°æå±ç±»å è½½å¨å·²å°è¯¥ååç±»å è½½è¿äºï¼åä¸ä¼åæ¬¡å è½½\n\n# åäº²å§æ´¾æ¨¡å¼\n\nåäº²å§æ´¾æ¨¡å¼ï¼å³è°ç¨ç±»å è½½å¨classloader ç loadclass æ¹æ³æ¶ï¼æ¥æ¾ç±»çè§å\n\nloadclassæºç \n\nprotected class<?> loadclass(string name, boolean resolve)\n    throws classnotfoundexception\n{\n    synchronized (getclassloadinglock(name)) {\n        // é¦åæ¥æ¾è¯¥ç±»æ¯å¦å·²ç»è¢«è¯¥ç±»å è½½å¨å è½½è¿äº\n        class<?> c = findloadedclass(name);\n        //å¦ææ²¡æè¢«å è½½è¿\n        if (c == null) {\n            long t0 = system.nanotime();\n            try {\n                //çæ¯å¦è¢«å®çä¸çº§å è½½å¨å è½½è¿äº extensionçä¸çº§æ¯bootstarpï¼ä½å®æ¾ç¤ºä¸ºnull\n                if (parent != null) {\n                    c = parent.loadclass(name, false);\n                } else {\n                    //çæ¯å¦è¢«å¯å¨ç±»å è½½å¨å è½½è¿\n                    c = findbootstrapclassornull(name);\n                }\n            } catch (classnotfoundexception e) {\n                // classnotfoundexception thrown if class not found\n                // from the non-null parent class loader\n                //æè·å¼å¸¸ï¼ä½ä¸åä»»ä½å¤ç\n            }\n\n            if (c == null) {\n                //å¦æè¿æ¯æ²¡ææ¾å°ï¼åè®©æå±ç±»å è½½å¨è°ç¨findclassæ¹æ³å»æ¾å°è¯¥ç±»ï¼å¦æè¿æ¯æ²¡æ¾å°ï¼å°±æåºå¼å¸¸\n                //ç¶åè®©åºç¨ç±»å è½½å¨å»æ¾classpathä¸æ¾è¯¥ç±»\n                long t1 = system.nanotime();\n                c = findclass(name);\n\n                // è®°å½æ¶é´\n                sun.misc.perfcounter.getparentdelegationtime().addtime(t1 - t0);\n                sun.misc.perfcounter.getfindclasstime().addelapsedtimefrom(t1);\n                sun.misc.perfcounter.getfindclasses().increment();\n            }\n        }\n        if (resolve) {\n            resolveclass(c);\n        }\n        return c;\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n\n\n# èªå®ä¹ç±»å è½½å¨\n\n# ä½¿ç¨åºæ¯\n\n * æ³å è½½é classpath éæè·¯å¾ä¸­çç±»æä»¶\n * éè¿æ¥å£æ¥ä½¿ç¨å®ç°ï¼å¸æè§£è¦æ¶ï¼å¸¸ç¨å¨æ¡æ¶è®¾è®¡\n * è¿äºç±»å¸æäºä»¥éç¦»ï¼ä¸ååºç¨çååç±»é½å¯ä»¥å è½½ï¼ä¸å²çªï¼å¸¸è§äº tomcat å®¹å¨\n\n# æ­¥éª¤\n\n * ç»§æ¿classloaderç¶ç±»\n * è¦éµä»åäº²å§æ´¾æºå¶ï¼éå ï¬ndclass æ¹æ³\n   * ä¸æ¯éåloadclassæ¹æ³ï¼å¦åä¸ä¼èµ°åäº²å§æ´¾æºå¶\n * è¯»åç±»æä»¶çå­èç \n * è°ç¨ç¶ç±»ç deï¬neclass æ¹æ³æ¥å è½½ç±»\n * ä½¿ç¨èè°ç¨è¯¥ç±»å è½½å¨ç loadclass æ¹æ³\n\n# ç ´ååäº²å§æ´¾æ¨¡å¼\n\n * åäº²å§æ´¾æ¨¡åçç¬¬ä¸æ¬¡âè¢«ç ´åâå¶å®åçå¨åäº²å§æ´¾æ¨¡ååºç°ä¹åââå³jdk1.2é¢ä¸ä»¥åçâè¿å¤âæ¶ä»£\n   * å»ºè®®ç¨æ·éåfindclass()æ¹æ³ï¼å¨ç±»å è½½å¨ä¸­çloadclass()æ¹æ³ä¸­ä¹ä¼è°ç¨è¯¥æ¹æ³\n * åäº²å§æ´¾æ¨¡åçç¬¬äºæ¬¡âè¢«ç ´åâæ¯ç±è¿ä¸ªæ¨¡åèªèº«çç¼ºé·å¯¼è´ç\n   * å¦ææåºç¡ç±»ååè¦è°ç¨åç¨æ·çä»£ç ï¼æ­¤æ¶ä¹ä¼ç ´ååäº²å§æ´¾æ¨¡å¼\n * åäº²å§æ´¾æ¨¡åçç¬¬ä¸æ¬¡âè¢«ç ´åâæ¯ç±äºç¨æ·å¯¹ç¨åºå¨ææ§çè¿½æ±èå¯¼è´ç\n   * è¿éæè¯´çâå¨ææ§âæçæ¯ä¸äºéå¸¸âç­âé¨çåè¯ï¼ä»£ç ç­æ¿æ¢ï¼hot swapï¼ãæ¨¡åç­é¨ç½²ï¼hot deploymentï¼ç­\n\n\n# 6ãè¿è¡æä¼å\n\n# åå±ç¼è¯\n\njvm å°æ§è¡ç¶æåæäº 5 ä¸ªå±æ¬¡ï¼\n\n * 0å±ï¼è§£éæ§è¡ï¼ç¨è§£éå¨å°å­èç ç¿»è¯ä¸ºæºå¨ç \n * 1å±ï¼ä½¿ç¨ c1 å³æ¶ç¼è¯å¨ç¼è¯æ§è¡ï¼ä¸å¸¦ proï¬lingï¼\n * 2å±ï¼ä½¿ç¨ c1 å³æ¶ç¼è¯å¨ç¼è¯æ§è¡ï¼å¸¦åºæ¬çprofilingï¼\n * 3å±ï¼ä½¿ç¨ c1 å³æ¶ç¼è¯å¨ç¼è¯æ§è¡ï¼å¸¦å®å¨çprofilingï¼\n * 4å±ï¼ä½¿ç¨ c2 å³æ¶ç¼è¯å¨ç¼è¯æ§è¡\n\nproï¬ling æ¯æå¨è¿è¡è¿ç¨ä¸­æ¶éä¸äºç¨åºæ§è¡ç¶æçæ°æ®ï¼ä¾å¦ãæ¹æ³çè°ç¨æ¬¡æ°ãï¼ãå¾ªç¯ç åè¾¹æ¬¡æ°ãç­\n\n# å³æ¶ç¼è¯å¨ï¼jitï¼ä¸è§£éå¨çåºå«\n\n * è§£éå¨\n   * å°å­èç è§£éä¸ºæºå¨ç ï¼ä¸æ¬¡å³ä½¿éå°ç¸åçå­èç ï¼ä»ä¼æ§è¡éå¤çè§£é\n   * æ¯å°å­èç è§£éä¸ºéå¯¹ææå¹³å°é½éç¨çæºå¨ç \n * å³æ¶ç¼è¯å¨\n   * å°ä¸äºå­èç ç¼è¯ä¸ºæºå¨ç ï¼å¹¶å­å¥ code cacheï¼ä¸æ¬¡éå°ç¸åçä»£ç ï¼ç´æ¥æ§è¡ï¼æ éåç¼è¯\n   * æ ¹æ®å¹³å°ç±»åï¼çæå¹³å°ç¹å®çæºå¨ç \n\nå¯¹äºå¤§é¨åçä¸å¸¸ç¨çä»£ç ï¼æä»¬æ éèè´¹æ¶é´å°å¶ç¼è¯ææºå¨ç ï¼èæ¯éåè§£éæ§è¡çæ¹å¼è¿è¡ï¼å¦ä¸æ¹é¢ï¼å¯¹äºä»å æ®å°é¨åçç­ç¹ä»£ç ï¼æä»¬åå¯ä»¥å°å¶ç¼è¯ææºå¨ç ï¼ä»¥è¾¾å°çæ³çè¿è¡éåº¦ã æ§è¡æçä¸ç®åæ¯è¾ä¸ä¸ interpreter < c1 < c2ï¼æ»çç®æ æ¯åç°ç­ç¹ä»£ç ï¼hotspotåç§°çç± æ¥ï¼ï¼å¹¶ä¼åè¿äºç­ç¹ä»£ç \n\n# éé¸åæ\n\néé¸åæï¼escape analysisï¼ç®åæ¥è®²å°±æ¯ï¼java hotspot èææºå¯ä»¥åææ°åå»ºå¯¹è±¡çä½¿ç¨èå´ï¼å¹¶å³å®æ¯å¦å¨ java å ä¸åéåå­çä¸é¡¹ææ¯\n\néé¸åæç jvm åæ°å¦ä¸ï¼\n\n * å¼å¯éé¸åæï¼-xx:+doescapeanalysis\n * å³é­éé¸åæï¼-xx:-doescapeanalysis\n * æ¾ç¤ºåæç»æï¼-xx:+printescapeanalysis\n\néé¸åæææ¯å¨ java se 6u23+ å¼å§æ¯æï¼å¹¶é»è®¤è®¾ç½®ä¸ºå¯ç¨ç¶æï¼å¯ä»¥ä¸ç¨é¢å¤å è¿ä¸ªåæ°\n\nå¯¹è±¡éé¸ç¶æ\n\nå¨å±éé¸ï¼globalescapeï¼\n\n * å³ä¸ä¸ªå¯¹è±¡çä½ç¨èå´éåºäºå½åæ¹æ³æèå½åçº¿ç¨ï¼æä»¥ä¸å ç§åºæ¯ï¼\n   * å¯¹è±¡æ¯ä¸ä¸ªéæåé\n   * å¯¹è±¡æ¯ä¸ä¸ªå·²ç»åçéé¸çå¯¹è±¡\n   * å¯¹è±¡ä½ä¸ºå½åæ¹æ³çè¿åå¼\n\nåæ°éé¸ï¼argescapeï¼\n\n * å³ä¸ä¸ªå¯¹è±¡è¢«ä½ä¸ºæ¹æ³åæ°ä¼ éæèè¢«åæ°å¼ç¨ï¼ä½å¨è°ç¨è¿ç¨ä¸­ä¸ä¼åçå¨å±éé¸ï¼è¿ä¸ªç¶ææ¯éè¿è¢«è°æ¹æ³çå­èç ç¡®å®ç\n\næ²¡æéé¸\n\n * å³æ¹æ³ä¸­çå¯¹è±¡æ²¡æåçéé¸\n\néé¸åæä¼å\n\néå¯¹ä¸é¢ç¬¬ä¸ç¹ï¼å½ä¸ä¸ªå¯¹è±¡æ²¡æéé¸æ¶ï¼å¯ä»¥å¾å°ä»¥ä¸å ä¸ªèææºçä¼å\n\néæ¶é¤\n\næä»¬ç¥éçº¿ç¨åæ­¥éæ¯éå¸¸çºç²æ§è½çï¼å½ç¼è¯å¨ç¡®å®å½åå¯¹è±¡åªæå½åçº¿ç¨ä½¿ç¨ï¼é£ä¹å°±ä¼ç§»é¤è¯¥å¯¹è±¡çåæ­¥é\n\nä¾å¦ï¼stringbuffer å vector é½æ¯ç¨ synchronized ä¿®é¥°çº¿ç¨å®å¨çï¼ä½å¤§é¨åæåµä¸ï¼å®ä»¬é½åªæ¯å¨å½åçº¿ç¨ä¸­ç¨å°ï¼è¿æ ·ç¼è¯å¨å°±ä¼ä¼åç§»é¤æè¿äºéæä½\n\néæ¶é¤ç jvm åæ°å¦ä¸ï¼\n\n * å¼å¯éæ¶é¤ï¼-xx:+eliminatelocks\n * å³é­éæ¶é¤ï¼-xx:-eliminatelocks\n\néæ¶é¤å¨ jdk8 ä¸­é½æ¯é»è®¤å¼å¯çï¼å¹¶ä¸éæ¶é¤é½è¦å»ºç«å¨éé¸åæçåºç¡ä¸\n\næ éæ¿æ¢\n\né¦åè¦æç½æ éåèåéï¼åºç¡ç±»ååå¯¹è±¡çå¼ç¨å¯ä»¥çè§£ä¸ºæ éï¼å®ä»¬ä¸è½è¢«è¿ä¸æ­¥åè§£ãèè½è¢«è¿ä¸æ­¥åè§£çéå°±æ¯èåéï¼æ¯å¦ï¼å¯¹è±¡\n\nå¯¹è±¡æ¯èåéï¼å®åå¯ä»¥è¢«è¿ä¸æ­¥åè§£ææ éï¼å°å¶æååéåè§£ä¸ºåæ£çåéï¼è¿å°±å«åæ éæ¿æ¢ã\n\nè¿æ ·ï¼å¦æä¸ä¸ªå¯¹è±¡æ²¡æåçéé¸ï¼é£åæ ¹å°±ä¸ç¨åå»ºå®ï¼åªä¼å¨æ æèå¯å­å¨ä¸åå»ºå®ç¨å°çæåæ éï¼èçäºåå­ç©ºé´ï¼ä¹æåäºåºç¨ç¨åºæ§è½\n\næ éæ¿æ¢ç jvm åæ°å¦ä¸ï¼\n\n * å¼å¯æ éæ¿æ¢ï¼-xx:+eliminateallocations\n * å³é­æ éæ¿æ¢ï¼-xx:-eliminateallocations\n * æ¾ç¤ºæ éæ¿æ¢è¯¦æï¼-xx:+printeliminateallocations\n\næ éæ¿æ¢åæ ·å¨ jdk8 ä¸­é½æ¯é»è®¤å¼å¯çï¼å¹¶ä¸é½è¦å»ºç«å¨éé¸åæçåºç¡ä¸\n\næ ä¸åé\n\nå½å¯¹è±¡æ²¡æåçéé¸æ¶ï¼è¯¥å¯¹è±¡å°±å¯ä»¥éè¿æ éæ¿æ¢åè§£ææåæ éåéå¨æ åå­ä¸­ï¼åæ¹æ³ççå½å¨æä¸è´ï¼éçæ å¸§åºæ æ¶éæ¯ï¼åå°äº gc ååï¼æé«äºåºç¨ç¨åºæ§è½\n\n# æ¹æ³åè\n\n# åèå½æ°\n\nåèå½æ°å°±æ¯å¨ç¨åºç¼è¯æ¶ï¼ç¼è¯å¨å°ç¨åºä¸­åºç°çåèå½æ°çè°ç¨è¡¨è¾¾å¼ç¨åèå½æ°çå½æ°ä½æ¥ç´æ¥è¿è¡æ¿æ¢\n\n# jvmåèå½æ°\n\nc++æ¯å¦ä¸ºåèå½æ°ç±èªå·±å³å®ï¼javaç±ç¼è¯å¨å³å®ãjavaä¸æ¯æç´æ¥å£°æä¸ºåèå½æ°çï¼å¦ææ³è®©ä»åèï¼ä½ åªè½å¤åç¼è¯å¨æåºè¯·æ±: å³é®å­finalä¿®é¥° ç¨æ¥ææé£ä¸ªå½æ°æ¯å¸æè¢«jvmåèçï¼å¦\n\npublic final void dosomething() {  \n        // to do something  \n}\n\n\n1\n2\n3\n\n\næ»çæ¥è¯´ï¼ä¸è¬çå½æ°é½ä¸ä¼è¢«å½ååèå½æ°ï¼åªæå£°æäºfinalåï¼ç¼è¯å¨æä¼èèæ¯ä¸æ¯è¦æä½ çå½æ°åæåèå½æ°\n\njvmåå»ºæè®¸å¤è¿è¡æ¶ä¼åãé¦åç­æ¹æ³æ´å©äºjvmæ¨æ­ãæµç¨æ´ææ¾ï¼ä½ç¨åæ´ç­ï¼å¯ä½ç¨ä¹æ´ææ¾ãå¦ææ¯é¿æ¹æ³jvmå¯è½ç´æ¥å°±è·ªäºã\n\nç¬¬äºä¸ªåå åæ´éè¦ï¼æ¹æ³åè\n\nå¦æjvmçæµå°ä¸äºå°æ¹æ³è¢«é¢ç¹çæ§è¡ï¼å®ä¼ææ¹æ³çè°ç¨æ¿æ¢ææ¹æ³ä½æ¬èº«ï¼å¦ï¼\n\nprivate int add4(int x1, int x2, int x3, int x4) { \n\t\t//è¿éè°ç¨äºadd2æ¹æ³\n        return add2(x1, x2) + add2(x3, x4);  \n    }  \n\n    private int add2(int x1, int x2) {  \n        return x1 + x2;  \n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\næ¹æ³è°ç¨è¢«æ¿æ¢å\n\nprivate int add4(int x1, int x2, int x3, int x4) {  \n    \t//è¢«æ¿æ¢ä¸ºäºæ¹æ³æ¬èº«\n        return x1 + x2 + x3 + x4;  \n    }\n\n\n1\n2\n3\n4\n\n\n# åå°ä¼å\n\npublic class reflect1 {\n   public static void foo() {\n      system.out.println("foo...");\n   }\n\n   public static void main(string[] args) throws nosuchmethodexception, invocationtargetexception, illegalaccessexception {\n      method foo = demo3.class.getmethod("foo");\n      for(int i = 0; i<=16; i++) {\n         foo.invoke(null);\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nfoo.invoke åé¢ 0 ~ 15 æ¬¡è°ç¨ä½¿ç¨çæ¯ methodaccessor ç nativemethodaccessorimpl å®ç°\n\ninvokeæ¹æ³æºç \n\n@callersensitive\npublic object invoke(object obj, object... args)\n    throws illegalaccessexception, illegalargumentexception,\n       invocationtargetexception\n{\n    if (!override) {\n        if (!reflection.quickcheckmemberaccess(clazz, modifiers)) {\n            class<?> caller = reflection.getcallerclass();\n            checkaccess(caller, clazz, obj, modifiers);\n        }\n    }\n    //methodaccessoræ¯ä¸ä¸ªæ¥å£ï¼æ3ä¸ªå®ç°ç±»ï¼å¶ä¸­æä¸ä¸ªæ¯æ½è±¡ç±»\n    methodaccessor ma = methodaccessor;             // read volatile\n    if (ma == null) {\n        ma = acquiremethodaccessor();\n    }\n    return ma.invoke(obj, args);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\nä¼ç±delegatingmehodaccessorimplå»è°ç¨nativemethodaccessorimpl\n\nnativemethodaccessorimplæºç \n\nclass nativemethodaccessorimpl extends methodaccessorimpl {\n    private final method method;\n    private delegatingmethodaccessorimpl parent;\n    private int numinvocations;\n\n    nativemethodaccessorimpl(method var1) {\n        this.method = var1;\n    }\n\t\n\t//æ¯æ¬¡è¿è¡åå°è°ç¨ï¼ä¼è®©numinvocationä¸reflectionfactory.inflationthresholdçå¼ï¼15ï¼è¿è¡æ¯è¾ï¼å¹¶ä½¿ä½¿å¾numinvocationçå¼å ä¸\n\t//å¦ænuminvocation>reflectionfactory.inflationthresholdï¼åä¼è°ç¨æ¬å°æ¹æ³invoke0æ¹æ³\n    public object invoke(object var1, object[] var2) throws illegalargumentexception, invocationtargetexception {\n        if (++this.numinvocations > reflectionfactory.inflationthreshold() && !reflectutil.isvmanonymousclass(this.method.getdeclaringclass())) {\n            methodaccessorimpl var3 = (methodaccessorimpl)(new methodaccessorgenerator()).generatemethod(this.method.getdeclaringclass(), this.method.getname(), this.method.getparametertypes(), this.method.getreturntype(), this.method.getexceptiontypes(), this.method.getmodifiers());\n            this.parent.setdelegate(var3);\n        }\n\n        return invoke0(this.method, var1, var2);\n    }\n\n    void setparent(delegatingmethodaccessorimpl var1) {\n        this.parent = var1;\n    }\n\n    private static native object invoke0(method var0, object var1, object[] var2);\n}\n//reflectionfactory.inflationthreshold()æ¹æ³çè¿åå¼\nprivate static int inflationthreshold = 15;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n * ä¸å¼å§ifæ¡ä»¶ä¸æ»¡è¶³ï¼å°±ä¼è°ç¨æ¬å°æ¹æ³invoke0\n * éçnuminvocationçå¢å¤§ï¼å½å®å¤§äºreflectionfactory.inflationthresholdçå¼16æ¶ï¼å°±ä¼æ¬å°æ¹æ³è®¿é®å¨æ¿æ¢ä¸ºä¸ä¸ªè¿è¡æ¶å¨æçæçè®¿é®å¨ï¼æ¥æé«æç\n   * è¿æ¶ä¼ä»åå°è°ç¨åä¸ºæ­£å¸¸è°ç¨ï¼å³ç´æ¥è°ç¨ reflect1.foo()\n\n\n\n\n# äºãåå­æ¨¡å\n\nåå¾juc',charsets:{cjk:!0},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"Javaåºç¡",frontmatter:{title:"Javaåºç¡",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/f9a6a6/"},regularPath:"/01.Java/Java%E5%9F%BA%E7%A1%80.html",relativePath:"01.Java/Javaåºç¡.md",key:"v-64d333aa",path:"/pages/f9a6a6/",headers:[{level:3,title:"Java 8å¤§åºæ¬æ°æ®ç±»å",slug:"java-8å¤§åºæ¬æ°æ®ç±»å",normalizedTitle:"java 8å¤§åºæ¬æ°æ®ç±»å",charIndex:2},{level:3,title:"Objectç±»ä¸­å¸¸è§çæ¹æ³",slug:"objectç±»ä¸­å¸¸è§çæ¹æ³",normalizedTitle:"objectç±»ä¸­å¸¸è§çæ¹æ³",charIndex:631},{level:3,title:"é¢åå¯¹è±¡ä¸å¤§ç¹å¾",slug:"é¢åå¯¹è±¡ä¸å¤§ç¹å¾",normalizedTitle:"é¢åå¯¹è±¡ä¸å¤§ç¹å¾",charIndex:1987},{level:3,title:"æ·±æ·è´ä¸æµæ·è´",slug:"æ·±æ·è´ä¸æµæ·è´",normalizedTitle:"æ·±æ·è´ä¸æµæ·è´",charIndex:2182},{level:3,title:"StringãStringBufferãStringBuilder",slug:"stringãstringbufferãstringbuilder",normalizedTitle:"stringãstringbufferãstringbuilder",charIndex:2307},{level:3,title:"== å equals()",slug:"å-equals",normalizedTitle:"== å equals()",charIndex:3518},{level:3,title:"hashCode() ä¸ equals()",slug:"hashcode-ä¸-equals",normalizedTitle:"hashcode() ä¸ equals()",charIndex:4647}],headersStr:"Java 8å¤§åºæ¬æ°æ®ç±»å Objectç±»ä¸­å¸¸è§çæ¹æ³ é¢åå¯¹è±¡ä¸å¤§ç¹å¾ æ·±æ·è´ä¸æµæ·è´ StringãStringBufferãStringBuilder == å equals() hashCode() ä¸ equals()",content:"# Java 8å¤§åºæ¬æ°æ®ç±»å\n\nJava ä¸­æ 8 ç§åºæ¬æ°æ®ç±»åï¼åå«ä¸ºï¼\n\n 1. 6 ç§æ°å­ç±»åï¼\n    * 4 ç§æ´æ°åï¼byteãshortãintãlong\n    * 2 ç§æµ®ç¹åï¼floatãdouble\n 2. 1 ç§å­ç¬¦ç±»åï¼char\n 3. 1 ç§å¸å°åï¼booleanã\n\nè¿ 8 ç§åºæ¬æ°æ®ç±»åçé»è®¤å¼ä»¥åæå ç©ºé´çå¤§å°å¦ä¸ï¼\n\nåºæ¬ç±»å      ä½æ°   å­è   é»è®¤å¼       åå¼èå´\nbyte      8    1    0         -128 ~ 127\nshort     16   2    0         -32768 ~ 32767\nint       32   4    0         -2147483648 ~ 2147483647\nlong      64   8    0L        -9223372036854775808 ~ 9223372036854775807\nchar      16   2    'u0000'   0 ~ 65535\nfloat     32   4    0f        1.4E-45 ~ 3.4028235E38\ndouble    64   8    0d        4.9E-324 ~ 1.7976931348623157E308\nboolean   1         false     trueãfalse\n\n\n# Objectç±»ä¸­å¸¸è§çæ¹æ³\n\n//nativeæ¹æ³ï¼ç¨äºè¿åå½åè¿è¡æ¶å¯¹è±¡çClasså¯¹è±¡ï¼ä½¿ç¨äºfinalå³é®å­ä¿®é¥°ï¼æä¸åè®¸å­ç±»éåã\npublic final native Class<?> getClass()\n\n//nativeæ¹æ³ï¼ç¨äºè¿åå¯¹è±¡çåå¸ç ï¼ä¸»è¦ä½¿ç¨å¨åå¸è¡¨ä¸­ï¼æ¯å¦JDKä¸­çHashMapã\npublic native int hashCode() \n\n//ç¨äºæ¯è¾2ä¸ªå¯¹è±¡çåå­å°åæ¯å¦ç¸ç­ï¼Stringç±»å¯¹è¯¥æ¹æ³è¿è¡äºéåç¨æ·æ¯è¾å­ç¬¦ä¸²çå¼æ¯å¦ç¸ç­ã\npublic boolean equals(Object obj)\n\n//naitiveæ¹æ³ï¼ç¨äºåå»ºå¹¶è¿åå½åå¯¹è±¡çä¸ä»½æ·è´ãä¸è¬æåµä¸ï¼å¯¹äºä»»ä½å¯¹è±¡ xï¼è¡¨è¾¾å¼ x.clone() != x ä¸ºtrueï¼x.clone().getClass() == x.getClass() ä¸ºtrueãObjectæ¬èº«æ²¡æå®ç°Cloneableæ¥å£ï¼æä»¥ä¸éåcloneæ¹æ³å¹¶ä¸è¿è¡è°ç¨çè¯ä¼åçCloneNotSupportedExceptionå¼å¸¸ã\nprotected native Object clone() throws CloneNotSupportedException\n\n//è¿åç±»çåå­@å®ä¾çåå¸ç ç16è¿å¶çå­ç¬¦ä¸²ãå»ºè®®Objectææçå­ç±»é½éåè¿ä¸ªæ¹æ³ã\npublic String toString()\n\n//nativeæ¹æ³ï¼å¹¶ä¸ä¸è½éåãå¤éä¸ä¸ªå¨æ­¤å¯¹è±¡çè§å¨ä¸ç­å¾ççº¿ç¨(çè§å¨ç¸å½äºå°±æ¯éçæ¦å¿µ)ãå¦ææå¤ä¸ªçº¿ç¨å¨ç­å¾åªä¼ä»»æå¤éä¸ä¸ªã\npublic final native void notify()\n\n//nativeæ¹æ³ï¼å¹¶ä¸ä¸è½éåãè·notifyä¸æ ·ï¼å¯ä¸çåºå«å°±æ¯ä¼å¤éå¨æ­¤å¯¹è±¡çè§å¨ä¸ç­å¾çææçº¿ç¨ï¼èä¸æ¯ä¸ä¸ªçº¿ç¨ã\npublic final native void notifyAll()\n\n//nativeæ¹æ³ï¼å¹¶ä¸ä¸è½éåãæåçº¿ç¨çæ§è¡ãæ³¨æï¼sleepæ¹æ³æ²¡æéæ¾éï¼èwaitæ¹æ³éæ¾äºé ãtimeoutæ¯ç­å¾æ¶é´ã\npublic final native void wait(long timeout) throws InterruptedException\n\n//å¤äºnanosåæ°ï¼è¿ä¸ªåæ°è¡¨ç¤ºé¢å¤æ¶é´ï¼ä»¥æ¯«å¾®ç§ä¸ºåä½ï¼èå´æ¯ 0-999999ï¼ã æä»¥è¶æ¶çæ¶é´è¿éè¦å ä¸nanosæ¯«ç§ã\npublic final void wait(long timeout, int nanos) throws InterruptedException\n\n//è·ä¹åç2ä¸ªwaitæ¹æ³ä¸æ ·ï¼åªä¸è¿è¯¥æ¹æ³ä¸ç´ç­å¾ï¼æ²¡æè¶æ¶æ¶é´è¿ä¸ªæ¦å¿µ\npublic final void wait() throws InterruptedException\n\n//å®ä¾è¢«åå¾åæ¶å¨åæ¶çæ¶åè§¦åçæä½\nprotected void finalize() throws Throwable { }\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n\n# é¢åå¯¹è±¡ä¸å¤§ç¹å¾\n\nå°è£ï¼\n\nå°è£æ¯ææä¸ä¸ªå¯¹è±¡çå±æ§éèå¨å¯¹è±¡åé¨ï¼ä¸åè®¸å¤é¨å¯¹è±¡ç´æ¥è®¿é®å¯¹è±¡çåé¨ä¿¡æ¯privateãä½æ¯å¯ä»¥æä¾ä¸äºå¯ä»¥è¢«å¤çè®¿é®çæ¹æ³æ¥æä½å±æ§set/getæ¹æ³ã\n\nç»§æ¿ï¼\n\nä¸åç±»åçå¯¹è±¡ï¼ç¸äºä¹é´ç»å¸¸æä¸å®æ°éçå±åç¹ãåæ¶ï¼æ¯ä¸ä¸ªå¯¹è±¡è¿å®ä¹äºé¢å¤çç¹æ§ä½¿å¾ä»ä»¬ä¸ä¼ä¸åã\n\nå¤æï¼\n\nè¡¨ç¤ºä¸ä¸ªå¯¹è±¡å·æå¤ç§çç¶æï¼å·ä½è¡¨ç°ä¸ºç¶ç±»çå¼ç¨æåå­ç±»çå®ä¾ã\n\n\n# æ·±æ·è´ä¸æµæ·è´\n\n * æµæ·è´ï¼æµæ·è´ä¼å¨å ä¸åå»ºä¸ä¸ªæ°çå¯¹è±¡ï¼å¦æå¯¹è±¡åé¨å­å¨å¼ç¨ç±»åï¼æµæ·è´ç´æ¥å¤å¶åé¨å¯¹è±¡çå¼ç¨å°åãä¹å°±æ¯è¯´æ·è´å¯¹è±¡ååå¯¹è±¡å±ç¨åä¸ä¸ªå°åã\n\n * æ·±æ·è´ ï¼æ·±æ·è´ä¼å®å¨å¤å¶æ´ä¸ªå¯¹è±¡ï¼åæ¬è¿ä¸ªå¯¹è±¡æåå«çåé¨å¯¹è±¡ã\n\n\n# StringãStringBufferãStringBuilder\n\nå¯åæ§\n\nStringæ¯ä¸å¯åç\n\n 1. ä¿å­å­ç¬¦ä¸²çæ°ç»è¢« final ä¿®é¥°ä¸ä¸ºç§æçï¼å¹¶ä¸String ç±»æ²¡ææä¾/æ´é²ä¿®æ¹è¿ä¸ªå­ç¬¦ä¸²çæ¹æ³ã\n 2. String ç±»è¢« final ä¿®é¥°å¯¼è´å¶ä¸è½è¢«ç»§æ¿ï¼è¿èé¿åäºå­ç±»ç ´å String ä¸å¯åã\n\nStringBuilder ä¸ StringBuffer é½ç»§æ¿èª AbstractStringBuilder ç±»ï¼å¨ AbstractStringBuilder ä¸­ä¹æ¯ä½¿ç¨å­ç¬¦æ°ç»ä¿å­å­ç¬¦ä¸²ï¼æ²¡æä½¿ç¨ final å private å³é®å­ä¿®é¥°ï¼ AbstractStringBuilder ç±»è¿æä¾äºå¾å¤ä¿®æ¹å­ç¬¦ä¸²çæ¹æ³æ¯å¦ å¸¸è§çappend æ¹æ³ã\n\nabstract class AbstractStringBuilder implements Appendable, CharSequence {\n    char[] value;\n    public AbstractStringBuilder append(String str) {\n        if (str == null)\n            return appendNull();\n        int len = str.length();\n        ensureCapacityInternal(count + len);\n        str.getChars(0, len, value, count);\n        count += len;\n        return this;\n    }\n  \t//...\n}\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nçº¿ç¨å®å¨æ§\n\nString ä¸­çå¯¹è±¡æ¯ä¸å¯åçï¼ä¹å°±å¯ä»¥çè§£ä¸ºå¸¸éï¼çº¿ç¨å®å¨ã\n\nAbstractStringBuilder æ¯ StringBuilder ä¸ StringBuffer çå¬å±ç¶ç±»ï¼å®ä¹äºä¸äºå­ç¬¦ä¸²çåºæ¬æä½ï¼å¦ expandCapacityãappendãinsertãindexOf ç­å¬å±æ¹æ³ãStringBuffer å¯¹æ¹æ³å äºåæ­¥éæèå¯¹è°ç¨çæ¹æ³å äºåæ­¥éï¼æä»¥æ¯çº¿ç¨å®å¨çãStringBuilder å¹¶æ²¡æå¯¹æ¹æ³è¿è¡å åæ­¥éï¼æä»¥æ¯éçº¿ç¨å®å¨çã\n\næ§è½\n\næ¯æ¬¡å¯¹ String ç±»åè¿è¡æ¹åçæ¶åï¼é½ä¼çæä¸ä¸ªæ°ç String å¯¹è±¡ï¼ç¶åå°æéæåæ°ç String å¯¹è±¡ãStringBuffer æ¯æ¬¡é½ä¼å¯¹ StringBuffer å¯¹è±¡æ¬èº«è¿è¡æä½ï¼èä¸æ¯çææ°çå¯¹è±¡å¹¶æ¹åå¯¹è±¡å¼ç¨ãç¸åæåµä¸ä½¿ç¨ StringBuilder ç¸æ¯ä½¿ç¨ StringBuffer ä»è½è·å¾ 10%~15% å·¦å³çæ§è½æåï¼ä½å´è¦åå¤çº¿ç¨ä¸å®å¨çé£é©\n\n\n# == å equals()\n\n== å¯¹äºåºæ¬ç±»ååå¼ç¨ç±»åçä½ç¨æææ¯ä¸åçï¼\n\n * å¯¹äºåºæ¬æ°æ®ç±»åæ¥è¯´ï¼== æ¯è¾çæ¯å¼ã\n * å¯¹äºå¼ç¨æ°æ®ç±»åæ¥è¯´ï¼== æ¯è¾çæ¯å¯¹è±¡çåå­å°åã\n\nequals() ä¸è½ç¨äºå¤æ­åºæ¬æ°æ®ç±»åçåéï¼åªè½ç¨æ¥å¤æ­ä¸¤ä¸ªå¯¹è±¡æ¯å¦ç¸ç­ãequals()æ¹æ³å­å¨äºObjectç±»ä¸­ï¼èObjectç±»æ¯ææç±»çç´æ¥æé´æ¥ç¶ç±»ï¼å æ­¤ææçç±»é½æequals()æ¹æ³ã\n\nObject ç±» equals() æ¹æ³ï¼\n\npublic boolean equals(Object obj) {\n     return (this == obj);\n}\n\n\n1\n2\n3\n\n\nequals() æ¹æ³å­å¨ä¸¤ç§ä½¿ç¨æåµï¼\n\n * ç±»æ²¡æéå equals()æ¹æ³ ï¼éè¿equals()æ¯è¾è¯¥ç±»çä¸¤ä¸ªå¯¹è±¡æ¶ï¼ç­ä»·äºéè¿â==âæ¯è¾è¿ä¸¤ä¸ªå¯¹è±¡ï¼ä½¿ç¨çé»è®¤æ¯ Objectç±»equals()æ¹æ³ã\n * ç±»éåäº equals()æ¹æ³ ï¼ä¸è¬æä»¬é½éå equals()æ¹æ³æ¥æ¯è¾ä¸¤ä¸ªå¯¹è±¡ä¸­çå±æ§æ¯å¦ç¸ç­ï¼è¥å®ä»¬çå±æ§ç¸ç­ï¼åè¿å true(å³ï¼è®¤ä¸ºè¿ä¸¤ä¸ªå¯¹è±¡ç¸ç­)ã\n\nStringç±»equals()æ¹æ³ï¼\n\npublic boolean equals(Object anObject) {\n    if (this == anObject) {\n        return true;\n    }\n    if (anObject instanceof String) {\n        String anotherString = (String)anObject;\n        int n = value.length;\n        if (n == anotherString.value.length) {\n            char v1[] = value;\n            char v2[] = anotherString.value;\n            int i = 0;\n            while (n-- != 0) {\n                if (v1[i] != v2[i])\n                    return false;\n                i++;\n            }\n            return true;\n        }\n    }\n    return false;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# hashCode() ä¸ equals()\n\nhashCode() æä»ä¹ç¨ï¼\n\nhashCode() çä½ç¨æ¯è·ååå¸ç ï¼int æ´æ°ï¼ï¼ä¹ç§°ä¸ºæ£åç ãè¿ä¸ªåå¸ç çä½ç¨æ¯ç¡®å®è¯¥å¯¹è±¡å¨åå¸è¡¨ä¸­çç´¢å¼ä½ç½®ã\n\nhashCode()å®ä¹å¨ JDK ç Object ç±»ä¸­ï¼è¿å°±æå³ç Java ä¸­çä»»ä½ç±»é½åå«æ hashCode() å½æ°ãå¦å¤éè¦æ³¨æçæ¯ï¼ Object ç hashCode() æ¹æ³æ¯æ¬å°æ¹æ³ï¼ä¹å°±æ¯ç¨ C è¯­è¨æ C++ å®ç°çï¼è¯¥æ¹æ³éå¸¸ç¨æ¥å°å¯¹è±¡çåå­å°åè½¬æ¢ä¸ºæ´æ°ä¹åè¿åã\n\npublic native int hashCode();\n\n\n1\n\n\nä¸ºä»ä¹è¦æhashCodeï¼\n\nä»¥âHashSet å¦ä½æ£æ¥éå¤âä¸ºä¾å­æ¥è¯´æä¸ºä»ä¹è¦æ hashCodeï¼\n\n> ãHead First Javaã\n> \n> å½ä½ æå¯¹è±¡å å¥ HashSet æ¶ï¼HashSet ä¼åè®¡ç®å¯¹è±¡ç hashCode å¼æ¥å¤æ­å¯¹è±¡å å¥çä½ç½®ï¼åæ¶ä¹ä¼ä¸å¶ä»å·²ç»å å¥çå¯¹è±¡ç hashCode å¼ä½æ¯è¾ï¼å¦ææ²¡æç¸ç¬¦ç hashCodeï¼HashSet ä¼åè®¾å¯¹è±¡æ²¡æéå¤åºç°ãä½æ¯å¦æåç°æç¸å hashCode å¼çå¯¹è±¡ï¼è¿æ¶ä¼è°ç¨ equals() æ¹æ³æ¥æ£æ¥ hashCode ç¸ç­çå¯¹è±¡æ¯å¦ççç¸åãå¦æä¸¤èç¸åï¼HashSet å°±ä¸ä¼è®©å¶å å¥æä½æåãå¦æä¸åçè¯ï¼å°±ä¼éæ°æ£åå°å¶ä»ä½ç½®ãè¿æ ·æä»¬å°±å¤§å¤§åå°äº equals çæ¬¡æ°ï¼ç¸åºå°±å¤§å¤§æé«äºæ§è¡éåº¦ã\n\næ»ç» ï¼\n\n * equals æ¹æ³å¤æ­ä¸¤ä¸ªå¯¹è±¡æ¯ç¸ç­çï¼é£è¿ä¸¤ä¸ªå¯¹è±¡ç hashCode å¼ä¹è¦ç¸ç­ã\n * ä¸¤ä¸ªå¯¹è±¡æç¸åç hashCode å¼ï¼ä»ä»¬ä¹ä¸ä¸å®æ¯ç¸ç­çï¼åå¸ç¢°æï¼ã",normalizedContent:"# java 8å¤§åºæ¬æ°æ®ç±»å\n\njava ä¸­æ 8 ç§åºæ¬æ°æ®ç±»åï¼åå«ä¸ºï¼\n\n 1. 6 ç§æ°å­ç±»åï¼\n    * 4 ç§æ´æ°åï¼byteãshortãintãlong\n    * 2 ç§æµ®ç¹åï¼floatãdouble\n 2. 1 ç§å­ç¬¦ç±»åï¼char\n 3. 1 ç§å¸å°åï¼booleanã\n\nè¿ 8 ç§åºæ¬æ°æ®ç±»åçé»è®¤å¼ä»¥åæå ç©ºé´çå¤§å°å¦ä¸ï¼\n\nåºæ¬ç±»å      ä½æ°   å­è   é»è®¤å¼       åå¼èå´\nbyte      8    1    0         -128 ~ 127\nshort     16   2    0         -32768 ~ 32767\nint       32   4    0         -2147483648 ~ 2147483647\nlong      64   8    0l        -9223372036854775808 ~ 9223372036854775807\nchar      16   2    'u0000'   0 ~ 65535\nfloat     32   4    0f        1.4e-45 ~ 3.4028235e38\ndouble    64   8    0d        4.9e-324 ~ 1.7976931348623157e308\nboolean   1         false     trueãfalse\n\n\n# objectç±»ä¸­å¸¸è§çæ¹æ³\n\n//nativeæ¹æ³ï¼ç¨äºè¿åå½åè¿è¡æ¶å¯¹è±¡çclasså¯¹è±¡ï¼ä½¿ç¨äºfinalå³é®å­ä¿®é¥°ï¼æä¸åè®¸å­ç±»éåã\npublic final native class<?> getclass()\n\n//nativeæ¹æ³ï¼ç¨äºè¿åå¯¹è±¡çåå¸ç ï¼ä¸»è¦ä½¿ç¨å¨åå¸è¡¨ä¸­ï¼æ¯å¦jdkä¸­çhashmapã\npublic native int hashcode() \n\n//ç¨äºæ¯è¾2ä¸ªå¯¹è±¡çåå­å°åæ¯å¦ç¸ç­ï¼stringç±»å¯¹è¯¥æ¹æ³è¿è¡äºéåç¨æ·æ¯è¾å­ç¬¦ä¸²çå¼æ¯å¦ç¸ç­ã\npublic boolean equals(object obj)\n\n//naitiveæ¹æ³ï¼ç¨äºåå»ºå¹¶è¿åå½åå¯¹è±¡çä¸ä»½æ·è´ãä¸è¬æåµä¸ï¼å¯¹äºä»»ä½å¯¹è±¡ xï¼è¡¨è¾¾å¼ x.clone() != x ä¸ºtrueï¼x.clone().getclass() == x.getclass() ä¸ºtrueãobjectæ¬èº«æ²¡æå®ç°cloneableæ¥å£ï¼æä»¥ä¸éåcloneæ¹æ³å¹¶ä¸è¿è¡è°ç¨çè¯ä¼åçclonenotsupportedexceptionå¼å¸¸ã\nprotected native object clone() throws clonenotsupportedexception\n\n//è¿åç±»çåå­@å®ä¾çåå¸ç ç16è¿å¶çå­ç¬¦ä¸²ãå»ºè®®objectææçå­ç±»é½éåè¿ä¸ªæ¹æ³ã\npublic string tostring()\n\n//nativeæ¹æ³ï¼å¹¶ä¸ä¸è½éåãå¤éä¸ä¸ªå¨æ­¤å¯¹è±¡çè§å¨ä¸ç­å¾ççº¿ç¨(çè§å¨ç¸å½äºå°±æ¯éçæ¦å¿µ)ãå¦ææå¤ä¸ªçº¿ç¨å¨ç­å¾åªä¼ä»»æå¤éä¸ä¸ªã\npublic final native void notify()\n\n//nativeæ¹æ³ï¼å¹¶ä¸ä¸è½éåãè·notifyä¸æ ·ï¼å¯ä¸çåºå«å°±æ¯ä¼å¤éå¨æ­¤å¯¹è±¡çè§å¨ä¸ç­å¾çææçº¿ç¨ï¼èä¸æ¯ä¸ä¸ªçº¿ç¨ã\npublic final native void notifyall()\n\n//nativeæ¹æ³ï¼å¹¶ä¸ä¸è½éåãæåçº¿ç¨çæ§è¡ãæ³¨æï¼sleepæ¹æ³æ²¡æéæ¾éï¼èwaitæ¹æ³éæ¾äºé ãtimeoutæ¯ç­å¾æ¶é´ã\npublic final native void wait(long timeout) throws interruptedexception\n\n//å¤äºnanosåæ°ï¼è¿ä¸ªåæ°è¡¨ç¤ºé¢å¤æ¶é´ï¼ä»¥æ¯«å¾®ç§ä¸ºåä½ï¼èå´æ¯ 0-999999ï¼ã æä»¥è¶æ¶çæ¶é´è¿éè¦å ä¸nanosæ¯«ç§ã\npublic final void wait(long timeout, int nanos) throws interruptedexception\n\n//è·ä¹åç2ä¸ªwaitæ¹æ³ä¸æ ·ï¼åªä¸è¿è¯¥æ¹æ³ä¸ç´ç­å¾ï¼æ²¡æè¶æ¶æ¶é´è¿ä¸ªæ¦å¿µ\npublic final void wait() throws interruptedexception\n\n//å®ä¾è¢«åå¾åæ¶å¨åæ¶çæ¶åè§¦åçæä½\nprotected void finalize() throws throwable { }\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n\n# é¢åå¯¹è±¡ä¸å¤§ç¹å¾\n\nå°è£ï¼\n\nå°è£æ¯ææä¸ä¸ªå¯¹è±¡çå±æ§éèå¨å¯¹è±¡åé¨ï¼ä¸åè®¸å¤é¨å¯¹è±¡ç´æ¥è®¿é®å¯¹è±¡çåé¨ä¿¡æ¯privateãä½æ¯å¯ä»¥æä¾ä¸äºå¯ä»¥è¢«å¤çè®¿é®çæ¹æ³æ¥æä½å±æ§set/getæ¹æ³ã\n\nç»§æ¿ï¼\n\nä¸åç±»åçå¯¹è±¡ï¼ç¸äºä¹é´ç»å¸¸æä¸å®æ°éçå±åç¹ãåæ¶ï¼æ¯ä¸ä¸ªå¯¹è±¡è¿å®ä¹äºé¢å¤çç¹æ§ä½¿å¾ä»ä»¬ä¸ä¼ä¸åã\n\nå¤æï¼\n\nè¡¨ç¤ºä¸ä¸ªå¯¹è±¡å·æå¤ç§çç¶æï¼å·ä½è¡¨ç°ä¸ºç¶ç±»çå¼ç¨æåå­ç±»çå®ä¾ã\n\n\n# æ·±æ·è´ä¸æµæ·è´\n\n * æµæ·è´ï¼æµæ·è´ä¼å¨å ä¸åå»ºä¸ä¸ªæ°çå¯¹è±¡ï¼å¦æå¯¹è±¡åé¨å­å¨å¼ç¨ç±»åï¼æµæ·è´ç´æ¥å¤å¶åé¨å¯¹è±¡çå¼ç¨å°åãä¹å°±æ¯è¯´æ·è´å¯¹è±¡ååå¯¹è±¡å±ç¨åä¸ä¸ªå°åã\n\n * æ·±æ·è´ ï¼æ·±æ·è´ä¼å®å¨å¤å¶æ´ä¸ªå¯¹è±¡ï¼åæ¬è¿ä¸ªå¯¹è±¡æåå«çåé¨å¯¹è±¡ã\n\n\n# stringãstringbufferãstringbuilder\n\nå¯åæ§\n\nstringæ¯ä¸å¯åç\n\n 1. ä¿å­å­ç¬¦ä¸²çæ°ç»è¢« final ä¿®é¥°ä¸ä¸ºç§æçï¼å¹¶ä¸string ç±»æ²¡ææä¾/æ´é²ä¿®æ¹è¿ä¸ªå­ç¬¦ä¸²çæ¹æ³ã\n 2. string ç±»è¢« final ä¿®é¥°å¯¼è´å¶ä¸è½è¢«ç»§æ¿ï¼è¿èé¿åäºå­ç±»ç ´å string ä¸å¯åã\n\nstringbuilder ä¸ stringbuffer é½ç»§æ¿èª abstractstringbuilder ç±»ï¼å¨ abstractstringbuilder ä¸­ä¹æ¯ä½¿ç¨å­ç¬¦æ°ç»ä¿å­å­ç¬¦ä¸²ï¼æ²¡æä½¿ç¨ final å private å³é®å­ä¿®é¥°ï¼ abstractstringbuilder ç±»è¿æä¾äºå¾å¤ä¿®æ¹å­ç¬¦ä¸²çæ¹æ³æ¯å¦ å¸¸è§çappend æ¹æ³ã\n\nabstract class abstractstringbuilder implements appendable, charsequence {\n    char[] value;\n    public abstractstringbuilder append(string str) {\n        if (str == null)\n            return appendnull();\n        int len = str.length();\n        ensurecapacityinternal(count + len);\n        str.getchars(0, len, value, count);\n        count += len;\n        return this;\n    }\n  \t//...\n}\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nçº¿ç¨å®å¨æ§\n\nstring ä¸­çå¯¹è±¡æ¯ä¸å¯åçï¼ä¹å°±å¯ä»¥çè§£ä¸ºå¸¸éï¼çº¿ç¨å®å¨ã\n\nabstractstringbuilder æ¯ stringbuilder ä¸ stringbuffer çå¬å±ç¶ç±»ï¼å®ä¹äºä¸äºå­ç¬¦ä¸²çåºæ¬æä½ï¼å¦ expandcapacityãappendãinsertãindexof ç­å¬å±æ¹æ³ãstringbuffer å¯¹æ¹æ³å äºåæ­¥éæèå¯¹è°ç¨çæ¹æ³å äºåæ­¥éï¼æä»¥æ¯çº¿ç¨å®å¨çãstringbuilder å¹¶æ²¡æå¯¹æ¹æ³è¿è¡å åæ­¥éï¼æä»¥æ¯éçº¿ç¨å®å¨çã\n\næ§è½\n\næ¯æ¬¡å¯¹ string ç±»åè¿è¡æ¹åçæ¶åï¼é½ä¼çæä¸ä¸ªæ°ç string å¯¹è±¡ï¼ç¶åå°æéæåæ°ç string å¯¹è±¡ãstringbuffer æ¯æ¬¡é½ä¼å¯¹ stringbuffer å¯¹è±¡æ¬èº«è¿è¡æä½ï¼èä¸æ¯çææ°çå¯¹è±¡å¹¶æ¹åå¯¹è±¡å¼ç¨ãç¸åæåµä¸ä½¿ç¨ stringbuilder ç¸æ¯ä½¿ç¨ stringbuffer ä»è½è·å¾ 10%~15% å·¦å³çæ§è½æåï¼ä½å´è¦åå¤çº¿ç¨ä¸å®å¨çé£é©\n\n\n# == å equals()\n\n== å¯¹äºåºæ¬ç±»ååå¼ç¨ç±»åçä½ç¨æææ¯ä¸åçï¼\n\n * å¯¹äºåºæ¬æ°æ®ç±»åæ¥è¯´ï¼== æ¯è¾çæ¯å¼ã\n * å¯¹äºå¼ç¨æ°æ®ç±»åæ¥è¯´ï¼== æ¯è¾çæ¯å¯¹è±¡çåå­å°åã\n\nequals() ä¸è½ç¨äºå¤æ­åºæ¬æ°æ®ç±»åçåéï¼åªè½ç¨æ¥å¤æ­ä¸¤ä¸ªå¯¹è±¡æ¯å¦ç¸ç­ãequals()æ¹æ³å­å¨äºobjectç±»ä¸­ï¼èobjectç±»æ¯ææç±»çç´æ¥æé´æ¥ç¶ç±»ï¼å æ­¤ææçç±»é½æequals()æ¹æ³ã\n\nobject ç±» equals() æ¹æ³ï¼\n\npublic boolean equals(object obj) {\n     return (this == obj);\n}\n\n\n1\n2\n3\n\n\nequals() æ¹æ³å­å¨ä¸¤ç§ä½¿ç¨æåµï¼\n\n * ç±»æ²¡æéå equals()æ¹æ³ ï¼éè¿equals()æ¯è¾è¯¥ç±»çä¸¤ä¸ªå¯¹è±¡æ¶ï¼ç­ä»·äºéè¿â==âæ¯è¾è¿ä¸¤ä¸ªå¯¹è±¡ï¼ä½¿ç¨çé»è®¤æ¯ objectç±»equals()æ¹æ³ã\n * ç±»éåäº equals()æ¹æ³ ï¼ä¸è¬æä»¬é½éå equals()æ¹æ³æ¥æ¯è¾ä¸¤ä¸ªå¯¹è±¡ä¸­çå±æ§æ¯å¦ç¸ç­ï¼è¥å®ä»¬çå±æ§ç¸ç­ï¼åè¿å true(å³ï¼è®¤ä¸ºè¿ä¸¤ä¸ªå¯¹è±¡ç¸ç­)ã\n\nstringç±»equals()æ¹æ³ï¼\n\npublic boolean equals(object anobject) {\n    if (this == anobject) {\n        return true;\n    }\n    if (anobject instanceof string) {\n        string anotherstring = (string)anobject;\n        int n = value.length;\n        if (n == anotherstring.value.length) {\n            char v1[] = value;\n            char v2[] = anotherstring.value;\n            int i = 0;\n            while (n-- != 0) {\n                if (v1[i] != v2[i])\n                    return false;\n                i++;\n            }\n            return true;\n        }\n    }\n    return false;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n# hashcode() ä¸ equals()\n\nhashcode() æä»ä¹ç¨ï¼\n\nhashcode() çä½ç¨æ¯è·ååå¸ç ï¼int æ´æ°ï¼ï¼ä¹ç§°ä¸ºæ£åç ãè¿ä¸ªåå¸ç çä½ç¨æ¯ç¡®å®è¯¥å¯¹è±¡å¨åå¸è¡¨ä¸­çç´¢å¼ä½ç½®ã\n\nhashcode()å®ä¹å¨ jdk ç object ç±»ä¸­ï¼è¿å°±æå³ç java ä¸­çä»»ä½ç±»é½åå«æ hashcode() å½æ°ãå¦å¤éè¦æ³¨æçæ¯ï¼ object ç hashcode() æ¹æ³æ¯æ¬å°æ¹æ³ï¼ä¹å°±æ¯ç¨ c è¯­è¨æ c++ å®ç°çï¼è¯¥æ¹æ³éå¸¸ç¨æ¥å°å¯¹è±¡çåå­å°åè½¬æ¢ä¸ºæ´æ°ä¹åè¿åã\n\npublic native int hashcode();\n\n\n1\n\n\nä¸ºä»ä¹è¦æhashcodeï¼\n\nä»¥âhashset å¦ä½æ£æ¥éå¤âä¸ºä¾å­æ¥è¯´æä¸ºä»ä¹è¦æ hashcodeï¼\n\n> ãhead first javaã\n> \n> å½ä½ æå¯¹è±¡å å¥ hashset æ¶ï¼hashset ä¼åè®¡ç®å¯¹è±¡ç hashcode å¼æ¥å¤æ­å¯¹è±¡å å¥çä½ç½®ï¼åæ¶ä¹ä¼ä¸å¶ä»å·²ç»å å¥çå¯¹è±¡ç hashcode å¼ä½æ¯è¾ï¼å¦ææ²¡æç¸ç¬¦ç hashcodeï¼hashset ä¼åè®¾å¯¹è±¡æ²¡æéå¤åºç°ãä½æ¯å¦æåç°æç¸å hashcode å¼çå¯¹è±¡ï¼è¿æ¶ä¼è°ç¨ equals() æ¹æ³æ¥æ£æ¥ hashcode ç¸ç­çå¯¹è±¡æ¯å¦ççç¸åãå¦æä¸¤èç¸åï¼hashset å°±ä¸ä¼è®©å¶å å¥æä½æåãå¦æä¸åçè¯ï¼å°±ä¼éæ°æ£åå°å¶ä»ä½ç½®ãè¿æ ·æä»¬å°±å¤§å¤§åå°äº equals çæ¬¡æ°ï¼ç¸åºå°±å¤§å¤§æé«äºæ§è¡éåº¦ã\n\næ»ç» ï¼\n\n * equals æ¹æ³å¤æ­ä¸¤ä¸ªå¯¹è±¡æ¯ç¸ç­çï¼é£è¿ä¸¤ä¸ªå¯¹è±¡ç hashcode å¼ä¹è¦ç¸ç­ã\n * ä¸¤ä¸ªå¯¹è±¡æç¸åç hashcode å¼ï¼ä»ä»¬ä¹ä¸ä¸å®æ¯ç¸ç­çï¼åå¸ç¢°æï¼ã",charsets:{cjk:!0},lastUpdated:"2022/05/24, 15:05:00",lastUpdatedTimestamp:1653405625e3},{title:"Javaå¹¶å",frontmatter:{title:"Javaå¹¶å",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/f2ec12/"},regularPath:"/01.Java/Java%E5%B9%B6%E5%8F%91.html",relativePath:"01.Java/Javaå¹¶å.md",key:"v-648c7cfe",path:"/pages/f2ec12/",headers:[{level:2,title:"1ãè¿ç¨ä¸çº¿ç¨",slug:"_1ãè¿ç¨ä¸çº¿ç¨",normalizedTitle:"1ãè¿ç¨ä¸çº¿ç¨",charIndex:45},{level:3,title:"è¿ç¨",slug:"è¿ç¨",normalizedTitle:"è¿ç¨",charIndex:47},{level:3,title:"çº¿ç¨",slug:"çº¿ç¨",normalizedTitle:"çº¿ç¨",charIndex:50},{level:3,title:"äºèå¯¹æ¯",slug:"äºèå¯¹æ¯",normalizedTitle:"äºèå¯¹æ¯",charIndex:427},{level:2,title:"2ãå¹¶åä¸å¹¶è¡",slug:"_2ãå¹¶åä¸å¹¶è¡",normalizedTitle:"2ãå¹¶åä¸å¹¶è¡",charIndex:1378},{level:3,title:"3ãåºç¨",slug:"_3ãåºç¨",normalizedTitle:"3ãåºç¨",charIndex:1542},{level:2,title:"1ãåå»ºä¸ä¸ªçº¿ç¨ï¼éä¸»çº¿ç¨ï¼",slug:"_1ãåå»ºä¸ä¸ªçº¿ç¨-éä¸»çº¿ç¨",normalizedTitle:"1ãåå»ºä¸ä¸ªçº¿ç¨ï¼éä¸»çº¿ç¨ï¼",charIndex:2238},{level:3,title:"æ¹æ³ä¸ï¼éè¿ç»§æ¿Threadåå»ºçº¿ç¨",slug:"æ¹æ³ä¸-éè¿ç»§æ¿threadåå»ºçº¿ç¨",normalizedTitle:"æ¹æ³ä¸ï¼éè¿ç»§æ¿threadåå»ºçº¿ç¨",charIndex:2257},{level:3,title:"æ¹æ³äºï¼ä½¿ç¨RunnableéåThread(æ¨è)",slug:"æ¹æ³äº-ä½¿ç¨runnableéåthread-æ¨è",normalizedTitle:"æ¹æ³äºï¼ä½¿ç¨runnableéåthread(æ¨è)",charIndex:2725},{level:3,title:"æ¹æ³ä¸ï¼ä½¿ç¨FutureTaskä¸Threadç»å",slug:"æ¹æ³ä¸-ä½¿ç¨futuretaskä¸threadç»å",normalizedTitle:"æ¹æ³ä¸ï¼ä½¿ç¨futuretaskä¸threadç»å",charIndex:4143},{level:3,title:"æ»ç»",slug:"æ»ç»",normalizedTitle:"æ»ç»",charIndex:5254},{level:2,title:"2ãåçä¹çº¿ç¨è¿è¡",slug:"_2ãåçä¹çº¿ç¨è¿è¡",normalizedTitle:"2ãåçä¹çº¿ç¨è¿è¡",charIndex:5450},{level:2,title:"3ãå¸¸ç¨æ¹æ³",slug:"_3ãå¸¸ç¨æ¹æ³",normalizedTitle:"3ãå¸¸ç¨æ¹æ³",charIndex:6025},{level:3,title:"(1)start() vs run()",slug:"_1-start-vs-run",normalizedTitle:"(1)start() vs run()",charIndex:6036},{level:3,title:"(2)sleep()ä¸yield()",slug:"_2-sleep-ä¸yield",normalizedTitle:"(2)sleep()ä¸yield()",charIndex:6164},{level:3,title:"(3)join()æ¹æ³",slug:"_3-join-æ¹æ³",normalizedTitle:"(3)join()æ¹æ³",charIndex:6860},{level:3,title:"(4)interrupt()æ¹æ³",slug:"_4-interrupt-æ¹æ³",normalizedTitle:"(4)interrupt()æ¹æ³",charIndex:7106},{level:3,title:"(5)ä¸æ¨èä½¿ç¨çææ­æ¹æ³",slug:"_5-ä¸æ¨èä½¿ç¨çææ­æ¹æ³",normalizedTitle:"(5)ä¸æ¨èä½¿ç¨çææ­æ¹æ³",charIndex:8638},{level:3,title:"(6)å®æ¤çº¿ç¨",slug:"_6-å®æ¤çº¿ç¨",normalizedTitle:"(6)å®æ¤çº¿ç¨",charIndex:8736},{level:2,title:"4ãçº¿ç¨çç¶æ",slug:"_4ãçº¿ç¨çç¶æ",normalizedTitle:"4ãçº¿ç¨çç¶æ",charIndex:8998},{level:3,title:"(1)äºç§ç¶æ",slug:"_1-äºç§ç¶æ",normalizedTitle:"(1)äºç§ç¶æ",charIndex:9010},{level:3,title:"(2)å­ç§ç¶æ",slug:"_2-å­ç§ç¶æ",normalizedTitle:"(2)å­ç§ç¶æ",charIndex:9431},{level:2,title:"1ãå±äº«å¸¦æ¥çé®é¢",slug:"_1ãå±äº«å¸¦æ¥çé®é¢",normalizedTitle:"1ãå±äº«å¸¦æ¥çé®é¢",charIndex:9807},{level:3,title:"(1)ä¸´çåº Critical Section",slug:"_1-ä¸´çåº-critical-section",normalizedTitle:"(1)ä¸´çåº critical section",charIndex:9821},{level:3,title:"(2)ç«ææ¡ä»¶ Race Condition",slug:"_2-ç«ææ¡ä»¶-race-condition",normalizedTitle:"(2)ç«ææ¡ä»¶ race condition",charIndex:10169},{level:2,title:"2ãsynchronized è§£å³æ¹æ¡",slug:"_2ãsynchronized-è§£å³æ¹æ¡",normalizedTitle:"2ãsynchronized è§£å³æ¹æ¡",charIndex:10241},{level:3,title:"(1)è§£å³ææ®µ",slug:"_1-è§£å³ææ®µ",normalizedTitle:"(1)è§£å³ææ®µ",charIndex:10265},{level:3,title:"(2)synchronizedè¯­æ³",slug:"_2-synchronizedè¯­æ³",normalizedTitle:"(2)synchronizedè¯­æ³",charIndex:10507},{level:3,title:"(3)synchronizedå å¨æ¹æ³ä¸",slug:"_3-synchronizedå å¨æ¹æ³ä¸",normalizedTitle:"(3)synchronizedå å¨æ¹æ³ä¸",charIndex:11330},{level:2,title:"3ãåéççº¿ç¨å®å¨åæ",slug:"_3ãåéççº¿ç¨å®å¨åæ",normalizedTitle:"3ãåéççº¿ç¨å®å¨åæ",charIndex:11922},{level:3,title:"å¸¸è§çº¿ç¨å®å¨ç±»",slug:"å¸¸è§çº¿ç¨å®å¨ç±»",normalizedTitle:"å¸¸è§çº¿ç¨å®å¨ç±»",charIndex:12328},{level:3,title:"ä¸å¯åç±»çº¿ç¨å®å¨æ§",slug:"ä¸å¯åç±»çº¿ç¨å®å¨æ§",normalizedTitle:"ä¸å¯åç±»çº¿ç¨å®å¨æ§",charIndex:12583},{level:2,title:"4ãMonitoræ¦å¿µ",slug:"_4ãmonitoræ¦å¿µ",normalizedTitle:"4ãmonitoræ¦å¿µ",charIndex:12771},{level:3,title:"(1)åçä¹Monitor",slug:"_1-åçä¹monitor",normalizedTitle:"(1)åçä¹monitor",charIndex:12787},{level:2,title:"5ãSynchronizedåçè¿é¶",slug:"_5ãsynchronizedåçè¿é¶",normalizedTitle:"5ãsynchronizedåçè¿é¶",charIndex:13299},{level:3,title:"å¯¹è±¡å¤´æ ¼å¼",slug:"å¯¹è±¡å¤´æ ¼å¼",normalizedTitle:"å¯¹è±¡å¤´æ ¼å¼",charIndex:13322},{level:3,title:"(1)è½»éçº§éï¼ç¨äºä¼åMonitorè¿ç±»çééçº§éï¼",slug:"_1-è½»éçº§é-ç¨äºä¼åmonitorè¿ç±»çééçº§é",normalizedTitle:"(1)è½»éçº§éï¼ç¨äºä¼åmonitorè¿ç±»çééçº§éï¼",charIndex:13334},{level:3,title:"(2)éè¨è",slug:"_2-éè¨è",normalizedTitle:"(2)éè¨è",charIndex:13675},{level:3,title:"(3)èªæä¼å",slug:"_3-èªæä¼å",normalizedTitle:"(3)èªæä¼å",charIndex:13894},{level:3,title:"(4)ååé(ç¨äºä¼åè½»éçº§ééå¥)",slug:"_4-ååé-ç¨äºä¼åè½»éçº§ééå¥",normalizedTitle:"(4)ååé(ç¨äºä¼åè½»éçº§ééå¥)",charIndex:13998},{level:3,title:"(5)æ¹ééåå",slug:"_5-æ¹ééåå",normalizedTitle:"(5)æ¹ééåå",charIndex:14690},{level:3,title:"(6)æ¹éæ¤é",slug:"_6-æ¹éæ¤é",normalizedTitle:"(6)æ¹éæ¤é",charIndex:14828},{level:2,title:"6ãWait/Notify",slug:"_6ãwait-notify",normalizedTitle:"6ãwait/notify",charIndex:14875},{level:3,title:"(1)åç",slug:"_1-åç",normalizedTitle:"(1)åç",charIndex:12787},{level:3,title:"(2)Waitä¸Sleepçåºå«",slug:"_2-waitä¸sleepçåºå«",normalizedTitle:"(2)waitä¸sleepçåºå«",charIndex:15560},{level:3,title:"(3)ä¼éå°ä½¿ç¨wait/notify",slug:"_3-ä¼éå°ä½¿ç¨wait-notify",normalizedTitle:"(3)ä¼éå°ä½¿ç¨wait/notify",charIndex:15785},{level:2,title:"7ãæ¨¡å¼ä¹ä¿æ¤æ§æå",slug:"_7ãæ¨¡å¼ä¹ä¿æ¤æ§æå",normalizedTitle:"7ãæ¨¡å¼ä¹ä¿æ¤æ§æå",charIndex:16241},{level:3,title:"(1)å®ä¹",slug:"_1-å®ä¹",normalizedTitle:"(1)å®ä¹",charIndex:16256},{level:3,title:"(2)ä¸¾ä¾",slug:"_2-ä¸¾ä¾",normalizedTitle:"(2)ä¸¾ä¾",charIndex:16268},{level:3,title:"(3)joinæºç ââä½¿ç¨ä¿æ¤æ§æåæ¨¡å¼",slug:"_3-joinæºç -ä½¿ç¨ä¿æ¤æ§æåæ¨¡å¼",normalizedTitle:"(3)joinæºç ââä½¿ç¨ä¿æ¤æ§æåæ¨¡å¼",charIndex:18093},{level:2,title:"8ãpark/unpark",slug:"_8ãpark-unpark",normalizedTitle:"8ãpark/unpark",charIndex:18838},{level:3,title:"(1)åºæ¬ä½¿ç¨",slug:"_1-åºæ¬ä½¿ç¨",normalizedTitle:"(1)åºæ¬ä½¿ç¨",charIndex:18856},{level:3,title:"(2)ç¹ç¹",slug:"_2-ç¹ç¹",normalizedTitle:"(2)ç¹ç¹",charIndex:19362},{level:3,title:"(3)åç",slug:"_3-åç",normalizedTitle:"(3)åç",charIndex:19614},{level:2,title:"9ãçº¿ç¨ä¸­çç¶æè½¬æ¢",slug:"_9ãçº¿ç¨ä¸­çç¶æè½¬æ¢",normalizedTitle:"9ãçº¿ç¨ä¸­çç¶æè½¬æ¢",charIndex:20154},{level:3,title:"æåµä¸ï¼NEW â> RUNNABLE",slug:"æåµä¸-new-runnable",normalizedTitle:"æåµä¸ï¼new â&gt; runnable",charIndex:null},{level:3,title:"æåµäºï¼ RUNNABLE  WAITING",slug:"æåµäº-runnable-waiting",normalizedTitle:"æåµäºï¼ runnable  waiting",charIndex:null},{level:3,title:"æåµä¸ï¼RUNNABLE  WAITING",slug:"æåµä¸-runnable-waiting",normalizedTitle:"æåµä¸ï¼runnable  waiting",charIndex:null},{level:3,title:"æåµåï¼ RUNNABLE  WAITING",slug:"æåµå-runnable-waiting",normalizedTitle:"æåµåï¼ runnable  waiting",charIndex:null},{level:3,title:"æåµäºï¼ RUNNABLE  TIMED_WAITING",slug:"æåµäº-runnable-timed-waiting",normalizedTitle:"æåµäºï¼ runnable  timed_waiting",charIndex:null},{level:3,title:"æåµå­ï¼RUNNABLE  TIMED_WAITING",slug:"æåµå­-runnable-timed-waiting",normalizedTitle:"æåµå­ï¼runnable  timed_waiting",charIndex:null},{level:3,title:"æåµä¸ï¼RUNNABLE  TIMED_WAITING",slug:"æåµä¸-runnable-timed-waiting",normalizedTitle:"æåµä¸ï¼runnable  timed_waiting",charIndex:null},{level:3,title:"æåµå«ï¼RUNNABLE  TIMED_WAITING",slug:"æåµå«-runnable-timed-waiting",normalizedTitle:"æåµå«ï¼runnable  timed_waiting",charIndex:null},{level:3,title:"æåµä¹ï¼RUNNABLE  BLOCKED",slug:"æåµä¹-runnable-blocked",normalizedTitle:"æåµä¹ï¼runnable  blocked",charIndex:null},{level:3,title:"æåµåï¼ RUNNABLE  TERMINATED",slug:"æåµå-runnable-terminated",normalizedTitle:"æåµåï¼ runnable  terminated",charIndex:null},{level:2,title:"10ãå¤æé",slug:"_10ãå¤æé",normalizedTitle:"10ãå¤æé",charIndex:22013},{level:2,title:"11ãæ´»è·æ§",slug:"_11ãæ´»è·æ§",normalizedTitle:"11ãæ´»è·æ§",charIndex:22176},{level:3,title:"(1)å®ä¹",slug:"_1-å®ä¹-2",normalizedTitle:"(1)å®ä¹",charIndex:16256},{level:3,title:"(2)æ­»é",slug:"_2-æ­»é",normalizedTitle:"(2)æ­»é",charIndex:22229},{level:3,title:"(3)æ´»é",slug:"_3-æ´»é",normalizedTitle:"(3)æ´»é",charIndex:24007},{level:3,title:"(4)é¥¥é¥¿",slug:"_4-é¥¥é¥¿",normalizedTitle:"(4)é¥¥é¥¿",charIndex:24186},{level:2,title:"12ãReentrantLock",slug:"_12ãreentrantlock",normalizedTitle:"12ãreentrantlock",charIndex:24244},{level:2,title:"13ãåæ­¥æ¨¡å¼ä¹é¡ºåºæ§å¶",slug:"_13ãåæ­¥æ¨¡å¼ä¹é¡ºåºæ§å¶",normalizedTitle:"13ãåæ­¥æ¨¡å¼ä¹é¡ºåºæ§å¶",charIndex:31838},{level:3,title:"Wait/Notifyçæ¬",slug:"wait-notifyçæ¬",normalizedTitle:"wait/notifyçæ¬",charIndex:31855},{level:3,title:"äº¤æ¿è¾åº",slug:"äº¤æ¿è¾åº",normalizedTitle:"äº¤æ¿è¾åº",charIndex:32445},{level:2,title:"14ãThreadLocal",slug:"_14ãthreadlocal",normalizedTitle:"14ãthreadlocal",charIndex:35133},{level:3,title:"ç®ä»",slug:"ç®ä»",normalizedTitle:"ç®ä»",charIndex:35152},{level:3,title:"ä½¿ç¨",slug:"ä½¿ç¨",normalizedTitle:"ä½¿ç¨",charIndex:990},{level:3,title:"åç",slug:"åç",normalizedTitle:"åç",charIndex:3970},{level:2,title:"15ãInheritableThreadLocal",slug:"_15ãinheritablethreadlocal",normalizedTitle:"15ãinheritablethreadlocal",charIndex:40218},{level:3,title:"ç®ä»",slug:"ç®ä»-2",normalizedTitle:"ç®ä»",charIndex:35152},{level:3,title:"ä½¿ç¨",slug:"ä½¿ç¨-2",normalizedTitle:"ä½¿ç¨",charIndex:990},{level:3,title:"åç",slug:"åç-2",normalizedTitle:"åç",charIndex:3970},{level:2,title:"1ãJAVAåå­æ¨¡åï¼JMMï¼",slug:"_1ãjavaåå­æ¨¡å-jmm",normalizedTitle:"1ãjavaåå­æ¨¡åï¼jmmï¼",charIndex:44626},{level:2,title:"2ãå¯è§æ§",slug:"_2ãå¯è§æ§",normalizedTitle:"2ãå¯è§æ§",charIndex:44838},{level:2,title:"3ãæåºæ§",slug:"_3ãæåºæ§",normalizedTitle:"3ãæåºæ§",charIndex:48797},{level:3,title:"æä»¤éæ",slug:"æä»¤éæ",normalizedTitle:"æä»¤éæ",charIndex:48807},{level:3,title:"æä»¤éæåºä¼å",slug:"æä»¤éæåºä¼å",normalizedTitle:"æä»¤éæåºä¼å",charIndex:48884},{level:3,title:"æ¯ææµæ°´çº¿çå¤çå¨",slug:"æ¯ææµæ°´çº¿çå¤çå¨",normalizedTitle:"æ¯ææµæ°´çº¿çå¤çå¨",charIndex:49281},{level:3,title:"è§£å³åæ³",slug:"è§£å³åæ³",normalizedTitle:"è§£å³åæ³",charIndex:49501},{level:2,title:"4ãåå­å±é",slug:"_4ãåå­å±é",normalizedTitle:"4ãåå­å±é",charIndex:49567},{level:2,title:"5ãvolatile åç",slug:"_5ãvolatile-åç",normalizedTitle:"5ãvolatile åç",charIndex:49756},{level:3,title:"å¦ä½ä¿è¯å¯è§æ§",slug:"å¦ä½ä¿è¯å¯è§æ§",normalizedTitle:"å¦ä½ä¿è¯å¯è§æ§",charIndex:49882},{level:3,title:"å¦ä½ä¿è¯æåºæ§",slug:"å¦ä½ä¿è¯æåºæ§",normalizedTitle:"å¦ä½ä¿è¯æåºæ§",charIndex:49998},{level:3,title:"å®ç°åçä¹Lockåç¼",slug:"å®ç°åçä¹lockåç¼",normalizedTitle:"å®ç°åçä¹lockåç¼",charIndex:50182},{level:2,title:"1ãæ éè§£å³çº¿ç¨å®å¨é®é¢",slug:"_1ãæ éè§£å³çº¿ç¨å®å¨é®é¢",normalizedTitle:"1ãæ éè§£å³çº¿ç¨å®å¨é®é¢",charIndex:50782},{level:2,title:"2ãCASä¸volatile",slug:"_2ãcasä¸volatile",normalizedTitle:"2ãcasä¸volatile",charIndex:52689},{level:3,title:"å·¥ä½æµç¨",slug:"å·¥ä½æµç¨",normalizedTitle:"å·¥ä½æµç¨",charIndex:52847},{level:3,title:"volatile",slug:"volatile",normalizedTitle:"volatile",charIndex:45365},{level:3,title:"æçé®é¢",slug:"æçé®é¢",normalizedTitle:"æçé®é¢",charIndex:53524},{level:3,title:"CASç¹ç¹",slug:"casç¹ç¹",normalizedTitle:"casç¹ç¹",charIndex:53562},{level:2,title:"3ãåå­æ´æ°",slug:"_3ãåå­æ´æ°",normalizedTitle:"3ãåå­æ´æ°",charIndex:53892},{level:2,title:"4ãåå­å¼ç¨",slug:"_4ãåå­å¼ç¨",normalizedTitle:"4ãåå­å¼ç¨",charIndex:55258},{level:2,title:"5ãABAé®é¢",slug:"_5ãabaé®é¢",normalizedTitle:"5ãabaé®é¢",charIndex:56757},{level:3,title:"AtomicStampedReference",slug:"atomicstampedreference",normalizedTitle:"atomicstampedreference",charIndex:57762},{level:3,title:"AtomicMarkableReference",slug:"atomicmarkablereference",normalizedTitle:"atomicmarkablereference",charIndex:58940},{level:3,title:"ä¸¤èçåºå«",slug:"ä¸¤èçåºå«",normalizedTitle:"ä¸¤èçåºå«",charIndex:6e4},{level:2,title:"6ãåå­æ°ç»",slug:"_6ãåå­æ°ç»",normalizedTitle:"6ãåå­æ°ç»",charIndex:60114},{level:3,title:"lambaè¡¨è¾¾å¼çä½¿ç¨",slug:"lambaè¡¨è¾¾å¼çä½¿ç¨",normalizedTitle:"lambaè¡¨è¾¾å¼çä½¿ç¨",charIndex:60191},{level:2,title:"7ãåå­æ´æ°å¨",slug:"_7ãåå­æ´æ°å¨",normalizedTitle:"7ãåå­æ´æ°å¨",charIndex:60311},{level:3,title:"åå­æ´æ°å¨åå§åè¿ç¨",slug:"åå­æ´æ°å¨åå§åè¿ç¨",normalizedTitle:"åå­æ´æ°å¨åå§åè¿ç¨",charIndex:61149},{level:2,title:"8ãLongAdderåç",slug:"_8ãlongadderåç",normalizedTitle:"8ãlongadderåç",charIndex:64763},{level:3,title:"åçä¹ä¼ªå±äº«",slug:"åçä¹ä¼ªå±äº«",normalizedTitle:"åçä¹ä¼ªå±äº«",charIndex:64781},{level:2,title:"9ãUnsafe",slug:"_9ãunsafe",normalizedTitle:"9ãunsafe",charIndex:65832},{level:3,title:"1ãä¸å¯å",slug:"_1ãä¸å¯å",normalizedTitle:"1ãä¸å¯å",charIndex:66951},{level:3,title:"2ãä¸å¯åè®¾è®¡",slug:"_2ãä¸å¯åè®¾è®¡",normalizedTitle:"2ãä¸å¯åè®¾è®¡",charIndex:67006},{level:2,title:"1ãèªå®ä¹çº¿ç¨æ± ",slug:"_1ãèªå®ä¹çº¿ç¨æ± ",normalizedTitle:"1ãèªå®ä¹çº¿ç¨æ± ",charIndex:68823},{level:3,title:"å¾è§£",slug:"å¾è§£",normalizedTitle:"å¾è§£",charIndex:68836},{level:3,title:"ä»£ç ",slug:"ä»£ç ",normalizedTitle:"ä»£ç ",charIndex:181},{level:2,title:"2ãThreadPoolExecutor",slug:"_2ãthreadpoolexecutor",normalizedTitle:"2ãthreadpoolexecutor",charIndex:74590},{level:3,title:"ç»§æ¿å³ç³»",slug:"ç»§æ¿å³ç³»",normalizedTitle:"ç»§æ¿å³ç³»",charIndex:74615},{level:3,title:"çº¿ç¨æ± ç¶æ",slug:"çº¿ç¨æ± ç¶æ",normalizedTitle:"çº¿ç¨æ± ç¶æ",charIndex:74626},{level:3,title:"çº¿ç¨æ± å±æ§",slug:"çº¿ç¨æ± å±æ§",normalizedTitle:"çº¿ç¨æ± å±æ§",charIndex:76100},{level:3,title:"æé æ¹æ³æå¶åæ°",slug:"æé æ¹æ³æå¶åæ°",normalizedTitle:"æé æ¹æ³æå¶åæ°",charIndex:76526},{level:3,title:"FixedThreadPool",slug:"fixedthreadpool",normalizedTitle:"fixedthreadpool",charIndex:78938},{level:3,title:"CachedThreadPool",slug:"cachedthreadpool",normalizedTitle:"cachedthreadpool",charIndex:80155},{level:3,title:"SingleThread",slug:"singlethread",normalizedTitle:"singlethread",charIndex:80624},{level:3,title:"æ§è¡ä»»å¡",slug:"æ§è¡ä»»å¡",normalizedTitle:"æ§è¡ä»»å¡",charIndex:70139},{level:3,title:"åæ­¢",slug:"åæ­¢",normalizedTitle:"åæ­¢",charIndex:7327}],headersStr:"1ãè¿ç¨ä¸çº¿ç¨ è¿ç¨ çº¿ç¨ äºèå¯¹æ¯ 2ãå¹¶åä¸å¹¶è¡ 3ãåºç¨ 1ãåå»ºä¸ä¸ªçº¿ç¨ï¼éä¸»çº¿ç¨ï¼ æ¹æ³ä¸ï¼éè¿ç»§æ¿Threadåå»ºçº¿ç¨ æ¹æ³äºï¼ä½¿ç¨RunnableéåThread(æ¨è) æ¹æ³ä¸ï¼ä½¿ç¨FutureTaskä¸Threadç»å æ»ç» 2ãåçä¹çº¿ç¨è¿è¡ 3ãå¸¸ç¨æ¹æ³ (1)start() vs run() (2)sleep()ä¸yield() (3)join()æ¹æ³ (4)interrupt()æ¹æ³ (5)ä¸æ¨èä½¿ç¨çææ­æ¹æ³ (6)å®æ¤çº¿ç¨ 4ãçº¿ç¨çç¶æ (1)äºç§ç¶æ (2)å­ç§ç¶æ 1ãå±äº«å¸¦æ¥çé®é¢ (1)ä¸´çåº Critical Section (2)ç«ææ¡ä»¶ Race Condition 2ãsynchronized è§£å³æ¹æ¡ (1)è§£å³ææ®µ (2)synchronizedè¯­æ³ (3)synchronizedå å¨æ¹æ³ä¸ 3ãåéççº¿ç¨å®å¨åæ å¸¸è§çº¿ç¨å®å¨ç±» ä¸å¯åç±»çº¿ç¨å®å¨æ§ 4ãMonitoræ¦å¿µ (1)åçä¹Monitor 5ãSynchronizedåçè¿é¶ å¯¹è±¡å¤´æ ¼å¼ (1)è½»éçº§éï¼ç¨äºä¼åMonitorè¿ç±»çééçº§éï¼ (2)éè¨è (3)èªæä¼å (4)ååé(ç¨äºä¼åè½»éçº§ééå¥) (5)æ¹ééåå (6)æ¹éæ¤é 6ãWait/Notify (1)åç (2)Waitä¸Sleepçåºå« (3)ä¼éå°ä½¿ç¨wait/notify 7ãæ¨¡å¼ä¹ä¿æ¤æ§æå (1)å®ä¹ (2)ä¸¾ä¾ (3)joinæºç ââä½¿ç¨ä¿æ¤æ§æåæ¨¡å¼ 8ãpark/unpark (1)åºæ¬ä½¿ç¨ (2)ç¹ç¹ (3)åç 9ãçº¿ç¨ä¸­çç¶æè½¬æ¢ æåµä¸ï¼NEW â> RUNNABLE æåµäºï¼ RUNNABLE  WAITING æåµä¸ï¼RUNNABLE  WAITING æåµåï¼ RUNNABLE  WAITING æåµäºï¼ RUNNABLE  TIMED_WAITING æåµå­ï¼RUNNABLE  TIMED_WAITING æåµä¸ï¼RUNNABLE  TIMED_WAITING æåµå«ï¼RUNNABLE  TIMED_WAITING æåµä¹ï¼RUNNABLE  BLOCKED æåµåï¼ RUNNABLE  TERMINATED 10ãå¤æé 11ãæ´»è·æ§ (1)å®ä¹ (2)æ­»é (3)æ´»é (4)é¥¥é¥¿ 12ãReentrantLock 13ãåæ­¥æ¨¡å¼ä¹é¡ºåºæ§å¶ Wait/Notifyçæ¬ äº¤æ¿è¾åº 14ãThreadLocal ç®ä» ä½¿ç¨ åç 15ãInheritableThreadLocal ç®ä» ä½¿ç¨ åç 1ãJAVAåå­æ¨¡åï¼JMMï¼ 2ãå¯è§æ§ 3ãæåºæ§ æä»¤éæ æä»¤éæåºä¼å æ¯ææµæ°´çº¿çå¤çå¨ è§£å³åæ³ 4ãåå­å±é 5ãvolatile åç å¦ä½ä¿è¯å¯è§æ§ å¦ä½ä¿è¯æåºæ§ å®ç°åçä¹Lockåç¼ 1ãæ éè§£å³çº¿ç¨å®å¨é®é¢ 2ãCASä¸volatile å·¥ä½æµç¨ volatile æçé®é¢ CASç¹ç¹ 3ãåå­æ´æ° 4ãåå­å¼ç¨ 5ãABAé®é¢ AtomicStampedReference AtomicMarkableReference ä¸¤èçåºå« 6ãåå­æ°ç» lambaè¡¨è¾¾å¼çä½¿ç¨ 7ãåå­æ´æ°å¨ åå­æ´æ°å¨åå§åè¿ç¨ 8ãLongAdderåç åçä¹ä¼ªå±äº« 9ãUnsafe 1ãä¸å¯å 2ãä¸å¯åè®¾è®¡ 1ãèªå®ä¹çº¿ç¨æ±  å¾è§£ ä»£ç  2ãThreadPoolExecutor ç»§æ¿å³ç³» çº¿ç¨æ± ç¶æ çº¿ç¨æ± å±æ§ æé æ¹æ³æå¶åæ° FixedThreadPool CachedThreadPool SingleThread æ§è¡ä»»å¡ åæ­¢",content:'æ¬ç¯ç¬è®°æ ¹æ®\n\né»é©¬javaå¹¶åç¼ç¨æç¨\n\nå­¦ä¹ èåçç¬è®°\n\n\n# ä¸ãåºæ¬æ¦å¿µ\n\n\n# 1ãè¿ç¨ä¸çº¿ç¨\n\n\n# è¿ç¨\n\n * ç¨åºç±æä»¤åæ°æ®ç»æï¼ä½è¿äºæä»¤è¦è¿è¡ï¼æ°æ®è¦è¯»åï¼å°±å¿é¡»å°æä»¤å è½½è³ CPUï¼æ°æ®å è½½è³åå­ãå¨æä»¤è¿è¡è¿ç¨ä¸­è¿éè¦ç¨å°ç£çãç½ç»ç­è®¾å¤ãè¿ç¨å°±æ¯ç¨æ¥å è½½æä»¤ãç®¡çåå­ãç®¡ç IO çã\n * å½ä¸ä¸ªç¨åºè¢«è¿è¡ï¼ä»ç£çå è½½è¿ä¸ªç¨åºçä»£ç è³åå­ï¼è¿æ¶å°±å¼å¯äºä¸ä¸ªè¿ç¨ã\n * è¿ç¨å°±å¯ä»¥è§ä¸ºç¨åºçä¸ä¸ªå®ä¾ãå¤§é¨åç¨åºå¯ä»¥åæ¶è¿è¡å¤ä¸ªå®ä¾è¿ç¨ï¼ä¾å¦è®°äºæ¬ãç»å¾ãæµè§å¨ ç­ï¼ï¼ä¹æçç¨åºåªè½å¯å¨ä¸ä¸ªå®ä¾è¿ç¨ï¼ä¾å¦ç½æäºé³ä¹ã360 å®å¨å«å£«ç­ï¼\n\n\n# çº¿ç¨\n\n * ä¸ä¸ªè¿ç¨ä¹åå¯ä»¥åä¸ºä¸å°å¤ä¸ªçº¿ç¨ã\n * ä¸ä¸ªçº¿ç¨å°±æ¯ä¸ä¸ªæä»¤æµï¼å°æä»¤æµä¸­çä¸æ¡æ¡æä»¤ä»¥ä¸å®çé¡ºåºäº¤ç» CPU æ§è¡ ã\n * Java ä¸­ï¼çº¿ç¨ä½ä¸ºå°è°åº¦åä½ï¼è¿ç¨ä½ä¸ºèµæºåéçå°åä½ã å¨ windows ä¸­è¿ç¨æ¯ä¸æ´»å¨çï¼åªæ¯ä½ ä¸ºçº¿ç¨çå®¹å¨\n\n\n# äºèå¯¹æ¯\n\n * è¿ç¨åºæ¬ä¸ç¸äºç¬ç«çï¼èçº¿ç¨å­å¨äºè¿ç¨åï¼æ¯è¿ç¨çä¸ä¸ªå­é è¿ç¨æ¥æå±äº«çèµæºï¼å¦åå­ç©ºé´ç­ï¼ä¾å¶åé¨ççº¿ç¨å±äº«\n   * è¿ç¨é´éä¿¡è¾ä¸ºå¤æ åä¸å°è®¡ç®æºçè¿ç¨éä¿¡ç§°ä¸º IPCï¼Inter-process communicationï¼\n   * ä¸åè®¡ç®æºä¹é´çè¿ç¨éä¿¡ï¼éè¦éè¿ç½ç»ï¼å¹¶éµå®å±åçåè®®ï¼ä¾å¦ HTTP\n * çº¿ç¨éä¿¡ç¸å¯¹ç®åï¼å ä¸ºå®ä»¬å±äº«è¿ç¨åçåå­ï¼ä¸ä¸ªä¾å­æ¯å¤ä¸ªçº¿ç¨å¯ä»¥è®¿é®åä¸ä¸ªå±äº«åé çº¿ç¨æ´è½»éï¼çº¿ç¨ä¸ä¸æåæ¢ææ¬ä¸è¬ä¸è¦æ¯è¿ç¨ä¸ä¸æåæ¢ä½\n\n# è¿ç¨åçº¿ç¨çåæ¢\n\nä¸ä¸æåæ¢\n\nåæ ¸ä¸ºæ¯ä¸ä¸ªè¿ç¨ç»´æä¸ä¸ªä¸ä¸æã**ä¸ä¸æå°±æ¯åæ ¸éæ°å¯å¨ä¸ä¸ªè¢«æ¢å çè¿ç¨æéçç¶æã**åæ¬ä»¥ä¸åå®¹ï¼\n\n * éç¨ç®çå¯å­å¨\n * æµ®ç¹å¯å­å¨\n * ç¨åºè®¡æ°å¨\n * ç¨æ·æ \n * ç¶æå¯å­å¨\n * åæ ¸æ \n * åç§åæ ¸æ°æ®ç»æï¼æ¯å¦æç»å°åç©ºé´çé¡µè¡¨ï¼åå«æå³å½åè¿ç¨ä¿¡æ¯çè¿ç¨è¡¨ï¼ä»¥ååå«è¿ç¨å·²æå¼æä»¶çä¿¡æ¯çæä»¶è¡¨\n\nè¿ç¨åæ¢åçº¿ç¨åæ¢çä¸»è¦åºå«\n\næä¸»è¦çä¸ä¸ªåºå«å¨äºè¿ç¨åæ¢æ¶åèæå°åç©ºé´çåæ¢èçº¿ç¨ä¸ä¼ãå ä¸ºæ¯ä¸ªè¿ç¨é½æèªå·±çèæå°åç©ºé´ï¼èçº¿ç¨æ¯å±äº«æå¨è¿ç¨çèæå°åç©ºé´çï¼å æ­¤åä¸ä¸ªè¿ç¨ä¸­ççº¿ç¨è¿è¡çº¿ç¨åæ¢æ¶ä¸æ¶åèæå°åç©ºé´çè½¬æ¢\n\né¡µè¡¨æ¥æ¾æ¯ä¸ä¸ªå¾æ¢çè¿ç¨ï¼å æ­¤éå¸¸ä½¿ç¨cacheæ¥ç¼å­å¸¸ç¨çå°åæ å°ï¼è¿æ ·å¯ä»¥å éé¡µè¡¨æ¥æ¾ï¼è¿ä¸ªcacheå°±æ¯å¿«è¡¨TLBï¼translation Lookaside Bufferï¼ç¨æ¥å éé¡µè¡¨æ¥æ¾ï¼ãç±äºæ¯ä¸ªè¿ç¨é½æèªå·±çèæå°åç©ºé´ï¼é£ä¹æ¾ç¶æ¯ä¸ªè¿ç¨é½æèªå·±çé¡µè¡¨ï¼é£ä¹å½è¿ç¨åæ¢åé¡µè¡¨ä¹è¦è¿è¡åæ¢ï¼é¡µè¡¨åæ¢åTLBå°±å¤±æäºï¼cacheå¤±æå¯¼è´å½ä¸­çéä½ï¼é£ä¹èæå°åè½¬æ¢ä¸ºç©çå°åå°±ä¼åæ¢ï¼è¡¨ç°åºæ¥çå°±æ¯ç¨åºè¿è¡ä¼åæ¢ï¼èçº¿ç¨åæ¢åä¸ä¼å¯¼è´TLBå¤±æï¼å ä¸ºçº¿ç¨çº¿ç¨æ éåæ¢å°åç©ºé´ï¼å æ­¤æä»¬éå¸¸è¯´çº¿ç¨åæ¢è¦æ¯è¾è¿ç¨åæ¢å¿«\n\nèä¸è¿å¯è½åºç°ç¼ºé¡µä¸­æ­ï¼è¿å°±éè¦æä½ç³»ç»å°éè¦çåå®¹è°å¥åå­ä¸­ï¼è¥åå­å·²æ»¡åè¿éè¦å°ä¸ç¨çåå®¹è°åºåå­ï¼è¿ä¹éè¦è±è´¹æ¶é´\n\nä¸ºä»ä¹TLBè½å å¿«è®¿é®éåº¦\n\nå¿«è¡¨å¯ä»¥é¿åæ¯æ¬¡é½å¯¹é¡µå·è¿è¡å°åçæææ§å¤æ­ãå¿«è¡¨ä¸­ä¿å­äºå¯¹åºçç©çåå·ï¼å¯ä»¥ç´æ¥è®¡ç®åºç©çå°åï¼æ éåè¿è¡æææ§æ£æ¥\n\n\n# 2ãå¹¶åä¸å¹¶è¡\n\nå¹¶åæ¯ä¸ä¸ªCPUå¨ä¸åçæ¶é´å»ä¸åçº¿ç¨ä¸­æ§è¡æä»¤ã\n\nå¹¶è¡æ¯å¤ä¸ªCPUåæ¶å¤çä¸åççº¿ç¨ã\n\nå¼ç¨ Rob Pike çä¸æ®µæè¿°ï¼\n\n * å¹¶åï¼concurrentï¼æ¯åä¸æ¶é´åºå¯¹ï¼dealing withï¼å¤ä»¶äºæçè½å\n * å¹¶è¡ï¼parallelï¼æ¯åä¸æ¶é´å¨æåï¼doingï¼å¤ä»¶äºæçè½å\n\n\n# 3ãåºç¨\n\n# åºç¨ä¹å¼æ­¥è°ç¨ï¼æ¡ä¾1ï¼\n\nä»¥è°ç¨æ¹è§åº¦æ¥è®²ï¼å¦æ\n\n * éè¦ç­å¾ç»æè¿åï¼æè½ç»§ç»­è¿è¡å°±æ¯åæ­¥\n * ä¸éè¦ç­å¾ç»æè¿åï¼å°±è½ç»§ç»­è¿è¡å°±æ¯å¼æ­¥\n\n\\1) è®¾è®¡ å¤çº¿ç¨å¯ä»¥è®©æ¹æ³æ§è¡åä¸ºå¼æ­¥çï¼å³ä¸è¦å·´å·´å¹²ç­çï¼æ¯å¦è¯´è¯»åç£çæä»¶æ¶ï¼åè®¾è¯»åæä½è±è´¹äº 5 ç§éï¼å¦ ææ²¡æçº¿ç¨è°åº¦æºå¶ï¼è¿ 5 ç§ cpu ä»ä¹é½åä¸äºï¼å¶å®ä»£ç é½å¾æåâ¦ \\2) ç»è®º\n\n * æ¯å¦å¨é¡¹ç®ä¸­ï¼è§é¢æä»¶éè¦è½¬æ¢æ ¼å¼ç­æä½æ¯è¾è´¹æ¶ï¼è¿æ¶å¼ä¸ä¸ªæ°çº¿ç¨å¤çè§é¢è½¬æ¢ï¼é¿åé»å¡ä¸»çº¿ç¨\n * tomcat çå¼æ­¥ servlet ä¹æ¯ç±»ä¼¼çç®çï¼è®©ç¨æ·çº¿ç¨å¤çèæ¶è¾é¿çæä½ï¼é¿åé»å¡\n * tomcat çå·¥ä½çº¿ç¨ ui ç¨åºä¸­ï¼å¼çº¿ç¨è¿è¡å¶ä»æä½ï¼é¿åé»å¡ ui çº¿ç¨\n\nç»è®º\n\n 1. åæ ¸ cpu ä¸ï¼å¤çº¿ç¨ä¸è½å®éæé«ç¨åºè¿è¡æçï¼åªæ¯ä¸ºäºè½å¤å¨ä¸åçä»»å¡ä¹é´åæ¢ï¼ä¸åçº¿ç¨è½®æµä½¿ç¨ cpu ï¼ä¸è³äºä¸ä¸ªçº¿ç¨æ»å ç¨ cpuï¼å«ççº¿ç¨æ²¡æ³å¹²æ´»\n 2. å¤æ ¸ cpu å¯ä»¥å¹¶è¡è·å¤ä¸ªçº¿ç¨ï¼ä½è½å¦æé«ç¨åºè¿è¡æçè¿æ¯è¦åæåµç\n    * æäºä»»å¡ï¼ç»è¿ç²¾å¿è®¾è®¡ï¼å°ä»»å¡æåï¼å¹¶è¡æ§è¡ï¼å½ç¶å¯ä»¥æé«ç¨åºçè¿è¡æçãä½ä¸æ¯ææè®¡ç®ä»» å¡é½è½æåï¼åèåæçãé¿å§è¾¾å°å®å¾ãï¼\n    * ä¹ä¸æ¯ææä»»å¡é½éè¦æåï¼ä»»å¡çç®çå¦æä¸åï¼è°æååæçæ²¡å¥æä¹\n 3. IO æä½ä¸å ç¨ cpuï¼åªæ¯æä»¬ä¸è¬æ·è´æä»¶ä½¿ç¨çæ¯ãé»å¡ IOãï¼è¿æ¶ç¸å½äºçº¿ç¨è½ç¶ä¸ç¨ cpuï¼ä½éè¦ä¸ ç´ç­å¾ IO ç»æï¼æ²¡è½ååå©ç¨çº¿ç¨ãæä»¥ææåé¢çãéé»å¡ IOãåãå¼æ­¥ IOãä¼å\n\n\n# äºãçº¿ç¨çåå»º\n\n\n# 1ãåå»ºä¸ä¸ªçº¿ç¨ï¼éä¸»çº¿ç¨ï¼\n\n\n# æ¹æ³ä¸ï¼éè¿ç»§æ¿Threadåå»ºçº¿ç¨\n\npublic class CreateThread {\n\tpublic static void main(String[] args) {\n\t\tThread myThread = new MyThread();\n        // å¯å¨çº¿ç¨\n\t\tmyThread.start();\n\t}\n}\n\nclass MyThread extends Thread {\n\t@Override\n\tpublic void run() {\n\t\tSystem.out.println("my thread running...");\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä½¿ç¨ç»§æ¿æ¹å¼çå¥½å¤æ¯ï¼å¨runï¼ï¼æ¹æ³åè·åå½åçº¿ç¨ç´æ¥ä½¿ç¨thiså°±å¯ä»¥äºï¼æ é¡»ä½¿ç¨Thread.currentThreadï¼ï¼æ¹æ³ï¼ä¸å¥½çå°æ¹æ¯Javaä¸æ¯æå¤ç»§æ¿ï¼å¦æç»§æ¿äºThreadç±»ï¼é£ä¹å°±ä¸è½åç»§æ¿å¶ä»ç±»ãå¦å¤ä»»å¡ä¸ä»£ç æ²¡æåç¦»ï¼å½å¤ä¸ªçº¿ç¨æ§è¡ä¸æ ·çä»»å¡æ¶éè¦å¤ä»½ä»»å¡ä»£ç \n\n\n# æ¹æ³äºï¼ä½¿ç¨RunnableéåThread(æ¨è)\n\npublic class Test2 {\n\tpublic static void main(String[] args) {\n\t\t//åå»ºçº¿ç¨ä»»å¡\n\t\tRunnable r = new Runnable() {\n\t\t\t@Override\n\t\t\tpublic void run() {\n\t\t\t\tSystem.out.println("Runnable running");\n\t\t\t}\n\t\t};\n\t\t//å°Runnableå¯¹è±¡ä¼ ç»Thread\n\t\tThread t = new Thread(r);\n\t\t//å¯å¨çº¿ç¨\n\t\tt.start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\næè\n\npublic class CreateThread2 {\n   private static class MyRunnable implements Runnable {\n\n      @Override\n      public void run() {\n         System.out.println("my runnable running...");\n      }\n   }\n\n   public static void main(String[] args) {\n      MyRunnable myRunnable = new MyRunnable();\n      Thread thread = new Thread(myRunnable);\n      thread.start();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\néè¿å®ç°Runnableæ¥å£ï¼å¹¶ä¸å®ç°run()æ¹æ³ãå¨åå»ºçº¿ç¨æ¶ä½ä¸ºåæ°ä¼ å¥è¯¥ç±»çå®ä¾å³å¯\n\n# æ¹æ³äºçç®åï¼ä½¿ç¨lambdaè¡¨è¾¾å¼ç®åæä½\n\nå½ä¸ä¸ªæ¥å£å¸¦æ@FunctionalInterfaceæ³¨è§£æ¶ï¼æ¯å¯ä»¥ä½¿ç¨lambdaæ¥ç®åæä½ç\n\næä»¥æ¹æ³äºä¸­çä»£ç å¯ä»¥è¢«ç®åä¸º\n\npublic class Test2 {\n\tpublic static void main(String[] args) {\n\t\t//åå»ºçº¿ç¨ä»»å¡\n\t\tRunnable r = () -> {\n            //ç´æ¥åæ¹æ³ä½å³å¯\n\t\t\tSystem.out.println("Runnable running");\n\t\t\tSystem.out.println("Hello Thread");\n\t\t};\n\t\t//å°Runnableå¯¹è±¡ä¼ ç»Thread\n\t\tThread t = new Thread(r);\n\t\t//å¯å¨çº¿ç¨\n\t\tt.start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¯ä»¥åRunnableä¸ä½¿ç¨Alt+Enter\n\n\n\n# åçä¹ Thread ä¸ Runnable çå³ç³»\n\nåæ Thread çæºç ï¼çæ¸å®ä¸ Runnable çå³ç³» å°ç»\n\n * æ¹æ³1 æ¯æçº¿ç¨åä»»å¡åå¹¶å¨äºä¸èµ·\n * æ¹æ³2 æ¯æçº¿ç¨åä»»å¡åå¼äº\n * ç¨ Runnable æ´å®¹æä¸çº¿ç¨æ± ç­é«çº§ API éå ç¨ Runnable è®©ä»»å¡ç±»è±ç¦»äº Thread ç»§æ¿ä½ç³»ï¼æ´çµæ´»\n\n\n# æ¹æ³ä¸ï¼ä½¿ç¨FutureTaskä¸Threadç»å\n\nä½¿ç¨FutureTaskå¯ä»¥ç¨æ³åæå®çº¿ç¨çè¿åå¼ç±»åï¼Runnableçrunæ¹æ³æ²¡æè¿åå¼ï¼\n\npublic class Test3 {\n\tpublic static void main(String[] args) throws ExecutionException, InterruptedException {\n        //éè¦ä¼ å¥ä¸ä¸ªCallableå¯¹è±¡\n\t\tFutureTask<Integer> task = new FutureTask<Integer>(new Callable<Integer>() {\n\t\t\t@Override\n\t\t\tpublic Integer call() throws Exception {\n\t\t\t\tSystem.out.println("çº¿ç¨æ§è¡!");\n\t\t\t\tThread.sleep(1000);\n\t\t\t\treturn 100;\n\t\t\t}\n\t\t});\n\n\t\tThread r1 = new Thread(task, "t2");\n\t\tr1.start();\n\t\t//è·åçº¿ç¨ä¸­æ¹æ³æ§è¡åçè¿åç»æ\n\t\tSystem.out.println(task.get());\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\næ\n\npublic class UseFutureTask {\n   public static void main(String[] args) throws ExecutionException, InterruptedException {\n      FutureTask<String> futureTask = new FutureTask<>(new MyCall());\n      Thread thread = new Thread(futureTask);\n      thread.start();\n      // è·å¾çº¿ç¨è¿è¡åçè¿åå¼\n      System.out.println(futureTask.get());\n   }\n}\n\nclass MyCall implements Callable<String> {\n   @Override\n   public String call() throws Exception {\n      return "hello world";\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# æ»ç»\n\nä½¿ç¨ç»§æ¿æ¹å¼çå¥½å¤æ¯æ¹ä¾¿ä¼ åï¼ä½ å¯ä»¥å¨å­ç±»éé¢æ·»å æååéï¼éè¿setæ¹æ³è®¾ç½®åæ°æèéè¿æé å½æ°è¿è¡ä¼ éï¼èå¦æä½¿ç¨Runnableæ¹å¼ï¼ååªè½ä½¿ç¨ä¸»çº¿ç¨éé¢è¢«å£°æä¸ºfinalçåéãä¸å¥½çå°æ¹æ¯Javaä¸æ¯æå¤ç»§æ¿ï¼å¦æç»§æ¿äºThreadç±»ï¼é£ä¹å­ç±»ä¸è½åç»§æ¿å¶ä»ç±»ï¼èRunableåæ²¡æè¿ä¸ªéå¶ãåä¸¤ç§æ¹å¼é½æ²¡åæ³æ¿å°ä»»å¡çè¿åç»æï¼ä½æ¯Futuretaskæ¹å¼å¯ä»¥\n\n\n# 2ãåçä¹çº¿ç¨è¿è¡\n\n# æ ä¸æ å¸§\n\nJava Virtual Machine Stacks ï¼Java èææºæ ï¼ æä»¬é½ç¥é JVM ä¸­ç±å ãæ ãæ¹æ³åºæç»æï¼å¶ä¸­æ åå­æ¯ç»è°ç¨çå¢ï¼\n\n * å¶å®å°±æ¯çº¿ç¨ï¼æ¯ä¸ªçº¿ç¨å¯å¨åï¼èææºå°±ä¼ä¸ºå¶åéä¸åæ åå­\n * æ¯ä¸ªæ ç±å¤ä¸ªæ å¸§ï¼Frameï¼ç»æï¼å¯¹åºçæ¯æ¬¡æ¹æ³è°ç¨æ¶æå ç¨çåå­\n * æ¯ä¸ªçº¿ç¨åªè½æä¸ä¸ªæ´»å¨æ å¸§ï¼å¯¹åºçå½åæ­£å¨æ§è¡çé£ä¸ªæ¹æ³\n\n# çº¿ç¨ä¸ä¸æåæ¢ï¼Thread Context Switchï¼\n\nå ä¸ºä»¥ä¸ä¸äºåå å¯¼è´ cpu ä¸åæ§è¡å½åççº¿ç¨ï¼è½¬èæ§è¡å¦ä¸ä¸ªçº¿ç¨çä»£ç \n\n * çº¿ç¨ç cpu æ¶é´çç¨å®\n * åå¾åæ¶ ææ´é«ä¼åçº§ççº¿ç¨éè¦è¿è¡\n * çº¿ç¨èªå·±è°ç¨äº sleepãyieldãwaitãjoinãparkãsynchronizedãlock ç­æ¹æ³\n\nå½ Context Switch åçæ¶ï¼éè¦ç±æä½ç³»ç»ä¿å­å½åçº¿ç¨çç¶æï¼å¹¶æ¢å¤å¦ä¸ä¸ªçº¿ç¨çç¶æï¼Java ä¸­å¯¹åºçæ¦å¿µ å°±æ¯ç¨åºè®¡æ°å¨ï¼Program Counter Registerï¼ï¼å®çä½ç¨æ¯è®°ä½ä¸ä¸æ¡ jvm æä»¤çæ§è¡å°åï¼æ¯çº¿ç¨ç§æç\n\n * ç¶æåæ¬ç¨åºè®¡æ°å¨ãèææºæ ä¸­æ¯ä¸ªæ å¸§çä¿¡æ¯ï¼å¦å±é¨åéãæä½æ°æ ãè¿åå°åç­\n * Context Switch é¢ç¹åçä¼å½±åæ§è½\n\n\n# 3ãå¸¸ç¨æ¹æ³\n\n\n# (1)start() vs run()\n\nè¢«åå»ºçThreadå¯¹è±¡ç´æ¥è°ç¨éåçrunæ¹æ³æ¶ï¼ runæ¹æ³æ¯å¨ä¸»çº¿ç¨ä¸­è¢«æ§è¡çï¼èä¸æ¯å¨æä»¬æåå»ºççº¿ç¨ä¸­æ§è¡ãæä»¥å¦ææ³è¦å¨æåå»ºççº¿ç¨ä¸­æ§è¡runæ¹æ³ï¼éè¦ä½¿ç¨Threadå¯¹è±¡çstartæ¹æ³ã\n\n\n# (2)sleep()ä¸yield()\n\n# sleep (ä½¿çº¿ç¨é»å¡)\n\n 1. è°ç¨ sleep ä¼è®©å½åçº¿ç¨ä» Running è¿å¥ Timed Waiting ç¶æï¼é»å¡ï¼ï¼å¯éè¿state()æ¹æ³æ¥ç\n\n 2. å¶å®çº¿ç¨å¯ä»¥ä½¿ç¨ interrupt æ¹æ³ææ­æ­£å¨ç¡ç ççº¿ç¨ï¼è¿æ¶ sleep æ¹æ³ä¼æåº InterruptedException\n\n 3. ç¡ç ç»æåççº¿ç¨æªå¿ä¼ç«å»å¾å°æ§è¡\n\n 4. å»ºè®®ç¨ TimeUnit ç sleep ä»£æ¿ Thread ç sleep æ¥è·å¾æ´å¥½çå¯è¯»æ§ ãå¦ï¼\n    \n    //ä¼ç ä¸ç§\n    TimeUnit.SECONDS.sleep(1);\n    //ä¼ç ä¸åé\n    TimeUnit.MINUTES.sleep(1);\n    \n    \n    1\n    2\n    3\n    4\n    \n\n# yield ï¼è®©åºå½åçº¿ç¨ï¼\n\n 1. è°ç¨ yield ä¼è®©å½åçº¿ç¨ä» Running è¿å¥ Runnable å°±ç»ªç¶æï¼ä»ç¶æå¯è½è¢«æ§è¡ï¼ï¼ç¶åè°åº¦æ§è¡å¶å®çº¿ç¨\n 2. å·ä½çå®ç°ä¾èµäºæä½ç³»ç»çä»»å¡è°åº¦å¨\n\n# çº¿ç¨ä¼åçº§\n\n * çº¿ç¨ä¼åçº§ä¼æç¤ºï¼hintï¼è°åº¦å¨ä¼åè°åº¦è¯¥çº¿ç¨ï¼ä½å®ä»ä»æ¯ä¸ä¸ªæç¤ºï¼è°åº¦å¨å¯ä»¥å¿½ç¥å®\n\n * å¦æ cpu æ¯è¾å¿ï¼é£ä¹ä¼åçº§é«ççº¿ç¨ä¼è·å¾æ´å¤çæ¶é´çï¼ä½ cpu é²æ¶ï¼ä¼åçº§å ä¹æ²¡ä½ç¨\n\n * è®¾ç½®æ¹æ³ï¼\n   \n   thread1.setPriority(Thread.MAX_PRIORITY); //è®¾ç½®ä¸ºä¼åçº§æé«\n   \n   \n   1\n   \n\n\n# (3)join()æ¹æ³\n\nç¨äºç­å¾æä¸ªçº¿ç¨ç»æãåªä¸ªçº¿ç¨åè°ç¨join()æ¹æ³ï¼å°±ç­å¾åªä¸ªçº¿ç¨ç»æï¼ç¶ååå»æ§è¡å¶ä»çº¿ç¨ã\n\nå¦å¨ä¸»çº¿ç¨ä¸­è°ç¨ti.join()ï¼åæ¯ä¸»çº¿ç¨ç­å¾t1çº¿ç¨ç»æ\n\nThread thread = new Thread();\n//ç­å¾threadçº¿ç¨æ§è¡ç»æ\nthread.join();\n//æå¤ç­å¾1000ms,å¦æ1000msåçº¿ç¨æ§è¡å®æ¯ï¼åä¼ç´æ¥æ§è¡ä¸é¢çè¯­å¥ï¼ä¸ä¼ç­å¤1000ms\nthread.join(1000);\n\n\n1\n2\n3\n4\n5\n\n\n\n# (4)interrupt()æ¹æ³\n\nç¨äºææ­é»å¡(sleep wait joinâ¦)ççº¿ç¨ã å¤äºé»å¡ç¶æççº¿ç¨ï¼CPUä¸ä¼ç»å¶åéæ¶é´çã\n\n * å¦æä¸ä¸ªçº¿ç¨å¨å¨è¿è¡ä¸­è¢«ææ­ï¼ææ­æ è®°ä¼è¢«ç½®ä¸ºtrueã\n * å¦ææ¯ææ­å sleep wait joinæ¹æ³èè¢«é»å¡ççº¿ç¨ï¼ä¼å°ææ­æ è®°ç½®ä¸ºfalse\n\n//ç¨äºæ¥çææ­æ è®°ï¼è¿åå¼è¢«booleanç±»å\nt1.isInterrupted();\n\n\n1\n2\n\n\næ­£å¸¸è¿è¡ççº¿ç¨å¨è¢«ææ­åï¼ä¸ä¼åæ­¢ï¼ä¼ç»§ç»­æ§è¡ãå¦æè¦è®©çº¿ç¨å¨è¢«ææ­ååä¸æ¥ï¼éè¦ä½¿ç¨ææ­æ è®°æ¥å¤æ­ã\n\nwhile(true) {\n    if(Thread.currentThread().isInterrupted()) {\n        break;\n    }\n}\n\n\n1\n2\n3\n4\n5\n\n\n# interruptæ¹æ³çåºç¨ââä¸¤é¶æ®µç»æ­¢æ¨¡å¼\n\nå½æä»¬å¨æ§è¡çº¿ç¨ä¸æ¶ï¼æ³è¦ç»æ­¢çº¿ç¨äºï¼è¿æ¯å°±éè¦ä½¿ç¨interruptæ¹æ³æ¥ä¼éçåæ­¢çº¿ç¨äºã\n\n\n\nä»£ç \n\npublic class Test7 {\n\tpublic static void main(String[] args) throws InterruptedException {\n\t\tMonitor monitor = new Monitor();\n\t\tmonitor.start();\n\t\tThread.sleep(3500);\n\t\tmonitor.stop();\n\t}\n}\n\nclass Monitor {\n\n\tThread monitor;\n\n\t/**\n\t * å¯å¨çæ§å¨çº¿ç¨\n\t */\n\tpublic void start() {\n\t\t//è®¾ç½®çº¿æ§å¨çº¿ç¨ï¼ç¨äºçæ§çº¿ç¨ç¶æ\n\t\tmonitor = new Thread() {\n\t\t\t@Override\n\t\t\tpublic void run() {\n\t\t\t\t//å¼å§ä¸åççæ§\n\t\t\t\twhile (true) {\n                    //å¤æ­å½åçº¿ç¨æ¯å¦è¢«ææ­äº\n\t\t\t\t\tif(Thread.currentThread().isInterrupted()) {\n\t\t\t\t\t\tSystem.out.println("å¤çåç»­ä»»å¡");\n                        //ç»æ­¢çº¿ç¨æ§è¡\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tSystem.out.println("çæ§å¨è¿è¡ä¸­...");\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//çº¿ç¨ä¼ç \n\t\t\t\t\t\tThread.sleep(1000);\n\t\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\t\te.printStackTrace();\n\t\t\t\t\t\t//å¦ææ¯å¨ä¼ç çæ¶åè¢«ææ­ï¼ä¸ä¼å°ææ­æ è®°è®¾ç½®ä¸ºtrueï¼è¿æ¶è¦éæ°è®¾ç½®ææ­æ è®°\n\t\t\t\t\t\tThread.currentThread().interrupt();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tmonitor.start();\n\t}\n\n\t/**\n\t * \tç¨äºåæ­¢çæ§å¨çº¿ç¨\n\t */\n\tpublic void stop() {\n\t\t//ææ­çº¿ç¨\n\t\tmonitor.interrupt();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n\n\n\n# (5)ä¸æ¨èä½¿ç¨çææ­æ¹æ³\n\n * stopæ¹æ³ åæ­¢çº¿ç¨è¿è¡ï¼å¯è½é æå±äº«èµæºæ æ³è¢«éæ¾ï¼å¶ä»çº¿ç¨æ æ³ä½¿ç¨è¿äºå±äº«èµæºï¼\n * suspendï¼æåçº¿ç¨ï¼/resumeï¼æ¢å¤çº¿ç¨ï¼æ¹æ³\n\n\n# (6)å®æ¤çº¿ç¨\n\nå½JAVAè¿ç¨ä¸­æå¤ä¸ªçº¿ç¨å¨æ§è¡æ¶ï¼åªæå½ææéå®æ¤çº¿ç¨é½æ§è¡å®æ¯åï¼JAVAè¿ç¨æä¼ç»æãä½å½éå®æ¤çº¿ç¨å¨é¨æ§è¡å®æ¯åï¼å®æ¤çº¿ç¨æ è®ºæ¯å¦æ§è¡å®æ¯ï¼ä¹ä¼ä¸åç»æã\n\n//å°çº¿ç¨è®¾ç½®ä¸ºå®æ¤çº¿ç¨, é»è®¤ä¸ºfalse\nmonitor.setDaemon(true);\n\n\n1\n2\n\n\nå®æ¤çº¿ç¨çåºç¨\n\n * åå¾åæ¶å¨çº¿ç¨å°±æ¯ä¸ç§å®æ¤çº¿ç¨\n * Tomcat ä¸­ç Acceptor å Poller çº¿ç¨é½æ¯å®æ¤çº¿ç¨ï¼æä»¥ Tomcat æ¥æ¶å° shutdown å½ä»¤åï¼ä¸ä¼ç­ å¾å®ä»¬å¤çå®å½åè¯·æ±\n\n\n# 4ãçº¿ç¨çç¶æ\n\n\n# (1)äºç§ç¶æ\n\nè¿æ¯ä» æä½ç³»ç» å±é¢æ¥æè¿°ç\n\n\n\n * ãåå§ç¶æãä»æ¯å¨è¯­è¨å±é¢åå»ºäºçº¿ç¨å¯¹è±¡ï¼è¿æªä¸æä½ç³»ç»çº¿ç¨å³èï¼ä¾å¦çº¿ç¨è°ç¨äºstartæ¹æ³ï¼\n * ãå¯è¿è¡ç¶æãï¼å°±ç»ªç¶æï¼æè¯¥çº¿ç¨å·²ç»è¢«åå»ºï¼ä¸æä½ç³»ç»çº¿ç¨å³èï¼ï¼å¯ä»¥ç± CPU è°åº¦æ§è¡\n * ãè¿è¡ç¶æãæè·åäº CPU æ¶é´çè¿è¡ä¸­çç¶æ\n   * å½ CPU æ¶é´çç¨å®ï¼ä¼ä»ãè¿è¡ç¶æãè½¬æ¢è³ãå¯è¿è¡ç¶æãï¼ä¼å¯¼è´çº¿ç¨çä¸ä¸æåæ¢\n * ãé»å¡ç¶æã\n   * å¦æè°ç¨äºé»å¡ APIï¼å¦ BIO è¯»åæä»¶ï¼è¿æ¶è¯¥çº¿ç¨å®éä¸ä¼ç¨å° CPUï¼ä¼å¯¼è´çº¿ç¨ä¸ä¸æåæ¢ï¼è¿å¥ ãé»å¡ç¶æã\n   * ç­ BIO æä½å®æ¯ï¼ä¼ç±æä½ç³»ç»å¤éé»å¡ççº¿ç¨ï¼è½¬æ¢è³ãå¯è¿è¡ç¶æã\n   * ä¸ãå¯è¿è¡ç¶æãçåºå«æ¯ï¼å¯¹ãé»å¡ç¶æãççº¿ç¨æ¥è¯´åªè¦å®ä»¬ä¸ç´ä¸å¤éï¼è°åº¦å¨å°±ä¸ç´ä¸ä¼èèè°åº¦å®ä»¬\n * ãç»æ­¢ç¶æãè¡¨ç¤ºçº¿ç¨å·²ç»æ§è¡å®æ¯ï¼çå½å¨æå·²ç»ç»æï¼ä¸ä¼åè½¬æ¢ä¸ºå¶å®ç¶æ\n\n\n# (2)å­ç§ç¶æ\n\nè¿æ¯ä» Java API å±é¢æ¥æè¿°ç æ ¹æ® Thread.State æä¸¾ï¼åä¸ºå­ç§ç¶æ\n\n\n\n * NEW çº¿ç¨åè¢«åå»ºï¼ä½æ¯è¿æ²¡æè°ç¨ start() æ¹æ³\n * RUNNABLE å½è°ç¨äº start() æ¹æ³ä¹åï¼æ³¨æï¼Java API å±é¢ç RUNNABLE ç¶ææ¶µçäºæä½ç³»ç»å±é¢ç ãå¯è¿è¡ç¶æãããè¿è¡ç¶æãåãé»å¡ç¶æãï¼ç±äº BIO å¯¼è´ççº¿ç¨é»å¡ï¼å¨ Java éæ æ³åºåï¼ä»ç¶è®¤ä¸º æ¯å¯è¿è¡ï¼\n * BLOCKED ï¼ WAITING ï¼ TIMED_WAITING é½æ¯ Java API å±é¢å¯¹ãé»å¡ç¶æãçç»åï¼å¦sleepå°±ä½TIMED_WAITINGï¼ joinä¸ºWAITINGç¶æãåé¢ä¼å¨ç¶æè½¬æ¢ä¸èè¯¦è¿°ã\n * TERMINATED å½çº¿ç¨ä»£ç è¿è¡ç»æ\n\n\n# ä¸ãå±äº«æ¨¡åä¹ç®¡ç¨\n\n\n# 1ãå±äº«å¸¦æ¥çé®é¢\n\n\n# (1)ä¸´çåº Critical Section\n\n * ä¸ä¸ªç¨åºè¿è¡å¤ä¸ªçº¿ç¨æ¬èº«æ¯æ²¡æé®é¢ç\n * é®é¢åºå¨å¤ä¸ªçº¿ç¨è®¿é®å±äº«èµæº\n   * å¤ä¸ªçº¿ç¨è¯»å±äº«èµæºå¶å®ä¹æ²¡æé®é¢\n   * å¨å¤ä¸ªçº¿ç¨å¯¹å±äº«èµæºè¯»åæä½æ¶åçæä»¤äº¤éï¼å°±ä¼åºç°é®é¢\n * ä¸æ®µä»£ç ååå¦æå­å¨å¯¹å±äº«èµæºçå¤çº¿ç¨è¯»åæä½ï¼ç§°è¿æ®µä»£ç åä¸ºä¸´çåº ä¾å¦ï¼ä¸é¢ä»£ç ä¸­çä¸´çåº\n\nstatic int counter = 0;\n \nstatic void increment() \n// ä¸´çåº \n{   \n    counter++; \n}\n \nstatic void decrement() \n// ä¸´çåº \n{ \n    counter--; \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# (2)ç«ææ¡ä»¶ Race Condition\n\nå¤ä¸ªçº¿ç¨å¨ä¸´çåºåæ§è¡ï¼ç±äºä»£ç çæ§è¡åºåä¸åèå¯¼è´ç»ææ æ³é¢æµï¼ç§°ä¹ä¸ºåçäºç«ææ¡ä»¶\n\n\n# 2ãsynchronized è§£å³æ¹æ¡\n\n\n# (1)è§£å³ææ®µ\n\nä¸ºäºé¿åä¸´çåºçç«ææ¡ä»¶åçï¼æå¤ç§ææ®µå¯ä»¥è¾¾å°ç®çã\n\n * é»å¡å¼çè§£å³æ¹æ¡ï¼synchronizedï¼Lock\n * éé»å¡å¼çè§£å³æ¹æ¡ï¼åå­åé\n\næ¬æ¬¡è¯¾ä½¿ç¨é»å¡å¼çè§£å³æ¹æ¡ï¼synchronizedï¼æ¥è§£å³ä¸è¿°é®é¢ï¼å³ä¿ç§°ç**ãå¯¹è±¡éã**ï¼å®éç¨äºæ¥çæ¹å¼è®©åä¸ æ¶å»è³å¤åªæä¸ä¸ªçº¿ç¨è½ææãå¯¹è±¡éãï¼å¶å®çº¿ç¨åæ³è·åè¿ä¸ªãå¯¹è±¡éãæ¶å°±ä¼é»å¡ä½(blocked)ãè¿æ ·å°±è½ä¿è¯æ¥æé ççº¿ç¨å¯ä»¥å®å¨çæ§è¡ä¸´çåºåçä»£ç ï¼ä¸ç¨æå¿çº¿ç¨ä¸ä¸æåæ¢\n\n\n# (2)synchronizedè¯­æ³\n\nsynchronized(å¯¹è±¡) {\n\t//ä¸´çåº\n}\n\n\n1\n2\n3\n\n\nä¾ï¼\n\nstatic int counter = 0; \n//åå»ºä¸ä¸ªå¬å±å¯¹è±¡ï¼ä½ä¸ºå¯¹è±¡éçå¯¹è±¡\nstatic final Object room = new Object();\n \npublic static void main(String[] args) throws InterruptedException {    \n\tThread t1 = new Thread(() -> {        \n    for (int i = 0; i < 5000; i++) {            \n        synchronized (room) {     \n        counter++;            \n       \t }       \n \t   }    \n    }, "t1");\n \n    Thread t2 = new Thread(() -> {       \n        for (int i = 0; i < 5000; i++) {         \n            synchronized (room) {            \n            counter--;          \n            }    \n        } \n    }, "t2");\n \n    t1.start();    \n    t2.start(); \n    t1.join();   \n    t2.join();    \n    log.debug("{}",counter); \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\n\n# (3)synchronizedå å¨æ¹æ³ä¸\n\n * å å¨æåæ¹æ³ä¸\n   \n   public class Demo {\n   \t//å¨æ¹æ³ä¸å ä¸synchronizedå³é®å­\n   \tpublic synchronized void test() {\n   \t\n   \t}\n   \t//ç­ä»·äº\n   \tpublic void test() {\n   \t\tsynchronized(this) {\n   \t\t\n   \t\t}\n   \t}\n   }\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   9\n   10\n   11\n   12\n   \n\n * å å¨éææ¹æ³ä¸\n   \n   public class Demo {\n   \t//å¨éææ¹æ³ä¸å ä¸synchronizedå³é®å­\n   \tpublic synchronized static void test() {\n   \t\n   \t}\n   \t//ç­ä»·äº\n   \tpublic void test() {\n   \t\tsynchronized(Demo.class) {\n   \t\t\n   \t\t}\n   \t}\n   }\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   9\n   10\n   11\n   12\n   \n\n\n# 3ãåéççº¿ç¨å®å¨åæ\n\n# æååéåéæåéæ¯å¦çº¿ç¨å®å¨ï¼\n\n * å¦æå®ä»¬æ²¡æå±äº«ï¼åçº¿ç¨å®å¨\n * å¦æå®ä»¬è¢«å±äº«äºï¼æ ¹æ®å®ä»¬çç¶ææ¯å¦è½å¤æ¹åï¼ååä¸¤ç§æåµ\n   * å¦æåªæè¯»æä½ï¼åçº¿ç¨å®å¨\n   * å¦ææè¯»åæä½ï¼åè¿æ®µä»£ç æ¯ä¸´çåºï¼éè¦èèçº¿ç¨å®å¨\n\n# å±é¨åéæ¯å¦çº¿ç¨å®å¨ï¼\n\n * å±é¨åéæ¯çº¿ç¨å®å¨ç\n\n * ä½å±é¨åéå¼ç¨çå¯¹è±¡åæªå¿ ï¼è¦çè¯¥å¯¹è±¡\n   \n   æ¯å¦è¢«å±äº«\n   \n   ä¸è¢«æ§è¡äºè¯»åæä½ï¼\n   \n   * å¦æè¯¥å¯¹è±¡æ²¡æéç¦»æ¹æ³çä½ç¨èå´ï¼å®æ¯çº¿ç¨å®å¨ç\n   * å¦æè¯¥å¯¹è±¡éç¦»æ¹æ³çä½ç¨èå´ï¼éè¦èèçº¿ç¨å®å¨\n\n * å±é¨åéæ¯çº¿ç¨å®å¨çââæ¯ä¸ªæ¹æ³é½å¨å¯¹åºçº¿ç¨çæ ä¸­åå»ºæ å¸§ï¼ä¸ä¼è¢«å¶ä»çº¿ç¨å±äº«\n\n\n\n * å¦æè°ç¨çå¯¹è±¡è¢«å±äº«ï¼ä¸æ§è¡äºè¯»åæä½ï¼åçº¿ç¨ä¸å®å¨\n\n\n\n * å¦ææ¯å±é¨åéï¼åä¼å¨å ä¸­åå»ºå¯¹åºçå¯¹è±¡ï¼ä¸ä¼å­å¨çº¿ç¨å®å¨é®é¢ã\n\n\n\n\n# å¸¸è§çº¿ç¨å®å¨ç±»\n\n * String\n * Integer\n * StringBuï¬er\n * Random\n * Vector ï¼Listççº¿ç¨å®å¨å®ç°ç±»ï¼\n * Hashtable ï¼Hashççº¿ç¨å®å¨å®ç°ç±»ï¼\n * java.util.concurrent åä¸çç±»\n\nè¿éè¯´å®ä»¬æ¯çº¿ç¨å®å¨çæ¯æï¼å¤ä¸ªçº¿ç¨è°ç¨å®ä»¬åä¸ä¸ªå®ä¾çæä¸ªæ¹æ³æ¶ï¼æ¯çº¿ç¨å®å¨ç\n\n * å®ä»¬çæ¯ä¸ªæ¹æ³æ¯åå­çï¼é½è¢«å ä¸äºsynchronizedï¼\n * ä½æ³¨æå®ä»¬å¤ä¸ªæ¹æ³çç»åä¸æ¯åå­çï¼æä»¥å¯è½ä¼åºç°çº¿ç¨å®å¨é®é¢\n\n\n\n\n# ä¸å¯åç±»çº¿ç¨å®å¨æ§\n\nStringãInteger ç­é½æ¯ä¸å¯åç±»ï¼å ä¸ºå¶åé¨çç¶æä¸å¯ä»¥æ¹åï¼å æ­¤å®ä»¬çæ¹æ³é½æ¯çº¿ç¨å®å¨ç\n\næåå­¦æè®¸æçé®ï¼String æ replaceï¼substring ç­æ¹æ³ãå¯ä»¥ãæ¹åå¼åï¼é£ä¹è¿äºæ¹æ³åæ¯å¦ä½ä¿è¯çº¿ç¨å® å¨çå¢ï¼\n\nè¿æ¯å ä¸ºè¿äºæ¹æ³çè¿åå¼é½åå»ºäºä¸ä¸ªæ°çå¯¹è±¡ï¼èä¸æ¯ç´æ¥æ¹åStringãIntegerå¯¹è±¡æ¬èº«ã\n\n\n# 4ãMonitoræ¦å¿µ\n\n\n# (1)åçä¹Monitor\n\n\n\n * å½çº¿ç¨æ§è¡å°ä¸´çåºä»£ç æ¶ï¼å¦æä½¿ç¨äºsynchronizedï¼ä¼åæ¥è¯¢synchronizedä¸­ææå®çå¯¹è±¡(obj)æ¯å¦ç»å®äºMonitorã\n   \n   * å¦ææ²¡æç»å®ï¼åä¼åå»å»ä¸Monitorç»å®ï¼å¹¶ä¸å°Ownerè®¾ä¸ºå½åçº¿ç¨ã\n   \n   * å¦æ\n     \n     å·²ç»ç»å®\n     \n     ï¼åä¼å»æ¥è¯¢è¯¥Monitoræ¯å¦å·²ç»æäºOwner\n     \n     * å¦ææ²¡æï¼åOwnerä¸å°å½åçº¿ç¨ç»å®\n     * å¦ææï¼åæ¾å¥EntryListï¼è¿å¥é»å¡ç¶æ(blocked)\n\n * å½MonitorçOwnerå°ä¸´çåºä¸­ä»£ç æ§è¡å®æ¯åï¼Ownerä¾¿ä¼è¢«æ¸ç©ºï¼æ­¤æ¶EntryListä¸­å¤äºé»å¡ç¶æççº¿ç¨ä¼è¢«å«éå¹¶ç«äºï¼æ­¤æ¶çç«äºæ¯éå¬å¹³ç\n\n * æ³¨æï¼\n   \n   * å¯¹è±¡å¨ä½¿ç¨äºsynchronizedåä¸Monitorç»å®æ¶ï¼ä¼å°å¯¹è±¡å¤´ä¸­çMark Wordç½®ä¸ºMonitoræéã\n   * æ¯ä¸ªå¯¹è±¡é½ä¼ç»å®ä¸ä¸ªå¯ä¸çMonitorï¼å¦æsynchronizedä¸­ææå®çå¯¹è±¡(obj)ä¸åï¼åä¼ç»å®ä¸åçMonitor\n\n\n# 5ãSynchronizedåçè¿é¶\n\n\n# å¯¹è±¡å¤´æ ¼å¼\n\n\n\n\n# (1)è½»éçº§éï¼ç¨äºä¼åMonitorè¿ç±»çééçº§éï¼\n\nè½»éçº§éä½¿ç¨åºæ¯ï¼å½ä¸ä¸ªå¯¹è±¡è¢«å¤ä¸ªçº¿ç¨æè®¿é®ï¼ä½è®¿é®çæ¶é´æ¯éå¼çï¼ä¸å­å¨ç«äºï¼ï¼æ­¤æ¶å°±å¯ä»¥ä½¿ç¨è½»éçº§éæ¥ä¼åã\n\n * åå»ºéè®°å½ï¼Lock Recordï¼å¯¹è±¡ï¼æ¯ä¸ªçº¿ç¨çæ å¸§é½ä¼åå«ä¸ä¸ªéè®°å½å¯¹è±¡ï¼åé¨å¯ä»¥å­å¨éå®å¯¹è±¡çmark wordï¼ä¸åä¸å¼å§å°±ä½¿ç¨Monitorï¼\n   \n   \n\n * è®©éè®°å½ä¸­çObject referenceæåéå¯¹è±¡ï¼Objectï¼ï¼å¹¶å°è¯ç¨caså»æ¿æ¢Objectä¸­çmark wordï¼å°æ­¤mark wordæ¾å¥lock recordä¸­ä¿å­\n\n\n\n * å¦æcasæ¿æ¢æåï¼åå°Objectçå¯¹è±¡å¤´æ¿æ¢ä¸ºéè®°å½çå°ååç¶æ 00ï¼è½»éçº§éç¶æï¼ï¼å¹¶ç±è¯¥çº¿ç¨ç»å¯¹è±¡å é\n\n\n\n\n# (2)éè¨è\n\n * å¦æä¸ä¸ªçº¿ç¨å¨ç»ä¸ä¸ªå¯¹è±¡å è½»éçº§éæ¶ï¼casæ¿æ¢æä½å¤±è´¥ï¼å ä¸ºæ­¤æ¶å¶ä»çº¿ç¨å·²ç»ç»å¯¹è±¡å äºè½»éçº§éï¼ï¼æ­¤æ¶è¯¥çº¿ç¨å°±ä¼è¿å¥éè¨èè¿ç¨\n\n\n\n * æ­¤æ¶ä¾¿ä¼ç»å¯¹è±¡å ä¸ééçº§éï¼ä½¿ç¨Monitorï¼\n   \n   * å°å¯¹è±¡å¤´çMark Wordæ¹ä¸ºMonitorçå°åï¼å¹¶ä¸ç¶ææ¹ä¸º01(ééçº§é)\n   \n   * å¹¶ä¸è¯¥çº¿ç¨æ¾å¥å¥EntryListä¸­ï¼å¹¶è¿å¥é»å¡ç¶æ(blocked)\n     \n     \n\n\n# (3)èªæä¼å\n\nééçº§éç«äºæ¶ï¼è¿å¯ä»¥ä½¿ç¨èªéæ¥ä¼åï¼å¦æå½åçº¿ç¨å¨èªææåï¼ä½¿ç¨éççº¿ç¨éåºäºåæ­¥åï¼éæ¾äºéï¼ï¼è¿æ¶å°±å¯ä»¥é¿åçº¿ç¨è¿å¥é»å¡ç¶æã\n\n * ç¬¬ä¸ç§æåµ\n\n\n\n * ç¬¬äºç§æåµ\n\n\n\n\n# (4)ååé(ç¨äºä¼åè½»éçº§ééå¥)\n\nè½»éçº§éå¨æ²¡æç«äºæ¶ï¼æ¯æ¬¡éå¥ï¼è¯¥çº¿ç¨æ§è¡çæ¹æ³ä¸­åæ¬¡éä½è¯¥å¯¹è±¡ï¼æä½ä»éè¦casæ¿æ¢æä½ï¼è¿æ ·æ¯ä¼ä½¿æ§è½éä½çã\n\næä»¥å¼å¥äºååéå¯¹æ§è½è¿è¡ä¼åï¼å¨ç¬¬ä¸æ¬¡casæ¶ä¼å°çº¿ç¨çIDåå¥å¯¹è±¡çMark Wordä¸­ãæ­¤ååç°è¿ä¸ªçº¿ç¨IDå°±æ¯èªå·±çï¼å°±è¡¨ç¤ºæ²¡æç«äºï¼å°±ä¸éè¦åæ¬¡casï¼ä»¥ååªè¦ä¸åçç«äºï¼è¿ä¸ªå¯¹è±¡å°±å½è¯¥çº¿ç¨ææã\n\n\n\n# ååç¶æ\n\n * Normalï¼ä¸è¬ç¶æï¼æ²¡æå ä»»ä½éï¼åé¢62ä½ä¿å­çæ¯å¯¹è±¡çä¿¡æ¯ï¼æå2ä½ä¸ºç¶æï¼01ï¼ï¼åæ°ç¬¬ä¸ä½è¡¨ç¤ºæ¯å¦ä½¿ç¨ååéï¼æªä½¿ç¨ï¼0ï¼\n * Biasedï¼ååç¶æï¼ä½¿ç¨ååéï¼åé¢54ä½ä¿å­çå½åçº¿ç¨çIDï¼æå2ä½ä¸ºç¶æï¼01ï¼ï¼åæ°ç¬¬ä¸ä½è¡¨ç¤ºæ¯å¦ä½¿ç¨ååéï¼ä½¿ç¨ï¼1ï¼\n * Lightweightï¼ä½¿ç¨è½»éçº§éï¼å62ä½ä¿å­çæ¯éè®°å½çæéï¼æåä¸¤ä½ä¸ºç¶æï¼00ï¼\n * Heavyweightï¼ä½¿ç¨ééçº§éï¼å62ä½ä¿å­çæ¯Monitorçå°åæéï¼åä¸¤ä½ä¸ºç¶æ(10)\n\n\n\n * å¦æå¼å¯äºååéï¼é»è®¤å¼å¯ï¼ï¼å¨åå»ºå¯¹è±¡æ¶ï¼å¯¹è±¡çMark Wordåä¸ä½åºè¯¥æ¯101\n * ä½æ¯ååéé»è®¤æ¯æå»¶è¿çï¼ä¸ä¼åç¨åºä¸å¯å¨å°±çæï¼èæ¯ä¼å¨ç¨åºè¿è¡ä¸æ®µæ¶é´ï¼å ç§ä¹åï¼ï¼æä¼å¯¹åå»ºçå¯¹è±¡è®¾ç½®ä¸ºååç¶æ\n * å¦ææ²¡æå¼å¯ååéï¼å¯¹è±¡çMark Wordåä¸ä½åºè¯¥æ¯001\n\n# æ¤éåå\n\nä»¥ä¸å ç§æåµä¼ä½¿å¯¹è±¡çååéå¤±æ\n\n * è°ç¨å¯¹è±¡çhashCodeæ¹æ³\n * å¤ä¸ªçº¿ç¨ä½¿ç¨è¯¥å¯¹è±¡\n * è°ç¨äºwait/notifyæ¹æ³ï¼è°ç¨waitæ¹æ³ä¼å¯¼è´éè¨èèä½¿ç¨ééçº§éï¼\n\n\n# (5)æ¹ééåå\n\n * å¦æå¯¹è±¡è½ç¶è¢«å¤ä¸ªçº¿ç¨è®¿é®ï¼ä½æ¯çº¿ç¨é´ä¸å­å¨ç«äºï¼è¿æ¶ååT1çå¯¹è±¡ä»ææºä¼éæ°ååT2\n   * éååä¼éç½®Thread ID\n * å½æ¤éè¶è¿20æ¬¡åï¼è¶è¿éå¼ï¼ï¼JVMä¼è§å¾æ¯ä¸æ¯ååéäºï¼è¿æ¶ä¼å¨ç»å¯¹è±¡å éæ¶ï¼éæ°ååè³å éçº¿ç¨ã\n\n\n# (6)æ¹éæ¤é\n\nå½æ¤éååéçéå¼è¶è¿40ä»¥åï¼å°±ä¼å°æ´ä¸ªç±»çå¯¹è±¡é½æ¹ä¸ºä¸å¯ååç\n\n\n# 6ãWait/Notify\n\n\n# (1)åç\n\n\n\n * éå¯¹è±¡è°ç¨waitæ¹æ³ï¼obj.waitï¼ï¼å°±ä¼ä½¿å½åçº¿ç¨è¿å¥WaitSetä¸­ï¼åä¸ºWAITINGç¶æã\n\n * å¤äºBLOCKEDåWAITINGç¶æççº¿ç¨é½ä¸º\n   \n   é»å¡\n   \n   ç¶æï¼CPUé½ä¸ä¼åç»ä»ä»¬æ¶é´çãä½æ¯ææåºå«ï¼\n   \n   * BLOCKEDç¶æççº¿ç¨æ¯å¨ç«äºå¯¹è±¡æ¶ï¼åç°MonitorçOwnerå·²ç»æ¯å«ççº¿ç¨äºï¼æ­¤æ¶å°±ä¼è¿å¥EntryListä¸­ï¼å¹¶å¤äºBLOCKEDç¶æ\n   * WAITINGç¶æççº¿ç¨æ¯è·å¾äºå¯¹è±¡çéï¼ä½æ¯èªèº«å ä¸ºæäºåå éè¦è¿å¥é»å¡ç¶ææ¶ï¼éå¯¹è±¡è°ç¨äºwaitæ¹æ³èè¿å¥äºWaitSetä¸­ï¼å¤äºWAITINGç¶æ\n\n * BLOCKEDç¶æççº¿ç¨ä¼å¨éè¢«éæ¾çæ¶åè¢«å¤éï¼ä½æ¯å¤äºWAITINGç¶æççº¿ç¨åªæè¢«éå¯¹è±¡è°ç¨äºnotifyæ¹æ³(obj.notify/obj.notifyAll)ï¼æä¼è¢«å¤éã\n\næ³¨ï¼åªæå½å¯¹è±¡è¢«éä»¥åï¼æè½è°ç¨waitånotifyæ¹æ³\n\npublic class Test1 {\n\tfinal static Object LOCK = new Object();\n\tpublic static void main(String[] args) throws InterruptedException {\n        //åªæå¨å¯¹è±¡è¢«éä½åæè½è°ç¨waitæ¹æ³\n\t\tsynchronized (LOCK) {\n\t\t\tLOCK.wait();\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# (2)Waitä¸Sleepçåºå«\n\nä¸åç¹\n\n * Sleepæ¯Threadç±»çéææ¹æ³ï¼Waitæ¯Objectçæ¹æ³ï¼Objectåæ¯ææç±»çç¶ç±»ï¼æä»¥ææç±»é½æWaitæ¹æ³ã\n * Sleepå¨é»å¡çæ¶åä¸ä¼éæ¾éï¼èWaitå¨é»å¡çæ¶åä¼éæ¾é\n * Sleepä¸éè¦ä¸synchronizedä¸èµ·ä½¿ç¨ï¼èWaitéè¦ä¸synchronizedä¸èµ·ä½¿ç¨ï¼å¯¹è±¡è¢«éä»¥åæè½ä½¿ç¨ï¼\n\nç¸åç¹\n\n * é»å¡ç¶æé½ä¸ºTIMED_WAITING\n\n\n# (3)ä¼éå°ä½¿ç¨wait/notify\n\nä»ä¹æ¶åéåä½¿ç¨wait\n\n * å½çº¿ç¨ä¸æ»¡è¶³æäºæ¡ä»¶ï¼éè¦æåè¿è¡æ¶ï¼å¯ä»¥ä½¿ç¨waitãè¿æ ·ä¼å°å¯¹è±¡çééæ¾ï¼è®©å¶ä»çº¿ç¨è½å¤ç»§ç»­è¿è¡ãå¦ææ­¤æ¶ä½¿ç¨sleepï¼ä¼å¯¼è´ææçº¿ç¨é½è¿å¥é»å¡ï¼å¯¼è´ææçº¿ç¨é½æ²¡æ³è¿è¡ï¼ç´å°å½åçº¿ç¨sleepç»æåï¼è¿è¡å®æ¯ï¼æè½å¾å°æ§è¡ã\n\nä½¿ç¨wait/notifyéè¦æ³¨æä»ä¹\n\n * å½æå¤ä¸ªçº¿ç¨å¨è¿è¡æ¶ï¼å¯¹è±¡è°ç¨äºwaitæ¹æ³ï¼æ­¤æ¶è¿äºçº¿ç¨é½ä¼è¿å¥WaitSetä¸­ç­å¾ãå¦æè¿æ¶ä½¿ç¨äºnotifyæ¹æ³ï¼å¯è½ä¼é æèåå¤éï¼å¤éçä¸æ¯æ»¡è¶³æ¡ä»¶çç­å¾çº¿ç¨ï¼ï¼è¿æ¶å°±éè¦ä½¿ç¨notifyAllæ¹æ³\n\nsynchronized (LOCK) {\n\twhile(//ä¸æ»¡è¶³æ¡ä»¶ï¼ä¸ç´ç­å¾ï¼é¿åèåå¤é) {\n\t\tLOCK.wait();\n\t}\n\t//æ»¡è¶³æ¡ä»¶ååè¿è¡\n}\n\nsynchronized (LOCK) {\n\t//å¤éææç­å¾çº¿ç¨\n\tLOCK.notifyAll();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# 7ãæ¨¡å¼ä¹ä¿æ¤æ§æå\n\n\n# (1)å®ä¹\n\n\n\n\n# (2)ä¸¾ä¾\n\npublic class Test2 {\n\tpublic static void main(String[] args) {\n\t\tString hello = "hello thread!";\n\t\tGuarded guarded = new Guarded();\n\t\tnew Thread(()->{\n\t\t\tSystem.out.println("æ³è¦å¾å°ç»æ");\n\t\t\tsynchronized (guarded) {\n\t\t\t\tSystem.out.println("ç»ææ¯ï¼"+guarded.getResponse());\n\t\t\t}\n\t\t\tSystem.out.println("å¾å°ç»æ");\n\t\t}).start();\n\n\t\tnew Thread(()->{\n\t\t\tSystem.out.println("è®¾ç½®ç»æ");\n\t\t\tsynchronized (guarded) {\n\t\t\t\tguarded.setResponse(hello);\n\t\t\t}\n\t\t}).start();\n\t}\n}\n\nclass Guarded {\n\t/**\n\t * è¦è¿åçç»æ\n\t */\n\tprivate Object response;\n\t\n    //ä¼éå°ä½¿ç¨wait/notify\n\tpublic Object getResponse() {\n\t\t//å¦æè¿åç»æä¸ºç©ºå°±ä¸ç´ç­å¾ï¼é¿åèåå¤é\n\t\twhile(response == null) {\n\t\t\tsynchronized (this) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.wait();\n\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn response;\n\t}\n\n\tpublic void setResponse(Object response) {\n\t\tthis.response = response;\n\t\tsynchronized (this) {\n\t\t\t//å¤éä¼ç ççº¿ç¨\n\t\t\tthis.notifyAll();\n\t\t}\n\t}\n\n\t@Override\n\tpublic String toString() {\n\t\treturn "Guarded{" +\n\t\t\t\t"response=" + response +\n\t\t\t\t\'}\';\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n\n\nå¸¦è¶æ¶å¤æ­çæå\n\npublic Object getResponse(long time) {\n\t\tsynchronized (this) {\n\t\t\t//è·åå¼å§æ¶é´\n\t\t\tlong currentTime = System.currentTimeMillis();\n\t\t\t//ç¨äºä¿å­å·²ç»ç­å¾äºçæ¶é´\n\t\t\tlong passedTime = 0;\n\t\t\twhile(response == null) {\n\t\t\t\t//çç»è¿çæ¶é´-å¼å§æ¶é´æ¯å¦è¶è¿äºæå®æ¶é´\n\t\t\t\tlong waitTime = time -passedTime;\n\t\t\t\tif(waitTime <= 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttry {\n                   \t//ç­å¾å©ä½æ¶é´\n\t\t\t\t\tthis.wait(waitTime);\n\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t\t//è·åå½åæ¶é´\n\t\t\t\tpassedTime = System.currentTimeMillis()-currentTime\t\t\n            }\n\t\t}\n\t\treturn response;\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n# (3)joinæºç ââä½¿ç¨ä¿æ¤æ§æåæ¨¡å¼\n\npublic final synchronized void join(long millis)\n    throws InterruptedException {\n        long base = System.currentTimeMillis();\n        long now = 0;\n\n        if (millis < 0) {\n            throw new IllegalArgumentException("timeout value is negative");\n        }\n\n        if (millis == 0) {\n            while (isAlive()) {\n                wait(0);\n            }\n        } else {\n            while (isAlive()) {\n                long delay = millis - now;\n                if (delay <= 0) {\n                    break;\n                }\n                wait(delay);\n                now = System.currentTimeMillis() - base;\n            }\n        }\n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n# 8ãpark/unpark\n\n\n# (1)åºæ¬ä½¿ç¨\n\npark/unparké½æ¯LockSupportç±»ä¸­ççæ¹æ³\n\n//æåçº¿ç¨è¿è¡\nLockSupport.park;\n\n//æ¢å¤çº¿ç¨è¿è¡\nLockSupport.unpark(thread);\npublic static void main(String[] args) throws InterruptedException {\n\t\tThread thread = new Thread(()-> {\n\t\t\tSystem.out.println("park");\n            //æåçº¿ç¨è¿è¡\n\t\t\tLockSupport.park();\n\t\t\tSystem.out.println("resume");\n\t\t}, "t1");\n\t\tthread.start();\n\n\t\tThread.sleep(1000);\n\t\tSystem.out.println("unpark");\n    \t//æ¢å¤çº¿ç¨è¿è¡\n\t\tLockSupport.unpark(thread);\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# (2)ç¹ç¹\n\nä¸wait/notifyçåºå«\n\n * waitï¼notify å notifyAll å¿é¡»éåObject Monitorä¸èµ·ä½¿ç¨ï¼èparkï¼unparkä¸å¿\n * park ï¼unpark æ¯ä»¥çº¿ç¨ä¸ºåä½æ¥é»å¡åå¤éçº¿ç¨ï¼è notify åªè½éæºå¤éä¸ä¸ªç­å¾çº¿ç¨ï¼notifyAll æ¯å¤éææç­å¾çº¿ç¨ï¼å°±ä¸é£ä¹ç²¾ç¡®\n * park & unpark å¯ä»¥å unparkï¼è wait & notify ä¸è½å notify\n * parkä¸ä¼éæ¾éï¼èwaitä¼éæ¾é\n\n\n# (3)åç\n\næ¯ä¸ªçº¿ç¨é½æä¸ä¸ªèªå·±çParkå¯¹è±¡ï¼å¹¶ä¸è¯¥å¯¹è±¡**_counter, _cond,__mutex**ç»æ\n\n * åè°ç¨parkåè°ç¨unparkæ¶\n   \n   * åè°ç¨park\n     \n     * çº¿ç¨è¿è¡æ¶ï¼ä¼å°Parkå¯¹è±¡ä¸­ç**_counterçå¼è®¾ä¸º0**ï¼\n     * è°ç¨parkæ¶ï¼ä¼åæ¥çcounterçå¼æ¯å¦ä¸º0ï¼å¦æä¸º0ï¼åå°çº¿ç¨æ¾å¥é»å¡éåcondä¸­\n     * æ¾å¥é»å¡éåä¸­åï¼ä¼åæ¬¡å°counterè®¾ç½®ä¸º0\n   \n   * ç¶åè°ç¨unpark\n     \n     * è°ç¨unparkæ¹æ³åï¼ä¼å°counterçå¼è®¾ç½®ä¸º1\n     \n     * å»å¤éé»å¡éåcondä¸­ççº¿ç¨\n     \n     * çº¿ç¨ç»§ç»­è¿è¡å¹¶å°counterçå¼è®¾ä¸º0\n       \n       \n\n\n\n * åè°ç¨unparkï¼åè°ç¨park\n   * è°ç¨unpark\n     * ä¼å°counterè®¾ç½®ä¸º1ï¼è¿è¡æ¶0ï¼\n   * è°ç¨parkæ¹æ³\n     * æ¥çcounteræ¯å¦ä¸º0\n     * å ä¸ºunparkå·²ç»æcounterè®¾ç½®ä¸º1ï¼æä»¥æ­¤æ¶å°counterè®¾ç½®ä¸º0ï¼ä½ä¸æ¾å¥é»å¡éåcondä¸­\n\n\n\n\n# 9ãçº¿ç¨ä¸­çç¶æè½¬æ¢\n\n\n\n\n# æåµä¸ï¼NEW â> RUNNABLE\n\n * å½è°ç¨äºt.start()æ¹æ³æ¶ï¼ç± NEW â> RUNNABLE\n\n\n# æåµäºï¼ RUNNABLE <â> WAITING\n\n * å½è°ç¨äºt çº¿ç¨ç¨ synchronized(obj) è·åäºå¯¹è±¡éå\n   * è°ç¨ obj.wait() æ¹æ³æ¶ï¼t çº¿ç¨ä» RUNNABLE â> WAITING\n   * è°ç¨ obj.notify() ï¼ obj.notifyAll() ï¼ t.interrupt() æ¶\n     * ç«äºéæåï¼t çº¿ç¨ä» WAITING â> RUNNABLE\n     * ç«äºéå¤±è´¥ï¼t çº¿ç¨ä» WAITING â> BLOCKED\n\n\n# æåµä¸ï¼RUNNABLE <â> WAITING\n\n * å½åçº¿ç¨\n   \n   è°ç¨ t.join() æ¹æ³æ¶ï¼å½åçº¿ç¨ä» RUNNABLE â> WAITING\n   \n   * æ³¨ææ¯å½åçº¿ç¨å¨t çº¿ç¨å¯¹è±¡ççè§å¨ä¸ç­å¾\n\n * t çº¿ç¨è¿è¡ç»æï¼æè°ç¨äºå½åçº¿ç¨ç interrupt() æ¶ï¼å½åçº¿ç¨ä» WAITING â> RUNNABLE\n\n\n# æåµåï¼ RUNNABLE <â> WAITING\n\n * å½åçº¿ç¨è°ç¨ LockSupport.park() æ¹æ³ä¼è®©å½åçº¿ç¨ä» RUNNABLE â> WAITING\n * è°ç¨ LockSupport.unpark(ç®æ çº¿ç¨) æè°ç¨äºçº¿ç¨ ç interrupt() ï¼ä¼è®©ç®æ çº¿ç¨ä» WAITING â> RUNNABLE\n\n\n# æåµäºï¼ RUNNABLE <â> TIMED_WAITING\n\nt çº¿ç¨ç¨ synchronized(obj) è·åäºå¯¹è±¡éå\n\n * è°ç¨ obj.wait(long n) æ¹æ³æ¶ï¼t çº¿ç¨ä» RUNNABLE â> TIMED_WAITING\n * t çº¿ç¨ç­å¾æ¶é´è¶è¿äº n æ¯«ç§ï¼æè°ç¨ obj.notify() ï¼ obj.notifyAll() ï¼ t.interrupt() æ¶\n   * ç«äºéæåï¼t çº¿ç¨ä» TIMED_WAITING â> RUNNABLE\n   * ç«äºéå¤±è´¥ï¼t çº¿ç¨ä» TIMED_WAITING â> BLOCKED\n\n\n# æåµå­ï¼RUNNABLE <â> TIMED_WAITING\n\n * å½åçº¿ç¨è°ç¨ t.join\n   \n   (long n\n   \n   ) æ¹æ³æ¶ï¼å½åçº¿ç¨ä» RUNNABLE â> TIMED_WAITING\n   \n   * æ³¨ææ¯å½åçº¿ç¨å¨t çº¿ç¨å¯¹è±¡ççè§å¨ä¸ç­å¾\n\n * å½åçº¿ç¨ç­å¾æ¶é´è¶è¿äº n æ¯«ç§ï¼æt çº¿ç¨è¿è¡ç»æï¼æè°ç¨äºå½åçº¿ç¨ç interrupt() æ¶ï¼å½åçº¿ç¨ä» TIMED_WAITING â> RUNNABLE\n\n\n# æåµä¸ï¼RUNNABLE <â> TIMED_WAITING\n\n * å½åçº¿ç¨è°ç¨ Thread.sleep(long n) ï¼å½åçº¿ç¨ä» RUNNABLE â> TIMED_WAITING\n * å½åçº¿ç¨ç­å¾æ¶é´è¶è¿äº n æ¯«ç§ï¼å½åçº¿ç¨ä» TIMED_WAITING â> RUNNABLE\n\n\n# æåµå«ï¼RUNNABLE <â> TIMED_WAITING\n\n * å½åçº¿ç¨è°ç¨ LockSupport.parkNanos(long nanos) æ LockSupport.parkUntil(long millis) æ¶ï¼å½åçº¿ ç¨ä» RUNNABLE â> TIMED_WAITING\n * è°ç¨ LockSupport.unpark(ç®æ çº¿ç¨) æè°ç¨äºçº¿ç¨ ç interrupt() ï¼ææ¯ç­å¾è¶æ¶ï¼ä¼è®©ç®æ çº¿ç¨ä» TIMED_WAITINGâ> RUNNABLE\n\n\n# æåµä¹ï¼RUNNABLE <â> BLOCKED\n\n * t çº¿ç¨ç¨ synchronized(obj) è·åäºå¯¹è±¡éæ¶å¦æç«äºå¤±è´¥ï¼ä» RUNNABLE â> BLOCKED\n * æ obj éçº¿ç¨çåæ­¥ä»£ç åæ§è¡å®æ¯ï¼ä¼å¤éè¯¥å¯¹è±¡ä¸ææ BLOCKED ççº¿ç¨éæ°ç«äºï¼å¦æå¶ä¸­ t çº¿ç¨ç«äº æåï¼ä» BLOCKED â> RUNNABLE ï¼å¶å®å¤±è´¥ççº¿ç¨ä»ç¶ BLOCKED\n\n\n# æåµåï¼ RUNNABLE <â> TERMINATED\n\nå½åçº¿ç¨ææä»£ç è¿è¡å®æ¯ï¼è¿å¥ TERMINATED\n\n\n# 10ãå¤æé\n\nå°éçç²åº¦ç»å\n\nclass BigRoom {\n    //é¢å¤åå»ºå¯¹è±¡æ¥ä½ä¸ºé\n\tprivate final Object studyRoom = new Object();\n\tprivate final Object bedRoom = new Object();\n}\n\n\n1\n2\n3\n4\n5\n\n\n\n# 11ãæ´»è·æ§\n\n\n# (1)å®ä¹\n\nå ä¸ºæç§åå ï¼ä½¿å¾ä»£ç ä¸ç´æ æ³æ§è¡å®æ¯ï¼è¿æ ·çç°è±¡å«åæ´»è·æ§\n\n\n# (2)æ­»é\n\næè¿æ ·çæåµï¼ä¸ä¸ªçº¿ç¨éè¦åæ¶è·åå¤æéï¼è¿æ¶å°±å®¹æåçæ­»é\n\nå¦ï¼t1çº¿ç¨è·å¾Aå¯¹è±¡ éï¼æ¥ä¸æ¥æ³è·åBå¯¹è±¡çét2çº¿ç¨è·å¾Bå¯¹è±¡éï¼æ¥ä¸æ¥æ³è·åAå¯¹è±¡çé\n\npublic static void main(String[] args) {\n\t\tfinal Object A = new Object();\n\t\tfinal Object B = new Object();\n\t\tnew Thread(()->{\n\t\t\tsynchronized (A) {\n\t\t\t\ttry {\n\t\t\t\t\tThread.sleep(2000);\n\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t\tsynchronized (B) {\n\n\t\t\t\t}\n\t\t\t}\n\t\t}).start();\n\n\t\tnew Thread(()->{\n\t\t\tsynchronized (B) {\n\t\t\t\ttry {\n\t\t\t\t\tThread.sleep(1000);\n\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t\tsynchronized (A) {\n\n\t\t\t\t}\n\t\t\t}\n\t\t}).start();\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\n# åçæ­»éçå¿è¦æ¡ä»¶\n\n * äºæ¥æ¡ä»¶\n   * å¨ä¸æ®µæ¶é´åï¼ä¸ç§èµæºåªè½è¢«ä¸ä¸ªè¿ç¨æä½¿ç¨\n * è¯·æ±åä¿ææ¡ä»¶\n   * è¿ç¨å·²ç»æ¥æäºè³å°ä¸ç§èµæºï¼åæ¶åå»ç³è¯·å¶ä»èµæºãå ä¸ºå¶ä»èµæºè¢«å«çè¿ç¨æä½¿ç¨ï¼è¯¥è¿ç¨è¿å¥é»å¡ç¶æï¼å¹¶ä¸ä¸éæ¾èªå·±å·²æçèµæº\n * ä¸å¯æ¢å æ¡ä»¶\n   * è¿ç¨å¯¹å·²è·å¾çèµæºå¨æªä½¿ç¨å®æåä¸è½è¢«å¼ºå ï¼åªè½å¨è¿ç¨ä½¿ç¨å®åèªå·±éæ¾\n * å¾ªç¯ç­å¾æ¡ä»¶\n   * åçæ­»éæ¶ï¼å¿ç¶å­å¨ä¸ä¸ªè¿ç¨ââèµæºçå¾ªç¯é¾ã\n\n# å®ä½æ­»éçæ¹æ³\n\n * jps+jstack ThreadID\n   \n   * å¨JAVAæ§å¶å°ä¸­çTerminalä¸­è¾å¥jpsæä»¤å¯ä»¥æ¥çè¿è¡ä¸­ççº¿ç¨IDï¼ä½¿ç¨jstack ThreadIDå¯ä»¥æ¥ççº¿ç¨ç¶æã\n     \n     \n   \n   F:\\Thread_study>jps\n   20672 RemoteMavenServer36\n   22880 Jps\n   4432 Launcher\n   5316 Test5\n   20184 KotlinCompileDaemon\n   11132\n   \n   F:\\Thread_study>jstack 5316\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   9\n   \n\n * æå°çç»æ\n   \n   //æ¾å°ä¸ä¸ªjavaçº§å«çæ­»é\n   Found one Java-level deadlock:\n   =============================\n   "Thread-1":\n     waiting to lock monitor 0x0000000017f40de8 (object 0x00000000d6188880, a java.lang.Object),\n     which is held by "Thread-0"\n   "Thread-0":\n     waiting to lock monitor 0x0000000017f43678 (object 0x00000000d6188890, a java.lang.Object),\n     which is held by "Thread-1"\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   9\n   \n\n * jconsoleæ£æµæ­»é\n   \n   \n   \n   \n\n# å²å­¦å®¶å°±é¤é®é¢\n\n\n\n# é¿åæ­»éçæ¹æ³\n\nå¨çº¿ç¨ä½¿ç¨éå¯¹è±¡æ¶**ï¼é¡ºåºå é**å³å¯é¿åæ­»é\n\n\n\n\n# (3)æ´»é\n\næ´»éåºç°å¨ä¸¤ä¸ªçº¿ç¨äºç¸æ¹åå¯¹æ¹çç»ææ¡ä»¶ï¼åè°ä¹æ æ³ç»æã\n\n# é¿åæ´»éçæ¹æ³\n\nå¨çº¿ç¨æ§è¡æ¶ï¼ä¸­éç»äºä¸åçé´éæ¶é´å³å¯ã\n\n# æ­»éä¸æ´»éçåºå«\n\n * æ­»éæ¯å ä¸ºçº¿ç¨äºç¸ææå¯¹è±¡æ³è¦çéï¼å¹¶ä¸é½ä¸éæ¾ï¼æåå°æ¶çº¿ç¨é»å¡ï¼åæ­¢è¿è¡çç°è±¡ã\n * æ´»éæ¯å ä¸ºçº¿ç¨é´ä¿®æ¹äºå¯¹æ¹çç»ææ¡ä»¶ï¼èå¯¼è´ä»£ç ä¸ç´å¨è¿è¡ï¼å´ä¸ç´è¿è¡ä¸å®çç°è±¡ã\n\n\n# (4)é¥¥é¥¿\n\næäºçº¿ç¨å ä¸ºä¼åçº§å¤ªä½ï¼å¯¼è´ä¸ç´æ æ³è·å¾èµæºçç°è±¡ã\n\nå¨ä½¿ç¨é¡ºåºå éæ¶ï¼å¯è½ä¼åºç°é¥¥é¥¿ç°è±¡\n\n\n# 12ãReentrantLock\n\nåsynchronizedç¸æ¯å·æççç¹ç¹\n\n * å¯ä¸­æ­\n * å¯ä»¥è®¾ç½®è¶æ¶æ¶é´\n * å¯ä»¥è®¾ç½®ä¸ºå¬å¹³é (åå°åå¾)\n * æ¯æå¤ä¸ªæ¡ä»¶åé( å·æå¤ä¸ªwaitset)\n\nåºæ¬è¯­æ³\n\n//è·åReentrantLockå¯¹è±¡\nprivate ReentrantLock lock = new ReentrantLock();\n//å é\nlock.lock();\ntry {\n\t//éè¦æ§è¡çä»£ç \n}finally {\n\t//éæ¾é\n\tlock.unlock();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n# å¯éå¥\n\n * å¯éå¥æ¯æåä¸ä¸ªçº¿ç¨å¦æé¦æ¬¡è·å¾äºè¿æéï¼é£ä¹å ä¸ºå®æ¯è¿æéçæ¥æèï¼å æ­¤ææå©åæ¬¡è·åè¿æé\n * å¦ææ¯ä¸å¯éå¥éï¼é£ä¹ç¬¬äºæ¬¡è·å¾éæ¶ï¼èªå·±ä¹ä¼è¢«éæ¡ä½\n\n# å¯ææ­\n\nå¦ææä¸ªçº¿ç¨å¤äºé»å¡ç¶æï¼å¯ä»¥è°ç¨å¶interruptæ¹æ³è®©å¶åæ­¢é»å¡ï¼è·å¾éå¤±è´¥\n\nç®èè¨ä¹å°±æ¯ï¼å¤äºé»å¡ç¶æççº¿ç¨ï¼è¢«ææ­äºå°±ä¸ç¨é»å¡äºï¼ç´æ¥åæ­¢è¿è¡\n\npublic static void main(String[] args) {\n\t\tReentrantLock lock = new ReentrantLock();\n\t\tThread t1 = new Thread(()-> {\n\t\t\ttry {\n\t\t\t\t//å éï¼å¯ææ­é\n\t\t\t\tlock.lockInterruptibly();\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n                //è¢«ææ­ï¼è¿åï¼ä¸ååä¸æ§è¡\n\t\t\t\treturn;\n\t\t\t}finally {\n\t\t\t\t//éæ¾é\n\t\t\t\tlock.unlock();\n\t\t\t}\n\n\t\t});\n\n\t\tlock.lock();\n\t\ttry {\n\t\t\tt1.start();\n\t\t\tThread.sleep(1000);\n\t\t\t//ææ­\n\t\t\tt1.interrupt();\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\n# éè¶æ¶\n\nä½¿ç¨lock.tryLockæ¹æ³ä¼è¿åè·åéæ¯å¦æåãå¦ææååè¿åtrueï¼åä¹åè¿åfalseã\n\nå¹¶ä¸tryLockæ¹æ³å¯ä»¥æå®ç­å¾æ¶é´ï¼åæ°ä¸ºï¼tryLock(long timeout, TimeUnit unit), å¶ä¸­timeoutä¸ºæé¿ç­å¾æ¶é´ï¼TimeUnitä¸ºæ¶é´åä½\n\nç®èè¨ä¹å°±æ¯ï¼è·åå¤±è´¥äºãè·åè¶æ¶äºæèè¢«ææ­äºï¼ä¸åé»å¡ï¼ç´æ¥åæ­¢è¿è¡\n\nä¸è®¾ç½®ç­å¾æ¶é´\n\npublic static void main(String[] args) {\n\t\tReentrantLock lock = new ReentrantLock();\n\t\tThread t1 = new Thread(()-> {\n            //æªè®¾ç½®ç­å¾æ¶é´ï¼ä¸æ¦è·åå¤±è´¥ï¼ç´æ¥è¿åfalse\n\t\t\tif(!lock.tryLock()) {\n\t\t\t\tSystem.out.println("è·åå¤±è´¥");\n                //è·åå¤±è´¥ï¼ä¸ååä¸æ§è¡ï¼è¿å\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tSystem.out.println("å¾å°äºé");\n\t\t\tlock.unlock();\n\t\t});\n\n\n\t\tlock.lock();\n\t\ttry{\n\t\t\tt1.start();\n\t\t\tThread.sleep(3000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nè®¾ç½®ç­å¾æ¶é´\n\npublic static void main(String[] args) {\n\t\tReentrantLock lock = new ReentrantLock();\n\t\tThread t1 = new Thread(()-> {\n\t\t\ttry {\n\t\t\t\t//å¤æ­è·åéæ¯å¦æåï¼æå¤ç­å¾1ç§\n\t\t\t\tif(!lock.tryLock(1, TimeUnit.SECONDS)) {\n\t\t\t\t\tSystem.out.println("è·åå¤±è´¥");\n\t\t\t\t\t//è·åå¤±è´¥ï¼ä¸ååä¸æ§è¡ï¼ç´æ¥è¿å\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t\t//è¢«ææ­ï¼ä¸ååä¸æ§è¡ï¼ç´æ¥è¿å\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tSystem.out.println("å¾å°äºé");\n\t\t\t//éæ¾é\n\t\t\tlock.unlock();\n\t\t});\n\n\n\t\tlock.lock();\n\t\ttry{\n\t\t\tt1.start();\n\t\t\t//ææ­ç­å¾\n\t\t\tt1.interrupt();\n\t\t\tThread.sleep(3000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n# å¬å¹³é\n\nå¨çº¿ç¨è·åéå¤±è´¥ï¼è¿å¥é»å¡éåæ¶ï¼åè¿å¥çä¼å¨éè¢«éæ¾ååè·å¾éãè¿æ ·çè·åæ¹å¼å°±æ¯å¬å¹³çã\n\n//é»è®¤æ¯ä¸å¬å¹³éï¼éè¦å¨åå»ºæ¶æå®ä¸ºå¬å¹³é\nReentrantLock lock = new ReentrantLock(true);\n\n\n1\n2\n\n\n# æ¡ä»¶åé\n\nsynchronized ä¸­ä¹ææ¡ä»¶åéï¼å°±æ¯æä»¬è®²åçæ¶é£ä¸ª waitSet ä¼æ¯å®¤ï¼å½æ¡ä»¶ä¸æ»¡è¶³æ¶è¿å¥waitSet ç­å¾\n\nReentrantLock çæ¡ä»¶åéæ¯ synchronized å¼ºå¤§ä¹å¤å¨äºï¼å®æ¯æ¯æå¤ä¸ªæ¡ä»¶åéçï¼è¿å°±å¥½æ¯\n\n * synchronized æ¯é£äºä¸æ»¡è¶³æ¡ä»¶ççº¿ç¨é½å¨ä¸é´ä¼æ¯å®¤ç­æ¶æ¯\n * è ReentrantLock æ¯æå¤é´ä¼æ¯å®¤ï¼æä¸é¨ç­ççä¼æ¯å®¤ãä¸é¨ç­æ©é¤çä¼æ¯å®¤ãå¤éæ¶ä¹æ¯æä¼æ¯å®¤æ¥å¤ é\n\nä½¿ç¨è¦ç¹ï¼\n\n * await åéè¦è·å¾é\n * await æ§è¡åï¼ä¼éæ¾éï¼è¿å¥ conditionObject ç­å¾\n * await ççº¿ç¨è¢«å¤éï¼æææ­ãæè¶æ¶ï¼åéæ°ç«äº lock é\n * ç«äº lock éæååï¼ä» await åç»§ç»­æ§\n\nstatic Boolean judge = false;\npublic static void main(String[] args) throws InterruptedException {\n\tReentrantLock lock = new ReentrantLock();\n\t//è·å¾æ¡ä»¶åé\n\tCondition condition = lock.newCondition();\n\tnew Thread(()->{\n\t\tlock.lock();\n\t\ttry{\n\t\t\twhile(!judge) {\n\t\t\t\tSystem.out.println("ä¸æ»¡è¶³æ¡ä»¶ï¼ç­å¾...");\n\t\t\t\t//ç­å¾\n\t\t\t\tcondition.await();\n\t\t\t}\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tSystem.out.println("æ§è¡å®æ¯ï¼");\n\t\t\tlock.unlock();\n\t\t}\n\t}).start();\n\n\tnew Thread(()->{\n\t\tlock.lock();\n\t\ttry {\n\t\t\tThread.sleep(1);\n\t\t\tjudge = true;\n\t\t\t//éæ¾\n\t\t\tcondition.signal();\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\n\t}).start();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\n# éè¿Lockä¸AQSå®ç°å¯éå¥é\n\npublic class MyLock implements Lock {\n   private static class Sync extends AbstractQueuedSynchronizer {\n      @Override\n      protected boolean tryAcquire(int arg) {\n         if (getExclusiveOwnerThread() == null) {\n            if (compareAndSetState(0, 1)) {\n               setExclusiveOwnerThread(Thread.currentThread());\n               return true;\n            }\n            return false;\n         }\n\n         if (getExclusiveOwnerThread() == Thread.currentThread()) {\n            int state = getState();\n            compareAndSetState(state, state + 1);\n            return true;\n         }\n\n         return false;\n      }\n\n      @Override\n      protected boolean tryRelease(int arg) {\n         if (getState() <= 0) {\n            throw new IllegalMonitorStateException();\n         }\n\n         if (getExclusiveOwnerThread() != Thread.currentThread()) {\n            throw new IllegalMonitorStateException();\n         }\n\n         int state = getState();\n         if (state == 1) {\n            setExclusiveOwnerThread(null);\n            compareAndSetState(state, 0);\n         } else {\n            compareAndSetState(state, state - 1);\n         }\n         return true;\n      }\n\n      @Override\n      protected boolean isHeldExclusively() {\n         return getState() >= 1;\n      }\n\n      public Condition newCondition() {\n         return new ConditionObject();\n      }\n\n   }\n\n   Sync sync = new Sync();\n\n   @Override\n   public void lock() {\n      sync.acquire(1);\n   }\n\n   @Override\n   public void lockInterruptibly() throws InterruptedException {\n      sync.acquireInterruptibly(1);\n   }\n\n   @Override\n   public boolean tryLock() {\n      return sync.tryAcquire(1);\n   }\n\n   @Override\n   public boolean tryLock(long time, TimeUnit unit) throws InterruptedException {\n      return sync.tryAcquireNanos(1, time);\n   }\n\n   @Override\n   public void unlock() {\n      sync.release(1);\n   }\n\n   @Override\n   public Condition newCondition() {\n      return sync.newCondition();\n   }\n}\n\nclass Main {\n   static int num = 0;\n   public static void main(String[] args) throws InterruptedException, IOException {\n      MyLock lock = new MyLock();\n\n      Object syncLock = new Object();\n\n      Thread t1 = new Thread(() -> {\n         for (int i = 0; i < 10000; i++) {\n            lock.lock();\n            try {\n               lock.lock();\n               try {\n                  lock.lock();\n                  try {\n                     num++;\n                  } finally {\n                     lock.unlock();\n                  }\n               } finally {\n                  lock.unlock();\n               }\n            } finally {\n               lock.unlock();\n            }\n         }\n      });\n\n      Thread t2 = new Thread(() -> {\n         for (int i = 0; i < 10000; i++) {\n            lock.lock();\n            try {\n               lock.lock();\n               try {\n                  lock.lock();\n                  try {\n                     num--;\n                  } finally {\n                     lock.unlock();\n                  }\n               } finally {\n                  lock.unlock();\n               }\n            } finally {\n               lock.unlock();\n            }\n         }\n      });\n\n      t1.start();\n      t2.start();\n      t1.join();\n      t2.join();\n\n      int x = 0;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n\n\n\n# 13ãåæ­¥æ¨¡å¼ä¹é¡ºåºæ§å¶\n\n\n# Wait/Notifyçæ¬\n\nstatic final Object LOCK = new Object();\n//å¤æ­åæ§è¡çåå®¹æ¯å¦æ§è¡å®æ¯\nstatic Boolean judge = false;\npublic static void main(String[] args) {\n\tnew Thread(()->{\n\t\tsynchronized (LOCK) {\n\t\t\twhile (!judge) {\n\t\t\t\ttry {\n\t\t\t\t\tLOCK.wait();\n\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println("2");\n\t\t}\n\t}).start();\n\n\tnew Thread(()->{\n\t\tsynchronized (LOCK) {\n\t\t\tSystem.out.println("1");\n\t\t\tjudge = true;\n               //æ§è¡å®æ¯ï¼å¤éææç­å¾çº¿ç¨\n\t\t\tLOCK.notifyAll();\n\t\t}\n\t}).start();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n\n# äº¤æ¿è¾åº\n\nwait/notifyçæ¬\n\npublic class Test4 {\n\tstatic Symbol symbol = new Symbol();\n\tpublic static void main(String[] args) {\n\t\tnew Thread(()->{\n\t\t\tsymbol.run("a", 1, 2);\n\t\t}).start();\n\n\t\tnew Thread(()->{\n\t\t\tsymbol.run("b", 2, 3);\n\n\t\t}).start();\n\t\tsymbol.run("c", 3, 1);\n\t\tnew Thread(()->{\n\n\t\t}).start();\n\t}\n}\n\nclass Symbol {\n\tpublic synchronized void run(String str, int flag, int nextFlag) {\n\t\tfor(int i=0; i<loopNumber; i++) {\n\t\t\twhile(flag != this.flag) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.wait();\n\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\te.printStackTrace();\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(str);\n\t\t\t//è®¾ç½®ä¸ä¸ä¸ªè¿è¡ççº¿ç¨æ è®°\n\t\t\tthis.flag = nextFlag;\n\t\t\t//å¤éææçº¿ç¨\n\t\t\tthis.notifyAll();\n\t\t}\n\t}\n\n\t/**\n\t * çº¿ç¨çæ§è¡æ è®°ï¼ 1->a 2->b 3->c\n\t */\n\tprivate int flag = 1;\n\tprivate int loopNumber = 5;\n\n\tpublic int getFlag() {\n\t\treturn flag;\n\t}\n\n\tpublic void setFlag(int flag) {\n\t\tthis.flag = flag;\n\t}\n\n\tpublic int getLoopNumber() {\n\t\treturn loopNumber;\n\t}\n\n\tpublic void setLoopNumber(int loopNumber) {\n\t\tthis.loopNumber = loopNumber;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n\n\nawait/signalçæ¬\n\npublic class Test5 {\n\tstatic AwaitSignal awaitSignal = new AwaitSignal();\n\tstatic Condition conditionA = awaitSignal.newCondition();\n\tstatic Condition conditionB = awaitSignal.newCondition();\n\tstatic Condition conditionC = awaitSignal.newCondition();\n\tpublic static void main(String[] args) {\n\t\tnew Thread(()->{\n\t\t\tawaitSignal.run("a", conditionA, conditionB);\n\t\t}).start();\n\n\t\tnew Thread(()->{\n\t\t\tawaitSignal.run("b", conditionB, conditionC);\n\t\t}).start();\n\n\t\tnew Thread(()->{\n\t\t\tawaitSignal.run("c", conditionC, conditionA);\n\t\t}).start();\n\n\n\t\ttry {\n\t\t\tThread.sleep(1000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\tawaitSignal.lock();\n\t\ttry {\n            //å¤éä¸ä¸ªç­å¾ççº¿ç¨\n\t\t\tconditionA.signal();\n\t\t}finally {\n\t\t\tawaitSignal.unlock();\n\t\t}\n\t}\n}\n\nclass AwaitSignal extends ReentrantLock{\n\tpublic void run(String str, Condition thisCondition, Condition nextCondition) {\n\t\tfor(int i=0; i<loopNumber; i++) {\n\t\t\tlock();\n\t\t\ttry {\n                //å¨é¨è¿å¥ç­å¾ç¶æ\n\t\t\t\tthisCondition.await();\n\t\t\t\tSystem.out.print(str);\n\t\t\t\tnextCondition.signal();\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t} finally {\n\t\t\t\tunlock();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate int loopNumber=5;\n\n\tpublic int getLoopNumber() {\n\t\treturn loopNumber;\n\t}\n\n\tpublic void setLoopNumber(int loopNumber) {\n\t\tthis.loopNumber = loopNumber;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n\n\n\n# 14ãThreadLocal\n\n\n# ç®ä»\n\nThreadLocalæ¯JDKåæä¾çï¼å®æä¾äºçº¿ç¨æ¬å°åéï¼ä¹å°±æ¯å¦æä½ åå»ºäºä¸ä¸ªThreadLocalåéï¼é£ä¹è®¿é®è¿ä¸ªåéçæ¯ä¸ªçº¿ç¨é½ä¼æè¿ä¸ªåéçä¸ä¸ªæ¬å°å¯æ¬ãå½å¤ä¸ªçº¿ç¨æä½è¿ä¸ªåéæ¶ï¼å®éæä½çæ¯èªå·±æ¬å°åå­éé¢çåéï¼ä»èé¿åäºçº¿ç¨å®å¨é®é¢\n\n\n# ä½¿ç¨\n\npublic class ThreadLocalStudy {\n   public static void main(String[] args) {\n      // åå»ºThreadLocalåé\n      ThreadLocal<String> stringThreadLocal = new ThreadLocal<>();\n      ThreadLocal<User> userThreadLocal = new ThreadLocal<>();\n\n      // åå»ºä¸¤ä¸ªçº¿ç¨ï¼åå«ä½¿ç¨ä¸é¢çä¸¤ä¸ªThreadLocalåé\n      Thread thread1 = new Thread(()->{\n         // stringThreadLocalç¬¬ä¸æ¬¡èµå¼\n         stringThreadLocal.set("thread1 stringThreadLocal first");\n         // stringThreadLocalç¬¬äºæ¬¡èµå¼\n         stringThreadLocal.set("thread1 stringThreadLocal second");\n         // userThreadLocalèµå¼\n         userThreadLocal.set(new User("Nyima", 20));\n\n         // åå¼\n         System.out.println(stringThreadLocal.get());\n         System.out.println(userThreadLocal.get());\n          \n          // ç§»é¤\n\t\t userThreadLocal.remove();\n\t\t System.out.println(userThreadLocal.get());\n      });\n\n      Thread thread2 = new Thread(()->{\n         // stringThreadLocalç¬¬ä¸æ¬¡èµå¼\n         stringThreadLocal.set("thread2 stringThreadLocal first");\n         // stringThreadLocalç¬¬äºæ¬¡èµå¼\n         stringThreadLocal.set("thread2 stringThreadLocal second");\n         // userThreadLocalèµå¼\n         userThreadLocal.set(new User("Hulu", 20));\n\n         // åå¼\n         System.out.println(stringThreadLocal.get());\n         System.out.println(userThreadLocal.get());\n      });\n\n      // å¯å¨çº¿ç¨\n      thread1.start();\n      thread2.start();\n   }\n}\n\nclass User {\n   String name;\n   int age;\n\n   public User(String name, int age) {\n      this.name = name;\n      this.age = age;\n   }\n\n   @Override\n   public String toString() {\n      return "User{" +\n            "name=\'" + name + \'\\\'\' +\n            ", age=" + age +\n            \'}\';\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n\n\nè¿è¡ç»æ\n\nthread1 stringThreadLocal second\nthread2 stringThreadLocal second\nUser{name=\'Nyima\', age=20}\nUser{name=\'Hulu\', age=20}\nnull\n\n\n1\n2\n3\n4\n5\n\n\nä»è¿è¡ç»æå¯ä»¥çåº\n\n * æ¯ä¸ªçº¿ç¨ä¸­çThreadLocalåéæ¯æ¯ä¸ªçº¿ç¨ç§æçï¼èä¸æ¯å±äº«ç\n   * ä»çº¿ç¨1åçº¿ç¨2çæå°ç»æå¯ä»¥çåº\n * ThreadLocalå¶å®å°±ç¸å½äºå¶æ³åç±»åçä¸ä¸ªåéï¼åªä¸è¿æ¯æ¯ä¸ªçº¿ç¨ç§æç\n   * stringThreadLocalè¢«èµå¼äºä¸¤æ¬¡ï¼ä¿å­çæ¯æåä¸æ¬¡èµå¼çç»æ\n * ThreadLocalå¯ä»¥è¿è¡ä»¥ä¸å ä¸ªæä½\n   * set è®¾ç½®å¼\n   * get ååºå¼\n   * remove ç§»é¤å¼\n\n\n# åç\n\n# Threadä¸­çthreadLocals\n\npublic class Thread implements Runnable {\n ...\n\n ThreadLocal.ThreadLocalMap threadLocals = null;\n\n // æ¾å¨åé¢è¯´\n ThreadLocal.ThreadLocalMap inheritableThreadLocals = null;\n\n ...\n}\nstatic class ThreadLocalMap {\n    static class Entry extends WeakReference<ThreadLocal<?>> {\n        /** The value associated with this ThreadLocal. */\n        Object value;\n\n        Entry(ThreadLocal<?> k, Object v) {\n            super(k);\n            value = v;\n        }\n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nå¯ä»¥çåºThreadç±»ä¸­æä¸ä¸ªthreadLocalsåä¸ä¸ªinheritableThreadLocalsï¼å®ä»¬é½æ¯ThreadLocalMapç±»åçåéï¼èThreadLocalMapæ¯ä¸ä¸ªå®å¶åçHashmapãå¨é»è®¤æåµä¸ï¼æ¯ä¸ªçº¿ç¨ä¸­çè¿ä¸¤ä¸ªåéé½ä¸ºnullãæ­¤å¤åè®¨è®ºthreadLocalsï¼inheritableThreadLocalsæ¾å¨åé¢è®¨è®º\n\n# ThreadLocalä¸­çæ¹æ³\n\nsetæ¹æ³\n\npublic void set(T value) {\n    // è·åå½åçº¿ç¨\n    Thread t = Thread.currentThread();\n    \n    // è·å¾ThreadLocalMapå¯¹è±¡ \n    // è¿éçgetä¼è¿åThreadç±»ä¸­çthreadLocals\n    ThreadLocalMap map = getMap(t);\n    \n    // å¤æ­mapæ¯å¦å·²ç»åå»ºï¼æ²¡åå»ºå°±åå»ºå¹¶æ¾å¥å¼ï¼åå»ºäºå°±ç´æ¥æ¾å¥\n    if (map != null)\n        // ThreadLocalèªççå¼ç¨ä½ä¸ºkeyï¼ä¼ å¥çå¼ä½ä¸ºvalue\n        map.set(this, value);\n    else\n        createMap(t, value);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦ææªåå»º\n\nvoid createMap(Thread t, T firstValue) {\n    // åå»ºçåæ¶è®¾ç½®æ³æ¾å¥çå¼\n    // hreadLocalèªççå¼ç¨ä½ä¸ºkeyï¼ä¼ å¥çå¼ä½ä¸ºvalue\n    t.threadLocals = new ThreadLocalMap(this, firstValue);\n}\n\n\n1\n2\n3\n4\n5\n\n\ngetæ¹æ³\n\npublic T get() {\n    // è·åå½åçº¿ç¨\n    Thread t = Thread.currentThread();\n\t// è·åå½åçº¿ç¨çthreadLocalsåé\n    ThreadLocalMap map = getMap(t);\n    \n    // å¤æ­threadLocalsæ¯å¦è¢«åå§åäº\n    if (map != null) {\n        // å·²ç»åå§ååç´æ¥è¿å\n        ThreadLocalMap.Entry e = map.getEntry(this);\n        if (e != null) {\n            @SuppressWarnings("unchecked")\n            T result = (T)e.value;\n            return result;\n        }\n    }\n    // å¦åå°±åå»ºthreadLocals\n    return setInitialValue();\n}\nprivate T setInitialValue() {\n    // è¿ä¸ªæ¹æ³è¿åæ¯null\n    T value = initialValue();\n    Thread t = Thread.currentThread();\n    ThreadLocalMap map = getMap(t);\n    \n    // æ è®ºmapåå»ºä¸å¦ï¼æç»valueçå¼é½ä¸ºnull\n    if (map != null)\n        map.set(this, value);\n    else\n        createMap(t, value);\n    return value;\n}\nprotected T initialValue() {\n    return null;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\nremoveæ¹æ³\n\npublic void remove() {\n    ThreadLocalMap m = getMap(Thread.currentThread());\n    if (m != null)\n        // å¦æthreadLocalså·²ç»è¢«åå§åï¼åç§»é¤\n        m.remove(this);\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\n# æ»ç»\n\nå¨æ¯ä¸ªçº¿ç¨åé¨é½æä¸ä¸ªåä¸ºthreadLocalsçæååéï¼è¯¥åéçç±»åä¸ºHashMapï¼å¶ä¸­keyä¸ºæä»¬å®ä¹çThreadLocalåéçthiså¼ç¨ï¼valueåä¸ºæä»¬ä½¿ç¨setæ¹æ³è®¾ç½®çå¼ãæ¯ä¸ªçº¿ç¨çæ¬å°åéå­æ¾å¨çº¿ç¨èªå·±çåå­åéthreadLocalsä¸­\n\nåªæå½åçº¿ç¨ç¬¬ä¸æ¬¡è°ç¨ThreadLocalçsetæègetæ¹æ³æ¶æä¼åå»ºthreadLocalsï¼inheritableThreadLocalsä¹æ¯ä¸æ ·ï¼ãå¶å®æ¯ä¸ªçº¿ç¨çæ¬å°åéä¸æ¯å­æ¾å¨ThreadLocalå®ä¾éé¢ï¼èæ¯å­æ¾å¨è°ç¨çº¿ç¨çthreadLocalsåééé¢\n\n\n# 15ãInheritableThreadLocal\n\n\n# ç®ä»\n\nä»ThreadLocalçæºç å¯ä»¥çåºï¼æ è®ºæ¯setãgetãè¿æ¯removeï¼é½æ¯ç¸å¯¹äºå½åçº¿ç¨æä½ç\n\nThread.currentThread()\n\n\n1\n\n\næä»¥ThreadLocalæ æ³ä»ç¶çº¿ç¨ä¼ åå­çº¿ç¨ï¼æä»¥InheritableThreadLocalåºç°äºï¼å®è½å¤è®©ç¶çº¿ç¨ä¸­ThreadLocalçå¼ä¼ ç»å­çº¿ç¨ã\n\nä¹å°±æ¯ä»mainæå¨ççº¿ç¨ï¼ä¼ ç»thread1æthread2\n\n\n# ä½¿ç¨\n\npublic class Demo1 {\n   public static void main(String[] args) {\n      ThreadLocal<String> stringThreadLocal = new ThreadLocal<>();\n      InheritableThreadLocal<String> stringInheritable = new InheritableThreadLocal<>();\n\n      // ä¸»çº¿ç¨èµå¯¹ä¸é¢ä¸¤ä¸ªåéè¿è¡èµå¼\n      stringThreadLocal.set("this is threadLocal");\n      stringInheritable.set("this is inheritableThreadLocal");\n\n      // åå»ºçº¿ç¨\n      Thread thread1 = new Thread(()->{\n         // è·å¾ThreadLocalä¸­å­æ¾çå¼\n         System.out.println(stringThreadLocal.get());\n\n         // è·å¾InheritableThreadLocalå­æ¾çå¼\n         System.out.println(stringInheritable.get());\n      });\n\n      thread1.start();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nè¿è¡ç»æ\n\nnull\nthis is inheritableThreadLocal\n\n\n1\n2\n\n\nå¯ä»¥çåºInheritableThreadLocalçå¼æåä»ä¸»çº¿ç¨ä¼ å¥äºå­çº¿ç¨ï¼èThreadLocalåæ²¡æ\n\n\n# åç\n\n# InheritableThreadLocal\n\npublic class InheritableThreadLocal<T> extends ThreadLocal<T> {\n    // ä¼ å¥ç¶çº¿ç¨ä¸­çä¸ä¸ªå¼ï¼ç¶åç´æ¥è¿å\n    protected T childValue(T parentValue) {\n        return parentValue;\n    }\n\n  \t// è¿åä¼ å¥çº¿ç¨çinheritableThreadLocals\n    // Threadä¸­æä¸ä¸ªinheritableThreadLocalsåé\n    // ThreadLocal.ThreadLocalMap inheritableThreadLocals = null;\n    ThreadLocalMap getMap(Thread t) {\n       return t.inheritableThreadLocals;\n    }\n\n \t// åå»ºä¸ä¸ªinheritableThreadLocals\n    void createMap(Thread t, T firstValue) {\n        t.inheritableThreadLocals = new ThreadLocalMap(this, firstValue);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nç±å¦ä¸ä»£ç å¯ç¥ï¼InheritableThreadLocalç»§æ¿äºThreadLocalï¼å¹¶éåäºä¸ä¸ªæ¹æ³ãInheritableThreadLocaléåäºcreateMapæ¹æ³ï¼é£ä¹ç°å¨å½ç¬¬ä¸æ¬¡è°ç¨setæ¹æ³æ¶ï¼åå»ºçæ¯å½åçº¿ç¨çinheritableThreadLocalsåéçå®ä¾èä¸åæ¯threadLocalsãå½è°ç¨getMapæ¹æ³è·åå½åçº¿ç¨åé¨çmapåéæ¶ï¼è·åçæ¯inheritableThreadLocalsèä¸åæ¯threadLocals\n\n# childValue(T parentValue)æ¹æ³çè°ç¨\n\nå¨ä¸»å½æ°è¿è¡æ¶ï¼ä¼è°ç¨Threadçé»è®¤æé å½æ°ï¼åå»ºä¸»çº¿ç¨ï¼ä¹å°±æ¯ç¶çº¿ç¨ï¼ï¼æä»¥æä»¬åççThreadçé»è®¤æé å½æ°\n\npublic Thread() {\n    init(null, null, "Thread-" + nextThreadNum(), 0);\n}\nprivate void init(ThreadGroup g, Runnable target, String name,\n                  long stackSize, AccessControlContext acc,\n                  boolean inheritThreadLocals) {\n   \t...\n        \n\t// è·å¾å½åçº¿ç¨çï¼å¨è¿éæ¯ä¸»çº¿ç¨\n    Thread parent = currentThread();\n   \n    ...\n    \n    // å¦æç¶çº¿ç¨çinheritableThreadLocalså­å¨\n    // æä»¬å¨ä¸»çº¿ç¨ä¸­è°ç¨setågetæ¶ï¼ä¼åå»ºinheritableThreadLocals\n    if (inheritThreadLocals && parent.inheritableThreadLocals != null)\n        // è®¾ç½®å­çº¿ç¨çinheritableThreadLocals\n        this.inheritableThreadLocals =\n            ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);\n    \n    /* Stash the specified stack size in case the VM cares */\n    this.stackSize = stackSize;\n\n    /* Set thread ID */\n    tid = nextThreadID();\n}\nstatic ThreadLocalMap createInheritedMap(ThreadLocalMap parentMap) {\n    return new ThreadLocalMap(parentMap);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nå¨createInheritedMapåé¨ä½¿ç¨ç¶çº¿ç¨çinheritableThreadLocalsåéä½ä¸ºæé å½æ°åå»ºäºä¸ä¸ªæ°çThreadLocalMapåéï¼ç¶åèµå¼ç»äºå­çº¿ç¨çinheritableThreadLocalsåé\n\nprivate ThreadLocalMap(ThreadLocalMap parentMap) {\n    Entry[] parentTable = parentMap.table;\n    int len = parentTable.length;\n    setThreshold(len);\n    table = new Entry[len];\n\n    for (int j = 0; j < len; j++) {\n        Entry e = parentTable[j];\n        if (e != null) {\n            @SuppressWarnings("unchecked")\n            ThreadLocal<Object> key = (ThreadLocal<Object>) e.get();\n            if (key != null) {\n                // è¿éè°ç¨äº childValue æ¹æ³\n                // è¯¥æ¹æ³ä¼è¿åparentçå¼\n                Object value = key.childValue(e.value);\n                \n                Entry c = new Entry(key, value);\n                int h = key.threadLocalHashCode & (len - 1);\n                while (table[h] != null)\n                    h = nextIndex(h, len);\n                table[h] = c;\n                size++;\n            }\n        }\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nå¨è¯¥æé å½æ°åé¨æç¶çº¿ç¨çinheritableThreadLocalsæååéçå¼å¤å¶å°æ°çThreadLocalMapå¯¹è±¡ä¸­\n\n# æ»ç»\n\nInheritableThreadLocalç±»éè¿éågetMapåcreateMapï¼è®©æ¬å°åéä¿å­å°äºå·ä½çº¿ç¨çinheritableThreadLocalsåééé¢ï¼é£ä¹çº¿ç¨å¨éè¿InheritableThreadLocalç±»å®ä¾çsetæègetæ¹æ³è®¾ç½®åéæ¶ï¼å°±ä¼åå»ºå½åçº¿ç¨çinheritableThreadLocalsåéã\n\nå½ç¶çº¿ç¨åå»ºå­çº¿ç¨æ¶ï¼æé å½æ°ä¼æç¶çº¿ç¨ä¸­inheritableThreadLocalsåééé¢çæ¬å°åéå¤å¶ä¸ä»½ä¿å­å°å­çº¿ç¨çinheritableThreadLocalsåééé¢ã\n\n\n# åãå±äº«æ¨¡åä¹åå­\n\n\n# 1ãJAVAåå­æ¨¡åï¼JMMï¼\n\nJMM å³ Java Memory Modelï¼å®å®ä¹äº**ä¸»å­ï¼å±äº«åå­ï¼ãå·¥ä½åå­ï¼çº¿ç¨ç§æï¼**æ½è±¡æ¦å¿µï¼åºå±å¯¹åºç CPU å¯å­å¨ãç¼å­ãç¡¬ä»¶åå­ã CPU æä»¤ä¼åç­ã\n\nJMMä½ç°å¨ä»¥ä¸å ä¸ªæ¹é¢\n\n * åå­æ§ - ä¿è¯æä»¤ä¸ä¼åå°çº¿ç¨ä¸ä¸æåæ¢çå½±å\n * å¯è§æ§ - ä¿è¯æä»¤ä¸ä¼å cpu ç¼å­çå½±å\n * æåºæ§ - ä¿è¯æä»¤ä¸ä¼å cpu æä»¤å¹¶è¡ä¼åçå½±å\n\n\n# 2ãå¯è§æ§\n\n# å¼ä¾\n\néåºä¸åºçå¾ªç¯\n\nstatic Boolean run = true;\n\tpublic static void main(String[] args) throws InterruptedException {\n\t\tnew Thread(()->{\n\t\t\twhile (run) {\n\t\t\t\t//å¦ærunä¸ºçï¼åä¸ç´æ§è¡\n\t\t\t}\n\t\t}).start();\n\n\t\tThread.sleep(1000);\n\t\tSystem.out.println("æ¹årunçå¼ä¸ºfalse");\n\t\trun = false;\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸ºä»ä¹æ æ³éåºè¯¥å¾ªç¯\n\n * åå§ç¶æï¼ t çº¿ç¨åå¼å§ä»ä¸»åå­è¯»åäº run çå¼å°å·¥ä½åå­ã\n\n\n\n * å ä¸º t çº¿ç¨è¦é¢ç¹ä»ä¸»åå­ä¸­è¯»å run çå¼ï¼JIT ç¼è¯å¨ä¼å° run çå¼ç¼å­è³èªå·±å·¥ä½åå­ä¸­çé«éç¼å­ä¸­ï¼ åå°å¯¹ä¸»å­ä¸­ run çè®¿é®ï¼æé«æç\n\n\n\n * 1 ç§ä¹åï¼main çº¿ç¨ä¿®æ¹äº run çå¼ï¼å¹¶åæ­¥è³ä¸»å­ï¼è t æ¯ä»èªå·±å·¥ä½åå­ä¸­çé«éç¼å­ä¸­è¯»åè¿ä¸ªåé çå¼ï¼ç»ææ°¸è¿æ¯æ§å¼\n\n\n\nè§£å³æ¹æ³\n\n * ä½¿ç¨volatileæåå³é®å­\n * å®å¯ä»¥ç¨æ¥ä¿®é¥°æååéåéææååéï¼æ¾å¨ä¸»å­ä¸­çåéï¼ï¼ä»å¯ä»¥é¿åçº¿ç¨ä»èªå·±çå·¥ä½ç¼å­ä¸­æ¥æ¾åéçå¼ï¼å¿é¡»å°ä¸»å­ä¸­è·åå®çå¼ï¼çº¿ç¨æä½ volatile åéé½æ¯ç´æ¥æä½ä¸»å­\n\n//ä½¿ç¨æåå³é®å­\nvolatile static Boolean run = true;\npublic static void main(String[] args) throws InterruptedException {\n\tnew Thread(()->{\n\t\twhile (run) {\n\t\t\t//å¦ærunä¸ºçï¼åä¸ç´æ§è¡\n\t\t}\n\t}).start();\n\n\tThread.sleep(1000);\n\tSystem.out.println("æ¹årunçå¼ä¸ºfalse");\n\trun = false;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n# å¯è§æ§ä¸åå­æ§\n\nåé¢ä¾å­ä½ç°çå®éå°±æ¯å¯è§æ§ï¼å®ä¿è¯çæ¯å¨å¤ä¸ªçº¿ç¨ä¹é´ï¼ä¸ä¸ªçº¿ç¨å¯¹volatileåéçä¿®æ¹å¯¹å¦ä¸ä¸ªçº¿ç¨å¯è§ï¼ ä¸è½ä¿è¯åå­æ§ï¼ä»ç¨å¨ä¸ä¸ªåçº¿ç¨ï¼å¤ä¸ªè¯»çº¿ç¨çæåµ\n\n * æ³¨æ synchronized è¯­å¥åæ¢å¯ä»¥ä¿è¯ä»£ç åçåå­æ§ï¼ä¹åæ¶ä¿è¯ä»£ç åååéçå¯è§æ§ã\n\n * ä½ç¼ºç¹æ¯ synchronized æ¯å±äºééçº§æä½ï¼æ§è½ç¸å¯¹æ´ä½ã\n\n * å¦æå¨åé¢ç¤ºä¾çæ­»å¾ªç¯ä¸­å å¥ System.out.println() ä¼åç°å³ä½¿ä¸å  volatile ä¿®é¥°ç¬¦ï¼çº¿ç¨ t ä¹è½æ­£ç¡®çå° å¯¹ run åéçä¿®æ¹äºï¼æ³ä¸æ³ä¸ºä»ä¹ï¼\n   \n   * å ä¸ºä½¿ç¨äºsynchronizedå³é®å­\n     \n     public void println(String x) {\n     \t\t//ä½¿ç¨äºsynchronizedå³é®å­\n             synchronized (this) {\n                 print(x);\n                 newLine();\n             }\n         }\n     \n     \n     1\n     2\n     3\n     4\n     5\n     6\n     7\n     \n\n# ä¸¤é¶ç»æ­¢æ¨¡å¼ä¼å\n\npublic class Test7 {\n\tpublic static void main(String[] args) throws InterruptedException {\n\t\tMonitor monitor = new Monitor();\n\t\tmonitor.start();\n\t\tThread.sleep(3500);\n\t\tmonitor.stop();\n\t}\n}\n\nclass Monitor {\n\n\tThread monitor;\n\t//è®¾ç½®æ è®°ï¼ç¨äºå¤æ­æ¯å¦è¢«ç»æ­¢äº\n\tprivate volatile boolean stop = false;\n\t/**\n\t * å¯å¨çæ§å¨çº¿ç¨\n\t */\n\tpublic void start() {\n\t\t//è®¾ç½®çº¿æ§å¨çº¿ç¨ï¼ç¨äºçæ§çº¿ç¨ç¶æ\n\t\tmonitor = new Thread() {\n\t\t\t@Override\n\t\t\tpublic void run() {\n\t\t\t\t//å¼å§ä¸åççæ§\n\t\t\t\twhile (true) {\n\t\t\t\t\tif(stop) {\n\t\t\t\t\t\tSystem.out.println("å¤çåç»­ä»»å¡");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tSystem.out.println("çæ§å¨è¿è¡ä¸­...");\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//çº¿ç¨ä¼ç \n\t\t\t\t\t\tThread.sleep(1000);\n\t\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\t\tSystem.out.println("è¢«ææ­äº");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tmonitor.start();\n\t}\n\n\t/**\n\t * \tç¨äºåæ­¢çæ§å¨çº¿ç¨\n\t */\n\tpublic void stop() {\n\t\t//ææ­çº¿ç¨\n\t\tmonitor.interrupt();\n        //ä¿®æ¹æ è®°\n\t\tstop = true;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n\n\n# åæ­¥æ¨¡å¼ä¹ç¹è±«æ¨¡å¼\n\nå®ä¹\n\nBalking ï¼ç¹è±«ï¼æ¨¡å¼ç¨å¨ä¸ä¸ªçº¿ç¨åç°å¦ä¸ä¸ªçº¿ç¨ææ¬çº¿ç¨å·²ç»åäºæä¸ä»¶ç¸åçäºï¼é£ä¹æ¬çº¿ç¨å°±æ éåå äºï¼ç´æ¥ç»æè¿å\n\n * ç¨ä¸ä¸ªæ è®°æ¥å¤æ­è¯¥ä»»å¡æ¯å¦å·²ç»è¢«æ§è¡è¿äº\n * éè¦é¿åçº¿ç¨å®å¨é®é¢\n   * å éçä»£ç åè¦å°½éçå°ï¼ä»¥ä¿è¯æ§è½\n\npackage com.nyima.day1;\n\n/**\n * @author Chen Panwen\n * @data 2020/3/26 16:11\n */\npublic class Test7 {\n\tpublic static void main(String[] args) throws InterruptedException {\n\t\tMonitor monitor = new Monitor();\n\t\tmonitor.start();\n\t\tmonitor.start();\n\t\tThread.sleep(3500);\n\t\tmonitor.stop();\n\t}\n}\n\nclass Monitor {\n\n\tThread monitor;\n\t//è®¾ç½®æ è®°ï¼ç¨äºå¤æ­æ¯å¦è¢«ç»æ­¢äº\n\tprivate volatile boolean stop = false;\n\t//è®¾ç½®æ è®°ï¼ç¨äºå¤æ­æ¯å¦å·²ç»å¯å¨è¿äº\n\tprivate boolean starting = false;\n\t/**\n\t * å¯å¨çæ§å¨çº¿ç¨\n\t */\n\tpublic void start() {\n\t\t//ä¸éï¼é¿åå¤çº¿ç¨è¿è¡æ¶åºç°çº¿ç¨å®å¨é®é¢\n\t\tsynchronized (this) {\n\t\t\tif (starting) {\n\t\t\t\t//å·²è¢«å¯å¨ï¼ç´æ¥è¿å\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//å¯å¨çè§å¨ï¼æ¹åæ è®°\n\t\t\tstarting = true;\n\t\t}\n\t\t//è®¾ç½®çº¿æ§å¨çº¿ç¨ï¼ç¨äºçæ§çº¿ç¨ç¶æ\n\t\tmonitor = new Thread() {\n\t\t\t@Override\n\t\t\tpublic void run() {\n\t\t\t\t//å¼å§ä¸åççæ§\n\t\t\t\twhile (true) {\n\t\t\t\t\tif(stop) {\n\t\t\t\t\t\tSystem.out.println("å¤çåç»­ä»»å¡");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tSystem.out.println("çæ§å¨è¿è¡ä¸­...");\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//çº¿ç¨ä¼ç \n\t\t\t\t\t\tThread.sleep(1000);\n\t\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\t\tSystem.out.println("è¢«ææ­äº");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tmonitor.start();\n\t}\n\n\t/**\n\t * \tç¨äºåæ­¢çæ§å¨çº¿ç¨\n\t */\n\tpublic void stop() {\n\t\t//ææ­çº¿ç¨\n\t\tmonitor.interrupt();\n\t\tstop = true;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n\n\n\n# 3ãæåºæ§\n\n\n# æä»¤éæ\n\n * JVM ä¼å¨ä¸å½±åæ­£ç¡®æ§çåæä¸ï¼å¯ä»¥è°æ´è¯­å¥çæ§è¡é¡ºåº\n\n\n\nè¿ç§ç¹æ§ç§°ä¹ä¸ºãæä»¤éæãï¼å¤çº¿ç¨ä¸ãæä»¤éæãä¼å½±åæ­£ç¡®æ§ã\n\n\n# æä»¤éæåºä¼å\n\n * äºå®ä¸ï¼ç°ä»£å¤çå¨ä¼è®¾è®¡ä¸ºä¸ä¸ªæ¶éå¨æå®æä¸æ¡æ§è¡æ¶é´é¿ç CPU æä»¤ãä¸ºä»ä¹è¿ä¹åå¢ï¼å¯ä»¥æ³å°æä»¤è¿å¯ä»¥åååæä¸ä¸ªä¸ªæ´å°çé¶æ®µï¼ä¾å¦ï¼æ¯æ¡æä»¤é½å¯ä»¥åä¸ºï¼ åæä»¤ - æä»¤è¯ç  - æ§è¡æä»¤ - åå­è®¿é® - æ°æ®åå è¿5 ä¸ªé¶æ®µ\n\n\n\n * å¨ä¸æ¹åç¨åºç»æçåæä¸ï¼è¿äºæä»¤çåä¸ªé¶æ®µå¯ä»¥éè¿éæåºåç»åæ¥å®ç°æä»¤çº§å¹¶è¡\n\n * æä»¤éæçåææ¯ï¼éææä»¤ä¸è½å½±åç»æï¼ä¾å¦\n   \n   // å¯ä»¥éæçä¾å­ \n   int a = 10; \n   int b = 20; \n   System.out.println( a + b );\n   \n   // ä¸è½éæçä¾å­ \n   int a = 10;\n   int b = a - 5;\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   \n\n\n# æ¯ææµæ°´çº¿çå¤çå¨\n\nç°ä»£ CPU æ¯æå¤çº§æä»¤æµæ°´çº¿ï¼ä¾å¦æ¯æåæ¶æ§è¡ åæä»¤ - æä»¤è¯ç  - æ§è¡æä»¤ - åå­è®¿é® - æ°æ®åå çå¤çå¨ï¼å°±å¯ä»¥ç§°ä¹ä¸ºäºçº§æä»¤æµæ°´çº¿ãè¿æ¶ CPU å¯ä»¥å¨ä¸ä¸ªæ¶éå¨æåï¼åæ¶è¿è¡äºæ¡æä»¤çä¸åé¶æ®µï¼ç¸å½äºä¸ æ¡æ§è¡æ¶é´é¿çå¤ææä»¤ï¼ï¼IPC = 1ï¼æ¬è´¨ä¸ï¼æµæ°´çº¿ææ¯å¹¶ä¸è½ç¼©ç­åæ¡æä»¤çæ§è¡æ¶é´ï¼ä½å®åç¸å°æé«äºæä»¤å°ååçã\n\n\n\nå¨å¤çº¿ç¨ç¯å¢ä¸ï¼æä»¤éæåºå¯è½å¯¼è´åºç°ææä¹å¤çç»æ\n\n\n# è§£å³åæ³\n\nvolatile ä¿®é¥°çåéï¼å¯ä»¥ç¦ç¨æä»¤éæ\n\n * ç¦æ­¢çæ¯å volatileå³é®å­åéä¹åçä»£ç è¢«éæåº\n\n\n# 4ãåå­å±é\n\n * å¯è§æ§\n   * åå±éï¼sfenceï¼ä¿è¯å¨è¯¥å±éä¹åçï¼å¯¹å±äº«åéçæ¹å¨ï¼é½åæ­¥å°ä¸»å­å½ä¸­\n   * è¯»å±éï¼lfenceï¼ä¿è¯å¨è¯¥å±éä¹åï¼å¯¹å±äº«åéçè¯»åï¼å è½½çæ¯ä¸»å­ä¸­æ°æ°æ®\n * æåºæ§\n   * åå±éä¼ç¡®ä¿æä»¤éæåºæ¶ï¼ä¸ä¼å°åå±éä¹åçä»£ç æå¨åå±éä¹å\n   * è¯»å±éä¼ç¡®ä¿æä»¤éæåºæ¶ï¼ä¸ä¼å°è¯»å±éä¹åçä»£ç æå¨è¯»å±éä¹å\n\n\n# 5ãvolatile åç\n\nvolatileçåºå±å®ç°åçæ¯åå­å±éï¼Memory Barrierï¼Memory Fenceï¼\n\n * å¯¹ volatile åéçåæä»¤åä¼å å¥åå±é\n * å¯¹ volatile åéçè¯»æä»¤åä¼å å¥è¯»å±é\n\n\n# å¦ä½ä¿è¯å¯è§æ§\n\n * åå±éï¼sfenceï¼ä¿è¯å¨è¯¥å±éä¹åçï¼å¯¹å±äº«åéçæ¹å¨ï¼é½åæ­¥å°ä¸»å­å½ä¸­\n   \n   \n\n * èè¯»å±éï¼lfenceï¼ä¿è¯å¨è¯¥å±éä¹åï¼å¯¹å±äº«åéçè¯»åï¼å è½½çæ¯ä¸»å­ä¸­æ°æ°æ®\n   \n   \n\n\n# å¦ä½ä¿è¯æåºæ§\n\n * åå±éä¼ç¡®ä¿æä»¤éæåºæ¶ï¼ä¸ä¼å°åå±éä¹åçä»£ç æå¨åå±éä¹å\n   \n   \n\n * è¯»å±éä¼ç¡®ä¿æä»¤éæåºæ¶ï¼ä¸ä¼å°è¯»å±éä¹åçä»£ç æå¨è¯»å±éä¹å\n   \n   \n\n\n\nä½æ¯ä¸è½è§£å³æä»¤äº¤éé®é¢\n\n * åå±éä»ä»æ¯ä¿è¯ä¹åçè¯»è½å¤è¯»å°æ°çç»æï¼ä½ä¸è½ä¿è¯è¯»è·å°å®åé¢å»\n * èæåºæ§çä¿è¯ä¹åªæ¯ä¿è¯äºæ¬çº¿ç¨åç¸å³ä»£ç ä¸è¢«éæåº\n\n\n# å®ç°åçä¹Lockåç¼\n\nå¨X86å¤çå¨ä¸éè¿å·¥å·è·åJITç¼è¯å¨çæçæ±ç¼æä»¤æ¥æ¥çå¯¹volatileè¿è¡åæä½æ¶\n\ninstance = new Singleton();\n\n\n1\n\n\nå¯¹åºçæ±ç¼ä»£ç æ¯\n\n... lock addl ...\n\n\n1\n\n\nævolatileåéä¿®é¥°çå±äº«åéè¿è¡åæä½çæ¶åä¼å¤åºç¬¬äºè¡æ±ç¼ä»£ç ï¼éè¿æ¥IA-32æ¶æè½¯ä»¶å¼åèæåå¯ç¥ï¼Lockåç¼çæä»¤å¨å¤æ ¸å¤çå¨ä¸ä¼å¼åäºä¸¤ä»¶äº\n\n * Lockåç¼æä»¤ä¼å¼èµ·å¤çå¨\n   \n   ç¼å­ååå°åå­\n   \n   * Lockåç¼æä»¤å¯¼è´å¨æ§è¡æä»¤æé´ï¼å£°è¨å¤çå¨çLOCK#ä¿¡å·ãå¨å¤å¤çå¨ç¯å¢ä¸­ï¼LOCK#ä¿¡å·ç¡®ä¿å¨å£°è¨è¯¥ä¿¡å·æé´ï¼å¤çå¨å¯ä»¥ç¬å ä»»ä½å±äº«åå­ãä½æ¯ï¼å¨æè¿çå¤çå¨éï¼LOCK #ä¿¡å·ä¸è¬ä¸éæ»çº¿ï¼èæ¯éç¼å­ï¼æ¯ç«éæ»çº¿å¼éçæ¯è¾å¤§ãä½¿ç¨ç¼å­ä¸è´æ§æºå¶æ¥ç¡®ä¿ä¿®æ¹çåå­æ§ï¼æ­¤æä½è¢«ç§°ä¸ºâç¼å­éå®âï¼ç¼å­ä¸è´æ§æºå¶ä¼é»æ­¢åæ¶ä¿®æ¹ç±ä¸¤ä¸ªä»¥ä¸å¤çå¨ç¼å­çåå­åºåæ°æ®\n\n * ä¸ä¸ªå¤çå¨çç¼å­ååå°åå­ä¼\n   \n   å¯¼è´å¶ä»å¤çå¨çç¼å­æ æ\n   \n   * å¨å¤æ ¸å¤çå¨ç³»ç»ä¸­è¿è¡æä½çæ¶åï¼IA-32åIntel 64å¤çå¨è½åæ¢å¶ä»å¤çå¨è®¿é®ç³»ç»åå­åå®ä»¬çåé¨ç¼å­ãå¤çå¨ä½¿ç¨åæ¢ææ¯ä¿è¯å®çåé¨ç¼å­ãç³»ç»åå­åå¶ä»å¤çå¨çç¼å­çæ°æ®å¨æ»çº¿ä¸ä¿æä¸è´\n\n\n# äºãå±äº«æ¨¡åä¹æ é\n\n\n# 1ãæ éè§£å³çº¿ç¨å®å¨é®é¢\n\n * ä½¿ç¨åå­æ´æ°\n   \n   AtomicInteger balance = new AtomicInteger();\n   \n   \n   1\n   \n\ninterface Account {\n\tInteger getBalance();\n\n\tvoid withdraw(Integer amount);\n\n\t/**\n\t * æ¹æ³åä¼å¯å¨ 1000 ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨å -10 å çæä½     * å¦æåå§ä½é¢ä¸º 10000 é£ä¹æ­£ç¡®çç»æåºå½æ¯ 0\n\t */\n\tstatic void demo(Account account) {\n\t\tList<Thread> ts = new ArrayList<>();\n\t\tlong start = System.nanoTime();\n\t\tfor (int i = 0; i < 1000; i++) {\n\t\t\tts.add(new Thread(() -> {\n\t\t\t\taccount.withdraw(10);\n\t\t\t}));\n\t\t}\n\t\tts.forEach(Thread::start);\n\t\tts.forEach(t -> {\n\t\t\ttry {\n\t\t\t\tt.join();\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t});\n\t\tlong end = System.nanoTime();\n\t\tSystem.out.println(account.getBalance() + " cost: " + (end - start) / 1000_000 + " ms");\n\t}\n}\n\n//çº¿ç¨ä¸å®å¨çåæ³\nclass AccountUnsafe implements Account {\n\tprivate Integer balance;\n\n\tpublic AccountUnsafe(Integer balance) {\n\t\tthis.balance = balance;\n\t}\n\n\n\t@Override\n\tpublic Integer getBalance() {\n\t\treturn this.balance;\n\t}\n\n\t@Override\n\tpublic synchronized void withdraw(Integer amount) {\n\t\tbalance -= amount;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tAccount.demo(new AccountUnsafe(10000));\n\t\tAccount.demo(new AccountCas(10000));\n\t}\n}\n\n//çº¿ç¨å®å¨çåæ³\nclass AccountCas implements Account {\n\t//ä½¿ç¨åå­æ´æ°\n\tprivate AtomicInteger balance;\n\n\tpublic AccountCas(int balance) {\n\t\tthis.balance = new AtomicInteger(balance);\n\t}\n\n\t@Override\n\tpublic Integer getBalance() {\n\t\t//å¾å°åå­æ´æ°çå¼\n\t\treturn balance.get();\n\t}\n\n\t@Override\n\tpublic void withdraw(Integer amount) {\n\t\twhile(true) {\n\t\t\t//è·å¾ä¿®æ¹åçå¼\n\t\t\tint prev = balance.get();\n\t\t\t//è·å¾ä¿®æ¹åçå¼\n\t\t\tint next = prev-amount;\n\t\t\t//æ¯è¾å¹¶è®¾å¼\n\t\t\tif(balance.compareAndSet(prev, next)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n\n\n\n# 2ãCASä¸volatile\n\nåé¢çå°ç AtomicInteger çè§£å³æ¹æ³ï¼åé¨å¹¶æ²¡æç¨éæ¥ä¿æ¤å±äº«åéççº¿ç¨å®å¨ãé£ä¹å®æ¯å¦ä½å®ç°çå¢ï¼\n\nå¶ä¸­çå³é®æ¯ compareAndSwapï¼æ¯è¾å¹¶è®¾ç½®å¼ï¼ï¼å®çç®ç§°å°±æ¯ CAS ï¼ä¹æ Compare And Swap çè¯´æ³ï¼ï¼å®å¿é¡»æ¯åå­æä½ã\n\n\n\n\n# å·¥ä½æµç¨\n\n * å½ä¸ä¸ªçº¿ç¨è¦å»ä¿®æ¹Accountå¯¹è±¡ä¸­çå¼æ¶ï¼åè·åå¼preï¼è°ç¨getæ¹æ³ï¼ï¼ç¶ååå°å¶è®¾ç½®ä¸ºæ°çå¼nextï¼è°ç¨casæ¹æ³ï¼ãå¨è°ç¨casæ¹æ³æ¶ï¼ä¼å°preä¸Accountä¸­çä½é¢è¿è¡æ¯è¾ã\n   * å¦æä¸¤èç¸ç­ï¼å°±è¯´æè¯¥å¼è¿æªè¢«å¶ä»çº¿ç¨ä¿®æ¹ï¼æ­¤æ¶ä¾¿å¯ä»¥è¿è¡ä¿®æ¹æä½ã\n   * å¦æä¸¤èä¸ç¸ç­ï¼å°±ä¸è®¾ç½®å¼ï¼éæ°è·åå¼preï¼è°ç¨getæ¹æ³ï¼ï¼ç¶ååå°å¶è®¾ç½®ä¸ºæ°çå¼nextï¼è°ç¨casæ¹æ³ï¼ï¼ç´å°ä¿®æ¹æåä¸ºæ­¢ã\n\næ³¨æ\n\n * å¶å® CAS çåºå±æ¯ lock cmpxchg æä»¤ï¼X86 æ¶æï¼ï¼å¨åæ ¸ CPU åå¤æ ¸ CPU ä¸é½è½å¤ä¿è¯ãæ¯è¾-äº¤æ¢ãçåå­æ§ã\n * å¨å¤æ ¸ç¶æä¸ï¼æä¸ªæ ¸æ§è¡å°å¸¦ lock çæä»¤æ¶ï¼CPU ä¼è®©æ»çº¿éä½ï¼å½è¿ä¸ªæ ¸ææ­¤æä»¤æ§è¡å®æ¯ï¼åå¼å¯æ»çº¿ãè¿ä¸ªè¿ç¨ä¸­ä¸ä¼è¢«çº¿ç¨çè°åº¦æºå¶æææ­ï¼ä¿è¯äºå¤ä¸ªçº¿ç¨å¯¹åå­æä½çåç¡®æ§ï¼æ¯åå­çã\n\n\n# volatile\n\nè·åå±äº«åéæ¶ï¼ä¸ºäºä¿è¯è¯¥åéçå¯è§æ§ï¼éè¦ä½¿ç¨ volatile ä¿®é¥°ã å®å¯ä»¥ç¨æ¥ä¿®é¥°æååéåéææååéï¼ä»å¯ä»¥é¿åçº¿ç¨ä»èªå·±çå·¥ä½ç¼å­ä¸­æ¥æ¾åéçå¼ï¼å¿é¡»å°ä¸»å­ä¸­è·å å®çå¼ï¼çº¿ç¨æä½ volatile åéé½æ¯ç´æ¥æä½ä¸»å­ãå³ä¸ä¸ªçº¿ç¨å¯¹ volatile åéçä¿®æ¹ï¼å¯¹å¦ä¸ä¸ªçº¿ç¨å¯è§ã\n\næ³¨æ\n\nvolatile ä»ä»ä¿è¯äºå±äº«åéçå¯è§æ§ï¼è®©å¶å®çº¿ç¨è½å¤çå°æ°å¼ï¼ä½ä¸è½è§£å³æä»¤äº¤éé®é¢ï¼ä¸è½ä¿è¯åå­æ§ï¼\n\n\n1\n\n\nCAS å¿é¡»åå© volatile æè½è¯»åå°å±äº«åéçæ°å¼æ¥å®ç°ãæ¯è¾å¹¶äº¤æ¢ãçææ\n\n\n# æçé®é¢\n\nä¸è¬æåµä¸ï¼ä½¿ç¨æ éæ¯ä½¿ç¨å éçæçæ´é«ã\n\n\n\nåå \n\n\n# CASç¹ç¹\n\nç»å CAS å volatile å¯ä»¥å®ç°æ éå¹¶åï¼éç¨äºçº¿ç¨æ°å°ãå¤æ ¸ CPU çåºæ¯ä¸ã\n\n * CAS æ¯åºäºä¹è§éçææ³ï¼ä¹è§çä¼°è®¡ï¼ä¸æå«ççº¿ç¨æ¥ä¿®æ¹å±äº«åéï¼å°±ç®æ¹äºä¹æ²¡å³ç³»ï¼æåäºç¹åéè¯åã\n\n * synchronized æ¯åºäºæ²è§éçææ³ï¼æ²è§çä¼°è®¡ï¼å¾é²çå¶å®çº¿ç¨æ¥ä¿®æ¹å±äº«åéï¼æä¸äºéä½ ä»¬é½å«æ³æ¹ï¼ææ¹å®äºè§£å¼éï¼ä½ ä»¬æææºä¼ã\n\n * CAS ä½ç°çæ¯\n   \n   æ éå¹¶åãæ é»å¡å¹¶å\n   \n   ï¼è¯·ä»ç»ä½ä¼è¿ä¸¤å¥è¯çææ\n   \n   * å ä¸ºæ²¡æä½¿ç¨ synchronizedï¼æä»¥çº¿ç¨ä¸ä¼é·å¥é»å¡ï¼è¿æ¯æçæåçå ç´ ä¹ä¸\n   * ä½å¦æç«äºæ¿çï¼å¯ä»¥æ³å°éè¯å¿ç¶é¢ç¹åçï¼åèæçä¼åå½±å\n\n\n# 3ãåå­æ´æ°\n\nJ.U.C å¹¶ååæä¾äº\n\n * AtomicBoolean\n * AtomicInteger\n * AtomicLong\n\nä»¥ AtomicInteger ä¸ºä¾\n\n AtomicInteger i = new AtomicInteger(0);\n \n// è·åå¹¶èªå¢ï¼i = 0, ç»æ i = 1, è¿å 0ï¼ï¼ç±»ä¼¼äº i++ System.out.println(i.getAndIncrement());\n \n// èªå¢å¹¶è·åï¼i = 1, ç»æ i = 2, è¿å 2ï¼ï¼ç±»ä¼¼äº ++i System.out.println(i.incrementAndGet());\n \n// èªåå¹¶è·åï¼i = 2, ç»æ i = 1, è¿å 1ï¼ï¼ç±»ä¼¼äº --i System.out.println(i.decrementAndGet());\n \n// è·åå¹¶èªåï¼i = 1, ç»æ i = 0, è¿å 1ï¼ï¼ç±»ä¼¼äº i--\nSystem.out.println(i.getAndDecrement());\n \n// è·åå¹¶å å¼ï¼i = 0, ç»æ i = 5, è¿å 0ï¼ \nSystem.out.println(i.getAndAdd(5));\n \n// å å¼å¹¶è·åï¼i = 5, ç»æ i = 0, è¿å 0ï¼ \nSystem.out.println(i.addAndGet(-5));\n \n// è·åå¹¶æ´æ°ï¼i = 0, p ä¸º i çå½åå¼, ç»æ i = -2, è¿å 0ï¼ \n// å¶ä¸­å½æ°ä¸­çæä½è½ä¿è¯åå­ï¼ä½å½æ°éè¦æ å¯ä½ç¨ \nSystem.out.println(i.getAndUpdate(p -> p - 2));\n \n// æ´æ°å¹¶è·åï¼i = -2, p ä¸º i çå½åå¼, ç»æ i = 0, è¿å 0ï¼\n// å¶ä¸­å½æ°ä¸­çæä½è½ä¿è¯åå­ï¼ä½å½æ°éè¦æ å¯ä½ç¨ \nSystem.out.println(i.updateAndGet(p -> p + 2));\n \n// è·åå¹¶è®¡ç®ï¼i = 0, p ä¸º i çå½åå¼, x ä¸ºåæ°1, ç»æ i = 10, è¿å 0ï¼ \n// å¶ä¸­å½æ°ä¸­çæä½è½ä¿è¯åå­ï¼ä½å½æ°éè¦æ å¯ä½ç¨ // getAndUpdate å¦æå¨ lambda ä¸­å¼ç¨äºå¤é¨çå±é¨åéï¼è¦ä¿è¯è¯¥å±é¨åéæ¯ final ç \n// getAndAccumulate å¯ä»¥éè¿ åæ°1 æ¥å¼ç¨å¤é¨çå±é¨åéï¼ä½å ä¸ºå¶ä¸å¨ lambda ä¸­å æ­¤ä¸å¿æ¯ \nfinal System.out.println(i.getAndAccumulate(10, (p, x) -> p + x));\n \n// è®¡ç®å¹¶è·åï¼i = 10, p ä¸º i çå½åå¼, x ä¸ºåæ°1, ç»æ i = 0, è¿å 0ï¼ \n// å¶ä¸­å½æ°ä¸­çæä½è½ä¿è¯åå­ï¼ä½å½æ°éè¦æ å¯ä½ç¨\nSystem.out.println(i.accumulateAndGet(-10, (p, x) -> p + x));\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n\n# 4ãåå­å¼ç¨\n\npublic interface DecimalAccount {\n\tBigDecimal getBalance();\n\n\tvoid withdraw(BigDecimal amount);\n\n\t/**\n\t * æ¹æ³åä¼å¯å¨ 1000 ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨å -10 å çæä½    \n     * å¦æåå§ä½é¢ä¸º 10000 é£ä¹æ­£ç¡®çç»æåºå½æ¯ 0\n\t */\n\tstatic void demo(DecimalAccountImpl account) {\n\t\tList<Thread> ts = new ArrayList<>();\n\t\tlong start = System.nanoTime();\n\t\tfor (int i = 0; i < 1000; i++) {\n\t\t\tts.add(new Thread(() -> {\n\t\t\t\taccount.withdraw(BigDecimal.TEN);\n\t\t\t}));\n\t\t}\n\t\tts.forEach(Thread::start);\n\t\tts.forEach(t -> {\n\t\t\ttry {\n\t\t\t\tt.join();\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t});\n\t\tlong end = System.nanoTime();\n\t\tSystem.out.println(account.getBalance() + " cost: " + (end - start) / 1000_000 + " ms");\n\t}\n}\n\nclass DecimalAccountImpl implements DecimalAccount {\n\t//åå­å¼ç¨ï¼æ³åç±»åä¸ºå°æ°ç±»å\n\tAtomicReference<BigDecimal> balance;\n\n\tpublic DecimalAccountImpl(BigDecimal balance) {\n\t\tthis.balance = new AtomicReference<BigDecimal>(balance);\n\t}\n\n\t@Override\n\tpublic BigDecimal getBalance() {\n\t\treturn balance.get();\n\t}\n\n\t@Override\n\tpublic void withdraw(BigDecimal amount) {\n\t\twhile(true) {\n\t\t\tBigDecimal pre = balance.get();\n\t\t\tBigDecimal next = pre.subtract(amount);\n\t\t\tif(balance.compareAndSet(pre, next)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tDecimalAccount.demo(new DecimalAccountImpl(new BigDecimal("10000")));\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n\n\n\n# 5ãABAé®é¢\n\npublic class Demo3 {\n\tstatic AtomicReference<String> str = new AtomicReference<>("A");\n\tpublic static void main(String[] args) {\n\t\tnew Thread(() -> {\n\t\t\tString pre = str.get();\n\t\t\tSystem.out.println("change");\n\t\t\ttry {\n\t\t\t\tother();\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tThread.sleep(1000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\t//æsträ¸­çAæ¹ä¸ºC\n\t\t\tSystem.out.println("change A->C " + str.compareAndSet(pre, "C"));\n\t\t}).start();\n\t}\n\n\tstatic void other() throws InterruptedException {\n\t\tnew Thread(()-> {\n\t\t\tSystem.out.println("change A->B " + str.compareAndSet("A", "B"));\n\t\t}).start();\n\t\tThread.sleep(500);\n\t\tnew Thread(()-> {\n\t\t\tSystem.out.println("change B->A " + str.compareAndSet("B", "A"));\n\t\t}).start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n\n\nä¸»çº¿ç¨ä»è½å¤æ­åºå±äº«åéçå¼ä¸åå¼ A æ¯å¦ç¸åï¼ä¸è½æç¥å°è¿ç§ä» A æ¹ä¸º B å æ¹å A çæåµï¼å¦æä¸»çº¿ç¨å¸æï¼ åªè¦æå¶å®çº¿ç¨ãå¨è¿äºãå±äº«åéï¼é£ä¹èªå·±ç cas å°±ç®å¤±è´¥ï¼è¿æ¶ï¼ä»æ¯è¾å¼æ¯ä¸å¤çï¼éè¦åå ä¸ä¸ªçæ¬å·\n\n\n# AtomicStampedReference\n\npublic class Demo3 {\n\t//æå®çæ¬å·\n\tstatic AtomicStampedReference<String> str = new AtomicStampedReference<>("A", 0);\n\tpublic static void main(String[] args) {\n\t\tnew Thread(() -> {\n\t\t\tString pre = str.getReference();\n\t\t\t//è·å¾çæ¬å·\n\t\t\tint stamp = str.getStamp();\n\t\t\tSystem.out.println("change");\n\t\t\ttry {\n\t\t\t\tother();\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tThread.sleep(1000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\t//æsträ¸­çAæ¹ä¸ºC,å¹¶æ¯å¯¹çæ¬å·ï¼å¦æçæ¬å·ç¸åï¼å°±æ§è¡æ¿æ¢ï¼å¹¶è®©çæ¬å·+1\n\t\t\tSystem.out.println("change A->C stamp " + stamp + str.compareAndSet(pre, "C", stamp, stamp+1));\n\t\t}).start();\n\t}\n\n\tstatic void other() throws InterruptedException {\n\t\tnew Thread(()-> {\n\t\t\tint stamp = str.getStamp();\n\t\t\tSystem.out.println("change A->B stamp " + stamp + str.compareAndSet("A", "B", stamp, stamp+1));\n\t\t}).start();\n\t\tThread.sleep(500);\n\t\tnew Thread(()-> {\n\t\t\tint stamp = str.getStamp();\n\t\t\tSystem.out.println("change B->A stamp " + stamp +  str.compareAndSet("B", "A", stamp, stamp+1));\n\t\t}).start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\n\n\n\n# AtomicMarkableReference\n\nAtomicStampedReference å¯ä»¥ç»åå­å¼ç¨å ä¸çæ¬å·ï¼è¿½è¸ªåå­å¼ç¨æ´ä¸ªçååè¿ç¨ï¼å¦ï¼ A -> B -> A -> C ï¼éè¿AtomicStampedReferenceï¼æä»¬å¯ä»¥ç¥éï¼å¼ç¨åéä¸­éè¢«æ´æ¹äºå æ¬¡ã ä½æ¯ææ¶åï¼å¹¶ä¸å³å¿å¼ç¨åéæ´æ¹äºå æ¬¡ï¼åªæ¯åçº¯çå³å¿æ¯å¦æ´æ¹è¿ï¼æä»¥å°±æäº AtomicMarkableReference\n\npublic class Demo4 {\n\t//æå®çæ¬å·\n\tstatic AtomicMarkableReference<String> str = new AtomicMarkableReference<>("A", true);\n\tpublic static void main(String[] args) {\n\t\tnew Thread(() -> {\n\t\t\tString pre = str.getReference();\n\t\t\tSystem.out.println("change");\n\t\t\ttry {\n\t\t\t\tother();\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tThread.sleep(1000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\t//æsträ¸­çAæ¹ä¸ºC,å¹¶æ¯å¯¹çæ¬å·ï¼å¦æçæ¬å·ç¸åï¼å°±æ§è¡æ¿æ¢ï¼å¹¶è®©çæ¬å·+1\n\t\t\tSystem.out.println("change A->C mark " +  str.compareAndSet(pre, "C", true, false));\n\t\t}).start();\n\t}\n\n\tstatic void other() throws InterruptedException {\n\t\tnew Thread(() -> {\n\t\t\tSystem.out.println("change A->A mark " + str.compareAndSet("A", "A", true, false));\n\t\t}).start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\n\n\n\n# ä¸¤èçåºå«\n\n * AtomicStampedReference éè¦æä»¬ä¼ å¥æ´ååéä½ä¸ºçæ¬å·ï¼æ¥å¤å®æ¯å¦è¢«æ´æ¹è¿\n * AtomicMarkableReferenceéè¦æä»¬ä¼ å¥å¸å°åéä½ä¸ºæ è®°ï¼æ¥å¤æ­æ¯å¦è¢«æ´æ¹è¿\n\n\n# 6ãåå­æ°ç»\n\n * AtomicIntegerArray\n * AtomicLongArray\n * AtomicReferenceArray\n\n\n# lambaè¡¨è¾¾å¼çä½¿ç¨\n\n * æä¾è\n   * æ ååè¿å\n   * ()->è¿åç»æ\n * æ¹æ³\n   * æåæè¿å\n   * (åæ°ä¸â¦)->è¿åç»æ\n * æ¶è´¹è\n   * æåæ è¿å\n   * (åæ°ä¸â¦)->void\n\n\n# 7ãåå­æ´æ°å¨\n\n * AtomicReferenceFieldUpdater // å å­æ®µ\n * AtomicIntegerFieldUpdater\n * AtomicLongFieldUpdate\n\nåå­æ´æ°å¨ç¨äºå¸®å©æä»¬æ¹åæä¸ªå¯¹è±¡ä¸­çæä¸ªå±æ§\n\npublic class Demo1 {\n   public static void main(String[] args) {\n      Student student = new Student();\n       \n      // è·å¾åå­æ´æ°å¨\n      // æ³å\n      // åæ°1 ææå±æ§çç±» åæ°2 è¢«æ´æ°çå±æ§çç±»\n      // newUpdaterä¸­çåæ°ï¼ç¬¬ä¸ä¸ªä¸ºå±æ§çåç§°\n      AtomicReferenceFieldUpdater<Student, String> updater = AtomicReferenceFieldUpdater.newUpdater(Student.class, String.class, "name");\n       \n      // ä¿®æ¹\n      updater.compareAndSet(student, null, "Nyima");\n      System.out.println(student);\n   }\n}\n\nclass Student {\n   volatile String name;\n\n   @Override\n   public String toString() {\n      return "Student{" +\n            "name=\'" + name + \'\\\'\' +\n            \'}\';\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n\n# åå­æ´æ°å¨åå§åè¿ç¨\n\nä»ä¸é¢çä¾å­å¯ä»¥çåºï¼åå­æ´æ°å¨æ¯éè¿newUpdateræ¥è·åå®ä¾çãå¶ä¸­ä¼ å¥äºä¸ä¸ªåæ°\n\n * æ¥æå±æ§çç±»çClass\n * å±æ§çClass\n * å±æ§çåç§°\n\nå¤§æ¦å¯ä»¥çåºæ¥ï¼åå§åè¿ç¨ç¨å°äºåå°ï¼è®©æä»¬ççæºç æ¥éªè¯ä¸ä¸è¿ä¸ªçæµã\n\n# newUpdateræ¹æ³\n\npublic static <U,W> AtomicReferenceFieldUpdater<U,W> newUpdater(Class<U> tclass,\n                                                                Class<W> vclass,\n                                                                String fieldName) {\n    // è¿åäºä¸ä¸ªAtomicReferenceFieldUpdaterImplå®ä¾\n    return new AtomicReferenceFieldUpdaterImpl<U,W>\n        (tclass, vclass, fieldName, Reflection.getCallerClass());\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä»newUpdateræ¹æ³è¿å¹¶ä¸è½çåºæ¥å·ä½çåå§åè¿ç¨\n\n# åé¨å®ç°ç±»\n\n\n\nAtomicReferenceFieldUpdaterä¸ºæ½è±¡ç±»ï¼è¯¥ç±»åé¨æä¸ä¸ªèªå·±çå®ç°ç±»AtomicReferenceFieldUpdaterImpl\n\nprivate static final class AtomicReferenceFieldUpdaterImpl<T,V>\n        extends AtomicReferenceFieldUpdater<T,V>\n\n\n1\n2\n\n\n\n\næé æ¹æ³\n\nAtomicReferenceFieldUpdaterImpl(final Class<T> tclass,\n                                final Class<V> vclass,\n                                final String fieldName,\n                                final Class<?> caller) {\n    // ç¨äºä¿å­è¦è¢«ä¿®æ¹çå±æ§\n    final Field field;\n    \n    // å±æ§çClass\n    final Class<?> fieldClass;\n    \n    // fieldçä¿®é¥°ç¬¦\n    final int modifiers;\n    try {\n        // åå°è·å¾å±æ§\n        field = AccessController.doPrivileged(\n            new PrivilegedExceptionAction<Field>() {\n                public Field run() throws NoSuchFieldException {\n                    // tclassä¸ºä¼ å¥çå±æ§çClassï¼å¯ä»¥éè¿å®æ¥è·å¾å±æ§\n                    return tclass.getDeclaredField(fieldName);\n                }\n            });\n        \n        // è·å¾å±æ§çä¿®é¥°ç¬¦ï¼ä¸»è¦ç¨äºå¤æ­\n        // 1ãvclass ä¸ å±æ§ç¡®åçç±»åæ¯å¦å¹é\n        // 2ãæ¯å¦ä¸ºå¼ç¨ç±»å\n        // 3ãè¢«ä¿®æ¹çå±æ§æ¯å¦å äºvolatileå³é®å­\n        modifiers = field.getModifiers();\n        sun.reflect.misc.ReflectUtil.ensureMemberAccess(\n            caller, tclass, null, modifiers);\n        ClassLoader cl = tclass.getClassLoader();\n        ClassLoader ccl = caller.getClassLoader();\n        if ((ccl != null) && (ccl != cl) &&\n            ((cl == null) || !isAncestor(cl, ccl))) {\n            sun.reflect.misc.ReflectUtil.checkPackageAccess(tclass);\n        }\n        \n        // è·å¾å±æ§ç±»çClass\n        fieldClass = field.getType();\n    } catch (PrivilegedActionException pae) {\n        throw new RuntimeException(pae.getException());\n    } catch (Exception ex) {\n        throw new RuntimeException(ex);\n    }\n\n    if (vclass != fieldClass)\n        throw new ClassCastException();\n    if (vclass.isPrimitive())\n        throw new IllegalArgumentException("Must be reference type");\n\n    if (!Modifier.isVolatile(modifiers))\n        throw new IllegalArgumentException("Must be volatile type");\n\n    // Access to protected field members is restricted to receivers only\n    // of the accessing class, or one of its subclasses, and the\n    // accessing class must in turn be a subclass (or package sibling)\n    // of the protected member\'s defining class.\n    // If the updater refers to a protected field of a declaring class\n    // outside the current package, the receiver argument will be\n    // narrowed to the type of the accessing class.\n \t// å¯¹ç±»ä¸­çå±æ§è¿è¡åå§å\n    this.cclass = (Modifier.isProtected(modifiers) &&\n                   tclass.isAssignableFrom(caller) &&\n                   !isSamePackage(tclass, caller))\n                  ? caller : tclass;\n    this.tclass = tclass;\n    this.vclass = vclass;\n    // è·å¾åç§»é\n    this.offset = U.objectFieldOffset(field);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n\n\nå¯ä»¥çåºï¼åå­å¼ç¨æ´æ°å¨ç¡®å®ä½¿ç¨äºåå°\n\n\n# 8ãLongAdderåç\n\n\n# åçä¹ä¼ªå±äº«\n\n\n\nç¼å­è¡ä¼ªå±äº«å¾ä»ç¼å­è¯´èµ· ç¼å­ä¸åå­çéåº¦æ¯è¾\n\n\n\n\n\nå ä¸º CPU ä¸ åå­çéåº¦å·®å¼å¾å¤§ï¼éè¦é é¢è¯»æ°æ®è³ç¼å­æ¥æåæçã èç¼å­ä»¥ç¼å­è¡ä¸ºåä½ï¼æ¯ä¸ªç¼å­è¡å¯¹åºçä¸ååå­ï¼ä¸è¬æ¯ 64 byteï¼8 ä¸ª longï¼ ç¼å­çå å¥ä¼é ææ°æ®å¯æ¬çäº§çï¼å³åä¸ä»½æ°æ®ä¼ç¼å­å¨ä¸åæ ¸å¿çç¼å­è¡ä¸­ CPU è¦ä¿è¯æ°æ®çä¸è´æ§ï¼å¦ææä¸ª CPU æ ¸å¿æ´æ¹äºæ°æ®ï¼å¶å® CPU æ ¸å¿å¯¹åºçæ´ä¸ªç¼å­è¡å¿é¡»å¤±æ\n\n\n\nå ä¸º Cell æ¯æ°ç»å½¢å¼ï¼å¨åå­ä¸­æ¯è¿ç»­å­å¨çï¼ä¸ä¸ª Cell ä¸º 24 å­èï¼16 å­èçå¯¹è±¡å¤´å 8 å­èç valueï¼ï¼å  æ­¤ç¼å­è¡å¯ä»¥å­ä¸ 2 ä¸ªç Cell å¯¹è±¡ãè¿æ ·é®é¢æ¥äºï¼\n\n * Core-0 è¦ä¿®æ¹ Cell[0]\n * Core-1 è¦ä¿®æ¹ Cell[1]\n\næ è®ºè°ä¿®æ¹æåï¼é½ä¼å¯¼è´å¯¹æ¹ Core çç¼å­è¡å¤±æï¼\n\næ¯å¦ Core-0 ä¸­ Cell[0]=6000, Cell[1]=8000 è¦ç´¯å  Cell[0]=6001, Cell[1]=8000 ï¼è¿æ¶ä¼è®© Core-1 çç¼å­è¡å¤±æ\n\n@sun.misc.Contended ç¨æ¥è§£å³è¿ä¸ªé®é¢ï¼å®çåçæ¯å¨ä½¿ç¨æ­¤æ³¨è§£çå¯¹è±¡æå­æ®µçåååå¢å  128 å­èå¤§å°ç paddingï¼ç©ºç½ï¼ï¼ä»èè®© CPU å°å¯¹è±¡é¢è¯»è³ç¼å­æ¶å ç¨ä¸åçç¼å­è¡ï¼è¿æ ·ï¼ä¸ä¼é æå¯¹æ¹ç¼å­è¡çå¤±æ\n\n\n\nç´¯å ä¸»è¦è°ç¨ä»¥ä¸æ¹æ³\n\npublic void add(long x) {\n       Cell[] as; long b, v; int m; Cell a;\n       if ((as = cells) != null || !casBase(b = base, b + x)) {\n           boolean uncontended = true;\n           if (as == null || (m = as.length - 1) < 0 ||\n               (a = as[getProbe() & m]) == null ||\n               !(uncontended = a.cas(v = a.value, v + x)))\n               longAccumulate(x, null, uncontended);\n       }\n   }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç´¯å æµç¨å¾\n\n\n\n\n# 9ãUnsafe\n\nUnsafe å¯¹è±¡æä¾äºéå¸¸åºå±çï¼æä½åå­ãçº¿ç¨çæ¹æ³ï¼Unsafe å¯¹è±¡ä¸è½ç´æ¥è°ç¨ï¼åªè½éè¿åå°è·å¾\n\npublic class GetUnsafe {\n\tpublic static void main(String[] args) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException, NoSuchFieldException {\n\t\t// éè¿åå°è·å¾Unsafeå¯¹è±¡\n\t\tClass unsafeClass = Unsafe.class;\n\t\t// è·å¾æé å½æ°ï¼Unsafeçæé å½æ°ä¸ºç§æç\n\t\tConstructor constructor = unsafeClass.getDeclaredConstructor();\n\t\t// è®¾ç½®ä¸ºåè®¸è®¿é®ç§æåå®¹\n\t\tconstructor.setAccessible(true);\n\t\t// åå»ºUnsafeå¯¹è±¡\n\t\tUnsafe unsafe = (Unsafe) constructor.newInstance();\n\t\t\n\t\t// åå»ºPersonå¯¹è±¡\n\t\tPerson person = new Person();\n\t\t// è·å¾å¶å±æ§ name çåç§»é\n\t\tField field = Person.class.getDeclaredField("name");\n\t\tlong offset = unsafe.objectFieldOffset(field);\n\n\t\t// éè¿unsafeçCASæä½æ¹åå¼\n\t\tunsafe.compareAndSwapObject(person, offset, null, "Nyima");\n\t\tSystem.out.println(person);\n\t}\n}\n\nclass Person {\n    // éåCASæä½ï¼å¿é¡»ç¨volatileä¿®é¥°\n \tvolatile String name;\n\n\n\t@Override\n\tpublic String toString() {\n\t\treturn "Person{" +\n\t\t\t\t"name=\'" + name + \'\\\'\' +\n\t\t\t\t\'}\';\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\n\n# å­ãå±äº«æ¨¡åä¹ä¸å¯å\n\n\n# 1ãä¸å¯å\n\nå¦æä¸ä¸ªå¯¹è±¡å¨ä¸è½å¤ä¿®æ¹å¶åé¨ç¶æï¼å±æ§ï¼ï¼é£ä¹å®å°±æ¯çº¿ç¨å®å¨çï¼å ä¸ºä¸å­å¨å¹¶åä¿®æ¹ã\n\n\n# 2ãä¸å¯åè®¾è®¡\n\n# Stringç±»ä¸­ä¸å¯åçä½ç°\n\npublic final class String\n    implements java.io.Serializable, Comparable<String>, CharSequence {\n    /** The value is used for character storage. */\n    private final char value[];\n\n    /** Cache the hash code for the string */\n    private int hash; // Default to 0\n    \n   //....\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nï¬nal çä½¿ç¨ * åç°è¯¥ç±»ãç±»ä¸­ææå±æ§é½æ¯ *ï¬nal ç\n\n * å±æ§ç¨ ï¬nal ä¿®é¥°ä¿è¯äºè¯¥å±æ§æ¯åªè¯»çï¼ä¸è½ä¿®æ¹\n * ç±»ç¨ ï¬nal ä¿®é¥°ä¿è¯äºè¯¥ç±»ä¸­çæ¹æ³ä¸è½è¢«è¦çï¼é²æ­¢å­ç±»æ æé´ç ´åä¸å¯åæ§\n\n**ä¿æ¤æ§æ·è´ **\n\nä½æåå­¦ä¼è¯´ï¼ä½¿ç¨å­ç¬¦ä¸²æ¶ï¼ä¹æä¸äºè·ä¿®æ¹ç¸å³çæ¹æ³åï¼æ¯å¦ substring ç­ï¼é£ä¹ä¸é¢å°±çä¸çè¿äºæ¹æ³æ¯ å¦ä½å®ç°çï¼å°±ä»¥ substring ä¸ºä¾\n\npublic String substring(int beginIndex) {\n        if (beginIndex < 0) {\n            throw new StringIndexOutOfBoundsException(beginIndex);\n        }\n        int subLen = value.length - beginIndex;\n        if (subLen < 0) {\n            throw new StringIndexOutOfBoundsException(subLen);\n        }\n    \t//è¿åçæ¯ä¸ä¸ªæ°çå¯¹è±¡\n        return (beginIndex == 0) ? this : new String(value, beginIndex, subLen);\n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nåç°å¶åé¨æ¯è°ç¨ String çæé æ¹æ³åå»ºäºä¸ä¸ªæ°å­ç¬¦ä¸²\n\npublic String(char value[], int offset, int count) {\n        if (offset < 0) {\n            throw new StringIndexOutOfBoundsException(offset);\n        }\n        if (count <= 0) {\n            if (count < 0) {\n                throw new StringIndexOutOfBoundsException(count);\n            }\n            if (offset <= value.length) {\n                this.value = "".value;\n                return;\n            }\n        }\n        // Note: offset or count might be near -1>>>1.\n        if (offset > value.length - count) {\n            throw new StringIndexOutOfBoundsException(offset + count);\n        }\n        this.value = Arrays.OfRange(value, offset, offset+count);\n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næé æ°å­ç¬¦ä¸²å¯¹è±¡æ¶ï¼ä¼çææ°ç char[] valueï¼å¯¹åå®¹è¿è¡å¤å¶ ãè¿ç§éè¿åå»ºå¯æ¬å¯¹è±¡æ¥é¿åå±äº«çææ®µç§°ä¹ä¸ºãä¿æ¤æ§æ·è´ï¼defensive ï¼ã\n\n\n# ä¸ãçº¿ç¨æ± \n\n\n# 1ãèªå®ä¹çº¿ç¨æ± \n\n\n# å¾è§£\n\n\n\n * é»å¡éåä¸­ç»´æ¤äºç±ä¸»çº¿ç¨ï¼æèå¶ä»çº¿ç¨ï¼æäº§çççä»»å¡\n * ä¸»çº¿ç¨ç±»ä¼¼äºçäº§èï¼äº§çä»»å¡å¹¶æ¾å¥é»å¡éåä¸­\n * çº¿ç¨æ± ç±»ä¼¼äºæ¶è´¹èï¼å¾å°é»å¡éåä¸­å·²æçä»»å¡å¹¶æ§è¡\n\n\n# ä»£ç \n\npublic class Demo3 {\n   public static void main(String[] args) {\n      ThreadPool threadPool = new ThreadPool(2,  TimeUnit.SECONDS, 1, 4);\n      for (int i = 0; i < 10; i++) {\n         threadPool.execute(()->{\n            try {\n               TimeUnit.SECONDS.sleep(10000);\n            } catch (InterruptedException e) {\n               e.printStackTrace();\n            }\n            System.out.println("ä»»å¡æ­£å¨æ§è¡!");\n         });\n      }\n   }\n}\n\n\n/**\n * èªå®ä¹çº¿ç¨æ± \n */\nclass ThreadPool {\n   /**\n    * èªå®ä¹é»å¡éå\n    */\n   private BlockingQueue<Runnable> blockingQueue;\n\n   /**\n    * æ ¸å¿çº¿ç¨æ°\n    */\n   private int coreSize;\n\n   private HashSet<Worker> workers = new HashSet<>();\n\n   /**\n    * ç¨äºæå®çº¿ç¨æå¤§å­æ´»æ¶é´\n    */\n   private TimeUnit timeUnit;\n   private long timeout;\n\n   /**\n    * å·¥ä½çº¿ç¨ç±»\n    * åé¨å°è£äºThreadç±»ï¼å¹¶ä¸æ·»å äºä¸äºå±æ§\n    */\n   private class Worker extends Thread {\n      Runnable task;\n\n      public Worker(Runnable task) {\n         System.out.println("åå§åä»»å¡");\n         this.task = task;\n      }\n\n      @Override\n      public void run() {\n         // å¦ææä»»å¡å°±æ§è¡\n         // å¦æé»å¡éåä¸­æä»»å¡ï¼å°±ç»§ç»­æ§è¡\n         while (task != null || (task = blockingQueue.take()) != null) {\n            try {\n               System.out.println("æ§è¡ä»»å¡");\n               task.run();\n            } catch (Exception e) {\n               e.printStackTrace();\n            } finally {\n               // ä»»å¡æ§è¡å®æ¯ï¼è®¾ä¸ºç©º\n               System.out.println("ä»»å¡æ§è¡å®æ¯");\n               task = null;\n            }\n         }\n         // ç§»é¤ä»»å¡\n         synchronized (workers) {\n            System.out.println("ç§»é¤ä»»å¡");\n            workers.remove(this);\n         }\n      }\n   }\n\n   public ThreadPool(int coreSize, TimeUnit timeUnit, long timeout, int capacity) {\n      this.coreSize = coreSize;\n      this.timeUnit = timeUnit;\n      blockingQueue = new BlockingQueue<>(capacity);\n      this.timeout = timeout;\n   }\n\n   public void execute(Runnable task) {\n      synchronized (workers) {\n         // åå»ºä»»å¡\n         // æ± ä¸­è¿æç©ºä½çº¿ç¨æ¶ï¼å¯ä»¥è¿è¡ä»»å¡\n         // å¦åé»å¡\n         if (workers.size() < coreSize) {\n            Worker worker = new Worker(task);\n            workers.add(worker);\n            worker.start();\n         } else {\n            System.out.println("çº¿ç¨æ± ä¸­çº¿ç¨å·²ç¨å®ï¼è¯·ç¨ç­");\n            blockingQueue.put(task);\n         }\n      }\n   }\n}\n\n/**\n * é»å¡éå\n * ç¨äºå­æ¾ä¸»çº¿ç¨æå¶ä»çº¿ç¨äº§ççä»»å¡\n */\nclass BlockingQueue<T> {\n   /**\n    * é»å¡éå\n    */\n   private  Deque<T> blockingQueue;\n\n   /**\n    * é»å¡éåå®¹é\n    */\n   private int capacity;\n\n   /**\n    * é\n    */\n   private ReentrantLock lock;\n\n   /**\n    * æ¡ä»¶éå\n    */\n   private Condition fullQueue;\n   private Condition emptyQueue;\n\n\n   public BlockingQueue(int capacity) {\n      blockingQueue = new ArrayDeque<>(capacity);\n      lock = new ReentrantLock();\n      fullQueue = lock.newCondition();\n      emptyQueue = lock.newCondition();\n      this.capacity = capacity;\n   }\n\n   /**\n    * è·åä»»å¡çæ¹æ³\n    */\n   public T take() {\n      // å é\n      lock.lock();\n      try {\n         // å¦æé»å¡éåä¸ºç©ºï¼æ²¡æä»»å¡ï¼ï¼å°±ä¸ç´ç­å¾\n         while (blockingQueue.isEmpty()) {\n            try {\n               emptyQueue.await();\n            } catch (InterruptedException e) {\n               e.printStackTrace();\n            }\n         }\n         // è·åä»»å¡å¹¶å¤éçäº§èçº¿ç¨\n         T task = blockingQueue.removeFirst();\n         fullQueue.signalAll();\n         return task;\n      } finally {\n         lock.unlock();\n      }\n   }\n\n   public T takeNanos(long timeout, TimeUnit unit) {\n      // è½¬æ¢ç­å¾æ¶é´\n      lock.lock();\n      try {\n         long nanos = unit.toNanos(timeout);\n         while (blockingQueue.isEmpty()) {\n            try {\n               // awaitNanosä¼è¿åå©ä¸çç­å¾æ¶é´\n               nanos = emptyQueue.awaitNanos(nanos);\n               if (nanos < 0) {\n                  return null;\n               }\n            } catch (InterruptedException e) {\n               e.printStackTrace();\n            }\n         }\n         T task = blockingQueue.removeFirst();\n         fullQueue.signalAll();\n         return task;\n      } finally {\n         lock.unlock();\n      }\n   }\n\n   /**\n    * æ¾å¥ä»»å¡çæ¹æ³\n    * @param task æ¾å¥é»å¡éåçä»»å¡\n    */\n   public void put(T task) {\n      lock.lock();\n      try {\n         while (blockingQueue.size() == capacity) {\n            try {\n               System.out.println("é»å¡éåå·²æ»¡");\n               fullQueue.await();\n            } catch (InterruptedException e) {\n               e.printStackTrace();\n            }\n         }\n         blockingQueue.add(task);\n         // å¤éç­å¾çæ¶è´¹è\n         emptyQueue.signalAll();\n      } finally {\n         lock.unlock();\n      }\n   }\n\n   public int getSize() {\n      lock.lock();\n      try {\n         return blockingQueue.size();\n      } finally {\n         lock.unlock();\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n143\n144\n145\n146\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n163\n164\n165\n166\n167\n168\n169\n170\n171\n172\n173\n174\n175\n176\n177\n178\n179\n180\n181\n182\n183\n184\n185\n186\n187\n188\n189\n190\n191\n192\n193\n194\n195\n196\n197\n198\n199\n200\n201\n202\n203\n204\n205\n206\n207\n208\n209\n210\n211\n212\n213\n214\n\n\nå®ç°äºä¸ä¸ªç®åççº¿ç¨æ± \n\n * é»å¡éåBlockingQueueç¨äºæå­æ¥ä¸åè¢«çº¿ç¨æ§è¡çä»»å¡\n   * ä¹å¯ä»¥è¯´æ¯å¹³è¡¡çäº§èåæ¶è´¹èæ§è¡éåº¦ä¸çå·®å¼\n   * éé¢çè·åä»»å¡åæ¾å¥ä»»å¡ç¨å°äºçäº§èæ¶è´¹èæ¨¡å¼\n * çº¿ç¨æ± ä¸­å¯¹çº¿ç¨Threadè¿è¡äºåæ¬¡çå°è£ï¼å°è£ä¸ºäºWorker\n   * å¨è°ç¨ä»»å¡çrunæ¹æ³æ¶ï¼çº¿ç¨ä¼å»æ§è¡è¯¥ä»»å¡ï¼æ§è¡å®æ¯åè¿ä¼å°é»å¡éåä¸­è·åæ°ä»»å¡æ¥æ§è¡\n * çº¿ç¨æ± ä¸­æ§è¡ä»»å¡çä¸»è¦æ¹æ³ä¸ºexecuteæ¹æ³\n   * æ§è¡æ¶è¦å¤æ­æ­£å¨æ§è¡ççº¿ç¨æ°æ¯å¦å¤§äºäºçº¿ç¨æ± å®¹é\n\n\n# 2ãThreadPoolExecutor\n\n\n# ç»§æ¿å³ç³»\n\n\n\n\n# çº¿ç¨æ± ç¶æ\n\n// çº¿ç¨æ± ç¶æ\n// runState is stored in the high-order bits\n// RUNNING é«3ä½ä¸º111\nprivate static final int RUNNING    = -1 << COUNT_BITS;\n\n// SHUTDOWN é«3ä½ä¸º000\nprivate static final int SHUTDOWN   =  0 << COUNT_BITS;\n\n// é«3ä½ 001\nprivate static final int STOP       =  1 << COUNT_BITS;\n\n// é«3ä½ 010\nprivate static final int TIDYING    =  2 << COUNT_BITS;\n\n// é«3ä½ 011\nprivate static final int TERMINATED =  3 << COUNT_BITS;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nç¶æåç§°         é«3ä½çå¼   æè¿°\nRUNNING      111     æ¥æ¶æ°ä»»å¡ï¼åæ¶å¤çä»»å¡éåä¸­çä»»å¡\nSHUTDOWN     000     ä¸æ¥åæ°ä»»å¡ï¼ä½æ¯å¤çä»»å¡éåä¸­çä»»å¡\nSTOP         001     ä¸­æ­æ­£å¨æ§è¡çä»»å¡ï¼åæ¶æå¼é»å¡éåä¸­çä»»å¡\nTIDYING      010     ä»»å¡æ§è¡å®æ¯ï¼æ´»å¨çº¿ç¨ä¸º0æ¶ï¼å³å°è¿å¥ç»ç»é¶æ®µ\nTERMINATED   011     ç»ç»ç¶æ\n\nçº¿ç¨æ± ç¶æåçº¿ç¨æ± ä¸­çº¿ç¨çæ°éç±ä¸ä¸ªåå­æ´åctlæ¥å±åè¡¨ç¤º\n\n * ä½¿ç¨ä¸ä¸ªæ°æ¥è¡¨ç¤ºä¸¤ä¸ªå¼çä¸»è¦åå æ¯ï¼å¯ä»¥éè¿ä¸æ¬¡CASåæ¶æ´æ¹ä¸¤ä¸ªå±æ§çå¼\n\n// åå­æ´æ°ï¼å3ä½ä¿å­äºçº¿ç¨æ± çç¶æï¼å©ä½ä½ä¿å­çæ¯çº¿ç¨æ°é\nprivate final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));\n\n// å¹¶ä¸æ¯ææå¹³å°çinté½æ¯32ä½ã\n// å»æåä¸ä½ä¿å­çº¿ç¨ç¶æçä½æ°ï¼å©ä¸çç¨äºä¿å­çº¿ç¨æ°é\n// é«3ä½ä¸º0ï¼å©ä½ä½æ°å¨ä¸º1\nprivate static final int COUNT_BITS = Integer.SIZE - 3;\n\n// 2^COUNT_BITSæ¬¡æ¹ï¼è¡¨ç¤ºå¯ä»¥ä¿å­çæå¤§çº¿ç¨æ°\n// CAPACITY çé«3ä½ä¸º 0\nprivate static final int CAPACITY   = (1 << COUNT_BITS) - 1;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nè·åçº¿ç¨æ± ç¶æãçº¿ç¨æ°éä»¥ååå¹¶ä¸¤ä¸ªå¼çæä½\n\n// Packing and unpacking ctl\n// è·åè¿è¡ç¶æ\n// è¯¥æä½ä¼è®©é¤é«3ä½ä»¥å¤çæ°å¨é¨åä¸º0\nprivate static int runStateOf(int c)     { return c & ~CAPACITY; }\n\n// è·åè¿è¡çº¿ç¨æ°\n// è¯¥æä½ä¼è®©é«3ä½ä¸º0\nprivate static int workerCountOf(int c)  { return c & CAPACITY; }\n\n// è®¡ç®ctlæ°å¼\nprivate static int ctlOf(int rs, int wc) { return rs | wc; }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# çº¿ç¨æ± å±æ§\n\n// å·¥ä½çº¿ç¨ï¼åé¨å°è£äºThread\nprivate final class Worker\n        extends AbstractQueuedSynchronizer\n        implements Runnable {\n    ...\n}\n\n// é»å¡éåï¼ç¨äºå­æ¾æ¥ä¸åè¢«æ ¸å¿çº¿ç¨æ§è¡çä»»å¡\nprivate final BlockingQueue<Runnable> workQueue;\n\n// é\nprivate final ReentrantLock mainLock = new ReentrantLock();\n\n//  ç¨äºå­æ¾æ ¸å¿çº¿ç¨çå®¹å¨ï¼åªæå½ææéæ¶æè½å¤è·åå¶ä¸­çåç´ ï¼æ ¸å¿çº¿ç¨ï¼\nprivate final HashSet<Worker> workers = new HashSet<Worker>();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# æé æ¹æ³æå¶åæ°\n\nThreadPoolExecutoræå¨é¢çæé æ¹æ³\n\nä¹æ¯æé èªå®ä¹çº¿ç¨æ± çæ¹æ³\n\npublic ThreadPoolExecutor(int corePoolSize,\n                          int maximumPoolSize,\n                          long keepAliveTime,\n                          TimeUnit unit,\n                          BlockingQueue<Runnable> workQueue,\n                          ThreadFactory threadFactory,\n                          RejectedExecutionHandler handler)\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# åæ°è§£é\n\n * corePoolSizeï¼æ ¸å¿çº¿ç¨æ°\n * maximumPoolSizeï¼æå¤§çº¿ç¨æ°\n   * maximumPoolSize - corePoolSize = ææ¥çº¿ç¨æ°\n * keepAliveTimeï¼ææ¥çº¿ç¨ç©ºé²æ¶çæå¤§çå­æ¶é´\n * unitï¼æ¶é´åä½\n * workQueueï¼é»å¡éåï¼å­æ¾ä»»å¡ï¼\n   * æçé»å¡éå ArrayBlockingQueue\n   * æ çé»å¡éå LinkedBlockingQueue\n   * æå¤åªæä¸ä¸ªåæ­¥åç´ ç SynchronousQueue\n   * ä¼åéå PriorityBlockingQueue\n * threadFactoryï¼çº¿ç¨å·¥åï¼ç»çº¿ç¨ååå­ï¼\n * handlerï¼æç»ç­ç¥\n\n# å·¥ä½æ¹å¼\n\n * å½ä¸ä¸ªä»»å¡ä¼ ç»çº¿ç¨æ± ä»¥åï¼å¯è½æä»¥ä¸å ç§å¯è½\n   * å°ä»»å¡åéç»ä¸ä¸ªæ ¸å¿çº¿ç¨æ¥æ§è¡\n   * æ ¸å¿çº¿ç¨é½å¨æ§è¡ä»»å¡ï¼å°ä»»å¡æ¾å°é»å¡éåworkQueueä¸­ç­å¾è¢«æ§è¡\n   * é»å¡éåæ»¡äºï¼ä½¿ç¨ææ¥çº¿ç¨æ¥æ§è¡ä»»å¡\n     * ææ¥çº¿ç¨ç¨å®ä»¥åï¼è¶è¿çå­æ¶é´ï¼keepAliveTimeï¼åä¼è¢«éæ¾\n   * ä»»å¡æ»æ°å¤§äºäº æå¤§çº¿ç¨æ°ï¼maximumPoolSizeï¼ä¸é»å¡éåå®¹éçæå¤§å¼ï¼workQueue.capacityï¼ï¼ä½¿ç¨ææ¥ç­ç¥\n\n# æç»ç­ç¥\n\nå¦æçº¿ç¨å°è¾¾ maximumPoolSize ä»ç¶ææ°ä»»å¡è¿æ¶ä¼æ§è¡æç»ç­ç¥ãæç»ç­ç¥ jdk æä¾äº 4 ç§å®ç°\n\n\n\n * AbortPolicyï¼è®©è°ç¨èæåº RejectedExecutionException å¼å¸¸ï¼è¿æ¯é»è®¤ç­ç¥\n * CallerRunsPolicyï¼è®©è°ç¨èè¿è¡ä»»å¡\n * DiscardPolicyï¼æ¾å¼æ¬æ¬¡ä»»å¡\n * DiscardOldestPolicyï¼æ¾å¼éåä¸­ææ©çä»»å¡ï¼æ¬ä»»å¡åèä»£ä¹\n\n# ä½¿ç¨\n\npublic class Demo1 {\n   static AtomicInteger threadId = new AtomicInteger(0);\n\n   public static void main(String[] args) {\n      // æå¨åå»ºçº¿ç¨æ± \n      // åå»ºæçé»å¡éå\n      ArrayBlockingQueue<Runnable> runnable = new ArrayBlockingQueue<Runnable>(10);\n      // åå»ºçº¿ç¨å·¥å\n      ThreadFactory threadFactory = new ThreadFactory() {\n         @Override\n         public Thread newThread(Runnable r) {\n            Thread thread = new Thread(r, "working_thread_"+threadId.getAndIncrement());\n            return thread;\n         }\n      };\n\n      // æå¨åå»ºçº¿ç¨æ± \n      // æç»ç­ç¥éç¨é»è®¤ç­ç¥\n      ThreadPoolExecutor executor = new ThreadPoolExecutor(5, 7, 10, TimeUnit.SECONDS, runnable, threadFactory);\n\n      for (int i = 0; i < 20; i++) {\n         executor.execute(new Runnable() {\n            @Override\n            public void run() {\n               System.out.println(Thread.currentThread());\n               try {\n                  Thread.sleep(100000);\n               } catch (InterruptedException e) {\n                  e.printStackTrace();\n               }\n            }\n         });\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\n\n# FixedThreadPool\n\npublic class TestFixedThreadPool {\n   public static void main(String[] args) {\n      // èªå®ä¹çº¿ç¨å·¥å\n      ThreadFactory factory = new ThreadFactory() {\n         AtomicInteger atomicInteger = new AtomicInteger(1);\n\n         @Override\n         public Thread newThread(Runnable r) {\n            return new Thread(r, "myThread_" + atomicInteger.getAndIncrement());\n         }\n      };\n\n      // åå»ºæ ¸å¿çº¿ç¨æ°éä¸º2ççº¿ç¨æ± \n      // éè¿ ThreadFactoryå¯ä»¥ç»çº¿ç¨æ·»å åå­\n\n      ExecutorService executorService = Executors.newFixedThreadPool(2, factory);\n\n      // ä»»å¡\n      Runnable runnable = new Runnable() {\n         @Override\n         public void run() {\n            System.out.println(Thread.currentThread().getName());\n            System.out.println("this is fixedThreadPool");\n         }\n      };\n      \n      executorService.execute(runnable);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nåºå®å¤§å°ççº¿ç¨æ± å¯ä»¥ä¼ å¥ä¸¤ä¸ªåæ°\n\n * æ ¸å¿çº¿ç¨æ°ï¼nThreads\n * çº¿ç¨å·¥åï¼threadFactory\n\nåé¨è°ç¨çæé æ¹æ³\n\nThreadPoolExecutor(nThreads, nThreads,\n                              0L, TimeUnit.MILLISECONDS,\n                              new LinkedBlockingQueue<Runnable>(),\n                              threadFactory);\n\n\n1\n2\n3\n4\n\n\n\n# CachedThreadPool\n\nExecutorService executorService = Executors.newCachedThreadPool();\n\n\n1\n\n\nåé¨æé æ¹æ³\n\nThreadPoolExecutor(0, Integer.MAX_VALUE,\n                              60L, TimeUnit.SECONDS,\n                              new SynchronousQueue<Runnable>());\n\n\n1\n2\n3\n\n\n * æ²¡ææ ¸å¿çº¿ç¨ï¼æå¤§çº¿ç¨æ°ä¸ºInteger.MAX_VALUEï¼ææåå»ºççº¿ç¨é½æ¯ææ¥çº¿ç¨ï¼ç©ºé²æ¶çå­æ¶é´ä¸º60ç§\n\n * é»å¡éåä½¿ç¨çæ¯SynchronousQueue\n   \n   * SynchronousQueue\n     \n     æ¯ä¸ç§ç¹æ®çéå\n     \n     * æ²¡æå®¹éï¼æ²¡æçº¿ç¨æ¥åæ¯æ¾ä¸è¿å»ç\n     * åªæå½çº¿ç¨åä»»å¡æ¶ï¼æä¼å°ä»»å¡æ¾å¥è¯¥é»å¡éåä¸­\n\n\n# SingleThread\n\nExecutorService service = Executors.newSingleThreadExecutor();\n\n\n1\n\n\nåé¨æé æ¹æ³\n\nnew FinalizableDelegatedExecutorService\n    (new ThreadPoolExecutor(1, 1,\n                            0L, TimeUnit.MILLISECONDS,\n                            new LinkedBlockingQueue<Runnable>()));\n\n\n1\n2\n3\n4\n\n\nåé¨è°ç¨äºnew ThreadPoolExecutorçæé æ¹æ³ï¼ä¼ å¥çcorePoolSizeåmaximumPoolSizeé½ä¸º1ãç¶åå°è¯¥å¯¹è±¡ä¼ ç»äºFinalizableDelegatedExecutorServiceãè¯¥ç±»ä¿®é¥°äºThreadPoolExecutorï¼è®©å¤é¨æ æ³è°ç¨ThreadPoolExecutoråé¨çæäºæ¹æ³æ¥ä¿®æ¹æåå»ºççº¿ç¨æ± çå¤§å°ã\n\n# å ä¸ªæ³¨æ\n\n * SingleThreadåèªå·±åå»ºä¸ä¸ªçº¿ç¨æ¥è¿è¡å¤ä¸ªä»»å¡çåºå«\n   \n   * å½çº¿ç¨æ­£å¨æ§è¡çä»»å¡åçéè¯¯æ¶ï¼å¦ææ¯èªå·±åå»ºççº¿ç¨ï¼è¯¥ä»»å¡åå©ä½çä»»å¡å°±æ æ³åç»§ç»­è¿è¡ä¸å»ãèSingleThreadä¼åå»ºä¸ä¸ªæ°çº¿ç¨ï¼ç»§ç»­æ§è¡ä»»å¡éåä¸­å©ä½çä»»å¡ã\n\n * SingleThreadånewFixedThreadPool(1)çåºå«\n   \n   * newFixedThreadPool(1)ä¼ å¼ä¸º1ï¼å¯ä»¥å°FixedThreadPoolå¼ºè½¬ä¸ºThreadPoolExecutorï¼ç¶åéè¿setCorePoolSizeæ¹åæ ¸å¿çº¿ç¨æ°\n   \n   // å¼ºè½¬ä¸ºThreadPoolExecutor\n   ThreadPoolExecutor threadPool = (ThreadPoolExecutor) Executors.newFixedThreadPool(1);\n   // æ¹åæ ¸å¿çº¿ç¨æ°\n   threadPool.setCorePoolSize(2);\n   \n   \n   1\n   2\n   3\n   4\n   \n   * èSingleThreadæ æ³ä¿®æ¹æ ¸å¿çº¿ç¨æ°\n\n\n# æ§è¡ä»»å¡\n\n# execute()æ¹æ³\n\nexecute(Runnable command)\n\n\n1\n\n\nä¼ å¥ä¸ä¸ªRunnableå¯¹è±¡ï¼æ§è¡å¶ä¸­çrunæ¹æ³\n\næºç è§£æ\n\npublic void execute(Runnable command) {\n    if (command == null)\n        throw new NullPointerException();\n\n    // è·åctl\n    int c = ctl.get();\n    \n    // å¤æ­å½åå¯ç¨ççº¿ç¨æ°æ¯å¦å°äºæ ¸å¿çº¿ç¨æ°\n    if (workerCountOf(c) < corePoolSize) {\n        // ä¸ºè¯¥ä»»å¡åéçº¿ç¨\n        if (addWorker(command, true))\n            // åéæåå°±è¿å\n            return;\n        \n        // åéå¤±è´¥åæ¬¡è·åctl\n        c = ctl.get();\n    }\n    \n    // åéåä¿¡æ¯çº¿ç¨å¤±è´¥ä»¥å\n    // å¦ææ± ç¶æä¸ºRUNNINGå¹¶ä¸æå¥å°ä»»å¡éåæå\n    if (isRunning(c) && workQueue.offer(command)) {\n        \n        // åéæ£æµï¼å¯è½å¨æ·»å åçº¿ç¨æ± ç¶æåä¸ºäºéRUNNING\n        int recheck = ctl.get();\n        \n        // å¦ææ± ç¶æä¸ºéRUNNINGï¼åä¸ä¼æ§è¡æ°æ¥çä»»å¡\n        // å°è¯¥ä»»å¡ä»é»å¡éåä¸­ç§»é¤\n        if (! isRunning(recheck) && remove(command))\n            // è°ç¨æç»ç­ç¥ï¼æç»è¯¥ä»»å¡çæ§è¡\n            reject(command);\n        \n        // å¦ææ²¡ææ­£å¨è¿è¡ççº¿ç¨\n        else if (workerCountOf(recheck) == 0)\n            // å°±åå»ºæ°çº¿ç¨æ¥æ§è¡è¯¥ä»»å¡\n            addWorker(null, false);\n    }\n    \n    // å¦ææ·»å å¤±è´¥äºï¼ä»»å¡éåå·²æ»¡ï¼ï¼å°±è°ç¨æç»ç­ç¥\n    else if (!addWorker(command, false))\n        reject(command);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n\n\nå¶ä¸­è°ç¨äº**addWoker()**æ¹æ³ï¼åçççè¿ä¸ªæ¹æ³\n\nprivate boolean addWorker(Runnable firstTask, boolean core) {\n    retry:\n    for (;;) {\n        int c = ctl.get();\n        int rs = runStateOf(c);\n\n        // Check if queue empty only if necessary.\n        // å¦ææ± ç¶æä¸ºéRUNNINGç¶æãçº¿ç¨æ± ä¸ºSHUTDOWNä¸è¯¥ä»»å¡ä¸ºç©º æèé»å¡éåä¸­å·²ç»æä»»å¡\n        if (rs >= SHUTDOWN &&\n            ! (rs == SHUTDOWN &&\n               firstTask == null &&\n               ! workQueue.isEmpty()))\n            // åå»ºæ°çº¿ç¨å¤±è´¥\n            return false;\n\n        for (;;) {\n            // è·å¾å½åå·¥ä½çº¿ç¨æ°\n            int wc = workerCountOf(c);\n\n            // åæ°ä¸­ core ä¸ºtrue\n            // CAPACITY ä¸º 1 << COUNT_BITS-1ï¼ä¸è¬ä¸ä¼è¶è¿\n            // å¦æå·¥ä½çº¿ç¨æ°å¤§äºäºæ ¸å¿çº¿ç¨æ°ï¼ååå»ºå¤±è´¥\n            if (wc >= CAPACITY ||\n                wc >= (core ? corePoolSize : maximumPoolSize))\n                return false;\n            // éè¿CASæä½æ¹åcçå¼\n            if (compareAndIncrementWorkerCount(c))\n                // æ´æ¹æåå°±è·³åºå¤éå¾ªç¯ï¼ä¸ä¸åè¿è¡å¾ªç¯\n                break retry;\n            // æ´æ¹å¤±è´¥ï¼éæ°è·åctlçå¼\n            c = ctl.get();  // Re-read ctl\n            if (runStateOf(c) != rs)\n                // è·³åºå¤éå¾ªç¯ï¼ä¸éæ°è¿å¥å¾ªç¯\n                continue retry;\n            // else CAS failed due to workerCount change; retry inner loop\n        }\n    }\n\n    // ç¨äºæ è®°workä¸­çä»»å¡æ¯å¦æåæ§è¡\n    boolean workerStarted = false;\n    // ç¨äºæ è®°workeræ¯å¦æåå å¥äºçº¿ç¨æ± ä¸­\n    boolean workerAdded = false;\n    Worker w = null;\n    try {\n        // åå»ºæ°çº¿ç¨æ¥æ§è¡ä»»å¡\n        w = new Worker(firstTask);\n        final Thread t = w.thread;\n        if (t != null) {\n            final ReentrantLock mainLock = this.mainLock;\n            // å é\n            mainLock.lock();\n            try {\n                // Recheck while holding lock.\n                // Back out on ThreadFactory failure or if\n                // shut down before lock acquired.\n                // å éçåæ¶åæ¬¡æ£æµ\n                // é¿åå¨éæ¾éä¹åè°ç¨äºshut down\n                int rs = runStateOf(ctl.get());\n\n                if (rs < SHUTDOWN ||\n                    (rs == SHUTDOWN && firstTask == null)) {\n                    if (t.isAlive()) // precheck that t is startable\n                        throw new IllegalThreadStateException();\n                    // å°çº¿ç¨æ·»å å°çº¿ç¨æ± ä¸­\n                    workers.add(w);\n                    int s = workers.size();\n                    if (s > largestPoolSize)\n                        largestPoolSize = s;\n                    // æ·»å æåæ å¿ä½åä¸ºtrue\n                    workerAdded = true;\n                }\n            } finally {\n                mainLock.unlock();\n            }\n            // å¦æworkeræåå å¥äºçº¿ç¨æ± ï¼å°±æ§è¡å¶ä¸­çä»»å¡\n            if (workerAdded) {\n                t.start();\n                // å¯å¨æå\n                workerStarted = true;\n            }\n        }\n    } finally {\n        // å¦ææ§è¡å¤±è´¥\n        if (! workerStarted)\n            // è°ç¨æ·»å å¤±è´¥çå½æ°\n            addWorkerFailed(w);\n    }\n    return workerStarted;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n\n\n# submit()æ¹æ³\n\nFuture<T> submit(Callable<T> task)\n\n\n1\n\n\nä¼ å¥ä¸ä¸ªCallableå¯¹è±¡ï¼ç¨Futureæ¥æè·è¿åå¼\n\nä½¿ç¨\n\n// éè¿submitæ§è¡Callableä¸­çcallæ¹æ³\n// éè¿Futureæ¥æè·è¿åå¼\nFuture<String> future = threadPool.submit(new Callable<String>() {\n   @Override\n   public String call() throws Exception {\n      return "hello submit";\n   }\n});\n\n// æ¥çæè·çè¿åå¼\nSystem.out.println(future.get());\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# åæ­¢\n\n# shutdown()\n\n/**\n* å°çº¿ç¨æ± çç¶ææ¹ä¸º SHUTDOWN\n* ä¸åæ¥åæ°ä»»å¡ï¼ä½æ¯ä¼å°é»å¡éåä¸­çä»»å¡æ§è¡å®\n*/\npublic void shutdown() {\n    final ReentrantLock mainLock = this.mainLock;\n    mainLock.lock();\n    try {\n        checkShutdownAccess();\n        \n        // ä¿®æ¹çº¿ç¨æ± ç¶æä¸º SHUTDOWN\n        advanceRunState(SHUTDOWN);\n        \n  \t\t// ä¸­æ­ç©ºé²çº¿ç¨ï¼æ²¡ææ§è¡ä»»å¡ççº¿ç¨ï¼\n        // Idleï¼ç©ºé²ç\n        interruptIdleWorkers();\n        onShutdown(); // hook for ScheduledThreadPoolExecutor\n    } finally {\n        mainLock.unlock();\n    }\n    // å°è¯ç»ç»ï¼ä¸ä¸å®æå\n    // \n    tryTerminate();\n}\nfinal void tryTerminate() {\n    for (;;) {\n        int c = ctl.get();\n        // ç»ç»å¤±è´¥çæ¡ä»¶\n        // çº¿ç¨æ± ç¶æä¸ºRUNNING\n        // çº¿ç¨æ± ç¶æä¸º RUNNING SHUTDOWN STOP ï¼ç¶æå¼å¤§äºTIDYINGï¼\n        // çº¿ç¨æ± ç¶æä¸ºSHUTDOWNï¼ä½é»å¡éåä¸­è¿æä»»å¡ç­å¾æ§è¡\n        if (isRunning(c) ||\n            runStateAtLeast(c, TIDYING) ||\n            (runStateOf(c) == SHUTDOWN && ! workQueue.isEmpty()))\n            return;\n        \n        // å¦ææ´»è·çº¿ç¨æ°ä¸ä¸º0\n        if (workerCountOf(c) != 0) { // Eligible to terminate\n            // ä¸­æ­ç©ºé²çº¿ç¨\n            interruptIdleWorkers(ONLY_ONE);\n            return;\n        }\n\n        final ReentrantLock mainLock = this.mainLock;\n        mainLock.lock();\n        try {\n            // å¤äºå¯ä»¥ç»ç»çç¶æ\n            // éè¿CASå°çº¿ç¨æ± ç¶ææ¹ä¸ºTIDYING\n            if (ctl.compareAndSet(c, ctlOf(TIDYING, 0))) {\n                try {\n                    terminated();\n                } finally {\n                    // éè¿CASå°çº¿ç¨æ± ç¶ææ¹ä¸ºTERMINATED\n                    ctl.set(ctlOf(TERMINATED, 0));\n                    termination.signalAll();\n                }\n                return;\n            }\n        } finally {\n            mainLock.unlock();\n        }\n        // else retry on failed CAS\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n\n\n# shutdownNow()\n\n/**\n* å°çº¿ç¨æ± çç¶ææ¹ä¸º STOP\n* ä¸åæ¥åæ°ä»»å¡ï¼ä¹ä¸ä¼å¨æ§è¡é»å¡éåä¸­çä»»å¡\n* ä¼å°é»å¡éåä¸­æªæ§è¡çä»»å¡è¿åç»è°ç¨è\n*/\npublic List<Runnable> shutdownNow() {\n    List<Runnable> tasks;\n    final ReentrantLock mainLock = this.mainLock;\n    mainLock.lock();\n    try {\n        checkShutdownAccess();\n        \n        // ä¿®æ¹ç¶æä¸ºSTOPï¼ä¸æ§è¡ä»»ä½ä»»å¡\n        advanceRunState(STOP);\n        \n        // ä¸­æ­ææçº¿ç¨\n        interruptWorkers();\n        \n        // å°æªæ§è¡çä»»å¡ä»éåä¸­ç§»é¤ï¼ç¶åè¿åç»è°ç¨è\n        tasks = drainQueue();\n    } finally {\n        mainLock.unlock();\n    }\n    // å°è¯ç»ç»ï¼ä¸å®ä¼æåï¼å ä¸ºé»å¡éåä¸ºç©ºäº\n    tryTerminate();\n    return tasks;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n',normalizedContent:'æ¬ç¯ç¬è®°æ ¹æ®\n\né»é©¬javaå¹¶åç¼ç¨æç¨\n\nå­¦ä¹ èåçç¬è®°\n\n\n# ä¸ãåºæ¬æ¦å¿µ\n\n\n# 1ãè¿ç¨ä¸çº¿ç¨\n\n\n# è¿ç¨\n\n * ç¨åºç±æä»¤åæ°æ®ç»æï¼ä½è¿äºæä»¤è¦è¿è¡ï¼æ°æ®è¦è¯»åï¼å°±å¿é¡»å°æä»¤å è½½è³ cpuï¼æ°æ®å è½½è³åå­ãå¨æä»¤è¿è¡è¿ç¨ä¸­è¿éè¦ç¨å°ç£çãç½ç»ç­è®¾å¤ãè¿ç¨å°±æ¯ç¨æ¥å è½½æä»¤ãç®¡çåå­ãç®¡ç io çã\n * å½ä¸ä¸ªç¨åºè¢«è¿è¡ï¼ä»ç£çå è½½è¿ä¸ªç¨åºçä»£ç è³åå­ï¼è¿æ¶å°±å¼å¯äºä¸ä¸ªè¿ç¨ã\n * è¿ç¨å°±å¯ä»¥è§ä¸ºç¨åºçä¸ä¸ªå®ä¾ãå¤§é¨åç¨åºå¯ä»¥åæ¶è¿è¡å¤ä¸ªå®ä¾è¿ç¨ï¼ä¾å¦è®°äºæ¬ãç»å¾ãæµè§å¨ ç­ï¼ï¼ä¹æçç¨åºåªè½å¯å¨ä¸ä¸ªå®ä¾è¿ç¨ï¼ä¾å¦ç½æäºé³ä¹ã360 å®å¨å«å£«ç­ï¼\n\n\n# çº¿ç¨\n\n * ä¸ä¸ªè¿ç¨ä¹åå¯ä»¥åä¸ºä¸å°å¤ä¸ªçº¿ç¨ã\n * ä¸ä¸ªçº¿ç¨å°±æ¯ä¸ä¸ªæä»¤æµï¼å°æä»¤æµä¸­çä¸æ¡æ¡æä»¤ä»¥ä¸å®çé¡ºåºäº¤ç» cpu æ§è¡ ã\n * java ä¸­ï¼çº¿ç¨ä½ä¸ºå°è°åº¦åä½ï¼è¿ç¨ä½ä¸ºèµæºåéçå°åä½ã å¨ windows ä¸­è¿ç¨æ¯ä¸æ´»å¨çï¼åªæ¯ä½ ä¸ºçº¿ç¨çå®¹å¨\n\n\n# äºèå¯¹æ¯\n\n * è¿ç¨åºæ¬ä¸ç¸äºç¬ç«çï¼èçº¿ç¨å­å¨äºè¿ç¨åï¼æ¯è¿ç¨çä¸ä¸ªå­é è¿ç¨æ¥æå±äº«çèµæºï¼å¦åå­ç©ºé´ç­ï¼ä¾å¶åé¨ççº¿ç¨å±äº«\n   * è¿ç¨é´éä¿¡è¾ä¸ºå¤æ åä¸å°è®¡ç®æºçè¿ç¨éä¿¡ç§°ä¸º ipcï¼inter-process communicationï¼\n   * ä¸åè®¡ç®æºä¹é´çè¿ç¨éä¿¡ï¼éè¦éè¿ç½ç»ï¼å¹¶éµå®å±åçåè®®ï¼ä¾å¦ http\n * çº¿ç¨éä¿¡ç¸å¯¹ç®åï¼å ä¸ºå®ä»¬å±äº«è¿ç¨åçåå­ï¼ä¸ä¸ªä¾å­æ¯å¤ä¸ªçº¿ç¨å¯ä»¥è®¿é®åä¸ä¸ªå±äº«åé çº¿ç¨æ´è½»éï¼çº¿ç¨ä¸ä¸æåæ¢ææ¬ä¸è¬ä¸è¦æ¯è¿ç¨ä¸ä¸æåæ¢ä½\n\n# è¿ç¨åçº¿ç¨çåæ¢\n\nä¸ä¸æåæ¢\n\nåæ ¸ä¸ºæ¯ä¸ä¸ªè¿ç¨ç»´æä¸ä¸ªä¸ä¸æã**ä¸ä¸æå°±æ¯åæ ¸éæ°å¯å¨ä¸ä¸ªè¢«æ¢å çè¿ç¨æéçç¶æã**åæ¬ä»¥ä¸åå®¹ï¼\n\n * éç¨ç®çå¯å­å¨\n * æµ®ç¹å¯å­å¨\n * ç¨åºè®¡æ°å¨\n * ç¨æ·æ \n * ç¶æå¯å­å¨\n * åæ ¸æ \n * åç§åæ ¸æ°æ®ç»æï¼æ¯å¦æç»å°åç©ºé´çé¡µè¡¨ï¼åå«æå³å½åè¿ç¨ä¿¡æ¯çè¿ç¨è¡¨ï¼ä»¥ååå«è¿ç¨å·²æå¼æä»¶çä¿¡æ¯çæä»¶è¡¨\n\nè¿ç¨åæ¢åçº¿ç¨åæ¢çä¸»è¦åºå«\n\næä¸»è¦çä¸ä¸ªåºå«å¨äºè¿ç¨åæ¢æ¶åèæå°åç©ºé´çåæ¢èçº¿ç¨ä¸ä¼ãå ä¸ºæ¯ä¸ªè¿ç¨é½æèªå·±çèæå°åç©ºé´ï¼èçº¿ç¨æ¯å±äº«æå¨è¿ç¨çèæå°åç©ºé´çï¼å æ­¤åä¸ä¸ªè¿ç¨ä¸­ççº¿ç¨è¿è¡çº¿ç¨åæ¢æ¶ä¸æ¶åèæå°åç©ºé´çè½¬æ¢\n\né¡µè¡¨æ¥æ¾æ¯ä¸ä¸ªå¾æ¢çè¿ç¨ï¼å æ­¤éå¸¸ä½¿ç¨cacheæ¥ç¼å­å¸¸ç¨çå°åæ å°ï¼è¿æ ·å¯ä»¥å éé¡µè¡¨æ¥æ¾ï¼è¿ä¸ªcacheå°±æ¯å¿«è¡¨tlbï¼translation lookaside bufferï¼ç¨æ¥å éé¡µè¡¨æ¥æ¾ï¼ãç±äºæ¯ä¸ªè¿ç¨é½æèªå·±çèæå°åç©ºé´ï¼é£ä¹æ¾ç¶æ¯ä¸ªè¿ç¨é½æèªå·±çé¡µè¡¨ï¼é£ä¹å½è¿ç¨åæ¢åé¡µè¡¨ä¹è¦è¿è¡åæ¢ï¼é¡µè¡¨åæ¢åtlbå°±å¤±æäºï¼cacheå¤±æå¯¼è´å½ä¸­çéä½ï¼é£ä¹èæå°åè½¬æ¢ä¸ºç©çå°åå°±ä¼åæ¢ï¼è¡¨ç°åºæ¥çå°±æ¯ç¨åºè¿è¡ä¼åæ¢ï¼èçº¿ç¨åæ¢åä¸ä¼å¯¼è´tlbå¤±æï¼å ä¸ºçº¿ç¨çº¿ç¨æ éåæ¢å°åç©ºé´ï¼å æ­¤æä»¬éå¸¸è¯´çº¿ç¨åæ¢è¦æ¯è¾è¿ç¨åæ¢å¿«\n\nèä¸è¿å¯è½åºç°ç¼ºé¡µä¸­æ­ï¼è¿å°±éè¦æä½ç³»ç»å°éè¦çåå®¹è°å¥åå­ä¸­ï¼è¥åå­å·²æ»¡åè¿éè¦å°ä¸ç¨çåå®¹è°åºåå­ï¼è¿ä¹éè¦è±è´¹æ¶é´\n\nä¸ºä»ä¹tlbè½å å¿«è®¿é®éåº¦\n\nå¿«è¡¨å¯ä»¥é¿åæ¯æ¬¡é½å¯¹é¡µå·è¿è¡å°åçæææ§å¤æ­ãå¿«è¡¨ä¸­ä¿å­äºå¯¹åºçç©çåå·ï¼å¯ä»¥ç´æ¥è®¡ç®åºç©çå°åï¼æ éåè¿è¡æææ§æ£æ¥\n\n\n# 2ãå¹¶åä¸å¹¶è¡\n\nå¹¶åæ¯ä¸ä¸ªcpuå¨ä¸åçæ¶é´å»ä¸åçº¿ç¨ä¸­æ§è¡æä»¤ã\n\nå¹¶è¡æ¯å¤ä¸ªcpuåæ¶å¤çä¸åççº¿ç¨ã\n\nå¼ç¨ rob pike çä¸æ®µæè¿°ï¼\n\n * å¹¶åï¼concurrentï¼æ¯åä¸æ¶é´åºå¯¹ï¼dealing withï¼å¤ä»¶äºæçè½å\n * å¹¶è¡ï¼parallelï¼æ¯åä¸æ¶é´å¨æåï¼doingï¼å¤ä»¶äºæçè½å\n\n\n# 3ãåºç¨\n\n# åºç¨ä¹å¼æ­¥è°ç¨ï¼æ¡ä¾1ï¼\n\nä»¥è°ç¨æ¹è§åº¦æ¥è®²ï¼å¦æ\n\n * éè¦ç­å¾ç»æè¿åï¼æè½ç»§ç»­è¿è¡å°±æ¯åæ­¥\n * ä¸éè¦ç­å¾ç»æè¿åï¼å°±è½ç»§ç»­è¿è¡å°±æ¯å¼æ­¥\n\n\\1) è®¾è®¡ å¤çº¿ç¨å¯ä»¥è®©æ¹æ³æ§è¡åä¸ºå¼æ­¥çï¼å³ä¸è¦å·´å·´å¹²ç­çï¼æ¯å¦è¯´è¯»åç£çæä»¶æ¶ï¼åè®¾è¯»åæä½è±è´¹äº 5 ç§éï¼å¦ ææ²¡æçº¿ç¨è°åº¦æºå¶ï¼è¿ 5 ç§ cpu ä»ä¹é½åä¸äºï¼å¶å®ä»£ç é½å¾æåâ¦ \\2) ç»è®º\n\n * æ¯å¦å¨é¡¹ç®ä¸­ï¼è§é¢æä»¶éè¦è½¬æ¢æ ¼å¼ç­æä½æ¯è¾è´¹æ¶ï¼è¿æ¶å¼ä¸ä¸ªæ°çº¿ç¨å¤çè§é¢è½¬æ¢ï¼é¿åé»å¡ä¸»çº¿ç¨\n * tomcat çå¼æ­¥ servlet ä¹æ¯ç±»ä¼¼çç®çï¼è®©ç¨æ·çº¿ç¨å¤çèæ¶è¾é¿çæä½ï¼é¿åé»å¡\n * tomcat çå·¥ä½çº¿ç¨ ui ç¨åºä¸­ï¼å¼çº¿ç¨è¿è¡å¶ä»æä½ï¼é¿åé»å¡ ui çº¿ç¨\n\nç»è®º\n\n 1. åæ ¸ cpu ä¸ï¼å¤çº¿ç¨ä¸è½å®éæé«ç¨åºè¿è¡æçï¼åªæ¯ä¸ºäºè½å¤å¨ä¸åçä»»å¡ä¹é´åæ¢ï¼ä¸åçº¿ç¨è½®æµä½¿ç¨ cpu ï¼ä¸è³äºä¸ä¸ªçº¿ç¨æ»å ç¨ cpuï¼å«ççº¿ç¨æ²¡æ³å¹²æ´»\n 2. å¤æ ¸ cpu å¯ä»¥å¹¶è¡è·å¤ä¸ªçº¿ç¨ï¼ä½è½å¦æé«ç¨åºè¿è¡æçè¿æ¯è¦åæåµç\n    * æäºä»»å¡ï¼ç»è¿ç²¾å¿è®¾è®¡ï¼å°ä»»å¡æåï¼å¹¶è¡æ§è¡ï¼å½ç¶å¯ä»¥æé«ç¨åºçè¿è¡æçãä½ä¸æ¯ææè®¡ç®ä»» å¡é½è½æåï¼åèåæçãé¿å§è¾¾å°å®å¾ãï¼\n    * ä¹ä¸æ¯ææä»»å¡é½éè¦æåï¼ä»»å¡çç®çå¦æä¸åï¼è°æååæçæ²¡å¥æä¹\n 3. io æä½ä¸å ç¨ cpuï¼åªæ¯æä»¬ä¸è¬æ·è´æä»¶ä½¿ç¨çæ¯ãé»å¡ ioãï¼è¿æ¶ç¸å½äºçº¿ç¨è½ç¶ä¸ç¨ cpuï¼ä½éè¦ä¸ ç´ç­å¾ io ç»æï¼æ²¡è½ååå©ç¨çº¿ç¨ãæä»¥ææåé¢çãéé»å¡ ioãåãå¼æ­¥ ioãä¼å\n\n\n# äºãçº¿ç¨çåå»º\n\n\n# 1ãåå»ºä¸ä¸ªçº¿ç¨ï¼éä¸»çº¿ç¨ï¼\n\n\n# æ¹æ³ä¸ï¼éè¿ç»§æ¿threadåå»ºçº¿ç¨\n\npublic class createthread {\n\tpublic static void main(string[] args) {\n\t\tthread mythread = new mythread();\n        // å¯å¨çº¿ç¨\n\t\tmythread.start();\n\t}\n}\n\nclass mythread extends thread {\n\t@override\n\tpublic void run() {\n\t\tsystem.out.println("my thread running...");\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nä½¿ç¨ç»§æ¿æ¹å¼çå¥½å¤æ¯ï¼å¨runï¼ï¼æ¹æ³åè·åå½åçº¿ç¨ç´æ¥ä½¿ç¨thiså°±å¯ä»¥äºï¼æ é¡»ä½¿ç¨thread.currentthreadï¼ï¼æ¹æ³ï¼ä¸å¥½çå°æ¹æ¯javaä¸æ¯æå¤ç»§æ¿ï¼å¦æç»§æ¿äºthreadç±»ï¼é£ä¹å°±ä¸è½åç»§æ¿å¶ä»ç±»ãå¦å¤ä»»å¡ä¸ä»£ç æ²¡æåç¦»ï¼å½å¤ä¸ªçº¿ç¨æ§è¡ä¸æ ·çä»»å¡æ¶éè¦å¤ä»½ä»»å¡ä»£ç \n\n\n# æ¹æ³äºï¼ä½¿ç¨runnableéåthread(æ¨è)\n\npublic class test2 {\n\tpublic static void main(string[] args) {\n\t\t//åå»ºçº¿ç¨ä»»å¡\n\t\trunnable r = new runnable() {\n\t\t\t@override\n\t\t\tpublic void run() {\n\t\t\t\tsystem.out.println("runnable running");\n\t\t\t}\n\t\t};\n\t\t//å°runnableå¯¹è±¡ä¼ ç»thread\n\t\tthread t = new thread(r);\n\t\t//å¯å¨çº¿ç¨\n\t\tt.start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\næè\n\npublic class createthread2 {\n   private static class myrunnable implements runnable {\n\n      @override\n      public void run() {\n         system.out.println("my runnable running...");\n      }\n   }\n\n   public static void main(string[] args) {\n      myrunnable myrunnable = new myrunnable();\n      thread thread = new thread(myrunnable);\n      thread.start();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\néè¿å®ç°runnableæ¥å£ï¼å¹¶ä¸å®ç°run()æ¹æ³ãå¨åå»ºçº¿ç¨æ¶ä½ä¸ºåæ°ä¼ å¥è¯¥ç±»çå®ä¾å³å¯\n\n# æ¹æ³äºçç®åï¼ä½¿ç¨lambdaè¡¨è¾¾å¼ç®åæä½\n\nå½ä¸ä¸ªæ¥å£å¸¦æ@functionalinterfaceæ³¨è§£æ¶ï¼æ¯å¯ä»¥ä½¿ç¨lambdaæ¥ç®åæä½ç\n\næä»¥æ¹æ³äºä¸­çä»£ç å¯ä»¥è¢«ç®åä¸º\n\npublic class test2 {\n\tpublic static void main(string[] args) {\n\t\t//åå»ºçº¿ç¨ä»»å¡\n\t\trunnable r = () -> {\n            //ç´æ¥åæ¹æ³ä½å³å¯\n\t\t\tsystem.out.println("runnable running");\n\t\t\tsystem.out.println("hello thread");\n\t\t};\n\t\t//å°runnableå¯¹è±¡ä¼ ç»thread\n\t\tthread t = new thread(r);\n\t\t//å¯å¨çº¿ç¨\n\t\tt.start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nå¯ä»¥årunnableä¸ä½¿ç¨alt+enter\n\n\n\n# åçä¹ thread ä¸ runnable çå³ç³»\n\nåæ thread çæºç ï¼çæ¸å®ä¸ runnable çå³ç³» å°ç»\n\n * æ¹æ³1 æ¯æçº¿ç¨åä»»å¡åå¹¶å¨äºä¸èµ·\n * æ¹æ³2 æ¯æçº¿ç¨åä»»å¡åå¼äº\n * ç¨ runnable æ´å®¹æä¸çº¿ç¨æ± ç­é«çº§ api éå ç¨ runnable è®©ä»»å¡ç±»è±ç¦»äº thread ç»§æ¿ä½ç³»ï¼æ´çµæ´»\n\n\n# æ¹æ³ä¸ï¼ä½¿ç¨futuretaskä¸threadç»å\n\nä½¿ç¨futuretaskå¯ä»¥ç¨æ³åæå®çº¿ç¨çè¿åå¼ç±»åï¼runnableçrunæ¹æ³æ²¡æè¿åå¼ï¼\n\npublic class test3 {\n\tpublic static void main(string[] args) throws executionexception, interruptedexception {\n        //éè¦ä¼ å¥ä¸ä¸ªcallableå¯¹è±¡\n\t\tfuturetask<integer> task = new futuretask<integer>(new callable<integer>() {\n\t\t\t@override\n\t\t\tpublic integer call() throws exception {\n\t\t\t\tsystem.out.println("çº¿ç¨æ§è¡!");\n\t\t\t\tthread.sleep(1000);\n\t\t\t\treturn 100;\n\t\t\t}\n\t\t});\n\n\t\tthread r1 = new thread(task, "t2");\n\t\tr1.start();\n\t\t//è·åçº¿ç¨ä¸­æ¹æ³æ§è¡åçè¿åç»æ\n\t\tsystem.out.println(task.get());\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\næ\n\npublic class usefuturetask {\n   public static void main(string[] args) throws executionexception, interruptedexception {\n      futuretask<string> futuretask = new futuretask<>(new mycall());\n      thread thread = new thread(futuretask);\n      thread.start();\n      // è·å¾çº¿ç¨è¿è¡åçè¿åå¼\n      system.out.println(futuretask.get());\n   }\n}\n\nclass mycall implements callable<string> {\n   @override\n   public string call() throws exception {\n      return "hello world";\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n# æ»ç»\n\nä½¿ç¨ç»§æ¿æ¹å¼çå¥½å¤æ¯æ¹ä¾¿ä¼ åï¼ä½ å¯ä»¥å¨å­ç±»éé¢æ·»å æååéï¼éè¿setæ¹æ³è®¾ç½®åæ°æèéè¿æé å½æ°è¿è¡ä¼ éï¼èå¦æä½¿ç¨runnableæ¹å¼ï¼ååªè½ä½¿ç¨ä¸»çº¿ç¨éé¢è¢«å£°æä¸ºfinalçåéãä¸å¥½çå°æ¹æ¯javaä¸æ¯æå¤ç»§æ¿ï¼å¦æç»§æ¿äºthreadç±»ï¼é£ä¹å­ç±»ä¸è½åç»§æ¿å¶ä»ç±»ï¼èrunableåæ²¡æè¿ä¸ªéå¶ãåä¸¤ç§æ¹å¼é½æ²¡åæ³æ¿å°ä»»å¡çè¿åç»æï¼ä½æ¯futuretaskæ¹å¼å¯ä»¥\n\n\n# 2ãåçä¹çº¿ç¨è¿è¡\n\n# æ ä¸æ å¸§\n\njava virtual machine stacks ï¼java èææºæ ï¼ æä»¬é½ç¥é jvm ä¸­ç±å ãæ ãæ¹æ³åºæç»æï¼å¶ä¸­æ åå­æ¯ç»è°ç¨çå¢ï¼\n\n * å¶å®å°±æ¯çº¿ç¨ï¼æ¯ä¸ªçº¿ç¨å¯å¨åï¼èææºå°±ä¼ä¸ºå¶åéä¸åæ åå­\n * æ¯ä¸ªæ ç±å¤ä¸ªæ å¸§ï¼frameï¼ç»æï¼å¯¹åºçæ¯æ¬¡æ¹æ³è°ç¨æ¶æå ç¨çåå­\n * æ¯ä¸ªçº¿ç¨åªè½æä¸ä¸ªæ´»å¨æ å¸§ï¼å¯¹åºçå½åæ­£å¨æ§è¡çé£ä¸ªæ¹æ³\n\n# çº¿ç¨ä¸ä¸æåæ¢ï¼thread context switchï¼\n\nå ä¸ºä»¥ä¸ä¸äºåå å¯¼è´ cpu ä¸åæ§è¡å½åççº¿ç¨ï¼è½¬èæ§è¡å¦ä¸ä¸ªçº¿ç¨çä»£ç \n\n * çº¿ç¨ç cpu æ¶é´çç¨å®\n * åå¾åæ¶ ææ´é«ä¼åçº§ççº¿ç¨éè¦è¿è¡\n * çº¿ç¨èªå·±è°ç¨äº sleepãyieldãwaitãjoinãparkãsynchronizedãlock ç­æ¹æ³\n\nå½ context switch åçæ¶ï¼éè¦ç±æä½ç³»ç»ä¿å­å½åçº¿ç¨çç¶æï¼å¹¶æ¢å¤å¦ä¸ä¸ªçº¿ç¨çç¶æï¼java ä¸­å¯¹åºçæ¦å¿µ å°±æ¯ç¨åºè®¡æ°å¨ï¼program counter registerï¼ï¼å®çä½ç¨æ¯è®°ä½ä¸ä¸æ¡ jvm æä»¤çæ§è¡å°åï¼æ¯çº¿ç¨ç§æç\n\n * ç¶æåæ¬ç¨åºè®¡æ°å¨ãèææºæ ä¸­æ¯ä¸ªæ å¸§çä¿¡æ¯ï¼å¦å±é¨åéãæä½æ°æ ãè¿åå°åç­\n * context switch é¢ç¹åçä¼å½±åæ§è½\n\n\n# 3ãå¸¸ç¨æ¹æ³\n\n\n# (1)start() vs run()\n\nè¢«åå»ºçthreadå¯¹è±¡ç´æ¥è°ç¨éåçrunæ¹æ³æ¶ï¼ runæ¹æ³æ¯å¨ä¸»çº¿ç¨ä¸­è¢«æ§è¡çï¼èä¸æ¯å¨æä»¬æåå»ºççº¿ç¨ä¸­æ§è¡ãæä»¥å¦ææ³è¦å¨æåå»ºççº¿ç¨ä¸­æ§è¡runæ¹æ³ï¼éè¦ä½¿ç¨threadå¯¹è±¡çstartæ¹æ³ã\n\n\n# (2)sleep()ä¸yield()\n\n# sleep (ä½¿çº¿ç¨é»å¡)\n\n 1. è°ç¨ sleep ä¼è®©å½åçº¿ç¨ä» running è¿å¥ timed waiting ç¶æï¼é»å¡ï¼ï¼å¯éè¿state()æ¹æ³æ¥ç\n\n 2. å¶å®çº¿ç¨å¯ä»¥ä½¿ç¨ interrupt æ¹æ³ææ­æ­£å¨ç¡ç ççº¿ç¨ï¼è¿æ¶ sleep æ¹æ³ä¼æåº interruptedexception\n\n 3. ç¡ç ç»æåççº¿ç¨æªå¿ä¼ç«å»å¾å°æ§è¡\n\n 4. å»ºè®®ç¨ timeunit ç sleep ä»£æ¿ thread ç sleep æ¥è·å¾æ´å¥½çå¯è¯»æ§ ãå¦ï¼\n    \n    //ä¼ç ä¸ç§\n    timeunit.seconds.sleep(1);\n    //ä¼ç ä¸åé\n    timeunit.minutes.sleep(1);\n    \n    \n    1\n    2\n    3\n    4\n    \n\n# yield ï¼è®©åºå½åçº¿ç¨ï¼\n\n 1. è°ç¨ yield ä¼è®©å½åçº¿ç¨ä» running è¿å¥ runnable å°±ç»ªç¶æï¼ä»ç¶æå¯è½è¢«æ§è¡ï¼ï¼ç¶åè°åº¦æ§è¡å¶å®çº¿ç¨\n 2. å·ä½çå®ç°ä¾èµäºæä½ç³»ç»çä»»å¡è°åº¦å¨\n\n# çº¿ç¨ä¼åçº§\n\n * çº¿ç¨ä¼åçº§ä¼æç¤ºï¼hintï¼è°åº¦å¨ä¼åè°åº¦è¯¥çº¿ç¨ï¼ä½å®ä»ä»æ¯ä¸ä¸ªæç¤ºï¼è°åº¦å¨å¯ä»¥å¿½ç¥å®\n\n * å¦æ cpu æ¯è¾å¿ï¼é£ä¹ä¼åçº§é«ççº¿ç¨ä¼è·å¾æ´å¤çæ¶é´çï¼ä½ cpu é²æ¶ï¼ä¼åçº§å ä¹æ²¡ä½ç¨\n\n * è®¾ç½®æ¹æ³ï¼\n   \n   thread1.setpriority(thread.max_priority); //è®¾ç½®ä¸ºä¼åçº§æé«\n   \n   \n   1\n   \n\n\n# (3)join()æ¹æ³\n\nç¨äºç­å¾æä¸ªçº¿ç¨ç»æãåªä¸ªçº¿ç¨åè°ç¨join()æ¹æ³ï¼å°±ç­å¾åªä¸ªçº¿ç¨ç»æï¼ç¶ååå»æ§è¡å¶ä»çº¿ç¨ã\n\nå¦å¨ä¸»çº¿ç¨ä¸­è°ç¨ti.join()ï¼åæ¯ä¸»çº¿ç¨ç­å¾t1çº¿ç¨ç»æ\n\nthread thread = new thread();\n//ç­å¾threadçº¿ç¨æ§è¡ç»æ\nthread.join();\n//æå¤ç­å¾1000ms,å¦æ1000msåçº¿ç¨æ§è¡å®æ¯ï¼åä¼ç´æ¥æ§è¡ä¸é¢çè¯­å¥ï¼ä¸ä¼ç­å¤1000ms\nthread.join(1000);\n\n\n1\n2\n3\n4\n5\n\n\n\n# (4)interrupt()æ¹æ³\n\nç¨äºææ­é»å¡(sleep wait joinâ¦)ççº¿ç¨ã å¤äºé»å¡ç¶æççº¿ç¨ï¼cpuä¸ä¼ç»å¶åéæ¶é´çã\n\n * å¦æä¸ä¸ªçº¿ç¨å¨å¨è¿è¡ä¸­è¢«ææ­ï¼ææ­æ è®°ä¼è¢«ç½®ä¸ºtrueã\n * å¦ææ¯ææ­å sleep wait joinæ¹æ³èè¢«é»å¡ççº¿ç¨ï¼ä¼å°ææ­æ è®°ç½®ä¸ºfalse\n\n//ç¨äºæ¥çææ­æ è®°ï¼è¿åå¼è¢«booleanç±»å\nt1.isinterrupted();\n\n\n1\n2\n\n\næ­£å¸¸è¿è¡ççº¿ç¨å¨è¢«ææ­åï¼ä¸ä¼åæ­¢ï¼ä¼ç»§ç»­æ§è¡ãå¦æè¦è®©çº¿ç¨å¨è¢«ææ­ååä¸æ¥ï¼éè¦ä½¿ç¨ææ­æ è®°æ¥å¤æ­ã\n\nwhile(true) {\n    if(thread.currentthread().isinterrupted()) {\n        break;\n    }\n}\n\n\n1\n2\n3\n4\n5\n\n\n# interruptæ¹æ³çåºç¨ââä¸¤é¶æ®µç»æ­¢æ¨¡å¼\n\nå½æä»¬å¨æ§è¡çº¿ç¨ä¸æ¶ï¼æ³è¦ç»æ­¢çº¿ç¨äºï¼è¿æ¯å°±éè¦ä½¿ç¨interruptæ¹æ³æ¥ä¼éçåæ­¢çº¿ç¨äºã\n\n\n\nä»£ç \n\npublic class test7 {\n\tpublic static void main(string[] args) throws interruptedexception {\n\t\tmonitor monitor = new monitor();\n\t\tmonitor.start();\n\t\tthread.sleep(3500);\n\t\tmonitor.stop();\n\t}\n}\n\nclass monitor {\n\n\tthread monitor;\n\n\t/**\n\t * å¯å¨çæ§å¨çº¿ç¨\n\t */\n\tpublic void start() {\n\t\t//è®¾ç½®çº¿æ§å¨çº¿ç¨ï¼ç¨äºçæ§çº¿ç¨ç¶æ\n\t\tmonitor = new thread() {\n\t\t\t@override\n\t\t\tpublic void run() {\n\t\t\t\t//å¼å§ä¸åççæ§\n\t\t\t\twhile (true) {\n                    //å¤æ­å½åçº¿ç¨æ¯å¦è¢«ææ­äº\n\t\t\t\t\tif(thread.currentthread().isinterrupted()) {\n\t\t\t\t\t\tsystem.out.println("å¤çåç»­ä»»å¡");\n                        //ç»æ­¢çº¿ç¨æ§è¡\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsystem.out.println("çæ§å¨è¿è¡ä¸­...");\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//çº¿ç¨ä¼ç \n\t\t\t\t\t\tthread.sleep(1000);\n\t\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\t\te.printstacktrace();\n\t\t\t\t\t\t//å¦ææ¯å¨ä¼ç çæ¶åè¢«ææ­ï¼ä¸ä¼å°ææ­æ è®°è®¾ç½®ä¸ºtrueï¼è¿æ¶è¦éæ°è®¾ç½®ææ­æ è®°\n\t\t\t\t\t\tthread.currentthread().interrupt();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tmonitor.start();\n\t}\n\n\t/**\n\t * \tç¨äºåæ­¢çæ§å¨çº¿ç¨\n\t */\n\tpublic void stop() {\n\t\t//ææ­çº¿ç¨\n\t\tmonitor.interrupt();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n\n\n\n# (5)ä¸æ¨èä½¿ç¨çææ­æ¹æ³\n\n * stopæ¹æ³ åæ­¢çº¿ç¨è¿è¡ï¼å¯è½é æå±äº«èµæºæ æ³è¢«éæ¾ï¼å¶ä»çº¿ç¨æ æ³ä½¿ç¨è¿äºå±äº«èµæºï¼\n * suspendï¼æåçº¿ç¨ï¼/resumeï¼æ¢å¤çº¿ç¨ï¼æ¹æ³\n\n\n# (6)å®æ¤çº¿ç¨\n\nå½javaè¿ç¨ä¸­æå¤ä¸ªçº¿ç¨å¨æ§è¡æ¶ï¼åªæå½ææéå®æ¤çº¿ç¨é½æ§è¡å®æ¯åï¼javaè¿ç¨æä¼ç»æãä½å½éå®æ¤çº¿ç¨å¨é¨æ§è¡å®æ¯åï¼å®æ¤çº¿ç¨æ è®ºæ¯å¦æ§è¡å®æ¯ï¼ä¹ä¼ä¸åç»æã\n\n//å°çº¿ç¨è®¾ç½®ä¸ºå®æ¤çº¿ç¨, é»è®¤ä¸ºfalse\nmonitor.setdaemon(true);\n\n\n1\n2\n\n\nå®æ¤çº¿ç¨çåºç¨\n\n * åå¾åæ¶å¨çº¿ç¨å°±æ¯ä¸ç§å®æ¤çº¿ç¨\n * tomcat ä¸­ç acceptor å poller çº¿ç¨é½æ¯å®æ¤çº¿ç¨ï¼æä»¥ tomcat æ¥æ¶å° shutdown å½ä»¤åï¼ä¸ä¼ç­ å¾å®ä»¬å¤çå®å½åè¯·æ±\n\n\n# 4ãçº¿ç¨çç¶æ\n\n\n# (1)äºç§ç¶æ\n\nè¿æ¯ä» æä½ç³»ç» å±é¢æ¥æè¿°ç\n\n\n\n * ãåå§ç¶æãä»æ¯å¨è¯­è¨å±é¢åå»ºäºçº¿ç¨å¯¹è±¡ï¼è¿æªä¸æä½ç³»ç»çº¿ç¨å³èï¼ä¾å¦çº¿ç¨è°ç¨äºstartæ¹æ³ï¼\n * ãå¯è¿è¡ç¶æãï¼å°±ç»ªç¶æï¼æè¯¥çº¿ç¨å·²ç»è¢«åå»ºï¼ä¸æä½ç³»ç»çº¿ç¨å³èï¼ï¼å¯ä»¥ç± cpu è°åº¦æ§è¡\n * ãè¿è¡ç¶æãæè·åäº cpu æ¶é´çè¿è¡ä¸­çç¶æ\n   * å½ cpu æ¶é´çç¨å®ï¼ä¼ä»ãè¿è¡ç¶æãè½¬æ¢è³ãå¯è¿è¡ç¶æãï¼ä¼å¯¼è´çº¿ç¨çä¸ä¸æåæ¢\n * ãé»å¡ç¶æã\n   * å¦æè°ç¨äºé»å¡ apiï¼å¦ bio è¯»åæä»¶ï¼è¿æ¶è¯¥çº¿ç¨å®éä¸ä¼ç¨å° cpuï¼ä¼å¯¼è´çº¿ç¨ä¸ä¸æåæ¢ï¼è¿å¥ ãé»å¡ç¶æã\n   * ç­ bio æä½å®æ¯ï¼ä¼ç±æä½ç³»ç»å¤éé»å¡ççº¿ç¨ï¼è½¬æ¢è³ãå¯è¿è¡ç¶æã\n   * ä¸ãå¯è¿è¡ç¶æãçåºå«æ¯ï¼å¯¹ãé»å¡ç¶æãççº¿ç¨æ¥è¯´åªè¦å®ä»¬ä¸ç´ä¸å¤éï¼è°åº¦å¨å°±ä¸ç´ä¸ä¼èèè°åº¦å®ä»¬\n * ãç»æ­¢ç¶æãè¡¨ç¤ºçº¿ç¨å·²ç»æ§è¡å®æ¯ï¼çå½å¨æå·²ç»ç»æï¼ä¸ä¼åè½¬æ¢ä¸ºå¶å®ç¶æ\n\n\n# (2)å­ç§ç¶æ\n\nè¿æ¯ä» java api å±é¢æ¥æè¿°ç æ ¹æ® thread.state æä¸¾ï¼åä¸ºå­ç§ç¶æ\n\n\n\n * new çº¿ç¨åè¢«åå»ºï¼ä½æ¯è¿æ²¡æè°ç¨ start() æ¹æ³\n * runnable å½è°ç¨äº start() æ¹æ³ä¹åï¼æ³¨æï¼java api å±é¢ç runnable ç¶ææ¶µçäºæä½ç³»ç»å±é¢ç ãå¯è¿è¡ç¶æãããè¿è¡ç¶æãåãé»å¡ç¶æãï¼ç±äº bio å¯¼è´ççº¿ç¨é»å¡ï¼å¨ java éæ æ³åºåï¼ä»ç¶è®¤ä¸º æ¯å¯è¿è¡ï¼\n * blocked ï¼ waiting ï¼ timed_waiting é½æ¯ java api å±é¢å¯¹ãé»å¡ç¶æãçç»åï¼å¦sleepå°±ä½timed_waitingï¼ joinä¸ºwaitingç¶æãåé¢ä¼å¨ç¶æè½¬æ¢ä¸èè¯¦è¿°ã\n * terminated å½çº¿ç¨ä»£ç è¿è¡ç»æ\n\n\n# ä¸ãå±äº«æ¨¡åä¹ç®¡ç¨\n\n\n# 1ãå±äº«å¸¦æ¥çé®é¢\n\n\n# (1)ä¸´çåº critical section\n\n * ä¸ä¸ªç¨åºè¿è¡å¤ä¸ªçº¿ç¨æ¬èº«æ¯æ²¡æé®é¢ç\n * é®é¢åºå¨å¤ä¸ªçº¿ç¨è®¿é®å±äº«èµæº\n   * å¤ä¸ªçº¿ç¨è¯»å±äº«èµæºå¶å®ä¹æ²¡æé®é¢\n   * å¨å¤ä¸ªçº¿ç¨å¯¹å±äº«èµæºè¯»åæä½æ¶åçæä»¤äº¤éï¼å°±ä¼åºç°é®é¢\n * ä¸æ®µä»£ç ååå¦æå­å¨å¯¹å±äº«èµæºçå¤çº¿ç¨è¯»åæä½ï¼ç§°è¿æ®µä»£ç åä¸ºä¸´çåº ä¾å¦ï¼ä¸é¢ä»£ç ä¸­çä¸´çåº\n\nstatic int counter = 0;\n \nstatic void increment() \n// ä¸´çåº \n{   \n    counter++; \n}\n \nstatic void decrement() \n// ä¸´çåº \n{ \n    counter--; \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n# (2)ç«ææ¡ä»¶ race condition\n\nå¤ä¸ªçº¿ç¨å¨ä¸´çåºåæ§è¡ï¼ç±äºä»£ç çæ§è¡åºåä¸åèå¯¼è´ç»ææ æ³é¢æµï¼ç§°ä¹ä¸ºåçäºç«ææ¡ä»¶\n\n\n# 2ãsynchronized è§£å³æ¹æ¡\n\n\n# (1)è§£å³ææ®µ\n\nä¸ºäºé¿åä¸´çåºçç«ææ¡ä»¶åçï¼æå¤ç§ææ®µå¯ä»¥è¾¾å°ç®çã\n\n * é»å¡å¼çè§£å³æ¹æ¡ï¼synchronizedï¼lock\n * éé»å¡å¼çè§£å³æ¹æ¡ï¼åå­åé\n\næ¬æ¬¡è¯¾ä½¿ç¨é»å¡å¼çè§£å³æ¹æ¡ï¼synchronizedï¼æ¥è§£å³ä¸è¿°é®é¢ï¼å³ä¿ç§°ç**ãå¯¹è±¡éã**ï¼å®éç¨äºæ¥çæ¹å¼è®©åä¸ æ¶å»è³å¤åªæä¸ä¸ªçº¿ç¨è½ææãå¯¹è±¡éãï¼å¶å®çº¿ç¨åæ³è·åè¿ä¸ªãå¯¹è±¡éãæ¶å°±ä¼é»å¡ä½(blocked)ãè¿æ ·å°±è½ä¿è¯æ¥æé ççº¿ç¨å¯ä»¥å®å¨çæ§è¡ä¸´çåºåçä»£ç ï¼ä¸ç¨æå¿çº¿ç¨ä¸ä¸æåæ¢\n\n\n# (2)synchronizedè¯­æ³\n\nsynchronized(å¯¹è±¡) {\n\t//ä¸´çåº\n}\n\n\n1\n2\n3\n\n\nä¾ï¼\n\nstatic int counter = 0; \n//åå»ºä¸ä¸ªå¬å±å¯¹è±¡ï¼ä½ä¸ºå¯¹è±¡éçå¯¹è±¡\nstatic final object room = new object();\n \npublic static void main(string[] args) throws interruptedexception {    \n\tthread t1 = new thread(() -> {        \n    for (int i = 0; i < 5000; i++) {            \n        synchronized (room) {     \n        counter++;            \n       \t }       \n \t   }    \n    }, "t1");\n \n    thread t2 = new thread(() -> {       \n        for (int i = 0; i < 5000; i++) {         \n            synchronized (room) {            \n            counter--;          \n            }    \n        } \n    }, "t2");\n \n    t1.start();    \n    t2.start(); \n    t1.join();   \n    t2.join();    \n    log.debug("{}",counter); \n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n\n\n# (3)synchronizedå å¨æ¹æ³ä¸\n\n * å å¨æåæ¹æ³ä¸\n   \n   public class demo {\n   \t//å¨æ¹æ³ä¸å ä¸synchronizedå³é®å­\n   \tpublic synchronized void test() {\n   \t\n   \t}\n   \t//ç­ä»·äº\n   \tpublic void test() {\n   \t\tsynchronized(this) {\n   \t\t\n   \t\t}\n   \t}\n   }\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   9\n   10\n   11\n   12\n   \n\n * å å¨éææ¹æ³ä¸\n   \n   public class demo {\n   \t//å¨éææ¹æ³ä¸å ä¸synchronizedå³é®å­\n   \tpublic synchronized static void test() {\n   \t\n   \t}\n   \t//ç­ä»·äº\n   \tpublic void test() {\n   \t\tsynchronized(demo.class) {\n   \t\t\n   \t\t}\n   \t}\n   }\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   9\n   10\n   11\n   12\n   \n\n\n# 3ãåéççº¿ç¨å®å¨åæ\n\n# æååéåéæåéæ¯å¦çº¿ç¨å®å¨ï¼\n\n * å¦æå®ä»¬æ²¡æå±äº«ï¼åçº¿ç¨å®å¨\n * å¦æå®ä»¬è¢«å±äº«äºï¼æ ¹æ®å®ä»¬çç¶ææ¯å¦è½å¤æ¹åï¼ååä¸¤ç§æåµ\n   * å¦æåªæè¯»æä½ï¼åçº¿ç¨å®å¨\n   * å¦ææè¯»åæä½ï¼åè¿æ®µä»£ç æ¯ä¸´çåºï¼éè¦èèçº¿ç¨å®å¨\n\n# å±é¨åéæ¯å¦çº¿ç¨å®å¨ï¼\n\n * å±é¨åéæ¯çº¿ç¨å®å¨ç\n\n * ä½å±é¨åéå¼ç¨çå¯¹è±¡åæªå¿ ï¼è¦çè¯¥å¯¹è±¡\n   \n   æ¯å¦è¢«å±äº«\n   \n   ä¸è¢«æ§è¡äºè¯»åæä½ï¼\n   \n   * å¦æè¯¥å¯¹è±¡æ²¡æéç¦»æ¹æ³çä½ç¨èå´ï¼å®æ¯çº¿ç¨å®å¨ç\n   * å¦æè¯¥å¯¹è±¡éç¦»æ¹æ³çä½ç¨èå´ï¼éè¦èèçº¿ç¨å®å¨\n\n * å±é¨åéæ¯çº¿ç¨å®å¨çââæ¯ä¸ªæ¹æ³é½å¨å¯¹åºçº¿ç¨çæ ä¸­åå»ºæ å¸§ï¼ä¸ä¼è¢«å¶ä»çº¿ç¨å±äº«\n\n\n\n * å¦æè°ç¨çå¯¹è±¡è¢«å±äº«ï¼ä¸æ§è¡äºè¯»åæä½ï¼åçº¿ç¨ä¸å®å¨\n\n\n\n * å¦ææ¯å±é¨åéï¼åä¼å¨å ä¸­åå»ºå¯¹åºçå¯¹è±¡ï¼ä¸ä¼å­å¨çº¿ç¨å®å¨é®é¢ã\n\n\n\n\n# å¸¸è§çº¿ç¨å®å¨ç±»\n\n * string\n * integer\n * stringbuï¬er\n * random\n * vector ï¼listççº¿ç¨å®å¨å®ç°ç±»ï¼\n * hashtable ï¼hashççº¿ç¨å®å¨å®ç°ç±»ï¼\n * java.util.concurrent åä¸çç±»\n\nè¿éè¯´å®ä»¬æ¯çº¿ç¨å®å¨çæ¯æï¼å¤ä¸ªçº¿ç¨è°ç¨å®ä»¬åä¸ä¸ªå®ä¾çæä¸ªæ¹æ³æ¶ï¼æ¯çº¿ç¨å®å¨ç\n\n * å®ä»¬çæ¯ä¸ªæ¹æ³æ¯åå­çï¼é½è¢«å ä¸äºsynchronizedï¼\n * ä½æ³¨æå®ä»¬å¤ä¸ªæ¹æ³çç»åä¸æ¯åå­çï¼æä»¥å¯è½ä¼åºç°çº¿ç¨å®å¨é®é¢\n\n\n\n\n# ä¸å¯åç±»çº¿ç¨å®å¨æ§\n\nstringãinteger ç­é½æ¯ä¸å¯åç±»ï¼å ä¸ºå¶åé¨çç¶æä¸å¯ä»¥æ¹åï¼å æ­¤å®ä»¬çæ¹æ³é½æ¯çº¿ç¨å®å¨ç\n\næåå­¦æè®¸æçé®ï¼string æ replaceï¼substring ç­æ¹æ³ãå¯ä»¥ãæ¹åå¼åï¼é£ä¹è¿äºæ¹æ³åæ¯å¦ä½ä¿è¯çº¿ç¨å® å¨çå¢ï¼\n\nè¿æ¯å ä¸ºè¿äºæ¹æ³çè¿åå¼é½åå»ºäºä¸ä¸ªæ°çå¯¹è±¡ï¼èä¸æ¯ç´æ¥æ¹åstringãintegerå¯¹è±¡æ¬èº«ã\n\n\n# 4ãmonitoræ¦å¿µ\n\n\n# (1)åçä¹monitor\n\n\n\n * å½çº¿ç¨æ§è¡å°ä¸´çåºä»£ç æ¶ï¼å¦æä½¿ç¨äºsynchronizedï¼ä¼åæ¥è¯¢synchronizedä¸­ææå®çå¯¹è±¡(obj)æ¯å¦ç»å®äºmonitorã\n   \n   * å¦ææ²¡æç»å®ï¼åä¼åå»å»ä¸monitorç»å®ï¼å¹¶ä¸å°ownerè®¾ä¸ºå½åçº¿ç¨ã\n   \n   * å¦æ\n     \n     å·²ç»ç»å®\n     \n     ï¼åä¼å»æ¥è¯¢è¯¥monitoræ¯å¦å·²ç»æäºowner\n     \n     * å¦ææ²¡æï¼åownerä¸å°å½åçº¿ç¨ç»å®\n     * å¦ææï¼åæ¾å¥entrylistï¼è¿å¥é»å¡ç¶æ(blocked)\n\n * å½monitorçownerå°ä¸´çåºä¸­ä»£ç æ§è¡å®æ¯åï¼ownerä¾¿ä¼è¢«æ¸ç©ºï¼æ­¤æ¶entrylistä¸­å¤äºé»å¡ç¶æççº¿ç¨ä¼è¢«å«éå¹¶ç«äºï¼æ­¤æ¶çç«äºæ¯éå¬å¹³ç\n\n * æ³¨æï¼\n   \n   * å¯¹è±¡å¨ä½¿ç¨äºsynchronizedåä¸monitorç»å®æ¶ï¼ä¼å°å¯¹è±¡å¤´ä¸­çmark wordç½®ä¸ºmonitoræéã\n   * æ¯ä¸ªå¯¹è±¡é½ä¼ç»å®ä¸ä¸ªå¯ä¸çmonitorï¼å¦æsynchronizedä¸­ææå®çå¯¹è±¡(obj)ä¸åï¼åä¼ç»å®ä¸åçmonitor\n\n\n# 5ãsynchronizedåçè¿é¶\n\n\n# å¯¹è±¡å¤´æ ¼å¼\n\n\n\n\n# (1)è½»éçº§éï¼ç¨äºä¼åmonitorè¿ç±»çééçº§éï¼\n\nè½»éçº§éä½¿ç¨åºæ¯ï¼å½ä¸ä¸ªå¯¹è±¡è¢«å¤ä¸ªçº¿ç¨æè®¿é®ï¼ä½è®¿é®çæ¶é´æ¯éå¼çï¼ä¸å­å¨ç«äºï¼ï¼æ­¤æ¶å°±å¯ä»¥ä½¿ç¨è½»éçº§éæ¥ä¼åã\n\n * åå»ºéè®°å½ï¼lock recordï¼å¯¹è±¡ï¼æ¯ä¸ªçº¿ç¨çæ å¸§é½ä¼åå«ä¸ä¸ªéè®°å½å¯¹è±¡ï¼åé¨å¯ä»¥å­å¨éå®å¯¹è±¡çmark wordï¼ä¸åä¸å¼å§å°±ä½¿ç¨monitorï¼\n   \n   \n\n * è®©éè®°å½ä¸­çobject referenceæåéå¯¹è±¡ï¼objectï¼ï¼å¹¶å°è¯ç¨caså»æ¿æ¢objectä¸­çmark wordï¼å°æ­¤mark wordæ¾å¥lock recordä¸­ä¿å­\n\n\n\n * å¦æcasæ¿æ¢æåï¼åå°objectçå¯¹è±¡å¤´æ¿æ¢ä¸ºéè®°å½çå°ååç¶æ 00ï¼è½»éçº§éç¶æï¼ï¼å¹¶ç±è¯¥çº¿ç¨ç»å¯¹è±¡å é\n\n\n\n\n# (2)éè¨è\n\n * å¦æä¸ä¸ªçº¿ç¨å¨ç»ä¸ä¸ªå¯¹è±¡å è½»éçº§éæ¶ï¼casæ¿æ¢æä½å¤±è´¥ï¼å ä¸ºæ­¤æ¶å¶ä»çº¿ç¨å·²ç»ç»å¯¹è±¡å äºè½»éçº§éï¼ï¼æ­¤æ¶è¯¥çº¿ç¨å°±ä¼è¿å¥éè¨èè¿ç¨\n\n\n\n * æ­¤æ¶ä¾¿ä¼ç»å¯¹è±¡å ä¸ééçº§éï¼ä½¿ç¨monitorï¼\n   \n   * å°å¯¹è±¡å¤´çmark wordæ¹ä¸ºmonitorçå°åï¼å¹¶ä¸ç¶ææ¹ä¸º01(ééçº§é)\n   \n   * å¹¶ä¸è¯¥çº¿ç¨æ¾å¥å¥entrylistä¸­ï¼å¹¶è¿å¥é»å¡ç¶æ(blocked)\n     \n     \n\n\n# (3)èªæä¼å\n\nééçº§éç«äºæ¶ï¼è¿å¯ä»¥ä½¿ç¨èªéæ¥ä¼åï¼å¦æå½åçº¿ç¨å¨èªææåï¼ä½¿ç¨éççº¿ç¨éåºäºåæ­¥åï¼éæ¾äºéï¼ï¼è¿æ¶å°±å¯ä»¥é¿åçº¿ç¨è¿å¥é»å¡ç¶æã\n\n * ç¬¬ä¸ç§æåµ\n\n\n\n * ç¬¬äºç§æåµ\n\n\n\n\n# (4)ååé(ç¨äºä¼åè½»éçº§ééå¥)\n\nè½»éçº§éå¨æ²¡æç«äºæ¶ï¼æ¯æ¬¡éå¥ï¼è¯¥çº¿ç¨æ§è¡çæ¹æ³ä¸­åæ¬¡éä½è¯¥å¯¹è±¡ï¼æä½ä»éè¦casæ¿æ¢æä½ï¼è¿æ ·æ¯ä¼ä½¿æ§è½éä½çã\n\næä»¥å¼å¥äºååéå¯¹æ§è½è¿è¡ä¼åï¼å¨ç¬¬ä¸æ¬¡casæ¶ä¼å°çº¿ç¨çidåå¥å¯¹è±¡çmark wordä¸­ãæ­¤ååç°è¿ä¸ªçº¿ç¨idå°±æ¯èªå·±çï¼å°±è¡¨ç¤ºæ²¡æç«äºï¼å°±ä¸éè¦åæ¬¡casï¼ä»¥ååªè¦ä¸åçç«äºï¼è¿ä¸ªå¯¹è±¡å°±å½è¯¥çº¿ç¨ææã\n\n\n\n# ååç¶æ\n\n * normalï¼ä¸è¬ç¶æï¼æ²¡æå ä»»ä½éï¼åé¢62ä½ä¿å­çæ¯å¯¹è±¡çä¿¡æ¯ï¼æå2ä½ä¸ºç¶æï¼01ï¼ï¼åæ°ç¬¬ä¸ä½è¡¨ç¤ºæ¯å¦ä½¿ç¨ååéï¼æªä½¿ç¨ï¼0ï¼\n * biasedï¼ååç¶æï¼ä½¿ç¨ååéï¼åé¢54ä½ä¿å­çå½åçº¿ç¨çidï¼æå2ä½ä¸ºç¶æï¼01ï¼ï¼åæ°ç¬¬ä¸ä½è¡¨ç¤ºæ¯å¦ä½¿ç¨ååéï¼ä½¿ç¨ï¼1ï¼\n * lightweightï¼ä½¿ç¨è½»éçº§éï¼å62ä½ä¿å­çæ¯éè®°å½çæéï¼æåä¸¤ä½ä¸ºç¶æï¼00ï¼\n * heavyweightï¼ä½¿ç¨ééçº§éï¼å62ä½ä¿å­çæ¯monitorçå°åæéï¼åä¸¤ä½ä¸ºç¶æ(10)\n\n\n\n * å¦æå¼å¯äºååéï¼é»è®¤å¼å¯ï¼ï¼å¨åå»ºå¯¹è±¡æ¶ï¼å¯¹è±¡çmark wordåä¸ä½åºè¯¥æ¯101\n * ä½æ¯ååéé»è®¤æ¯æå»¶è¿çï¼ä¸ä¼åç¨åºä¸å¯å¨å°±çæï¼èæ¯ä¼å¨ç¨åºè¿è¡ä¸æ®µæ¶é´ï¼å ç§ä¹åï¼ï¼æä¼å¯¹åå»ºçå¯¹è±¡è®¾ç½®ä¸ºååç¶æ\n * å¦ææ²¡æå¼å¯ååéï¼å¯¹è±¡çmark wordåä¸ä½åºè¯¥æ¯001\n\n# æ¤éåå\n\nä»¥ä¸å ç§æåµä¼ä½¿å¯¹è±¡çååéå¤±æ\n\n * è°ç¨å¯¹è±¡çhashcodeæ¹æ³\n * å¤ä¸ªçº¿ç¨ä½¿ç¨è¯¥å¯¹è±¡\n * è°ç¨äºwait/notifyæ¹æ³ï¼è°ç¨waitæ¹æ³ä¼å¯¼è´éè¨èèä½¿ç¨ééçº§éï¼\n\n\n# (5)æ¹ééåå\n\n * å¦æå¯¹è±¡è½ç¶è¢«å¤ä¸ªçº¿ç¨è®¿é®ï¼ä½æ¯çº¿ç¨é´ä¸å­å¨ç«äºï¼è¿æ¶ååt1çå¯¹è±¡ä»ææºä¼éæ°ååt2\n   * éååä¼éç½®thread id\n * å½æ¤éè¶è¿20æ¬¡åï¼è¶è¿éå¼ï¼ï¼jvmä¼è§å¾æ¯ä¸æ¯ååéäºï¼è¿æ¶ä¼å¨ç»å¯¹è±¡å éæ¶ï¼éæ°ååè³å éçº¿ç¨ã\n\n\n# (6)æ¹éæ¤é\n\nå½æ¤éååéçéå¼è¶è¿40ä»¥åï¼å°±ä¼å°æ´ä¸ªç±»çå¯¹è±¡é½æ¹ä¸ºä¸å¯ååç\n\n\n# 6ãwait/notify\n\n\n# (1)åç\n\n\n\n * éå¯¹è±¡è°ç¨waitæ¹æ³ï¼obj.waitï¼ï¼å°±ä¼ä½¿å½åçº¿ç¨è¿å¥waitsetä¸­ï¼åä¸ºwaitingç¶æã\n\n * å¤äºblockedåwaitingç¶æççº¿ç¨é½ä¸º\n   \n   é»å¡\n   \n   ç¶æï¼cpué½ä¸ä¼åç»ä»ä»¬æ¶é´çãä½æ¯ææåºå«ï¼\n   \n   * blockedç¶æççº¿ç¨æ¯å¨ç«äºå¯¹è±¡æ¶ï¼åç°monitorçownerå·²ç»æ¯å«ççº¿ç¨äºï¼æ­¤æ¶å°±ä¼è¿å¥entrylistä¸­ï¼å¹¶å¤äºblockedç¶æ\n   * waitingç¶æççº¿ç¨æ¯è·å¾äºå¯¹è±¡çéï¼ä½æ¯èªèº«å ä¸ºæäºåå éè¦è¿å¥é»å¡ç¶ææ¶ï¼éå¯¹è±¡è°ç¨äºwaitæ¹æ³èè¿å¥äºwaitsetä¸­ï¼å¤äºwaitingç¶æ\n\n * blockedç¶æççº¿ç¨ä¼å¨éè¢«éæ¾çæ¶åè¢«å¤éï¼ä½æ¯å¤äºwaitingç¶æççº¿ç¨åªæè¢«éå¯¹è±¡è°ç¨äºnotifyæ¹æ³(obj.notify/obj.notifyall)ï¼æä¼è¢«å¤éã\n\næ³¨ï¼åªæå½å¯¹è±¡è¢«éä»¥åï¼æè½è°ç¨waitånotifyæ¹æ³\n\npublic class test1 {\n\tfinal static object lock = new object();\n\tpublic static void main(string[] args) throws interruptedexception {\n        //åªæå¨å¯¹è±¡è¢«éä½åæè½è°ç¨waitæ¹æ³\n\t\tsynchronized (lock) {\n\t\t\tlock.wait();\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n# (2)waitä¸sleepçåºå«\n\nä¸åç¹\n\n * sleepæ¯threadç±»çéææ¹æ³ï¼waitæ¯objectçæ¹æ³ï¼objectåæ¯ææç±»çç¶ç±»ï¼æä»¥ææç±»é½æwaitæ¹æ³ã\n * sleepå¨é»å¡çæ¶åä¸ä¼éæ¾éï¼èwaitå¨é»å¡çæ¶åä¼éæ¾é\n * sleepä¸éè¦ä¸synchronizedä¸èµ·ä½¿ç¨ï¼èwaitéè¦ä¸synchronizedä¸èµ·ä½¿ç¨ï¼å¯¹è±¡è¢«éä»¥åæè½ä½¿ç¨ï¼\n\nç¸åç¹\n\n * é»å¡ç¶æé½ä¸ºtimed_waiting\n\n\n# (3)ä¼éå°ä½¿ç¨wait/notify\n\nä»ä¹æ¶åéåä½¿ç¨wait\n\n * å½çº¿ç¨ä¸æ»¡è¶³æäºæ¡ä»¶ï¼éè¦æåè¿è¡æ¶ï¼å¯ä»¥ä½¿ç¨waitãè¿æ ·ä¼å°å¯¹è±¡çééæ¾ï¼è®©å¶ä»çº¿ç¨è½å¤ç»§ç»­è¿è¡ãå¦ææ­¤æ¶ä½¿ç¨sleepï¼ä¼å¯¼è´ææçº¿ç¨é½è¿å¥é»å¡ï¼å¯¼è´ææçº¿ç¨é½æ²¡æ³è¿è¡ï¼ç´å°å½åçº¿ç¨sleepç»æåï¼è¿è¡å®æ¯ï¼æè½å¾å°æ§è¡ã\n\nä½¿ç¨wait/notifyéè¦æ³¨æä»ä¹\n\n * å½æå¤ä¸ªçº¿ç¨å¨è¿è¡æ¶ï¼å¯¹è±¡è°ç¨äºwaitæ¹æ³ï¼æ­¤æ¶è¿äºçº¿ç¨é½ä¼è¿å¥waitsetä¸­ç­å¾ãå¦æè¿æ¶ä½¿ç¨äºnotifyæ¹æ³ï¼å¯è½ä¼é æèåå¤éï¼å¤éçä¸æ¯æ»¡è¶³æ¡ä»¶çç­å¾çº¿ç¨ï¼ï¼è¿æ¶å°±éè¦ä½¿ç¨notifyallæ¹æ³\n\nsynchronized (lock) {\n\twhile(//ä¸æ»¡è¶³æ¡ä»¶ï¼ä¸ç´ç­å¾ï¼é¿åèåå¤é) {\n\t\tlock.wait();\n\t}\n\t//æ»¡è¶³æ¡ä»¶ååè¿è¡\n}\n\nsynchronized (lock) {\n\t//å¤éææç­å¾çº¿ç¨\n\tlock.notifyall();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# 7ãæ¨¡å¼ä¹ä¿æ¤æ§æå\n\n\n# (1)å®ä¹\n\n\n\n\n# (2)ä¸¾ä¾\n\npublic class test2 {\n\tpublic static void main(string[] args) {\n\t\tstring hello = "hello thread!";\n\t\tguarded guarded = new guarded();\n\t\tnew thread(()->{\n\t\t\tsystem.out.println("æ³è¦å¾å°ç»æ");\n\t\t\tsynchronized (guarded) {\n\t\t\t\tsystem.out.println("ç»ææ¯ï¼"+guarded.getresponse());\n\t\t\t}\n\t\t\tsystem.out.println("å¾å°ç»æ");\n\t\t}).start();\n\n\t\tnew thread(()->{\n\t\t\tsystem.out.println("è®¾ç½®ç»æ");\n\t\t\tsynchronized (guarded) {\n\t\t\t\tguarded.setresponse(hello);\n\t\t\t}\n\t\t}).start();\n\t}\n}\n\nclass guarded {\n\t/**\n\t * è¦è¿åçç»æ\n\t */\n\tprivate object response;\n\t\n    //ä¼éå°ä½¿ç¨wait/notify\n\tpublic object getresponse() {\n\t\t//å¦æè¿åç»æä¸ºç©ºå°±ä¸ç´ç­å¾ï¼é¿åèåå¤é\n\t\twhile(response == null) {\n\t\t\tsynchronized (this) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.wait();\n\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\te.printstacktrace();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn response;\n\t}\n\n\tpublic void setresponse(object response) {\n\t\tthis.response = response;\n\t\tsynchronized (this) {\n\t\t\t//å¤éä¼ç ççº¿ç¨\n\t\t\tthis.notifyall();\n\t\t}\n\t}\n\n\t@override\n\tpublic string tostring() {\n\t\treturn "guarded{" +\n\t\t\t\t"response=" + response +\n\t\t\t\t\'}\';\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n\n\nå¸¦è¶æ¶å¤æ­çæå\n\npublic object getresponse(long time) {\n\t\tsynchronized (this) {\n\t\t\t//è·åå¼å§æ¶é´\n\t\t\tlong currenttime = system.currenttimemillis();\n\t\t\t//ç¨äºä¿å­å·²ç»ç­å¾äºçæ¶é´\n\t\t\tlong passedtime = 0;\n\t\t\twhile(response == null) {\n\t\t\t\t//çç»è¿çæ¶é´-å¼å§æ¶é´æ¯å¦è¶è¿äºæå®æ¶é´\n\t\t\t\tlong waittime = time -passedtime;\n\t\t\t\tif(waittime <= 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttry {\n                   \t//ç­å¾å©ä½æ¶é´\n\t\t\t\t\tthis.wait(waittime);\n\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\te.printstacktrace();\n\t\t\t\t}\n\t\t\t\t//è·åå½åæ¶é´\n\t\t\t\tpassedtime = system.currenttimemillis()-currenttime\t\t\n            }\n\t\t}\n\t\treturn response;\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n# (3)joinæºç ââä½¿ç¨ä¿æ¤æ§æåæ¨¡å¼\n\npublic final synchronized void join(long millis)\n    throws interruptedexception {\n        long base = system.currenttimemillis();\n        long now = 0;\n\n        if (millis < 0) {\n            throw new illegalargumentexception("timeout value is negative");\n        }\n\n        if (millis == 0) {\n            while (isalive()) {\n                wait(0);\n            }\n        } else {\n            while (isalive()) {\n                long delay = millis - now;\n                if (delay <= 0) {\n                    break;\n                }\n                wait(delay);\n                now = system.currenttimemillis() - base;\n            }\n        }\n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n# 8ãpark/unpark\n\n\n# (1)åºæ¬ä½¿ç¨\n\npark/unparké½æ¯locksupportç±»ä¸­ççæ¹æ³\n\n//æåçº¿ç¨è¿è¡\nlocksupport.park;\n\n//æ¢å¤çº¿ç¨è¿è¡\nlocksupport.unpark(thread);\npublic static void main(string[] args) throws interruptedexception {\n\t\tthread thread = new thread(()-> {\n\t\t\tsystem.out.println("park");\n            //æåçº¿ç¨è¿è¡\n\t\t\tlocksupport.park();\n\t\t\tsystem.out.println("resume");\n\t\t}, "t1");\n\t\tthread.start();\n\n\t\tthread.sleep(1000);\n\t\tsystem.out.println("unpark");\n    \t//æ¢å¤çº¿ç¨è¿è¡\n\t\tlocksupport.unpark(thread);\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n# (2)ç¹ç¹\n\nä¸wait/notifyçåºå«\n\n * waitï¼notify å notifyall å¿é¡»éåobject monitorä¸èµ·ä½¿ç¨ï¼èparkï¼unparkä¸å¿\n * park ï¼unpark æ¯ä»¥çº¿ç¨ä¸ºåä½æ¥é»å¡åå¤éçº¿ç¨ï¼è notify åªè½éæºå¤éä¸ä¸ªç­å¾çº¿ç¨ï¼notifyall æ¯å¤éææç­å¾çº¿ç¨ï¼å°±ä¸é£ä¹ç²¾ç¡®\n * park & unpark å¯ä»¥å unparkï¼è wait & notify ä¸è½å notify\n * parkä¸ä¼éæ¾éï¼èwaitä¼éæ¾é\n\n\n# (3)åç\n\næ¯ä¸ªçº¿ç¨é½æä¸ä¸ªèªå·±çparkå¯¹è±¡ï¼å¹¶ä¸è¯¥å¯¹è±¡**_counter, _cond,__mutex**ç»æ\n\n * åè°ç¨parkåè°ç¨unparkæ¶\n   \n   * åè°ç¨park\n     \n     * çº¿ç¨è¿è¡æ¶ï¼ä¼å°parkå¯¹è±¡ä¸­ç**_counterçå¼è®¾ä¸º0**ï¼\n     * è°ç¨parkæ¶ï¼ä¼åæ¥çcounterçå¼æ¯å¦ä¸º0ï¼å¦æä¸º0ï¼åå°çº¿ç¨æ¾å¥é»å¡éåcondä¸­\n     * æ¾å¥é»å¡éåä¸­åï¼ä¼åæ¬¡å°counterè®¾ç½®ä¸º0\n   \n   * ç¶åè°ç¨unpark\n     \n     * è°ç¨unparkæ¹æ³åï¼ä¼å°counterçå¼è®¾ç½®ä¸º1\n     \n     * å»å¤éé»å¡éåcondä¸­ççº¿ç¨\n     \n     * çº¿ç¨ç»§ç»­è¿è¡å¹¶å°counterçå¼è®¾ä¸º0\n       \n       \n\n\n\n * åè°ç¨unparkï¼åè°ç¨park\n   * è°ç¨unpark\n     * ä¼å°counterè®¾ç½®ä¸º1ï¼è¿è¡æ¶0ï¼\n   * è°ç¨parkæ¹æ³\n     * æ¥çcounteræ¯å¦ä¸º0\n     * å ä¸ºunparkå·²ç»æcounterè®¾ç½®ä¸º1ï¼æä»¥æ­¤æ¶å°counterè®¾ç½®ä¸º0ï¼ä½ä¸æ¾å¥é»å¡éåcondä¸­\n\n\n\n\n# 9ãçº¿ç¨ä¸­çç¶æè½¬æ¢\n\n\n\n\n# æåµä¸ï¼new â> runnable\n\n * å½è°ç¨äºt.start()æ¹æ³æ¶ï¼ç± new â> runnable\n\n\n# æåµäºï¼ runnable <â> waiting\n\n * å½è°ç¨äºt çº¿ç¨ç¨ synchronized(obj) è·åäºå¯¹è±¡éå\n   * è°ç¨ obj.wait() æ¹æ³æ¶ï¼t çº¿ç¨ä» runnable â> waiting\n   * è°ç¨ obj.notify() ï¼ obj.notifyall() ï¼ t.interrupt() æ¶\n     * ç«äºéæåï¼t çº¿ç¨ä» waiting â> runnable\n     * ç«äºéå¤±è´¥ï¼t çº¿ç¨ä» waiting â> blocked\n\n\n# æåµä¸ï¼runnable <â> waiting\n\n * å½åçº¿ç¨\n   \n   è°ç¨ t.join() æ¹æ³æ¶ï¼å½åçº¿ç¨ä» runnable â> waiting\n   \n   * æ³¨ææ¯å½åçº¿ç¨å¨t çº¿ç¨å¯¹è±¡ççè§å¨ä¸ç­å¾\n\n * t çº¿ç¨è¿è¡ç»æï¼æè°ç¨äºå½åçº¿ç¨ç interrupt() æ¶ï¼å½åçº¿ç¨ä» waiting â> runnable\n\n\n# æåµåï¼ runnable <â> waiting\n\n * å½åçº¿ç¨è°ç¨ locksupport.park() æ¹æ³ä¼è®©å½åçº¿ç¨ä» runnable â> waiting\n * è°ç¨ locksupport.unpark(ç®æ çº¿ç¨) æè°ç¨äºçº¿ç¨ ç interrupt() ï¼ä¼è®©ç®æ çº¿ç¨ä» waiting â> runnable\n\n\n# æåµäºï¼ runnable <â> timed_waiting\n\nt çº¿ç¨ç¨ synchronized(obj) è·åäºå¯¹è±¡éå\n\n * è°ç¨ obj.wait(long n) æ¹æ³æ¶ï¼t çº¿ç¨ä» runnable â> timed_waiting\n * t çº¿ç¨ç­å¾æ¶é´è¶è¿äº n æ¯«ç§ï¼æè°ç¨ obj.notify() ï¼ obj.notifyall() ï¼ t.interrupt() æ¶\n   * ç«äºéæåï¼t çº¿ç¨ä» timed_waiting â> runnable\n   * ç«äºéå¤±è´¥ï¼t çº¿ç¨ä» timed_waiting â> blocked\n\n\n# æåµå­ï¼runnable <â> timed_waiting\n\n * å½åçº¿ç¨è°ç¨ t.join\n   \n   (long n\n   \n   ) æ¹æ³æ¶ï¼å½åçº¿ç¨ä» runnable â> timed_waiting\n   \n   * æ³¨ææ¯å½åçº¿ç¨å¨t çº¿ç¨å¯¹è±¡ççè§å¨ä¸ç­å¾\n\n * å½åçº¿ç¨ç­å¾æ¶é´è¶è¿äº n æ¯«ç§ï¼æt çº¿ç¨è¿è¡ç»æï¼æè°ç¨äºå½åçº¿ç¨ç interrupt() æ¶ï¼å½åçº¿ç¨ä» timed_waiting â> runnable\n\n\n# æåµä¸ï¼runnable <â> timed_waiting\n\n * å½åçº¿ç¨è°ç¨ thread.sleep(long n) ï¼å½åçº¿ç¨ä» runnable â> timed_waiting\n * å½åçº¿ç¨ç­å¾æ¶é´è¶è¿äº n æ¯«ç§ï¼å½åçº¿ç¨ä» timed_waiting â> runnable\n\n\n# æåµå«ï¼runnable <â> timed_waiting\n\n * å½åçº¿ç¨è°ç¨ locksupport.parknanos(long nanos) æ locksupport.parkuntil(long millis) æ¶ï¼å½åçº¿ ç¨ä» runnable â> timed_waiting\n * è°ç¨ locksupport.unpark(ç®æ çº¿ç¨) æè°ç¨äºçº¿ç¨ ç interrupt() ï¼ææ¯ç­å¾è¶æ¶ï¼ä¼è®©ç®æ çº¿ç¨ä» timed_waitingâ> runnable\n\n\n# æåµä¹ï¼runnable <â> blocked\n\n * t çº¿ç¨ç¨ synchronized(obj) è·åäºå¯¹è±¡éæ¶å¦æç«äºå¤±è´¥ï¼ä» runnable â> blocked\n * æ obj éçº¿ç¨çåæ­¥ä»£ç åæ§è¡å®æ¯ï¼ä¼å¤éè¯¥å¯¹è±¡ä¸ææ blocked ççº¿ç¨éæ°ç«äºï¼å¦æå¶ä¸­ t çº¿ç¨ç«äº æåï¼ä» blocked â> runnable ï¼å¶å®å¤±è´¥ççº¿ç¨ä»ç¶ blocked\n\n\n# æåµåï¼ runnable <â> terminated\n\nå½åçº¿ç¨ææä»£ç è¿è¡å®æ¯ï¼è¿å¥ terminated\n\n\n# 10ãå¤æé\n\nå°éçç²åº¦ç»å\n\nclass bigroom {\n    //é¢å¤åå»ºå¯¹è±¡æ¥ä½ä¸ºé\n\tprivate final object studyroom = new object();\n\tprivate final object bedroom = new object();\n}\n\n\n1\n2\n3\n4\n5\n\n\n\n# 11ãæ´»è·æ§\n\n\n# (1)å®ä¹\n\nå ä¸ºæç§åå ï¼ä½¿å¾ä»£ç ä¸ç´æ æ³æ§è¡å®æ¯ï¼è¿æ ·çç°è±¡å«åæ´»è·æ§\n\n\n# (2)æ­»é\n\næè¿æ ·çæåµï¼ä¸ä¸ªçº¿ç¨éè¦åæ¶è·åå¤æéï¼è¿æ¶å°±å®¹æåçæ­»é\n\nå¦ï¼t1çº¿ç¨è·å¾aå¯¹è±¡ éï¼æ¥ä¸æ¥æ³è·åbå¯¹è±¡çét2çº¿ç¨è·å¾bå¯¹è±¡éï¼æ¥ä¸æ¥æ³è·åaå¯¹è±¡çé\n\npublic static void main(string[] args) {\n\t\tfinal object a = new object();\n\t\tfinal object b = new object();\n\t\tnew thread(()->{\n\t\t\tsynchronized (a) {\n\t\t\t\ttry {\n\t\t\t\t\tthread.sleep(2000);\n\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\te.printstacktrace();\n\t\t\t\t}\n\t\t\t\tsynchronized (b) {\n\n\t\t\t\t}\n\t\t\t}\n\t\t}).start();\n\n\t\tnew thread(()->{\n\t\t\tsynchronized (b) {\n\t\t\t\ttry {\n\t\t\t\t\tthread.sleep(1000);\n\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\te.printstacktrace();\n\t\t\t\t}\n\t\t\t\tsynchronized (a) {\n\n\t\t\t\t}\n\t\t\t}\n\t\t}).start();\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\n# åçæ­»éçå¿è¦æ¡ä»¶\n\n * äºæ¥æ¡ä»¶\n   * å¨ä¸æ®µæ¶é´åï¼ä¸ç§èµæºåªè½è¢«ä¸ä¸ªè¿ç¨æä½¿ç¨\n * è¯·æ±åä¿ææ¡ä»¶\n   * è¿ç¨å·²ç»æ¥æäºè³å°ä¸ç§èµæºï¼åæ¶åå»ç³è¯·å¶ä»èµæºãå ä¸ºå¶ä»èµæºè¢«å«çè¿ç¨æä½¿ç¨ï¼è¯¥è¿ç¨è¿å¥é»å¡ç¶æï¼å¹¶ä¸ä¸éæ¾èªå·±å·²æçèµæº\n * ä¸å¯æ¢å æ¡ä»¶\n   * è¿ç¨å¯¹å·²è·å¾çèµæºå¨æªä½¿ç¨å®æåä¸è½è¢«å¼ºå ï¼åªè½å¨è¿ç¨ä½¿ç¨å®åèªå·±éæ¾\n * å¾ªç¯ç­å¾æ¡ä»¶\n   * åçæ­»éæ¶ï¼å¿ç¶å­å¨ä¸ä¸ªè¿ç¨ââèµæºçå¾ªç¯é¾ã\n\n# å®ä½æ­»éçæ¹æ³\n\n * jps+jstack threadid\n   \n   * å¨javaæ§å¶å°ä¸­çterminalä¸­è¾å¥jpsæä»¤å¯ä»¥æ¥çè¿è¡ä¸­ççº¿ç¨idï¼ä½¿ç¨jstack threadidå¯ä»¥æ¥ççº¿ç¨ç¶æã\n     \n     \n   \n   f:\\thread_study>jps\n   20672 remotemavenserver36\n   22880 jps\n   4432 launcher\n   5316 test5\n   20184 kotlincompiledaemon\n   11132\n   \n   f:\\thread_study>jstack 5316\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   9\n   \n\n * æå°çç»æ\n   \n   //æ¾å°ä¸ä¸ªjavaçº§å«çæ­»é\n   found one java-level deadlock:\n   =============================\n   "thread-1":\n     waiting to lock monitor 0x0000000017f40de8 (object 0x00000000d6188880, a java.lang.object),\n     which is held by "thread-0"\n   "thread-0":\n     waiting to lock monitor 0x0000000017f43678 (object 0x00000000d6188890, a java.lang.object),\n     which is held by "thread-1"\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   9\n   \n\n * jconsoleæ£æµæ­»é\n   \n   \n   \n   \n\n# å²å­¦å®¶å°±é¤é®é¢\n\n\n\n# é¿åæ­»éçæ¹æ³\n\nå¨çº¿ç¨ä½¿ç¨éå¯¹è±¡æ¶**ï¼é¡ºåºå é**å³å¯é¿åæ­»é\n\n\n\n\n# (3)æ´»é\n\næ´»éåºç°å¨ä¸¤ä¸ªçº¿ç¨äºç¸æ¹åå¯¹æ¹çç»ææ¡ä»¶ï¼åè°ä¹æ æ³ç»æã\n\n# é¿åæ´»éçæ¹æ³\n\nå¨çº¿ç¨æ§è¡æ¶ï¼ä¸­éç»äºä¸åçé´éæ¶é´å³å¯ã\n\n# æ­»éä¸æ´»éçåºå«\n\n * æ­»éæ¯å ä¸ºçº¿ç¨äºç¸ææå¯¹è±¡æ³è¦çéï¼å¹¶ä¸é½ä¸éæ¾ï¼æåå°æ¶çº¿ç¨é»å¡ï¼åæ­¢è¿è¡çç°è±¡ã\n * æ´»éæ¯å ä¸ºçº¿ç¨é´ä¿®æ¹äºå¯¹æ¹çç»ææ¡ä»¶ï¼èå¯¼è´ä»£ç ä¸ç´å¨è¿è¡ï¼å´ä¸ç´è¿è¡ä¸å®çç°è±¡ã\n\n\n# (4)é¥¥é¥¿\n\næäºçº¿ç¨å ä¸ºä¼åçº§å¤ªä½ï¼å¯¼è´ä¸ç´æ æ³è·å¾èµæºçç°è±¡ã\n\nå¨ä½¿ç¨é¡ºåºå éæ¶ï¼å¯è½ä¼åºç°é¥¥é¥¿ç°è±¡\n\n\n# 12ãreentrantlock\n\nåsynchronizedç¸æ¯å·æççç¹ç¹\n\n * å¯ä¸­æ­\n * å¯ä»¥è®¾ç½®è¶æ¶æ¶é´\n * å¯ä»¥è®¾ç½®ä¸ºå¬å¹³é (åå°åå¾)\n * æ¯æå¤ä¸ªæ¡ä»¶åé( å·æå¤ä¸ªwaitset)\n\nåºæ¬è¯­æ³\n\n//è·åreentrantlockå¯¹è±¡\nprivate reentrantlock lock = new reentrantlock();\n//å é\nlock.lock();\ntry {\n\t//éè¦æ§è¡çä»£ç \n}finally {\n\t//éæ¾é\n\tlock.unlock();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n# å¯éå¥\n\n * å¯éå¥æ¯æåä¸ä¸ªçº¿ç¨å¦æé¦æ¬¡è·å¾äºè¿æéï¼é£ä¹å ä¸ºå®æ¯è¿æéçæ¥æèï¼å æ­¤ææå©åæ¬¡è·åè¿æé\n * å¦ææ¯ä¸å¯éå¥éï¼é£ä¹ç¬¬äºæ¬¡è·å¾éæ¶ï¼èªå·±ä¹ä¼è¢«éæ¡ä½\n\n# å¯ææ­\n\nå¦ææä¸ªçº¿ç¨å¤äºé»å¡ç¶æï¼å¯ä»¥è°ç¨å¶interruptæ¹æ³è®©å¶åæ­¢é»å¡ï¼è·å¾éå¤±è´¥\n\nç®èè¨ä¹å°±æ¯ï¼å¤äºé»å¡ç¶æççº¿ç¨ï¼è¢«ææ­äºå°±ä¸ç¨é»å¡äºï¼ç´æ¥åæ­¢è¿è¡\n\npublic static void main(string[] args) {\n\t\treentrantlock lock = new reentrantlock();\n\t\tthread t1 = new thread(()-> {\n\t\t\ttry {\n\t\t\t\t//å éï¼å¯ææ­é\n\t\t\t\tlock.lockinterruptibly();\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n                //è¢«ææ­ï¼è¿åï¼ä¸ååä¸æ§è¡\n\t\t\t\treturn;\n\t\t\t}finally {\n\t\t\t\t//éæ¾é\n\t\t\t\tlock.unlock();\n\t\t\t}\n\n\t\t});\n\n\t\tlock.lock();\n\t\ttry {\n\t\t\tt1.start();\n\t\t\tthread.sleep(1000);\n\t\t\t//ææ­\n\t\t\tt1.interrupt();\n\t\t} catch (interruptedexception e) {\n\t\t\te.printstacktrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\n# éè¶æ¶\n\nä½¿ç¨lock.trylockæ¹æ³ä¼è¿åè·åéæ¯å¦æåãå¦ææååè¿åtrueï¼åä¹åè¿åfalseã\n\nå¹¶ä¸trylockæ¹æ³å¯ä»¥æå®ç­å¾æ¶é´ï¼åæ°ä¸ºï¼trylock(long timeout, timeunit unit), å¶ä¸­timeoutä¸ºæé¿ç­å¾æ¶é´ï¼timeunitä¸ºæ¶é´åä½\n\nç®èè¨ä¹å°±æ¯ï¼è·åå¤±è´¥äºãè·åè¶æ¶äºæèè¢«ææ­äºï¼ä¸åé»å¡ï¼ç´æ¥åæ­¢è¿è¡\n\nä¸è®¾ç½®ç­å¾æ¶é´\n\npublic static void main(string[] args) {\n\t\treentrantlock lock = new reentrantlock();\n\t\tthread t1 = new thread(()-> {\n            //æªè®¾ç½®ç­å¾æ¶é´ï¼ä¸æ¦è·åå¤±è´¥ï¼ç´æ¥è¿åfalse\n\t\t\tif(!lock.trylock()) {\n\t\t\t\tsystem.out.println("è·åå¤±è´¥");\n                //è·åå¤±è´¥ï¼ä¸ååä¸æ§è¡ï¼è¿å\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsystem.out.println("å¾å°äºé");\n\t\t\tlock.unlock();\n\t\t});\n\n\n\t\tlock.lock();\n\t\ttry{\n\t\t\tt1.start();\n\t\t\tthread.sleep(3000);\n\t\t} catch (interruptedexception e) {\n\t\t\te.printstacktrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\nè®¾ç½®ç­å¾æ¶é´\n\npublic static void main(string[] args) {\n\t\treentrantlock lock = new reentrantlock();\n\t\tthread t1 = new thread(()-> {\n\t\t\ttry {\n\t\t\t\t//å¤æ­è·åéæ¯å¦æåï¼æå¤ç­å¾1ç§\n\t\t\t\tif(!lock.trylock(1, timeunit.seconds)) {\n\t\t\t\t\tsystem.out.println("è·åå¤±è´¥");\n\t\t\t\t\t//è·åå¤±è´¥ï¼ä¸ååä¸æ§è¡ï¼ç´æ¥è¿å\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t\t//è¢«ææ­ï¼ä¸ååä¸æ§è¡ï¼ç´æ¥è¿å\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsystem.out.println("å¾å°äºé");\n\t\t\t//éæ¾é\n\t\t\tlock.unlock();\n\t\t});\n\n\n\t\tlock.lock();\n\t\ttry{\n\t\t\tt1.start();\n\t\t\t//ææ­ç­å¾\n\t\t\tt1.interrupt();\n\t\t\tthread.sleep(3000);\n\t\t} catch (interruptedexception e) {\n\t\t\te.printstacktrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n# å¬å¹³é\n\nå¨çº¿ç¨è·åéå¤±è´¥ï¼è¿å¥é»å¡éåæ¶ï¼åè¿å¥çä¼å¨éè¢«éæ¾ååè·å¾éãè¿æ ·çè·åæ¹å¼å°±æ¯å¬å¹³çã\n\n//é»è®¤æ¯ä¸å¬å¹³éï¼éè¦å¨åå»ºæ¶æå®ä¸ºå¬å¹³é\nreentrantlock lock = new reentrantlock(true);\n\n\n1\n2\n\n\n# æ¡ä»¶åé\n\nsynchronized ä¸­ä¹ææ¡ä»¶åéï¼å°±æ¯æä»¬è®²åçæ¶é£ä¸ª waitset ä¼æ¯å®¤ï¼å½æ¡ä»¶ä¸æ»¡è¶³æ¶è¿å¥waitset ç­å¾\n\nreentrantlock çæ¡ä»¶åéæ¯ synchronized å¼ºå¤§ä¹å¤å¨äºï¼å®æ¯æ¯æå¤ä¸ªæ¡ä»¶åéçï¼è¿å°±å¥½æ¯\n\n * synchronized æ¯é£äºä¸æ»¡è¶³æ¡ä»¶ççº¿ç¨é½å¨ä¸é´ä¼æ¯å®¤ç­æ¶æ¯\n * è reentrantlock æ¯æå¤é´ä¼æ¯å®¤ï¼æä¸é¨ç­ççä¼æ¯å®¤ãä¸é¨ç­æ©é¤çä¼æ¯å®¤ãå¤éæ¶ä¹æ¯æä¼æ¯å®¤æ¥å¤ é\n\nä½¿ç¨è¦ç¹ï¼\n\n * await åéè¦è·å¾é\n * await æ§è¡åï¼ä¼éæ¾éï¼è¿å¥ conditionobject ç­å¾\n * await ççº¿ç¨è¢«å¤éï¼æææ­ãæè¶æ¶ï¼åéæ°ç«äº lock é\n * ç«äº lock éæååï¼ä» await åç»§ç»­æ§\n\nstatic boolean judge = false;\npublic static void main(string[] args) throws interruptedexception {\n\treentrantlock lock = new reentrantlock();\n\t//è·å¾æ¡ä»¶åé\n\tcondition condition = lock.newcondition();\n\tnew thread(()->{\n\t\tlock.lock();\n\t\ttry{\n\t\t\twhile(!judge) {\n\t\t\t\tsystem.out.println("ä¸æ»¡è¶³æ¡ä»¶ï¼ç­å¾...");\n\t\t\t\t//ç­å¾\n\t\t\t\tcondition.await();\n\t\t\t}\n\t\t} catch (interruptedexception e) {\n\t\t\te.printstacktrace();\n\t\t} finally {\n\t\t\tsystem.out.println("æ§è¡å®æ¯ï¼");\n\t\t\tlock.unlock();\n\t\t}\n\t}).start();\n\n\tnew thread(()->{\n\t\tlock.lock();\n\t\ttry {\n\t\t\tthread.sleep(1);\n\t\t\tjudge = true;\n\t\t\t//éæ¾\n\t\t\tcondition.signal();\n\t\t} catch (interruptedexception e) {\n\t\t\te.printstacktrace();\n\t\t} finally {\n\t\t\tlock.unlock();\n\t\t}\n\n\t}).start();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\n# éè¿lockä¸aqså®ç°å¯éå¥é\n\npublic class mylock implements lock {\n   private static class sync extends abstractqueuedsynchronizer {\n      @override\n      protected boolean tryacquire(int arg) {\n         if (getexclusiveownerthread() == null) {\n            if (compareandsetstate(0, 1)) {\n               setexclusiveownerthread(thread.currentthread());\n               return true;\n            }\n            return false;\n         }\n\n         if (getexclusiveownerthread() == thread.currentthread()) {\n            int state = getstate();\n            compareandsetstate(state, state + 1);\n            return true;\n         }\n\n         return false;\n      }\n\n      @override\n      protected boolean tryrelease(int arg) {\n         if (getstate() <= 0) {\n            throw new illegalmonitorstateexception();\n         }\n\n         if (getexclusiveownerthread() != thread.currentthread()) {\n            throw new illegalmonitorstateexception();\n         }\n\n         int state = getstate();\n         if (state == 1) {\n            setexclusiveownerthread(null);\n            compareandsetstate(state, 0);\n         } else {\n            compareandsetstate(state, state - 1);\n         }\n         return true;\n      }\n\n      @override\n      protected boolean isheldexclusively() {\n         return getstate() >= 1;\n      }\n\n      public condition newcondition() {\n         return new conditionobject();\n      }\n\n   }\n\n   sync sync = new sync();\n\n   @override\n   public void lock() {\n      sync.acquire(1);\n   }\n\n   @override\n   public void lockinterruptibly() throws interruptedexception {\n      sync.acquireinterruptibly(1);\n   }\n\n   @override\n   public boolean trylock() {\n      return sync.tryacquire(1);\n   }\n\n   @override\n   public boolean trylock(long time, timeunit unit) throws interruptedexception {\n      return sync.tryacquirenanos(1, time);\n   }\n\n   @override\n   public void unlock() {\n      sync.release(1);\n   }\n\n   @override\n   public condition newcondition() {\n      return sync.newcondition();\n   }\n}\n\nclass main {\n   static int num = 0;\n   public static void main(string[] args) throws interruptedexception, ioexception {\n      mylock lock = new mylock();\n\n      object synclock = new object();\n\n      thread t1 = new thread(() -> {\n         for (int i = 0; i < 10000; i++) {\n            lock.lock();\n            try {\n               lock.lock();\n               try {\n                  lock.lock();\n                  try {\n                     num++;\n                  } finally {\n                     lock.unlock();\n                  }\n               } finally {\n                  lock.unlock();\n               }\n            } finally {\n               lock.unlock();\n            }\n         }\n      });\n\n      thread t2 = new thread(() -> {\n         for (int i = 0; i < 10000; i++) {\n            lock.lock();\n            try {\n               lock.lock();\n               try {\n                  lock.lock();\n                  try {\n                     num--;\n                  } finally {\n                     lock.unlock();\n                  }\n               } finally {\n                  lock.unlock();\n               }\n            } finally {\n               lock.unlock();\n            }\n         }\n      });\n\n      t1.start();\n      t2.start();\n      t1.join();\n      t2.join();\n\n      int x = 0;\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n\n\n\n# 13ãåæ­¥æ¨¡å¼ä¹é¡ºåºæ§å¶\n\n\n# wait/notifyçæ¬\n\nstatic final object lock = new object();\n//å¤æ­åæ§è¡çåå®¹æ¯å¦æ§è¡å®æ¯\nstatic boolean judge = false;\npublic static void main(string[] args) {\n\tnew thread(()->{\n\t\tsynchronized (lock) {\n\t\t\twhile (!judge) {\n\t\t\t\ttry {\n\t\t\t\t\tlock.wait();\n\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\te.printstacktrace();\n\t\t\t\t}\n\t\t\t}\n\t\t\tsystem.out.println("2");\n\t\t}\n\t}).start();\n\n\tnew thread(()->{\n\t\tsynchronized (lock) {\n\t\t\tsystem.out.println("1");\n\t\t\tjudge = true;\n               //æ§è¡å®æ¯ï¼å¤éææç­å¾çº¿ç¨\n\t\t\tlock.notifyall();\n\t\t}\n\t}).start();\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n\n# äº¤æ¿è¾åº\n\nwait/notifyçæ¬\n\npublic class test4 {\n\tstatic symbol symbol = new symbol();\n\tpublic static void main(string[] args) {\n\t\tnew thread(()->{\n\t\t\tsymbol.run("a", 1, 2);\n\t\t}).start();\n\n\t\tnew thread(()->{\n\t\t\tsymbol.run("b", 2, 3);\n\n\t\t}).start();\n\t\tsymbol.run("c", 3, 1);\n\t\tnew thread(()->{\n\n\t\t}).start();\n\t}\n}\n\nclass symbol {\n\tpublic synchronized void run(string str, int flag, int nextflag) {\n\t\tfor(int i=0; i<loopnumber; i++) {\n\t\t\twhile(flag != this.flag) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.wait();\n\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\te.printstacktrace();\n\t\t\t\t}\n\t\t\t}\n\t\t\tsystem.out.println(str);\n\t\t\t//è®¾ç½®ä¸ä¸ä¸ªè¿è¡ççº¿ç¨æ è®°\n\t\t\tthis.flag = nextflag;\n\t\t\t//å¤éææçº¿ç¨\n\t\t\tthis.notifyall();\n\t\t}\n\t}\n\n\t/**\n\t * çº¿ç¨çæ§è¡æ è®°ï¼ 1->a 2->b 3->c\n\t */\n\tprivate int flag = 1;\n\tprivate int loopnumber = 5;\n\n\tpublic int getflag() {\n\t\treturn flag;\n\t}\n\n\tpublic void setflag(int flag) {\n\t\tthis.flag = flag;\n\t}\n\n\tpublic int getloopnumber() {\n\t\treturn loopnumber;\n\t}\n\n\tpublic void setloopnumber(int loopnumber) {\n\t\tthis.loopnumber = loopnumber;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n\n\nawait/signalçæ¬\n\npublic class test5 {\n\tstatic awaitsignal awaitsignal = new awaitsignal();\n\tstatic condition conditiona = awaitsignal.newcondition();\n\tstatic condition conditionb = awaitsignal.newcondition();\n\tstatic condition conditionc = awaitsignal.newcondition();\n\tpublic static void main(string[] args) {\n\t\tnew thread(()->{\n\t\t\tawaitsignal.run("a", conditiona, conditionb);\n\t\t}).start();\n\n\t\tnew thread(()->{\n\t\t\tawaitsignal.run("b", conditionb, conditionc);\n\t\t}).start();\n\n\t\tnew thread(()->{\n\t\t\tawaitsignal.run("c", conditionc, conditiona);\n\t\t}).start();\n\n\n\t\ttry {\n\t\t\tthread.sleep(1000);\n\t\t} catch (interruptedexception e) {\n\t\t\te.printstacktrace();\n\t\t}\n\t\tawaitsignal.lock();\n\t\ttry {\n            //å¤éä¸ä¸ªç­å¾ççº¿ç¨\n\t\t\tconditiona.signal();\n\t\t}finally {\n\t\t\tawaitsignal.unlock();\n\t\t}\n\t}\n}\n\nclass awaitsignal extends reentrantlock{\n\tpublic void run(string str, condition thiscondition, condition nextcondition) {\n\t\tfor(int i=0; i<loopnumber; i++) {\n\t\t\tlock();\n\t\t\ttry {\n                //å¨é¨è¿å¥ç­å¾ç¶æ\n\t\t\t\tthiscondition.await();\n\t\t\t\tsystem.out.print(str);\n\t\t\t\tnextcondition.signal();\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t} finally {\n\t\t\t\tunlock();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate int loopnumber=5;\n\n\tpublic int getloopnumber() {\n\t\treturn loopnumber;\n\t}\n\n\tpublic void setloopnumber(int loopnumber) {\n\t\tthis.loopnumber = loopnumber;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n\n\n\n# 14ãthreadlocal\n\n\n# ç®ä»\n\nthreadlocalæ¯jdkåæä¾çï¼å®æä¾äºçº¿ç¨æ¬å°åéï¼ä¹å°±æ¯å¦æä½ åå»ºäºä¸ä¸ªthreadlocalåéï¼é£ä¹è®¿é®è¿ä¸ªåéçæ¯ä¸ªçº¿ç¨é½ä¼æè¿ä¸ªåéçä¸ä¸ªæ¬å°å¯æ¬ãå½å¤ä¸ªçº¿ç¨æä½è¿ä¸ªåéæ¶ï¼å®éæä½çæ¯èªå·±æ¬å°åå­éé¢çåéï¼ä»èé¿åäºçº¿ç¨å®å¨é®é¢\n\n\n# ä½¿ç¨\n\npublic class threadlocalstudy {\n   public static void main(string[] args) {\n      // åå»ºthreadlocalåé\n      threadlocal<string> stringthreadlocal = new threadlocal<>();\n      threadlocal<user> userthreadlocal = new threadlocal<>();\n\n      // åå»ºä¸¤ä¸ªçº¿ç¨ï¼åå«ä½¿ç¨ä¸é¢çä¸¤ä¸ªthreadlocalåé\n      thread thread1 = new thread(()->{\n         // stringthreadlocalç¬¬ä¸æ¬¡èµå¼\n         stringthreadlocal.set("thread1 stringthreadlocal first");\n         // stringthreadlocalç¬¬äºæ¬¡èµå¼\n         stringthreadlocal.set("thread1 stringthreadlocal second");\n         // userthreadlocalèµå¼\n         userthreadlocal.set(new user("nyima", 20));\n\n         // åå¼\n         system.out.println(stringthreadlocal.get());\n         system.out.println(userthreadlocal.get());\n          \n          // ç§»é¤\n\t\t userthreadlocal.remove();\n\t\t system.out.println(userthreadlocal.get());\n      });\n\n      thread thread2 = new thread(()->{\n         // stringthreadlocalç¬¬ä¸æ¬¡èµå¼\n         stringthreadlocal.set("thread2 stringthreadlocal first");\n         // stringthreadlocalç¬¬äºæ¬¡èµå¼\n         stringthreadlocal.set("thread2 stringthreadlocal second");\n         // userthreadlocalèµå¼\n         userthreadlocal.set(new user("hulu", 20));\n\n         // åå¼\n         system.out.println(stringthreadlocal.get());\n         system.out.println(userthreadlocal.get());\n      });\n\n      // å¯å¨çº¿ç¨\n      thread1.start();\n      thread2.start();\n   }\n}\n\nclass user {\n   string name;\n   int age;\n\n   public user(string name, int age) {\n      this.name = name;\n      this.age = age;\n   }\n\n   @override\n   public string tostring() {\n      return "user{" +\n            "name=\'" + name + \'\\\'\' +\n            ", age=" + age +\n            \'}\';\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n\n\nè¿è¡ç»æ\n\nthread1 stringthreadlocal second\nthread2 stringthreadlocal second\nuser{name=\'nyima\', age=20}\nuser{name=\'hulu\', age=20}\nnull\n\n\n1\n2\n3\n4\n5\n\n\nä»è¿è¡ç»æå¯ä»¥çåº\n\n * æ¯ä¸ªçº¿ç¨ä¸­çthreadlocalåéæ¯æ¯ä¸ªçº¿ç¨ç§æçï¼èä¸æ¯å±äº«ç\n   * ä»çº¿ç¨1åçº¿ç¨2çæå°ç»æå¯ä»¥çåº\n * threadlocalå¶å®å°±ç¸å½äºå¶æ³åç±»åçä¸ä¸ªåéï¼åªä¸è¿æ¯æ¯ä¸ªçº¿ç¨ç§æç\n   * stringthreadlocalè¢«èµå¼äºä¸¤æ¬¡ï¼ä¿å­çæ¯æåä¸æ¬¡èµå¼çç»æ\n * threadlocalå¯ä»¥è¿è¡ä»¥ä¸å ä¸ªæä½\n   * set è®¾ç½®å¼\n   * get ååºå¼\n   * remove ç§»é¤å¼\n\n\n# åç\n\n# threadä¸­çthreadlocals\n\npublic class thread implements runnable {\n ...\n\n threadlocal.threadlocalmap threadlocals = null;\n\n // æ¾å¨åé¢è¯´\n threadlocal.threadlocalmap inheritablethreadlocals = null;\n\n ...\n}\nstatic class threadlocalmap {\n    static class entry extends weakreference<threadlocal<?>> {\n        /** the value associated with this threadlocal. */\n        object value;\n\n        entry(threadlocal<?> k, object v) {\n            super(k);\n            value = v;\n        }\n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nå¯ä»¥çåºthreadç±»ä¸­æä¸ä¸ªthreadlocalsåä¸ä¸ªinheritablethreadlocalsï¼å®ä»¬é½æ¯threadlocalmapç±»åçåéï¼èthreadlocalmapæ¯ä¸ä¸ªå®å¶åçhashmapãå¨é»è®¤æåµä¸ï¼æ¯ä¸ªçº¿ç¨ä¸­çè¿ä¸¤ä¸ªåéé½ä¸ºnullãæ­¤å¤åè®¨è®ºthreadlocalsï¼inheritablethreadlocalsæ¾å¨åé¢è®¨è®º\n\n# threadlocalä¸­çæ¹æ³\n\nsetæ¹æ³\n\npublic void set(t value) {\n    // è·åå½åçº¿ç¨\n    thread t = thread.currentthread();\n    \n    // è·å¾threadlocalmapå¯¹è±¡ \n    // è¿éçgetä¼è¿åthreadç±»ä¸­çthreadlocals\n    threadlocalmap map = getmap(t);\n    \n    // å¤æ­mapæ¯å¦å·²ç»åå»ºï¼æ²¡åå»ºå°±åå»ºå¹¶æ¾å¥å¼ï¼åå»ºäºå°±ç´æ¥æ¾å¥\n    if (map != null)\n        // threadlocalèªççå¼ç¨ä½ä¸ºkeyï¼ä¼ å¥çå¼ä½ä¸ºvalue\n        map.set(this, value);\n    else\n        createmap(t, value);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\nå¦ææªåå»º\n\nvoid createmap(thread t, t firstvalue) {\n    // åå»ºçåæ¶è®¾ç½®æ³æ¾å¥çå¼\n    // hreadlocalèªççå¼ç¨ä½ä¸ºkeyï¼ä¼ å¥çå¼ä½ä¸ºvalue\n    t.threadlocals = new threadlocalmap(this, firstvalue);\n}\n\n\n1\n2\n3\n4\n5\n\n\ngetæ¹æ³\n\npublic t get() {\n    // è·åå½åçº¿ç¨\n    thread t = thread.currentthread();\n\t// è·åå½åçº¿ç¨çthreadlocalsåé\n    threadlocalmap map = getmap(t);\n    \n    // å¤æ­threadlocalsæ¯å¦è¢«åå§åäº\n    if (map != null) {\n        // å·²ç»åå§ååç´æ¥è¿å\n        threadlocalmap.entry e = map.getentry(this);\n        if (e != null) {\n            @suppresswarnings("unchecked")\n            t result = (t)e.value;\n            return result;\n        }\n    }\n    // å¦åå°±åå»ºthreadlocals\n    return setinitialvalue();\n}\nprivate t setinitialvalue() {\n    // è¿ä¸ªæ¹æ³è¿åæ¯null\n    t value = initialvalue();\n    thread t = thread.currentthread();\n    threadlocalmap map = getmap(t);\n    \n    // æ è®ºmapåå»ºä¸å¦ï¼æç»valueçå¼é½ä¸ºnull\n    if (map != null)\n        map.set(this, value);\n    else\n        createmap(t, value);\n    return value;\n}\nprotected t initialvalue() {\n    return null;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\nremoveæ¹æ³\n\npublic void remove() {\n    threadlocalmap m = getmap(thread.currentthread());\n    if (m != null)\n        // å¦æthreadlocalså·²ç»è¢«åå§åï¼åç§»é¤\n        m.remove(this);\n}\n\n\n1\n2\n3\n4\n5\n6\n\n\n# æ»ç»\n\nå¨æ¯ä¸ªçº¿ç¨åé¨é½æä¸ä¸ªåä¸ºthreadlocalsçæååéï¼è¯¥åéçç±»åä¸ºhashmapï¼å¶ä¸­keyä¸ºæä»¬å®ä¹çthreadlocalåéçthiså¼ç¨ï¼valueåä¸ºæä»¬ä½¿ç¨setæ¹æ³è®¾ç½®çå¼ãæ¯ä¸ªçº¿ç¨çæ¬å°åéå­æ¾å¨çº¿ç¨èªå·±çåå­åéthreadlocalsä¸­\n\nåªæå½åçº¿ç¨ç¬¬ä¸æ¬¡è°ç¨threadlocalçsetæègetæ¹æ³æ¶æä¼åå»ºthreadlocalsï¼inheritablethreadlocalsä¹æ¯ä¸æ ·ï¼ãå¶å®æ¯ä¸ªçº¿ç¨çæ¬å°åéä¸æ¯å­æ¾å¨threadlocalå®ä¾éé¢ï¼èæ¯å­æ¾å¨è°ç¨çº¿ç¨çthreadlocalsåééé¢\n\n\n# 15ãinheritablethreadlocal\n\n\n# ç®ä»\n\nä»threadlocalçæºç å¯ä»¥çåºï¼æ è®ºæ¯setãgetãè¿æ¯removeï¼é½æ¯ç¸å¯¹äºå½åçº¿ç¨æä½ç\n\nthread.currentthread()\n\n\n1\n\n\næä»¥threadlocalæ æ³ä»ç¶çº¿ç¨ä¼ åå­çº¿ç¨ï¼æä»¥inheritablethreadlocalåºç°äºï¼å®è½å¤è®©ç¶çº¿ç¨ä¸­threadlocalçå¼ä¼ ç»å­çº¿ç¨ã\n\nä¹å°±æ¯ä»mainæå¨ççº¿ç¨ï¼ä¼ ç»thread1æthread2\n\n\n# ä½¿ç¨\n\npublic class demo1 {\n   public static void main(string[] args) {\n      threadlocal<string> stringthreadlocal = new threadlocal<>();\n      inheritablethreadlocal<string> stringinheritable = new inheritablethreadlocal<>();\n\n      // ä¸»çº¿ç¨èµå¯¹ä¸é¢ä¸¤ä¸ªåéè¿è¡èµå¼\n      stringthreadlocal.set("this is threadlocal");\n      stringinheritable.set("this is inheritablethreadlocal");\n\n      // åå»ºçº¿ç¨\n      thread thread1 = new thread(()->{\n         // è·å¾threadlocalä¸­å­æ¾çå¼\n         system.out.println(stringthreadlocal.get());\n\n         // è·å¾inheritablethreadlocalå­æ¾çå¼\n         system.out.println(stringinheritable.get());\n      });\n\n      thread1.start();\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\nè¿è¡ç»æ\n\nnull\nthis is inheritablethreadlocal\n\n\n1\n2\n\n\nå¯ä»¥çåºinheritablethreadlocalçå¼æåä»ä¸»çº¿ç¨ä¼ å¥äºå­çº¿ç¨ï¼èthreadlocalåæ²¡æ\n\n\n# åç\n\n# inheritablethreadlocal\n\npublic class inheritablethreadlocal<t> extends threadlocal<t> {\n    // ä¼ å¥ç¶çº¿ç¨ä¸­çä¸ä¸ªå¼ï¼ç¶åç´æ¥è¿å\n    protected t childvalue(t parentvalue) {\n        return parentvalue;\n    }\n\n  \t// è¿åä¼ å¥çº¿ç¨çinheritablethreadlocals\n    // threadä¸­æä¸ä¸ªinheritablethreadlocalsåé\n    // threadlocal.threadlocalmap inheritablethreadlocals = null;\n    threadlocalmap getmap(thread t) {\n       return t.inheritablethreadlocals;\n    }\n\n \t// åå»ºä¸ä¸ªinheritablethreadlocals\n    void createmap(thread t, t firstvalue) {\n        t.inheritablethreadlocals = new threadlocalmap(this, firstvalue);\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nç±å¦ä¸ä»£ç å¯ç¥ï¼inheritablethreadlocalç»§æ¿äºthreadlocalï¼å¹¶éåäºä¸ä¸ªæ¹æ³ãinheritablethreadlocaléåäºcreatemapæ¹æ³ï¼é£ä¹ç°å¨å½ç¬¬ä¸æ¬¡è°ç¨setæ¹æ³æ¶ï¼åå»ºçæ¯å½åçº¿ç¨çinheritablethreadlocalsåéçå®ä¾èä¸åæ¯threadlocalsãå½è°ç¨getmapæ¹æ³è·åå½åçº¿ç¨åé¨çmapåéæ¶ï¼è·åçæ¯inheritablethreadlocalsèä¸åæ¯threadlocals\n\n# childvalue(t parentvalue)æ¹æ³çè°ç¨\n\nå¨ä¸»å½æ°è¿è¡æ¶ï¼ä¼è°ç¨threadçé»è®¤æé å½æ°ï¼åå»ºä¸»çº¿ç¨ï¼ä¹å°±æ¯ç¶çº¿ç¨ï¼ï¼æä»¥æä»¬åççthreadçé»è®¤æé å½æ°\n\npublic thread() {\n    init(null, null, "thread-" + nextthreadnum(), 0);\n}\nprivate void init(threadgroup g, runnable target, string name,\n                  long stacksize, accesscontrolcontext acc,\n                  boolean inheritthreadlocals) {\n   \t...\n        \n\t// è·å¾å½åçº¿ç¨çï¼å¨è¿éæ¯ä¸»çº¿ç¨\n    thread parent = currentthread();\n   \n    ...\n    \n    // å¦æç¶çº¿ç¨çinheritablethreadlocalså­å¨\n    // æä»¬å¨ä¸»çº¿ç¨ä¸­è°ç¨setågetæ¶ï¼ä¼åå»ºinheritablethreadlocals\n    if (inheritthreadlocals && parent.inheritablethreadlocals != null)\n        // è®¾ç½®å­çº¿ç¨çinheritablethreadlocals\n        this.inheritablethreadlocals =\n            threadlocal.createinheritedmap(parent.inheritablethreadlocals);\n    \n    /* stash the specified stack size in case the vm cares */\n    this.stacksize = stacksize;\n\n    /* set thread id */\n    tid = nextthreadid();\n}\nstatic threadlocalmap createinheritedmap(threadlocalmap parentmap) {\n    return new threadlocalmap(parentmap);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nå¨createinheritedmapåé¨ä½¿ç¨ç¶çº¿ç¨çinheritablethreadlocalsåéä½ä¸ºæé å½æ°åå»ºäºä¸ä¸ªæ°çthreadlocalmapåéï¼ç¶åèµå¼ç»äºå­çº¿ç¨çinheritablethreadlocalsåé\n\nprivate threadlocalmap(threadlocalmap parentmap) {\n    entry[] parenttable = parentmap.table;\n    int len = parenttable.length;\n    setthreshold(len);\n    table = new entry[len];\n\n    for (int j = 0; j < len; j++) {\n        entry e = parenttable[j];\n        if (e != null) {\n            @suppresswarnings("unchecked")\n            threadlocal<object> key = (threadlocal<object>) e.get();\n            if (key != null) {\n                // è¿éè°ç¨äº childvalue æ¹æ³\n                // è¯¥æ¹æ³ä¼è¿åparentçå¼\n                object value = key.childvalue(e.value);\n                \n                entry c = new entry(key, value);\n                int h = key.threadlocalhashcode & (len - 1);\n                while (table[h] != null)\n                    h = nextindex(h, len);\n                table[h] = c;\n                size++;\n            }\n        }\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nå¨è¯¥æé å½æ°åé¨æç¶çº¿ç¨çinheritablethreadlocalsæååéçå¼å¤å¶å°æ°çthreadlocalmapå¯¹è±¡ä¸­\n\n# æ»ç»\n\ninheritablethreadlocalç±»éè¿éågetmapåcreatemapï¼è®©æ¬å°åéä¿å­å°äºå·ä½çº¿ç¨çinheritablethreadlocalsåééé¢ï¼é£ä¹çº¿ç¨å¨éè¿inheritablethreadlocalç±»å®ä¾çsetæègetæ¹æ³è®¾ç½®åéæ¶ï¼å°±ä¼åå»ºå½åçº¿ç¨çinheritablethreadlocalsåéã\n\nå½ç¶çº¿ç¨åå»ºå­çº¿ç¨æ¶ï¼æé å½æ°ä¼æç¶çº¿ç¨ä¸­inheritablethreadlocalsåééé¢çæ¬å°åéå¤å¶ä¸ä»½ä¿å­å°å­çº¿ç¨çinheritablethreadlocalsåééé¢ã\n\n\n# åãå±äº«æ¨¡åä¹åå­\n\n\n# 1ãjavaåå­æ¨¡åï¼jmmï¼\n\njmm å³ java memory modelï¼å®å®ä¹äº**ä¸»å­ï¼å±äº«åå­ï¼ãå·¥ä½åå­ï¼çº¿ç¨ç§æï¼**æ½è±¡æ¦å¿µï¼åºå±å¯¹åºç cpu å¯å­å¨ãç¼å­ãç¡¬ä»¶åå­ã cpu æä»¤ä¼åç­ã\n\njmmä½ç°å¨ä»¥ä¸å ä¸ªæ¹é¢\n\n * åå­æ§ - ä¿è¯æä»¤ä¸ä¼åå°çº¿ç¨ä¸ä¸æåæ¢çå½±å\n * å¯è§æ§ - ä¿è¯æä»¤ä¸ä¼å cpu ç¼å­çå½±å\n * æåºæ§ - ä¿è¯æä»¤ä¸ä¼å cpu æä»¤å¹¶è¡ä¼åçå½±å\n\n\n# 2ãå¯è§æ§\n\n# å¼ä¾\n\néåºä¸åºçå¾ªç¯\n\nstatic boolean run = true;\n\tpublic static void main(string[] args) throws interruptedexception {\n\t\tnew thread(()->{\n\t\t\twhile (run) {\n\t\t\t\t//å¦ærunä¸ºçï¼åä¸ç´æ§è¡\n\t\t\t}\n\t\t}).start();\n\n\t\tthread.sleep(1000);\n\t\tsystem.out.println("æ¹årunçå¼ä¸ºfalse");\n\t\trun = false;\n\t}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nä¸ºä»ä¹æ æ³éåºè¯¥å¾ªç¯\n\n * åå§ç¶æï¼ t çº¿ç¨åå¼å§ä»ä¸»åå­è¯»åäº run çå¼å°å·¥ä½åå­ã\n\n\n\n * å ä¸º t çº¿ç¨è¦é¢ç¹ä»ä¸»åå­ä¸­è¯»å run çå¼ï¼jit ç¼è¯å¨ä¼å° run çå¼ç¼å­è³èªå·±å·¥ä½åå­ä¸­çé«éç¼å­ä¸­ï¼ åå°å¯¹ä¸»å­ä¸­ run çè®¿é®ï¼æé«æç\n\n\n\n * 1 ç§ä¹åï¼main çº¿ç¨ä¿®æ¹äº run çå¼ï¼å¹¶åæ­¥è³ä¸»å­ï¼è t æ¯ä»èªå·±å·¥ä½åå­ä¸­çé«éç¼å­ä¸­è¯»åè¿ä¸ªåé çå¼ï¼ç»ææ°¸è¿æ¯æ§å¼\n\n\n\nè§£å³æ¹æ³\n\n * ä½¿ç¨volatileæåå³é®å­\n * å®å¯ä»¥ç¨æ¥ä¿®é¥°æååéåéææååéï¼æ¾å¨ä¸»å­ä¸­çåéï¼ï¼ä»å¯ä»¥é¿åçº¿ç¨ä»èªå·±çå·¥ä½ç¼å­ä¸­æ¥æ¾åéçå¼ï¼å¿é¡»å°ä¸»å­ä¸­è·åå®çå¼ï¼çº¿ç¨æä½ volatile åéé½æ¯ç´æ¥æä½ä¸»å­\n\n//ä½¿ç¨æåå³é®å­\nvolatile static boolean run = true;\npublic static void main(string[] args) throws interruptedexception {\n\tnew thread(()->{\n\t\twhile (run) {\n\t\t\t//å¦ærunä¸ºçï¼åä¸ç´æ§è¡\n\t\t}\n\t}).start();\n\n\tthread.sleep(1000);\n\tsystem.out.println("æ¹årunçå¼ä¸ºfalse");\n\trun = false;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n# å¯è§æ§ä¸åå­æ§\n\nåé¢ä¾å­ä½ç°çå®éå°±æ¯å¯è§æ§ï¼å®ä¿è¯çæ¯å¨å¤ä¸ªçº¿ç¨ä¹é´ï¼ä¸ä¸ªçº¿ç¨å¯¹volatileåéçä¿®æ¹å¯¹å¦ä¸ä¸ªçº¿ç¨å¯è§ï¼ ä¸è½ä¿è¯åå­æ§ï¼ä»ç¨å¨ä¸ä¸ªåçº¿ç¨ï¼å¤ä¸ªè¯»çº¿ç¨çæåµ\n\n * æ³¨æ synchronized è¯­å¥åæ¢å¯ä»¥ä¿è¯ä»£ç åçåå­æ§ï¼ä¹åæ¶ä¿è¯ä»£ç åååéçå¯è§æ§ã\n\n * ä½ç¼ºç¹æ¯ synchronized æ¯å±äºééçº§æä½ï¼æ§è½ç¸å¯¹æ´ä½ã\n\n * å¦æå¨åé¢ç¤ºä¾çæ­»å¾ªç¯ä¸­å å¥ system.out.println() ä¼åç°å³ä½¿ä¸å  volatile ä¿®é¥°ç¬¦ï¼çº¿ç¨ t ä¹è½æ­£ç¡®çå° å¯¹ run åéçä¿®æ¹äºï¼æ³ä¸æ³ä¸ºä»ä¹ï¼\n   \n   * å ä¸ºä½¿ç¨äºsynchronizedå³é®å­\n     \n     public void println(string x) {\n     \t\t//ä½¿ç¨äºsynchronizedå³é®å­\n             synchronized (this) {\n                 print(x);\n                 newline();\n             }\n         }\n     \n     \n     1\n     2\n     3\n     4\n     5\n     6\n     7\n     \n\n# ä¸¤é¶ç»æ­¢æ¨¡å¼ä¼å\n\npublic class test7 {\n\tpublic static void main(string[] args) throws interruptedexception {\n\t\tmonitor monitor = new monitor();\n\t\tmonitor.start();\n\t\tthread.sleep(3500);\n\t\tmonitor.stop();\n\t}\n}\n\nclass monitor {\n\n\tthread monitor;\n\t//è®¾ç½®æ è®°ï¼ç¨äºå¤æ­æ¯å¦è¢«ç»æ­¢äº\n\tprivate volatile boolean stop = false;\n\t/**\n\t * å¯å¨çæ§å¨çº¿ç¨\n\t */\n\tpublic void start() {\n\t\t//è®¾ç½®çº¿æ§å¨çº¿ç¨ï¼ç¨äºçæ§çº¿ç¨ç¶æ\n\t\tmonitor = new thread() {\n\t\t\t@override\n\t\t\tpublic void run() {\n\t\t\t\t//å¼å§ä¸åççæ§\n\t\t\t\twhile (true) {\n\t\t\t\t\tif(stop) {\n\t\t\t\t\t\tsystem.out.println("å¤çåç»­ä»»å¡");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsystem.out.println("çæ§å¨è¿è¡ä¸­...");\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//çº¿ç¨ä¼ç \n\t\t\t\t\t\tthread.sleep(1000);\n\t\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\t\tsystem.out.println("è¢«ææ­äº");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tmonitor.start();\n\t}\n\n\t/**\n\t * \tç¨äºåæ­¢çæ§å¨çº¿ç¨\n\t */\n\tpublic void stop() {\n\t\t//ææ­çº¿ç¨\n\t\tmonitor.interrupt();\n        //ä¿®æ¹æ è®°\n\t\tstop = true;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n\n\n# åæ­¥æ¨¡å¼ä¹ç¹è±«æ¨¡å¼\n\nå®ä¹\n\nbalking ï¼ç¹è±«ï¼æ¨¡å¼ç¨å¨ä¸ä¸ªçº¿ç¨åç°å¦ä¸ä¸ªçº¿ç¨ææ¬çº¿ç¨å·²ç»åäºæä¸ä»¶ç¸åçäºï¼é£ä¹æ¬çº¿ç¨å°±æ éåå äºï¼ç´æ¥ç»æè¿å\n\n * ç¨ä¸ä¸ªæ è®°æ¥å¤æ­è¯¥ä»»å¡æ¯å¦å·²ç»è¢«æ§è¡è¿äº\n * éè¦é¿åçº¿ç¨å®å¨é®é¢\n   * å éçä»£ç åè¦å°½éçå°ï¼ä»¥ä¿è¯æ§è½\n\npackage com.nyima.day1;\n\n/**\n * @author chen panwen\n * @data 2020/3/26 16:11\n */\npublic class test7 {\n\tpublic static void main(string[] args) throws interruptedexception {\n\t\tmonitor monitor = new monitor();\n\t\tmonitor.start();\n\t\tmonitor.start();\n\t\tthread.sleep(3500);\n\t\tmonitor.stop();\n\t}\n}\n\nclass monitor {\n\n\tthread monitor;\n\t//è®¾ç½®æ è®°ï¼ç¨äºå¤æ­æ¯å¦è¢«ç»æ­¢äº\n\tprivate volatile boolean stop = false;\n\t//è®¾ç½®æ è®°ï¼ç¨äºå¤æ­æ¯å¦å·²ç»å¯å¨è¿äº\n\tprivate boolean starting = false;\n\t/**\n\t * å¯å¨çæ§å¨çº¿ç¨\n\t */\n\tpublic void start() {\n\t\t//ä¸éï¼é¿åå¤çº¿ç¨è¿è¡æ¶åºç°çº¿ç¨å®å¨é®é¢\n\t\tsynchronized (this) {\n\t\t\tif (starting) {\n\t\t\t\t//å·²è¢«å¯å¨ï¼ç´æ¥è¿å\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//å¯å¨çè§å¨ï¼æ¹åæ è®°\n\t\t\tstarting = true;\n\t\t}\n\t\t//è®¾ç½®çº¿æ§å¨çº¿ç¨ï¼ç¨äºçæ§çº¿ç¨ç¶æ\n\t\tmonitor = new thread() {\n\t\t\t@override\n\t\t\tpublic void run() {\n\t\t\t\t//å¼å§ä¸åççæ§\n\t\t\t\twhile (true) {\n\t\t\t\t\tif(stop) {\n\t\t\t\t\t\tsystem.out.println("å¤çåç»­ä»»å¡");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsystem.out.println("çæ§å¨è¿è¡ä¸­...");\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//çº¿ç¨ä¼ç \n\t\t\t\t\t\tthread.sleep(1000);\n\t\t\t\t\t} catch (interruptedexception e) {\n\t\t\t\t\t\tsystem.out.println("è¢«ææ­äº");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tmonitor.start();\n\t}\n\n\t/**\n\t * \tç¨äºåæ­¢çæ§å¨çº¿ç¨\n\t */\n\tpublic void stop() {\n\t\t//ææ­çº¿ç¨\n\t\tmonitor.interrupt();\n\t\tstop = true;\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n\n\n\n# 3ãæåºæ§\n\n\n# æä»¤éæ\n\n * jvm ä¼å¨ä¸å½±åæ­£ç¡®æ§çåæä¸ï¼å¯ä»¥è°æ´è¯­å¥çæ§è¡é¡ºåº\n\n\n\nè¿ç§ç¹æ§ç§°ä¹ä¸ºãæä»¤éæãï¼å¤çº¿ç¨ä¸ãæä»¤éæãä¼å½±åæ­£ç¡®æ§ã\n\n\n# æä»¤éæåºä¼å\n\n * äºå®ä¸ï¼ç°ä»£å¤çå¨ä¼è®¾è®¡ä¸ºä¸ä¸ªæ¶éå¨æå®æä¸æ¡æ§è¡æ¶é´é¿ç cpu æä»¤ãä¸ºä»ä¹è¿ä¹åå¢ï¼å¯ä»¥æ³å°æä»¤è¿å¯ä»¥åååæä¸ä¸ªä¸ªæ´å°çé¶æ®µï¼ä¾å¦ï¼æ¯æ¡æä»¤é½å¯ä»¥åä¸ºï¼ åæä»¤ - æä»¤è¯ç  - æ§è¡æä»¤ - åå­è®¿é® - æ°æ®åå è¿5 ä¸ªé¶æ®µ\n\n\n\n * å¨ä¸æ¹åç¨åºç»æçåæä¸ï¼è¿äºæä»¤çåä¸ªé¶æ®µå¯ä»¥éè¿éæåºåç»åæ¥å®ç°æä»¤çº§å¹¶è¡\n\n * æä»¤éæçåææ¯ï¼éææä»¤ä¸è½å½±åç»æï¼ä¾å¦\n   \n   // å¯ä»¥éæçä¾å­ \n   int a = 10; \n   int b = 20; \n   system.out.println( a + b );\n   \n   // ä¸è½éæçä¾å­ \n   int a = 10;\n   int b = a - 5;\n   \n   \n   1\n   2\n   3\n   4\n   5\n   6\n   7\n   8\n   \n\n\n# æ¯ææµæ°´çº¿çå¤çå¨\n\nç°ä»£ cpu æ¯æå¤çº§æä»¤æµæ°´çº¿ï¼ä¾å¦æ¯æåæ¶æ§è¡ åæä»¤ - æä»¤è¯ç  - æ§è¡æä»¤ - åå­è®¿é® - æ°æ®åå çå¤çå¨ï¼å°±å¯ä»¥ç§°ä¹ä¸ºäºçº§æä»¤æµæ°´çº¿ãè¿æ¶ cpu å¯ä»¥å¨ä¸ä¸ªæ¶éå¨æåï¼åæ¶è¿è¡äºæ¡æä»¤çä¸åé¶æ®µï¼ç¸å½äºä¸ æ¡æ§è¡æ¶é´é¿çå¤ææä»¤ï¼ï¼ipc = 1ï¼æ¬è´¨ä¸ï¼æµæ°´çº¿ææ¯å¹¶ä¸è½ç¼©ç­åæ¡æä»¤çæ§è¡æ¶é´ï¼ä½å®åç¸å°æé«äºæä»¤å°ååçã\n\n\n\nå¨å¤çº¿ç¨ç¯å¢ä¸ï¼æä»¤éæåºå¯è½å¯¼è´åºç°ææä¹å¤çç»æ\n\n\n# è§£å³åæ³\n\nvolatile ä¿®é¥°çåéï¼å¯ä»¥ç¦ç¨æä»¤éæ\n\n * ç¦æ­¢çæ¯å volatileå³é®å­åéä¹åçä»£ç è¢«éæåº\n\n\n# 4ãåå­å±é\n\n * å¯è§æ§\n   * åå±éï¼sfenceï¼ä¿è¯å¨è¯¥å±éä¹åçï¼å¯¹å±äº«åéçæ¹å¨ï¼é½åæ­¥å°ä¸»å­å½ä¸­\n   * è¯»å±éï¼lfenceï¼ä¿è¯å¨è¯¥å±éä¹åï¼å¯¹å±äº«åéçè¯»åï¼å è½½çæ¯ä¸»å­ä¸­æ°æ°æ®\n * æåºæ§\n   * åå±éä¼ç¡®ä¿æä»¤éæåºæ¶ï¼ä¸ä¼å°åå±éä¹åçä»£ç æå¨åå±éä¹å\n   * è¯»å±éä¼ç¡®ä¿æä»¤éæåºæ¶ï¼ä¸ä¼å°è¯»å±éä¹åçä»£ç æå¨è¯»å±éä¹å\n\n\n# 5ãvolatile åç\n\nvolatileçåºå±å®ç°åçæ¯åå­å±éï¼memory barrierï¼memory fenceï¼\n\n * å¯¹ volatile åéçåæä»¤åä¼å å¥åå±é\n * å¯¹ volatile åéçè¯»æä»¤åä¼å å¥è¯»å±é\n\n\n# å¦ä½ä¿è¯å¯è§æ§\n\n * åå±éï¼sfenceï¼ä¿è¯å¨è¯¥å±éä¹åçï¼å¯¹å±äº«åéçæ¹å¨ï¼é½åæ­¥å°ä¸»å­å½ä¸­\n   \n   \n\n * èè¯»å±éï¼lfenceï¼ä¿è¯å¨è¯¥å±éä¹åï¼å¯¹å±äº«åéçè¯»åï¼å è½½çæ¯ä¸»å­ä¸­æ°æ°æ®\n   \n   \n\n\n# å¦ä½ä¿è¯æåºæ§\n\n * åå±éä¼ç¡®ä¿æä»¤éæåºæ¶ï¼ä¸ä¼å°åå±éä¹åçä»£ç æå¨åå±éä¹å\n   \n   \n\n * è¯»å±éä¼ç¡®ä¿æä»¤éæåºæ¶ï¼ä¸ä¼å°è¯»å±éä¹åçä»£ç æå¨è¯»å±éä¹å\n   \n   \n\n\n\nä½æ¯ä¸è½è§£å³æä»¤äº¤éé®é¢\n\n * åå±éä»ä»æ¯ä¿è¯ä¹åçè¯»è½å¤è¯»å°æ°çç»æï¼ä½ä¸è½ä¿è¯è¯»è·å°å®åé¢å»\n * èæåºæ§çä¿è¯ä¹åªæ¯ä¿è¯äºæ¬çº¿ç¨åç¸å³ä»£ç ä¸è¢«éæåº\n\n\n# å®ç°åçä¹lockåç¼\n\nå¨x86å¤çå¨ä¸éè¿å·¥å·è·åjitç¼è¯å¨çæçæ±ç¼æä»¤æ¥æ¥çå¯¹volatileè¿è¡åæä½æ¶\n\ninstance = new singleton();\n\n\n1\n\n\nå¯¹åºçæ±ç¼ä»£ç æ¯\n\n... lock addl ...\n\n\n1\n\n\nævolatileåéä¿®é¥°çå±äº«åéè¿è¡åæä½çæ¶åä¼å¤åºç¬¬äºè¡æ±ç¼ä»£ç ï¼éè¿æ¥ia-32æ¶æè½¯ä»¶å¼åèæåå¯ç¥ï¼lockåç¼çæä»¤å¨å¤æ ¸å¤çå¨ä¸ä¼å¼åäºä¸¤ä»¶äº\n\n * lockåç¼æä»¤ä¼å¼èµ·å¤çå¨\n   \n   ç¼å­ååå°åå­\n   \n   * lockåç¼æä»¤å¯¼è´å¨æ§è¡æä»¤æé´ï¼å£°è¨å¤çå¨çlock#ä¿¡å·ãå¨å¤å¤çå¨ç¯å¢ä¸­ï¼lock#ä¿¡å·ç¡®ä¿å¨å£°è¨è¯¥ä¿¡å·æé´ï¼å¤çå¨å¯ä»¥ç¬å ä»»ä½å±äº«åå­ãä½æ¯ï¼å¨æè¿çå¤çå¨éï¼lock #ä¿¡å·ä¸è¬ä¸éæ»çº¿ï¼èæ¯éç¼å­ï¼æ¯ç«éæ»çº¿å¼éçæ¯è¾å¤§ãä½¿ç¨ç¼å­ä¸è´æ§æºå¶æ¥ç¡®ä¿ä¿®æ¹çåå­æ§ï¼æ­¤æä½è¢«ç§°ä¸ºâç¼å­éå®âï¼ç¼å­ä¸è´æ§æºå¶ä¼é»æ­¢åæ¶ä¿®æ¹ç±ä¸¤ä¸ªä»¥ä¸å¤çå¨ç¼å­çåå­åºåæ°æ®\n\n * ä¸ä¸ªå¤çå¨çç¼å­ååå°åå­ä¼\n   \n   å¯¼è´å¶ä»å¤çå¨çç¼å­æ æ\n   \n   * å¨å¤æ ¸å¤çå¨ç³»ç»ä¸­è¿è¡æä½çæ¶åï¼ia-32åintel 64å¤çå¨è½åæ¢å¶ä»å¤çå¨è®¿é®ç³»ç»åå­åå®ä»¬çåé¨ç¼å­ãå¤çå¨ä½¿ç¨åæ¢ææ¯ä¿è¯å®çåé¨ç¼å­ãç³»ç»åå­åå¶ä»å¤çå¨çç¼å­çæ°æ®å¨æ»çº¿ä¸ä¿æä¸è´\n\n\n# äºãå±äº«æ¨¡åä¹æ é\n\n\n# 1ãæ éè§£å³çº¿ç¨å®å¨é®é¢\n\n * ä½¿ç¨åå­æ´æ°\n   \n   atomicinteger balance = new atomicinteger();\n   \n   \n   1\n   \n\ninterface account {\n\tinteger getbalance();\n\n\tvoid withdraw(integer amount);\n\n\t/**\n\t * æ¹æ³åä¼å¯å¨ 1000 ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨å -10 å çæä½     * å¦æåå§ä½é¢ä¸º 10000 é£ä¹æ­£ç¡®çç»æåºå½æ¯ 0\n\t */\n\tstatic void demo(account account) {\n\t\tlist<thread> ts = new arraylist<>();\n\t\tlong start = system.nanotime();\n\t\tfor (int i = 0; i < 1000; i++) {\n\t\t\tts.add(new thread(() -> {\n\t\t\t\taccount.withdraw(10);\n\t\t\t}));\n\t\t}\n\t\tts.foreach(thread::start);\n\t\tts.foreach(t -> {\n\t\t\ttry {\n\t\t\t\tt.join();\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t});\n\t\tlong end = system.nanotime();\n\t\tsystem.out.println(account.getbalance() + " cost: " + (end - start) / 1000_000 + " ms");\n\t}\n}\n\n//çº¿ç¨ä¸å®å¨çåæ³\nclass accountunsafe implements account {\n\tprivate integer balance;\n\n\tpublic accountunsafe(integer balance) {\n\t\tthis.balance = balance;\n\t}\n\n\n\t@override\n\tpublic integer getbalance() {\n\t\treturn this.balance;\n\t}\n\n\t@override\n\tpublic synchronized void withdraw(integer amount) {\n\t\tbalance -= amount;\n\t}\n\n\tpublic static void main(string[] args) {\n\t\taccount.demo(new accountunsafe(10000));\n\t\taccount.demo(new accountcas(10000));\n\t}\n}\n\n//çº¿ç¨å®å¨çåæ³\nclass accountcas implements account {\n\t//ä½¿ç¨åå­æ´æ°\n\tprivate atomicinteger balance;\n\n\tpublic accountcas(int balance) {\n\t\tthis.balance = new atomicinteger(balance);\n\t}\n\n\t@override\n\tpublic integer getbalance() {\n\t\t//å¾å°åå­æ´æ°çå¼\n\t\treturn balance.get();\n\t}\n\n\t@override\n\tpublic void withdraw(integer amount) {\n\t\twhile(true) {\n\t\t\t//è·å¾ä¿®æ¹åçå¼\n\t\t\tint prev = balance.get();\n\t\t\t//è·å¾ä¿®æ¹åçå¼\n\t\t\tint next = prev-amount;\n\t\t\t//æ¯è¾å¹¶è®¾å¼\n\t\t\tif(balance.compareandset(prev, next)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n\n\n\n# 2ãcasä¸volatile\n\nåé¢çå°ç atomicinteger çè§£å³æ¹æ³ï¼åé¨å¹¶æ²¡æç¨éæ¥ä¿æ¤å±äº«åéççº¿ç¨å®å¨ãé£ä¹å®æ¯å¦ä½å®ç°çå¢ï¼\n\nå¶ä¸­çå³é®æ¯ compareandswapï¼æ¯è¾å¹¶è®¾ç½®å¼ï¼ï¼å®çç®ç§°å°±æ¯ cas ï¼ä¹æ compare and swap çè¯´æ³ï¼ï¼å®å¿é¡»æ¯åå­æä½ã\n\n\n\n\n# å·¥ä½æµç¨\n\n * å½ä¸ä¸ªçº¿ç¨è¦å»ä¿®æ¹accountå¯¹è±¡ä¸­çå¼æ¶ï¼åè·åå¼preï¼è°ç¨getæ¹æ³ï¼ï¼ç¶ååå°å¶è®¾ç½®ä¸ºæ°çå¼nextï¼è°ç¨casæ¹æ³ï¼ãå¨è°ç¨casæ¹æ³æ¶ï¼ä¼å°preä¸accountä¸­çä½é¢è¿è¡æ¯è¾ã\n   * å¦æä¸¤èç¸ç­ï¼å°±è¯´æè¯¥å¼è¿æªè¢«å¶ä»çº¿ç¨ä¿®æ¹ï¼æ­¤æ¶ä¾¿å¯ä»¥è¿è¡ä¿®æ¹æä½ã\n   * å¦æä¸¤èä¸ç¸ç­ï¼å°±ä¸è®¾ç½®å¼ï¼éæ°è·åå¼preï¼è°ç¨getæ¹æ³ï¼ï¼ç¶ååå°å¶è®¾ç½®ä¸ºæ°çå¼nextï¼è°ç¨casæ¹æ³ï¼ï¼ç´å°ä¿®æ¹æåä¸ºæ­¢ã\n\næ³¨æ\n\n * å¶å® cas çåºå±æ¯ lock cmpxchg æä»¤ï¼x86 æ¶æï¼ï¼å¨åæ ¸ cpu åå¤æ ¸ cpu ä¸é½è½å¤ä¿è¯ãæ¯è¾-äº¤æ¢ãçåå­æ§ã\n * å¨å¤æ ¸ç¶æä¸ï¼æä¸ªæ ¸æ§è¡å°å¸¦ lock çæä»¤æ¶ï¼cpu ä¼è®©æ»çº¿éä½ï¼å½è¿ä¸ªæ ¸ææ­¤æä»¤æ§è¡å®æ¯ï¼åå¼å¯æ»çº¿ãè¿ä¸ªè¿ç¨ä¸­ä¸ä¼è¢«çº¿ç¨çè°åº¦æºå¶æææ­ï¼ä¿è¯äºå¤ä¸ªçº¿ç¨å¯¹åå­æä½çåç¡®æ§ï¼æ¯åå­çã\n\n\n# volatile\n\nè·åå±äº«åéæ¶ï¼ä¸ºäºä¿è¯è¯¥åéçå¯è§æ§ï¼éè¦ä½¿ç¨ volatile ä¿®é¥°ã å®å¯ä»¥ç¨æ¥ä¿®é¥°æååéåéææååéï¼ä»å¯ä»¥é¿åçº¿ç¨ä»èªå·±çå·¥ä½ç¼å­ä¸­æ¥æ¾åéçå¼ï¼å¿é¡»å°ä¸»å­ä¸­è·å å®çå¼ï¼çº¿ç¨æä½ volatile åéé½æ¯ç´æ¥æä½ä¸»å­ãå³ä¸ä¸ªçº¿ç¨å¯¹ volatile åéçä¿®æ¹ï¼å¯¹å¦ä¸ä¸ªçº¿ç¨å¯è§ã\n\næ³¨æ\n\nvolatile ä»ä»ä¿è¯äºå±äº«åéçå¯è§æ§ï¼è®©å¶å®çº¿ç¨è½å¤çå°æ°å¼ï¼ä½ä¸è½è§£å³æä»¤äº¤éé®é¢ï¼ä¸è½ä¿è¯åå­æ§ï¼\n\n\n1\n\n\ncas å¿é¡»åå© volatile æè½è¯»åå°å±äº«åéçæ°å¼æ¥å®ç°ãæ¯è¾å¹¶äº¤æ¢ãçææ\n\n\n# æçé®é¢\n\nä¸è¬æåµä¸ï¼ä½¿ç¨æ éæ¯ä½¿ç¨å éçæçæ´é«ã\n\n\n\nåå \n\n\n# casç¹ç¹\n\nç»å cas å volatile å¯ä»¥å®ç°æ éå¹¶åï¼éç¨äºçº¿ç¨æ°å°ãå¤æ ¸ cpu çåºæ¯ä¸ã\n\n * cas æ¯åºäºä¹è§éçææ³ï¼ä¹è§çä¼°è®¡ï¼ä¸æå«ççº¿ç¨æ¥ä¿®æ¹å±äº«åéï¼å°±ç®æ¹äºä¹æ²¡å³ç³»ï¼æåäºç¹åéè¯åã\n\n * synchronized æ¯åºäºæ²è§éçææ³ï¼æ²è§çä¼°è®¡ï¼å¾é²çå¶å®çº¿ç¨æ¥ä¿®æ¹å±äº«åéï¼æä¸äºéä½ ä»¬é½å«æ³æ¹ï¼ææ¹å®äºè§£å¼éï¼ä½ ä»¬æææºä¼ã\n\n * cas ä½ç°çæ¯\n   \n   æ éå¹¶åãæ é»å¡å¹¶å\n   \n   ï¼è¯·ä»ç»ä½ä¼è¿ä¸¤å¥è¯çææ\n   \n   * å ä¸ºæ²¡æä½¿ç¨ synchronizedï¼æä»¥çº¿ç¨ä¸ä¼é·å¥é»å¡ï¼è¿æ¯æçæåçå ç´ ä¹ä¸\n   * ä½å¦æç«äºæ¿çï¼å¯ä»¥æ³å°éè¯å¿ç¶é¢ç¹åçï¼åèæçä¼åå½±å\n\n\n# 3ãåå­æ´æ°\n\nj.u.c å¹¶ååæä¾äº\n\n * atomicboolean\n * atomicinteger\n * atomiclong\n\nä»¥ atomicinteger ä¸ºä¾\n\n atomicinteger i = new atomicinteger(0);\n \n// è·åå¹¶èªå¢ï¼i = 0, ç»æ i = 1, è¿å 0ï¼ï¼ç±»ä¼¼äº i++ system.out.println(i.getandincrement());\n \n// èªå¢å¹¶è·åï¼i = 1, ç»æ i = 2, è¿å 2ï¼ï¼ç±»ä¼¼äº ++i system.out.println(i.incrementandget());\n \n// èªåå¹¶è·åï¼i = 2, ç»æ i = 1, è¿å 1ï¼ï¼ç±»ä¼¼äº --i system.out.println(i.decrementandget());\n \n// è·åå¹¶èªåï¼i = 1, ç»æ i = 0, è¿å 1ï¼ï¼ç±»ä¼¼äº i--\nsystem.out.println(i.getanddecrement());\n \n// è·åå¹¶å å¼ï¼i = 0, ç»æ i = 5, è¿å 0ï¼ \nsystem.out.println(i.getandadd(5));\n \n// å å¼å¹¶è·åï¼i = 5, ç»æ i = 0, è¿å 0ï¼ \nsystem.out.println(i.addandget(-5));\n \n// è·åå¹¶æ´æ°ï¼i = 0, p ä¸º i çå½åå¼, ç»æ i = -2, è¿å 0ï¼ \n// å¶ä¸­å½æ°ä¸­çæä½è½ä¿è¯åå­ï¼ä½å½æ°éè¦æ å¯ä½ç¨ \nsystem.out.println(i.getandupdate(p -> p - 2));\n \n// æ´æ°å¹¶è·åï¼i = -2, p ä¸º i çå½åå¼, ç»æ i = 0, è¿å 0ï¼\n// å¶ä¸­å½æ°ä¸­çæä½è½ä¿è¯åå­ï¼ä½å½æ°éè¦æ å¯ä½ç¨ \nsystem.out.println(i.updateandget(p -> p + 2));\n \n// è·åå¹¶è®¡ç®ï¼i = 0, p ä¸º i çå½åå¼, x ä¸ºåæ°1, ç»æ i = 10, è¿å 0ï¼ \n// å¶ä¸­å½æ°ä¸­çæä½è½ä¿è¯åå­ï¼ä½å½æ°éè¦æ å¯ä½ç¨ // getandupdate å¦æå¨ lambda ä¸­å¼ç¨äºå¤é¨çå±é¨åéï¼è¦ä¿è¯è¯¥å±é¨åéæ¯ final ç \n// getandaccumulate å¯ä»¥éè¿ åæ°1 æ¥å¼ç¨å¤é¨çå±é¨åéï¼ä½å ä¸ºå¶ä¸å¨ lambda ä¸­å æ­¤ä¸å¿æ¯ \nfinal system.out.println(i.getandaccumulate(10, (p, x) -> p + x));\n \n// è®¡ç®å¹¶è·åï¼i = 10, p ä¸º i çå½åå¼, x ä¸ºåæ°1, ç»æ i = 0, è¿å 0ï¼ \n// å¶ä¸­å½æ°ä¸­çæä½è½ä¿è¯åå­ï¼ä½å½æ°éè¦æ å¯ä½ç¨\nsystem.out.println(i.accumulateandget(-10, (p, x) -> p + x));\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n\n# 4ãåå­å¼ç¨\n\npublic interface decimalaccount {\n\tbigdecimal getbalance();\n\n\tvoid withdraw(bigdecimal amount);\n\n\t/**\n\t * æ¹æ³åä¼å¯å¨ 1000 ä¸ªçº¿ç¨ï¼æ¯ä¸ªçº¿ç¨å -10 å çæä½    \n     * å¦æåå§ä½é¢ä¸º 10000 é£ä¹æ­£ç¡®çç»æåºå½æ¯ 0\n\t */\n\tstatic void demo(decimalaccountimpl account) {\n\t\tlist<thread> ts = new arraylist<>();\n\t\tlong start = system.nanotime();\n\t\tfor (int i = 0; i < 1000; i++) {\n\t\t\tts.add(new thread(() -> {\n\t\t\t\taccount.withdraw(bigdecimal.ten);\n\t\t\t}));\n\t\t}\n\t\tts.foreach(thread::start);\n\t\tts.foreach(t -> {\n\t\t\ttry {\n\t\t\t\tt.join();\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t});\n\t\tlong end = system.nanotime();\n\t\tsystem.out.println(account.getbalance() + " cost: " + (end - start) / 1000_000 + " ms");\n\t}\n}\n\nclass decimalaccountimpl implements decimalaccount {\n\t//åå­å¼ç¨ï¼æ³åç±»åä¸ºå°æ°ç±»å\n\tatomicreference<bigdecimal> balance;\n\n\tpublic decimalaccountimpl(bigdecimal balance) {\n\t\tthis.balance = new atomicreference<bigdecimal>(balance);\n\t}\n\n\t@override\n\tpublic bigdecimal getbalance() {\n\t\treturn balance.get();\n\t}\n\n\t@override\n\tpublic void withdraw(bigdecimal amount) {\n\t\twhile(true) {\n\t\t\tbigdecimal pre = balance.get();\n\t\t\tbigdecimal next = pre.subtract(amount);\n\t\t\tif(balance.compareandset(pre, next)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static void main(string[] args) {\n\t\tdecimalaccount.demo(new decimalaccountimpl(new bigdecimal("10000")));\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n\n\n\n# 5ãabaé®é¢\n\npublic class demo3 {\n\tstatic atomicreference<string> str = new atomicreference<>("a");\n\tpublic static void main(string[] args) {\n\t\tnew thread(() -> {\n\t\t\tstring pre = str.get();\n\t\t\tsystem.out.println("change");\n\t\t\ttry {\n\t\t\t\tother();\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tthread.sleep(1000);\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t\t//æsträ¸­çaæ¹ä¸ºc\n\t\t\tsystem.out.println("change a->c " + str.compareandset(pre, "c"));\n\t\t}).start();\n\t}\n\n\tstatic void other() throws interruptedexception {\n\t\tnew thread(()-> {\n\t\t\tsystem.out.println("change a->b " + str.compareandset("a", "b"));\n\t\t}).start();\n\t\tthread.sleep(500);\n\t\tnew thread(()-> {\n\t\t\tsystem.out.println("change b->a " + str.compareandset("b", "a"));\n\t\t}).start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n\n\n\n\nä¸»çº¿ç¨ä»è½å¤æ­åºå±äº«åéçå¼ä¸åå¼ a æ¯å¦ç¸åï¼ä¸è½æç¥å°è¿ç§ä» a æ¹ä¸º b å æ¹å a çæåµï¼å¦æä¸»çº¿ç¨å¸æï¼ åªè¦æå¶å®çº¿ç¨ãå¨è¿äºãå±äº«åéï¼é£ä¹èªå·±ç cas å°±ç®å¤±è´¥ï¼è¿æ¶ï¼ä»æ¯è¾å¼æ¯ä¸å¤çï¼éè¦åå ä¸ä¸ªçæ¬å·\n\n\n# atomicstampedreference\n\npublic class demo3 {\n\t//æå®çæ¬å·\n\tstatic atomicstampedreference<string> str = new atomicstampedreference<>("a", 0);\n\tpublic static void main(string[] args) {\n\t\tnew thread(() -> {\n\t\t\tstring pre = str.getreference();\n\t\t\t//è·å¾çæ¬å·\n\t\t\tint stamp = str.getstamp();\n\t\t\tsystem.out.println("change");\n\t\t\ttry {\n\t\t\t\tother();\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tthread.sleep(1000);\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t\t//æsträ¸­çaæ¹ä¸ºc,å¹¶æ¯å¯¹çæ¬å·ï¼å¦æçæ¬å·ç¸åï¼å°±æ§è¡æ¿æ¢ï¼å¹¶è®©çæ¬å·+1\n\t\t\tsystem.out.println("change a->c stamp " + stamp + str.compareandset(pre, "c", stamp, stamp+1));\n\t\t}).start();\n\t}\n\n\tstatic void other() throws interruptedexception {\n\t\tnew thread(()-> {\n\t\t\tint stamp = str.getstamp();\n\t\t\tsystem.out.println("change a->b stamp " + stamp + str.compareandset("a", "b", stamp, stamp+1));\n\t\t}).start();\n\t\tthread.sleep(500);\n\t\tnew thread(()-> {\n\t\t\tint stamp = str.getstamp();\n\t\t\tsystem.out.println("change b->a stamp " + stamp +  str.compareandset("b", "a", stamp, stamp+1));\n\t\t}).start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n\n\n\n\n\n# atomicmarkablereference\n\natomicstampedreference å¯ä»¥ç»åå­å¼ç¨å ä¸çæ¬å·ï¼è¿½è¸ªåå­å¼ç¨æ´ä¸ªçååè¿ç¨ï¼å¦ï¼ a -> b -> a -> c ï¼éè¿atomicstampedreferenceï¼æä»¬å¯ä»¥ç¥éï¼å¼ç¨åéä¸­éè¢«æ´æ¹äºå æ¬¡ã ä½æ¯ææ¶åï¼å¹¶ä¸å³å¿å¼ç¨åéæ´æ¹äºå æ¬¡ï¼åªæ¯åçº¯çå³å¿æ¯å¦æ´æ¹è¿ï¼æä»¥å°±æäº atomicmarkablereference\n\npublic class demo4 {\n\t//æå®çæ¬å·\n\tstatic atomicmarkablereference<string> str = new atomicmarkablereference<>("a", true);\n\tpublic static void main(string[] args) {\n\t\tnew thread(() -> {\n\t\t\tstring pre = str.getreference();\n\t\t\tsystem.out.println("change");\n\t\t\ttry {\n\t\t\t\tother();\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tthread.sleep(1000);\n\t\t\t} catch (interruptedexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t\t//æsträ¸­çaæ¹ä¸ºc,å¹¶æ¯å¯¹çæ¬å·ï¼å¦æçæ¬å·ç¸åï¼å°±æ§è¡æ¿æ¢ï¼å¹¶è®©çæ¬å·+1\n\t\t\tsystem.out.println("change a->c mark " +  str.compareandset(pre, "c", true, false));\n\t\t}).start();\n\t}\n\n\tstatic void other() throws interruptedexception {\n\t\tnew thread(() -> {\n\t\t\tsystem.out.println("change a->a mark " + str.compareandset("a", "a", true, false));\n\t\t}).start();\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n\n\n\n\n\n# ä¸¤èçåºå«\n\n * atomicstampedreference éè¦æä»¬ä¼ å¥æ´ååéä½ä¸ºçæ¬å·ï¼æ¥å¤å®æ¯å¦è¢«æ´æ¹è¿\n * atomicmarkablereferenceéè¦æä»¬ä¼ å¥å¸å°åéä½ä¸ºæ è®°ï¼æ¥å¤æ­æ¯å¦è¢«æ´æ¹è¿\n\n\n# 6ãåå­æ°ç»\n\n * atomicintegerarray\n * atomiclongarray\n * atomicreferencearray\n\n\n# lambaè¡¨è¾¾å¼çä½¿ç¨\n\n * æä¾è\n   * æ ååè¿å\n   * ()->è¿åç»æ\n * æ¹æ³\n   * æåæè¿å\n   * (åæ°ä¸â¦)->è¿åç»æ\n * æ¶è´¹è\n   * æåæ è¿å\n   * (åæ°ä¸â¦)->void\n\n\n# 7ãåå­æ´æ°å¨\n\n * atomicreferencefieldupdater // å å­æ®µ\n * atomicintegerfieldupdater\n * atomiclongfieldupdate\n\nåå­æ´æ°å¨ç¨äºå¸®å©æä»¬æ¹åæä¸ªå¯¹è±¡ä¸­çæä¸ªå±æ§\n\npublic class demo1 {\n   public static void main(string[] args) {\n      student student = new student();\n       \n      // è·å¾åå­æ´æ°å¨\n      // æ³å\n      // åæ°1 ææå±æ§çç±» åæ°2 è¢«æ´æ°çå±æ§çç±»\n      // newupdaterä¸­çåæ°ï¼ç¬¬ä¸ä¸ªä¸ºå±æ§çåç§°\n      atomicreferencefieldupdater<student, string> updater = atomicreferencefieldupdater.newupdater(student.class, string.class, "name");\n       \n      // ä¿®æ¹\n      updater.compareandset(student, null, "nyima");\n      system.out.println(student);\n   }\n}\n\nclass student {\n   volatile string name;\n\n   @override\n   public string tostring() {\n      return "student{" +\n            "name=\'" + name + \'\\\'\' +\n            \'}\';\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n\n# åå­æ´æ°å¨åå§åè¿ç¨\n\nä»ä¸é¢çä¾å­å¯ä»¥çåºï¼åå­æ´æ°å¨æ¯éè¿newupdateræ¥è·åå®ä¾çãå¶ä¸­ä¼ å¥äºä¸ä¸ªåæ°\n\n * æ¥æå±æ§çç±»çclass\n * å±æ§çclass\n * å±æ§çåç§°\n\nå¤§æ¦å¯ä»¥çåºæ¥ï¼åå§åè¿ç¨ç¨å°äºåå°ï¼è®©æä»¬ççæºç æ¥éªè¯ä¸ä¸è¿ä¸ªçæµã\n\n# newupdateræ¹æ³\n\npublic static <u,w> atomicreferencefieldupdater<u,w> newupdater(class<u> tclass,\n                                                                class<w> vclass,\n                                                                string fieldname) {\n    // è¿åäºä¸ä¸ªatomicreferencefieldupdaterimplå®ä¾\n    return new atomicreferencefieldupdaterimpl<u,w>\n        (tclass, vclass, fieldname, reflection.getcallerclass());\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\nä»newupdateræ¹æ³è¿å¹¶ä¸è½çåºæ¥å·ä½çåå§åè¿ç¨\n\n# åé¨å®ç°ç±»\n\n\n\natomicreferencefieldupdaterä¸ºæ½è±¡ç±»ï¼è¯¥ç±»åé¨æä¸ä¸ªèªå·±çå®ç°ç±»atomicreferencefieldupdaterimpl\n\nprivate static final class atomicreferencefieldupdaterimpl<t,v>\n        extends atomicreferencefieldupdater<t,v>\n\n\n1\n2\n\n\n\n\næé æ¹æ³\n\natomicreferencefieldupdaterimpl(final class<t> tclass,\n                                final class<v> vclass,\n                                final string fieldname,\n                                final class<?> caller) {\n    // ç¨äºä¿å­è¦è¢«ä¿®æ¹çå±æ§\n    final field field;\n    \n    // å±æ§çclass\n    final class<?> fieldclass;\n    \n    // fieldçä¿®é¥°ç¬¦\n    final int modifiers;\n    try {\n        // åå°è·å¾å±æ§\n        field = accesscontroller.doprivileged(\n            new privilegedexceptionaction<field>() {\n                public field run() throws nosuchfieldexception {\n                    // tclassä¸ºä¼ å¥çå±æ§çclassï¼å¯ä»¥éè¿å®æ¥è·å¾å±æ§\n                    return tclass.getdeclaredfield(fieldname);\n                }\n            });\n        \n        // è·å¾å±æ§çä¿®é¥°ç¬¦ï¼ä¸»è¦ç¨äºå¤æ­\n        // 1ãvclass ä¸ å±æ§ç¡®åçç±»åæ¯å¦å¹é\n        // 2ãæ¯å¦ä¸ºå¼ç¨ç±»å\n        // 3ãè¢«ä¿®æ¹çå±æ§æ¯å¦å äºvolatileå³é®å­\n        modifiers = field.getmodifiers();\n        sun.reflect.misc.reflectutil.ensurememberaccess(\n            caller, tclass, null, modifiers);\n        classloader cl = tclass.getclassloader();\n        classloader ccl = caller.getclassloader();\n        if ((ccl != null) && (ccl != cl) &&\n            ((cl == null) || !isancestor(cl, ccl))) {\n            sun.reflect.misc.reflectutil.checkpackageaccess(tclass);\n        }\n        \n        // è·å¾å±æ§ç±»çclass\n        fieldclass = field.gettype();\n    } catch (privilegedactionexception pae) {\n        throw new runtimeexception(pae.getexception());\n    } catch (exception ex) {\n        throw new runtimeexception(ex);\n    }\n\n    if (vclass != fieldclass)\n        throw new classcastexception();\n    if (vclass.isprimitive())\n        throw new illegalargumentexception("must be reference type");\n\n    if (!modifier.isvolatile(modifiers))\n        throw new illegalargumentexception("must be volatile type");\n\n    // access to protected field members is restricted to receivers only\n    // of the accessing class, or one of its subclasses, and the\n    // accessing class must in turn be a subclass (or package sibling)\n    // of the protected member\'s defining class.\n    // if the updater refers to a protected field of a declaring class\n    // outside the current package, the receiver argument will be\n    // narrowed to the type of the accessing class.\n \t// å¯¹ç±»ä¸­çå±æ§è¿è¡åå§å\n    this.cclass = (modifier.isprotected(modifiers) &&\n                   tclass.isassignablefrom(caller) &&\n                   !issamepackage(tclass, caller))\n                  ? caller : tclass;\n    this.tclass = tclass;\n    this.vclass = vclass;\n    // è·å¾åç§»é\n    this.offset = u.objectfieldoffset(field);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n\n\nå¯ä»¥çåºï¼åå­å¼ç¨æ´æ°å¨ç¡®å®ä½¿ç¨äºåå°\n\n\n# 8ãlongadderåç\n\n\n# åçä¹ä¼ªå±äº«\n\n\n\nç¼å­è¡ä¼ªå±äº«å¾ä»ç¼å­è¯´èµ· ç¼å­ä¸åå­çéåº¦æ¯è¾\n\n\n\n\n\nå ä¸º cpu ä¸ åå­çéåº¦å·®å¼å¾å¤§ï¼éè¦é é¢è¯»æ°æ®è³ç¼å­æ¥æåæçã èç¼å­ä»¥ç¼å­è¡ä¸ºåä½ï¼æ¯ä¸ªç¼å­è¡å¯¹åºçä¸ååå­ï¼ä¸è¬æ¯ 64 byteï¼8 ä¸ª longï¼ ç¼å­çå å¥ä¼é ææ°æ®å¯æ¬çäº§çï¼å³åä¸ä»½æ°æ®ä¼ç¼å­å¨ä¸åæ ¸å¿çç¼å­è¡ä¸­ cpu è¦ä¿è¯æ°æ®çä¸è´æ§ï¼å¦ææä¸ª cpu æ ¸å¿æ´æ¹äºæ°æ®ï¼å¶å® cpu æ ¸å¿å¯¹åºçæ´ä¸ªç¼å­è¡å¿é¡»å¤±æ\n\n\n\nå ä¸º cell æ¯æ°ç»å½¢å¼ï¼å¨åå­ä¸­æ¯è¿ç»­å­å¨çï¼ä¸ä¸ª cell ä¸º 24 å­èï¼16 å­èçå¯¹è±¡å¤´å 8 å­èç valueï¼ï¼å  æ­¤ç¼å­è¡å¯ä»¥å­ä¸ 2 ä¸ªç cell å¯¹è±¡ãè¿æ ·é®é¢æ¥äºï¼\n\n * core-0 è¦ä¿®æ¹ cell[0]\n * core-1 è¦ä¿®æ¹ cell[1]\n\næ è®ºè°ä¿®æ¹æåï¼é½ä¼å¯¼è´å¯¹æ¹ core çç¼å­è¡å¤±æï¼\n\næ¯å¦ core-0 ä¸­ cell[0]=6000, cell[1]=8000 è¦ç´¯å  cell[0]=6001, cell[1]=8000 ï¼è¿æ¶ä¼è®© core-1 çç¼å­è¡å¤±æ\n\n@sun.misc.contended ç¨æ¥è§£å³è¿ä¸ªé®é¢ï¼å®çåçæ¯å¨ä½¿ç¨æ­¤æ³¨è§£çå¯¹è±¡æå­æ®µçåååå¢å  128 å­èå¤§å°ç paddingï¼ç©ºç½ï¼ï¼ä»èè®© cpu å°å¯¹è±¡é¢è¯»è³ç¼å­æ¶å ç¨ä¸åçç¼å­è¡ï¼è¿æ ·ï¼ä¸ä¼é æå¯¹æ¹ç¼å­è¡çå¤±æ\n\n\n\nç´¯å ä¸»è¦è°ç¨ä»¥ä¸æ¹æ³\n\npublic void add(long x) {\n       cell[] as; long b, v; int m; cell a;\n       if ((as = cells) != null || !casbase(b = base, b + x)) {\n           boolean uncontended = true;\n           if (as == null || (m = as.length - 1) < 0 ||\n               (a = as[getprobe() & m]) == null ||\n               !(uncontended = a.cas(v = a.value, v + x)))\n               longaccumulate(x, null, uncontended);\n       }\n   }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\nç´¯å æµç¨å¾\n\n\n\n\n# 9ãunsafe\n\nunsafe å¯¹è±¡æä¾äºéå¸¸åºå±çï¼æä½åå­ãçº¿ç¨çæ¹æ³ï¼unsafe å¯¹è±¡ä¸è½ç´æ¥è°ç¨ï¼åªè½éè¿åå°è·å¾\n\npublic class getunsafe {\n\tpublic static void main(string[] args) throws nosuchmethodexception, illegalaccessexception, invocationtargetexception, instantiationexception, nosuchfieldexception {\n\t\t// éè¿åå°è·å¾unsafeå¯¹è±¡\n\t\tclass unsafeclass = unsafe.class;\n\t\t// è·å¾æé å½æ°ï¼unsafeçæé å½æ°ä¸ºç§æç\n\t\tconstructor constructor = unsafeclass.getdeclaredconstructor();\n\t\t// è®¾ç½®ä¸ºåè®¸è®¿é®ç§æåå®¹\n\t\tconstructor.setaccessible(true);\n\t\t// åå»ºunsafeå¯¹è±¡\n\t\tunsafe unsafe = (unsafe) constructor.newinstance();\n\t\t\n\t\t// åå»ºpersonå¯¹è±¡\n\t\tperson person = new person();\n\t\t// è·å¾å¶å±æ§ name çåç§»é\n\t\tfield field = person.class.getdeclaredfield("name");\n\t\tlong offset = unsafe.objectfieldoffset(field);\n\n\t\t// éè¿unsafeçcasæä½æ¹åå¼\n\t\tunsafe.compareandswapobject(person, offset, null, "nyima");\n\t\tsystem.out.println(person);\n\t}\n}\n\nclass person {\n    // éåcasæä½ï¼å¿é¡»ç¨volatileä¿®é¥°\n \tvolatile string name;\n\n\n\t@override\n\tpublic string tostring() {\n\t\treturn "person{" +\n\t\t\t\t"name=\'" + name + \'\\\'\' +\n\t\t\t\t\'}\';\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\n\n# å­ãå±äº«æ¨¡åä¹ä¸å¯å\n\n\n# 1ãä¸å¯å\n\nå¦æä¸ä¸ªå¯¹è±¡å¨ä¸è½å¤ä¿®æ¹å¶åé¨ç¶æï¼å±æ§ï¼ï¼é£ä¹å®å°±æ¯çº¿ç¨å®å¨çï¼å ä¸ºä¸å­å¨å¹¶åä¿®æ¹ã\n\n\n# 2ãä¸å¯åè®¾è®¡\n\n# stringç±»ä¸­ä¸å¯åçä½ç°\n\npublic final class string\n    implements java.io.serializable, comparable<string>, charsequence {\n    /** the value is used for character storage. */\n    private final char value[];\n\n    /** cache the hash code for the string */\n    private int hash; // default to 0\n    \n   //....\n  }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nï¬nal çä½¿ç¨ * åç°è¯¥ç±»ãç±»ä¸­ææå±æ§é½æ¯ *ï¬nal ç\n\n * å±æ§ç¨ ï¬nal ä¿®é¥°ä¿è¯äºè¯¥å±æ§æ¯åªè¯»çï¼ä¸è½ä¿®æ¹\n * ç±»ç¨ ï¬nal ä¿®é¥°ä¿è¯äºè¯¥ç±»ä¸­çæ¹æ³ä¸è½è¢«è¦çï¼é²æ­¢å­ç±»æ æé´ç ´åä¸å¯åæ§\n\n**ä¿æ¤æ§æ·è´ **\n\nä½æåå­¦ä¼è¯´ï¼ä½¿ç¨å­ç¬¦ä¸²æ¶ï¼ä¹æä¸äºè·ä¿®æ¹ç¸å³çæ¹æ³åï¼æ¯å¦ substring ç­ï¼é£ä¹ä¸é¢å°±çä¸çè¿äºæ¹æ³æ¯ å¦ä½å®ç°çï¼å°±ä»¥ substring ä¸ºä¾\n\npublic string substring(int beginindex) {\n        if (beginindex < 0) {\n            throw new stringindexoutofboundsexception(beginindex);\n        }\n        int sublen = value.length - beginindex;\n        if (sublen < 0) {\n            throw new stringindexoutofboundsexception(sublen);\n        }\n    \t//è¿åçæ¯ä¸ä¸ªæ°çå¯¹è±¡\n        return (beginindex == 0) ? this : new string(value, beginindex, sublen);\n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nåç°å¶åé¨æ¯è°ç¨ string çæé æ¹æ³åå»ºäºä¸ä¸ªæ°å­ç¬¦ä¸²\n\npublic string(char value[], int offset, int count) {\n        if (offset < 0) {\n            throw new stringindexoutofboundsexception(offset);\n        }\n        if (count <= 0) {\n            if (count < 0) {\n                throw new stringindexoutofboundsexception(count);\n            }\n            if (offset <= value.length) {\n                this.value = "".value;\n                return;\n            }\n        }\n        // note: offset or count might be near -1>>>1.\n        if (offset > value.length - count) {\n            throw new stringindexoutofboundsexception(offset + count);\n        }\n        this.value = arrays.ofrange(value, offset, offset+count);\n    }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\næé æ°å­ç¬¦ä¸²å¯¹è±¡æ¶ï¼ä¼çææ°ç char[] valueï¼å¯¹åå®¹è¿è¡å¤å¶ ãè¿ç§éè¿åå»ºå¯æ¬å¯¹è±¡æ¥é¿åå±äº«çææ®µç§°ä¹ä¸ºãä¿æ¤æ§æ·è´ï¼defensive ï¼ã\n\n\n# ä¸ãçº¿ç¨æ± \n\n\n# 1ãèªå®ä¹çº¿ç¨æ± \n\n\n# å¾è§£\n\n\n\n * é»å¡éåä¸­ç»´æ¤äºç±ä¸»çº¿ç¨ï¼æèå¶ä»çº¿ç¨ï¼æäº§çççä»»å¡\n * ä¸»çº¿ç¨ç±»ä¼¼äºçäº§èï¼äº§çä»»å¡å¹¶æ¾å¥é»å¡éåä¸­\n * çº¿ç¨æ± ç±»ä¼¼äºæ¶è´¹èï¼å¾å°é»å¡éåä¸­å·²æçä»»å¡å¹¶æ§è¡\n\n\n# ä»£ç \n\npublic class demo3 {\n   public static void main(string[] args) {\n      threadpool threadpool = new threadpool(2,  timeunit.seconds, 1, 4);\n      for (int i = 0; i < 10; i++) {\n         threadpool.execute(()->{\n            try {\n               timeunit.seconds.sleep(10000);\n            } catch (interruptedexception e) {\n               e.printstacktrace();\n            }\n            system.out.println("ä»»å¡æ­£å¨æ§è¡!");\n         });\n      }\n   }\n}\n\n\n/**\n * èªå®ä¹çº¿ç¨æ± \n */\nclass threadpool {\n   /**\n    * èªå®ä¹é»å¡éå\n    */\n   private blockingqueue<runnable> blockingqueue;\n\n   /**\n    * æ ¸å¿çº¿ç¨æ°\n    */\n   private int coresize;\n\n   private hashset<worker> workers = new hashset<>();\n\n   /**\n    * ç¨äºæå®çº¿ç¨æå¤§å­æ´»æ¶é´\n    */\n   private timeunit timeunit;\n   private long timeout;\n\n   /**\n    * å·¥ä½çº¿ç¨ç±»\n    * åé¨å°è£äºthreadç±»ï¼å¹¶ä¸æ·»å äºä¸äºå±æ§\n    */\n   private class worker extends thread {\n      runnable task;\n\n      public worker(runnable task) {\n         system.out.println("åå§åä»»å¡");\n         this.task = task;\n      }\n\n      @override\n      public void run() {\n         // å¦ææä»»å¡å°±æ§è¡\n         // å¦æé»å¡éåä¸­æä»»å¡ï¼å°±ç»§ç»­æ§è¡\n         while (task != null || (task = blockingqueue.take()) != null) {\n            try {\n               system.out.println("æ§è¡ä»»å¡");\n               task.run();\n            } catch (exception e) {\n               e.printstacktrace();\n            } finally {\n               // ä»»å¡æ§è¡å®æ¯ï¼è®¾ä¸ºç©º\n               system.out.println("ä»»å¡æ§è¡å®æ¯");\n               task = null;\n            }\n         }\n         // ç§»é¤ä»»å¡\n         synchronized (workers) {\n            system.out.println("ç§»é¤ä»»å¡");\n            workers.remove(this);\n         }\n      }\n   }\n\n   public threadpool(int coresize, timeunit timeunit, long timeout, int capacity) {\n      this.coresize = coresize;\n      this.timeunit = timeunit;\n      blockingqueue = new blockingqueue<>(capacity);\n      this.timeout = timeout;\n   }\n\n   public void execute(runnable task) {\n      synchronized (workers) {\n         // åå»ºä»»å¡\n         // æ± ä¸­è¿æç©ºä½çº¿ç¨æ¶ï¼å¯ä»¥è¿è¡ä»»å¡\n         // å¦åé»å¡\n         if (workers.size() < coresize) {\n            worker worker = new worker(task);\n            workers.add(worker);\n            worker.start();\n         } else {\n            system.out.println("çº¿ç¨æ± ä¸­çº¿ç¨å·²ç¨å®ï¼è¯·ç¨ç­");\n            blockingqueue.put(task);\n         }\n      }\n   }\n}\n\n/**\n * é»å¡éå\n * ç¨äºå­æ¾ä¸»çº¿ç¨æå¶ä»çº¿ç¨äº§ççä»»å¡\n */\nclass blockingqueue<t> {\n   /**\n    * é»å¡éå\n    */\n   private  deque<t> blockingqueue;\n\n   /**\n    * é»å¡éåå®¹é\n    */\n   private int capacity;\n\n   /**\n    * é\n    */\n   private reentrantlock lock;\n\n   /**\n    * æ¡ä»¶éå\n    */\n   private condition fullqueue;\n   private condition emptyqueue;\n\n\n   public blockingqueue(int capacity) {\n      blockingqueue = new arraydeque<>(capacity);\n      lock = new reentrantlock();\n      fullqueue = lock.newcondition();\n      emptyqueue = lock.newcondition();\n      this.capacity = capacity;\n   }\n\n   /**\n    * è·åä»»å¡çæ¹æ³\n    */\n   public t take() {\n      // å é\n      lock.lock();\n      try {\n         // å¦æé»å¡éåä¸ºç©ºï¼æ²¡æä»»å¡ï¼ï¼å°±ä¸ç´ç­å¾\n         while (blockingqueue.isempty()) {\n            try {\n               emptyqueue.await();\n            } catch (interruptedexception e) {\n               e.printstacktrace();\n            }\n         }\n         // è·åä»»å¡å¹¶å¤éçäº§èçº¿ç¨\n         t task = blockingqueue.removefirst();\n         fullqueue.signalall();\n         return task;\n      } finally {\n         lock.unlock();\n      }\n   }\n\n   public t takenanos(long timeout, timeunit unit) {\n      // è½¬æ¢ç­å¾æ¶é´\n      lock.lock();\n      try {\n         long nanos = unit.tonanos(timeout);\n         while (blockingqueue.isempty()) {\n            try {\n               // awaitnanosä¼è¿åå©ä¸çç­å¾æ¶é´\n               nanos = emptyqueue.awaitnanos(nanos);\n               if (nanos < 0) {\n                  return null;\n               }\n            } catch (interruptedexception e) {\n               e.printstacktrace();\n            }\n         }\n         t task = blockingqueue.removefirst();\n         fullqueue.signalall();\n         return task;\n      } finally {\n         lock.unlock();\n      }\n   }\n\n   /**\n    * æ¾å¥ä»»å¡çæ¹æ³\n    * @param task æ¾å¥é»å¡éåçä»»å¡\n    */\n   public void put(t task) {\n      lock.lock();\n      try {\n         while (blockingqueue.size() == capacity) {\n            try {\n               system.out.println("é»å¡éåå·²æ»¡");\n               fullqueue.await();\n            } catch (interruptedexception e) {\n               e.printstacktrace();\n            }\n         }\n         blockingqueue.add(task);\n         // å¤éç­å¾çæ¶è´¹è\n         emptyqueue.signalall();\n      } finally {\n         lock.unlock();\n      }\n   }\n\n   public int getsize() {\n      lock.lock();\n      try {\n         return blockingqueue.size();\n      } finally {\n         lock.unlock();\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n143\n144\n145\n146\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n163\n164\n165\n166\n167\n168\n169\n170\n171\n172\n173\n174\n175\n176\n177\n178\n179\n180\n181\n182\n183\n184\n185\n186\n187\n188\n189\n190\n191\n192\n193\n194\n195\n196\n197\n198\n199\n200\n201\n202\n203\n204\n205\n206\n207\n208\n209\n210\n211\n212\n213\n214\n\n\nå®ç°äºä¸ä¸ªç®åççº¿ç¨æ± \n\n * é»å¡éåblockingqueueç¨äºæå­æ¥ä¸åè¢«çº¿ç¨æ§è¡çä»»å¡\n   * ä¹å¯ä»¥è¯´æ¯å¹³è¡¡çäº§èåæ¶è´¹èæ§è¡éåº¦ä¸çå·®å¼\n   * éé¢çè·åä»»å¡åæ¾å¥ä»»å¡ç¨å°äºçäº§èæ¶è´¹èæ¨¡å¼\n * çº¿ç¨æ± ä¸­å¯¹çº¿ç¨threadè¿è¡äºåæ¬¡çå°è£ï¼å°è£ä¸ºäºworker\n   * å¨è°ç¨ä»»å¡çrunæ¹æ³æ¶ï¼çº¿ç¨ä¼å»æ§è¡è¯¥ä»»å¡ï¼æ§è¡å®æ¯åè¿ä¼å°é»å¡éåä¸­è·åæ°ä»»å¡æ¥æ§è¡\n * çº¿ç¨æ± ä¸­æ§è¡ä»»å¡çä¸»è¦æ¹æ³ä¸ºexecuteæ¹æ³\n   * æ§è¡æ¶è¦å¤æ­æ­£å¨æ§è¡ççº¿ç¨æ°æ¯å¦å¤§äºäºçº¿ç¨æ± å®¹é\n\n\n# 2ãthreadpoolexecutor\n\n\n# ç»§æ¿å³ç³»\n\n\n\n\n# çº¿ç¨æ± ç¶æ\n\n// çº¿ç¨æ± ç¶æ\n// runstate is stored in the high-order bits\n// running é«3ä½ä¸º111\nprivate static final int running    = -1 << count_bits;\n\n// shutdown é«3ä½ä¸º000\nprivate static final int shutdown   =  0 << count_bits;\n\n// é«3ä½ 001\nprivate static final int stop       =  1 << count_bits;\n\n// é«3ä½ 010\nprivate static final int tidying    =  2 << count_bits;\n\n// é«3ä½ 011\nprivate static final int terminated =  3 << count_bits;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\nç¶æåç§°         é«3ä½çå¼   æè¿°\nrunning      111     æ¥æ¶æ°ä»»å¡ï¼åæ¶å¤çä»»å¡éåä¸­çä»»å¡\nshutdown     000     ä¸æ¥åæ°ä»»å¡ï¼ä½æ¯å¤çä»»å¡éåä¸­çä»»å¡\nstop         001     ä¸­æ­æ­£å¨æ§è¡çä»»å¡ï¼åæ¶æå¼é»å¡éåä¸­çä»»å¡\ntidying      010     ä»»å¡æ§è¡å®æ¯ï¼æ´»å¨çº¿ç¨ä¸º0æ¶ï¼å³å°è¿å¥ç»ç»é¶æ®µ\nterminated   011     ç»ç»ç¶æ\n\nçº¿ç¨æ± ç¶æåçº¿ç¨æ± ä¸­çº¿ç¨çæ°éç±ä¸ä¸ªåå­æ´åctlæ¥å±åè¡¨ç¤º\n\n * ä½¿ç¨ä¸ä¸ªæ°æ¥è¡¨ç¤ºä¸¤ä¸ªå¼çä¸»è¦åå æ¯ï¼å¯ä»¥éè¿ä¸æ¬¡casåæ¶æ´æ¹ä¸¤ä¸ªå±æ§çå¼\n\n// åå­æ´æ°ï¼å3ä½ä¿å­äºçº¿ç¨æ± çç¶æï¼å©ä½ä½ä¿å­çæ¯çº¿ç¨æ°é\nprivate final atomicinteger ctl = new atomicinteger(ctlof(running, 0));\n\n// å¹¶ä¸æ¯ææå¹³å°çinté½æ¯32ä½ã\n// å»æåä¸ä½ä¿å­çº¿ç¨ç¶æçä½æ°ï¼å©ä¸çç¨äºä¿å­çº¿ç¨æ°é\n// é«3ä½ä¸º0ï¼å©ä½ä½æ°å¨ä¸º1\nprivate static final int count_bits = integer.size - 3;\n\n// 2^count_bitsæ¬¡æ¹ï¼è¡¨ç¤ºå¯ä»¥ä¿å­çæå¤§çº¿ç¨æ°\n// capacity çé«3ä½ä¸º 0\nprivate static final int capacity   = (1 << count_bits) - 1;\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\nè·åçº¿ç¨æ± ç¶æãçº¿ç¨æ°éä»¥ååå¹¶ä¸¤ä¸ªå¼çæä½\n\n// packing and unpacking ctl\n// è·åè¿è¡ç¶æ\n// è¯¥æä½ä¼è®©é¤é«3ä½ä»¥å¤çæ°å¨é¨åä¸º0\nprivate static int runstateof(int c)     { return c & ~capacity; }\n\n// è·åè¿è¡çº¿ç¨æ°\n// è¯¥æä½ä¼è®©é«3ä½ä¸º0\nprivate static int workercountof(int c)  { return c & capacity; }\n\n// è®¡ç®ctlæ°å¼\nprivate static int ctlof(int rs, int wc) { return rs | wc; }\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# çº¿ç¨æ± å±æ§\n\n// å·¥ä½çº¿ç¨ï¼åé¨å°è£äºthread\nprivate final class worker\n        extends abstractqueuedsynchronizer\n        implements runnable {\n    ...\n}\n\n// é»å¡éåï¼ç¨äºå­æ¾æ¥ä¸åè¢«æ ¸å¿çº¿ç¨æ§è¡çä»»å¡\nprivate final blockingqueue<runnable> workqueue;\n\n// é\nprivate final reentrantlock mainlock = new reentrantlock();\n\n//  ç¨äºå­æ¾æ ¸å¿çº¿ç¨çå®¹å¨ï¼åªæå½ææéæ¶æè½å¤è·åå¶ä¸­çåç´ ï¼æ ¸å¿çº¿ç¨ï¼\nprivate final hashset<worker> workers = new hashset<worker>();\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n\n# æé æ¹æ³æå¶åæ°\n\nthreadpoolexecutoræå¨é¢çæé æ¹æ³\n\nä¹æ¯æé èªå®ä¹çº¿ç¨æ± çæ¹æ³\n\npublic threadpoolexecutor(int corepoolsize,\n                          int maximumpoolsize,\n                          long keepalivetime,\n                          timeunit unit,\n                          blockingqueue<runnable> workqueue,\n                          threadfactory threadfactory,\n                          rejectedexecutionhandler handler)\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# åæ°è§£é\n\n * corepoolsizeï¼æ ¸å¿çº¿ç¨æ°\n * maximumpoolsizeï¼æå¤§çº¿ç¨æ°\n   * maximumpoolsize - corepoolsize = ææ¥çº¿ç¨æ°\n * keepalivetimeï¼ææ¥çº¿ç¨ç©ºé²æ¶çæå¤§çå­æ¶é´\n * unitï¼æ¶é´åä½\n * workqueueï¼é»å¡éåï¼å­æ¾ä»»å¡ï¼\n   * æçé»å¡éå arrayblockingqueue\n   * æ çé»å¡éå linkedblockingqueue\n   * æå¤åªæä¸ä¸ªåæ­¥åç´ ç synchronousqueue\n   * ä¼åéå priorityblockingqueue\n * threadfactoryï¼çº¿ç¨å·¥åï¼ç»çº¿ç¨ååå­ï¼\n * handlerï¼æç»ç­ç¥\n\n# å·¥ä½æ¹å¼\n\n * å½ä¸ä¸ªä»»å¡ä¼ ç»çº¿ç¨æ± ä»¥åï¼å¯è½æä»¥ä¸å ç§å¯è½\n   * å°ä»»å¡åéç»ä¸ä¸ªæ ¸å¿çº¿ç¨æ¥æ§è¡\n   * æ ¸å¿çº¿ç¨é½å¨æ§è¡ä»»å¡ï¼å°ä»»å¡æ¾å°é»å¡éåworkqueueä¸­ç­å¾è¢«æ§è¡\n   * é»å¡éåæ»¡äºï¼ä½¿ç¨ææ¥çº¿ç¨æ¥æ§è¡ä»»å¡\n     * ææ¥çº¿ç¨ç¨å®ä»¥åï¼è¶è¿çå­æ¶é´ï¼keepalivetimeï¼åä¼è¢«éæ¾\n   * ä»»å¡æ»æ°å¤§äºäº æå¤§çº¿ç¨æ°ï¼maximumpoolsizeï¼ä¸é»å¡éåå®¹éçæå¤§å¼ï¼workqueue.capacityï¼ï¼ä½¿ç¨ææ¥ç­ç¥\n\n# æç»ç­ç¥\n\nå¦æçº¿ç¨å°è¾¾ maximumpoolsize ä»ç¶ææ°ä»»å¡è¿æ¶ä¼æ§è¡æç»ç­ç¥ãæç»ç­ç¥ jdk æä¾äº 4 ç§å®ç°\n\n\n\n * abortpolicyï¼è®©è°ç¨èæåº rejectedexecutionexception å¼å¸¸ï¼è¿æ¯é»è®¤ç­ç¥\n * callerrunspolicyï¼è®©è°ç¨èè¿è¡ä»»å¡\n * discardpolicyï¼æ¾å¼æ¬æ¬¡ä»»å¡\n * discardoldestpolicyï¼æ¾å¼éåä¸­ææ©çä»»å¡ï¼æ¬ä»»å¡åèä»£ä¹\n\n# ä½¿ç¨\n\npublic class demo1 {\n   static atomicinteger threadid = new atomicinteger(0);\n\n   public static void main(string[] args) {\n      // æå¨åå»ºçº¿ç¨æ± \n      // åå»ºæçé»å¡éå\n      arrayblockingqueue<runnable> runnable = new arrayblockingqueue<runnable>(10);\n      // åå»ºçº¿ç¨å·¥å\n      threadfactory threadfactory = new threadfactory() {\n         @override\n         public thread newthread(runnable r) {\n            thread thread = new thread(r, "working_thread_"+threadid.getandincrement());\n            return thread;\n         }\n      };\n\n      // æå¨åå»ºçº¿ç¨æ± \n      // æç»ç­ç¥éç¨é»è®¤ç­ç¥\n      threadpoolexecutor executor = new threadpoolexecutor(5, 7, 10, timeunit.seconds, runnable, threadfactory);\n\n      for (int i = 0; i < 20; i++) {\n         executor.execute(new runnable() {\n            @override\n            public void run() {\n               system.out.println(thread.currentthread());\n               try {\n                  thread.sleep(100000);\n               } catch (interruptedexception e) {\n                  e.printstacktrace();\n               }\n            }\n         });\n      }\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\n\n# fixedthreadpool\n\npublic class testfixedthreadpool {\n   public static void main(string[] args) {\n      // èªå®ä¹çº¿ç¨å·¥å\n      threadfactory factory = new threadfactory() {\n         atomicinteger atomicinteger = new atomicinteger(1);\n\n         @override\n         public thread newthread(runnable r) {\n            return new thread(r, "mythread_" + atomicinteger.getandincrement());\n         }\n      };\n\n      // åå»ºæ ¸å¿çº¿ç¨æ°éä¸º2ççº¿ç¨æ± \n      // éè¿ threadfactoryå¯ä»¥ç»çº¿ç¨æ·»å åå­\n\n      executorservice executorservice = executors.newfixedthreadpool(2, factory);\n\n      // ä»»å¡\n      runnable runnable = new runnable() {\n         @override\n         public void run() {\n            system.out.println(thread.currentthread().getname());\n            system.out.println("this is fixedthreadpool");\n         }\n      };\n      \n      executorservice.execute(runnable);\n   }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n\n\nåºå®å¤§å°ççº¿ç¨æ± å¯ä»¥ä¼ å¥ä¸¤ä¸ªåæ°\n\n * æ ¸å¿çº¿ç¨æ°ï¼nthreads\n * çº¿ç¨å·¥åï¼threadfactory\n\nåé¨è°ç¨çæé æ¹æ³\n\nthreadpoolexecutor(nthreads, nthreads,\n                              0l, timeunit.milliseconds,\n                              new linkedblockingqueue<runnable>(),\n                              threadfactory);\n\n\n1\n2\n3\n4\n\n\n\n# cachedthreadpool\n\nexecutorservice executorservice = executors.newcachedthreadpool();\n\n\n1\n\n\nåé¨æé æ¹æ³\n\nthreadpoolexecutor(0, integer.max_value,\n                              60l, timeunit.seconds,\n                              new synchronousqueue<runnable>());\n\n\n1\n2\n3\n\n\n * æ²¡ææ ¸å¿çº¿ç¨ï¼æå¤§çº¿ç¨æ°ä¸ºinteger.max_valueï¼ææåå»ºççº¿ç¨é½æ¯ææ¥çº¿ç¨ï¼ç©ºé²æ¶çå­æ¶é´ä¸º60ç§\n\n * é»å¡éåä½¿ç¨çæ¯synchronousqueue\n   \n   * synchronousqueue\n     \n     æ¯ä¸ç§ç¹æ®çéå\n     \n     * æ²¡æå®¹éï¼æ²¡æçº¿ç¨æ¥åæ¯æ¾ä¸è¿å»ç\n     * åªæå½çº¿ç¨åä»»å¡æ¶ï¼æä¼å°ä»»å¡æ¾å¥è¯¥é»å¡éåä¸­\n\n\n# singlethread\n\nexecutorservice service = executors.newsinglethreadexecutor();\n\n\n1\n\n\nåé¨æé æ¹æ³\n\nnew finalizabledelegatedexecutorservice\n    (new threadpoolexecutor(1, 1,\n                            0l, timeunit.milliseconds,\n                            new linkedblockingqueue<runnable>()));\n\n\n1\n2\n3\n4\n\n\nåé¨è°ç¨äºnew threadpoolexecutorçæé æ¹æ³ï¼ä¼ å¥çcorepoolsizeåmaximumpoolsizeé½ä¸º1ãç¶åå°è¯¥å¯¹è±¡ä¼ ç»äºfinalizabledelegatedexecutorserviceãè¯¥ç±»ä¿®é¥°äºthreadpoolexecutorï¼è®©å¤é¨æ æ³è°ç¨threadpoolexecutoråé¨çæäºæ¹æ³æ¥ä¿®æ¹æåå»ºççº¿ç¨æ± çå¤§å°ã\n\n# å ä¸ªæ³¨æ\n\n * singlethreadåèªå·±åå»ºä¸ä¸ªçº¿ç¨æ¥è¿è¡å¤ä¸ªä»»å¡çåºå«\n   \n   * å½çº¿ç¨æ­£å¨æ§è¡çä»»å¡åçéè¯¯æ¶ï¼å¦ææ¯èªå·±åå»ºççº¿ç¨ï¼è¯¥ä»»å¡åå©ä½çä»»å¡å°±æ æ³åç»§ç»­è¿è¡ä¸å»ãèsinglethreadä¼åå»ºä¸ä¸ªæ°çº¿ç¨ï¼ç»§ç»­æ§è¡ä»»å¡éåä¸­å©ä½çä»»å¡ã\n\n * singlethreadånewfixedthreadpool(1)çåºå«\n   \n   * newfixedthreadpool(1)ä¼ å¼ä¸º1ï¼å¯ä»¥å°fixedthreadpoolå¼ºè½¬ä¸ºthreadpoolexecutorï¼ç¶åéè¿setcorepoolsizeæ¹åæ ¸å¿çº¿ç¨æ°\n   \n   // å¼ºè½¬ä¸ºthreadpoolexecutor\n   threadpoolexecutor threadpool = (threadpoolexecutor) executors.newfixedthreadpool(1);\n   // æ¹åæ ¸å¿çº¿ç¨æ°\n   threadpool.setcorepoolsize(2);\n   \n   \n   1\n   2\n   3\n   4\n   \n   * èsinglethreadæ æ³ä¿®æ¹æ ¸å¿çº¿ç¨æ°\n\n\n# æ§è¡ä»»å¡\n\n# execute()æ¹æ³\n\nexecute(runnable command)\n\n\n1\n\n\nä¼ å¥ä¸ä¸ªrunnableå¯¹è±¡ï¼æ§è¡å¶ä¸­çrunæ¹æ³\n\næºç è§£æ\n\npublic void execute(runnable command) {\n    if (command == null)\n        throw new nullpointerexception();\n\n    // è·åctl\n    int c = ctl.get();\n    \n    // å¤æ­å½åå¯ç¨ççº¿ç¨æ°æ¯å¦å°äºæ ¸å¿çº¿ç¨æ°\n    if (workercountof(c) < corepoolsize) {\n        // ä¸ºè¯¥ä»»å¡åéçº¿ç¨\n        if (addworker(command, true))\n            // åéæåå°±è¿å\n            return;\n        \n        // åéå¤±è´¥åæ¬¡è·åctl\n        c = ctl.get();\n    }\n    \n    // åéåä¿¡æ¯çº¿ç¨å¤±è´¥ä»¥å\n    // å¦ææ± ç¶æä¸ºrunningå¹¶ä¸æå¥å°ä»»å¡éåæå\n    if (isrunning(c) && workqueue.offer(command)) {\n        \n        // åéæ£æµï¼å¯è½å¨æ·»å åçº¿ç¨æ± ç¶æåä¸ºäºérunning\n        int recheck = ctl.get();\n        \n        // å¦ææ± ç¶æä¸ºérunningï¼åä¸ä¼æ§è¡æ°æ¥çä»»å¡\n        // å°è¯¥ä»»å¡ä»é»å¡éåä¸­ç§»é¤\n        if (! isrunning(recheck) && remove(command))\n            // è°ç¨æç»ç­ç¥ï¼æç»è¯¥ä»»å¡çæ§è¡\n            reject(command);\n        \n        // å¦ææ²¡ææ­£å¨è¿è¡ççº¿ç¨\n        else if (workercountof(recheck) == 0)\n            // å°±åå»ºæ°çº¿ç¨æ¥æ§è¡è¯¥ä»»å¡\n            addworker(null, false);\n    }\n    \n    // å¦ææ·»å å¤±è´¥äºï¼ä»»å¡éåå·²æ»¡ï¼ï¼å°±è°ç¨æç»ç­ç¥\n    else if (!addworker(command, false))\n        reject(command);\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n\n\nå¶ä¸­è°ç¨äº**addwoker()**æ¹æ³ï¼åçççè¿ä¸ªæ¹æ³\n\nprivate boolean addworker(runnable firsttask, boolean core) {\n    retry:\n    for (;;) {\n        int c = ctl.get();\n        int rs = runstateof(c);\n\n        // check if queue empty only if necessary.\n        // å¦ææ± ç¶æä¸ºérunningç¶æãçº¿ç¨æ± ä¸ºshutdownä¸è¯¥ä»»å¡ä¸ºç©º æèé»å¡éåä¸­å·²ç»æä»»å¡\n        if (rs >= shutdown &&\n            ! (rs == shutdown &&\n               firsttask == null &&\n               ! workqueue.isempty()))\n            // åå»ºæ°çº¿ç¨å¤±è´¥\n            return false;\n\n        for (;;) {\n            // è·å¾å½åå·¥ä½çº¿ç¨æ°\n            int wc = workercountof(c);\n\n            // åæ°ä¸­ core ä¸ºtrue\n            // capacity ä¸º 1 << count_bits-1ï¼ä¸è¬ä¸ä¼è¶è¿\n            // å¦æå·¥ä½çº¿ç¨æ°å¤§äºäºæ ¸å¿çº¿ç¨æ°ï¼ååå»ºå¤±è´¥\n            if (wc >= capacity ||\n                wc >= (core ? corepoolsize : maximumpoolsize))\n                return false;\n            // éè¿casæä½æ¹åcçå¼\n            if (compareandincrementworkercount(c))\n                // æ´æ¹æåå°±è·³åºå¤éå¾ªç¯ï¼ä¸ä¸åè¿è¡å¾ªç¯\n                break retry;\n            // æ´æ¹å¤±è´¥ï¼éæ°è·åctlçå¼\n            c = ctl.get();  // re-read ctl\n            if (runstateof(c) != rs)\n                // è·³åºå¤éå¾ªç¯ï¼ä¸éæ°è¿å¥å¾ªç¯\n                continue retry;\n            // else cas failed due to workercount change; retry inner loop\n        }\n    }\n\n    // ç¨äºæ è®°workä¸­çä»»å¡æ¯å¦æåæ§è¡\n    boolean workerstarted = false;\n    // ç¨äºæ è®°workeræ¯å¦æåå å¥äºçº¿ç¨æ± ä¸­\n    boolean workeradded = false;\n    worker w = null;\n    try {\n        // åå»ºæ°çº¿ç¨æ¥æ§è¡ä»»å¡\n        w = new worker(firsttask);\n        final thread t = w.thread;\n        if (t != null) {\n            final reentrantlock mainlock = this.mainlock;\n            // å é\n            mainlock.lock();\n            try {\n                // recheck while holding lock.\n                // back out on threadfactory failure or if\n                // shut down before lock acquired.\n                // å éçåæ¶åæ¬¡æ£æµ\n                // é¿åå¨éæ¾éä¹åè°ç¨äºshut down\n                int rs = runstateof(ctl.get());\n\n                if (rs < shutdown ||\n                    (rs == shutdown && firsttask == null)) {\n                    if (t.isalive()) // precheck that t is startable\n                        throw new illegalthreadstateexception();\n                    // å°çº¿ç¨æ·»å å°çº¿ç¨æ± ä¸­\n                    workers.add(w);\n                    int s = workers.size();\n                    if (s > largestpoolsize)\n                        largestpoolsize = s;\n                    // æ·»å æåæ å¿ä½åä¸ºtrue\n                    workeradded = true;\n                }\n            } finally {\n                mainlock.unlock();\n            }\n            // å¦æworkeræåå å¥äºçº¿ç¨æ± ï¼å°±æ§è¡å¶ä¸­çä»»å¡\n            if (workeradded) {\n                t.start();\n                // å¯å¨æå\n                workerstarted = true;\n            }\n        }\n    } finally {\n        // å¦ææ§è¡å¤±è´¥\n        if (! workerstarted)\n            // è°ç¨æ·»å å¤±è´¥çå½æ°\n            addworkerfailed(w);\n    }\n    return workerstarted;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n\n\n# submit()æ¹æ³\n\nfuture<t> submit(callable<t> task)\n\n\n1\n\n\nä¼ å¥ä¸ä¸ªcallableå¯¹è±¡ï¼ç¨futureæ¥æè·è¿åå¼\n\nä½¿ç¨\n\n// éè¿submitæ§è¡callableä¸­çcallæ¹æ³\n// éè¿futureæ¥æè·è¿åå¼\nfuture<string> future = threadpool.submit(new callable<string>() {\n   @override\n   public string call() throws exception {\n      return "hello submit";\n   }\n});\n\n// æ¥çæè·çè¿åå¼\nsystem.out.println(future.get());\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n# åæ­¢\n\n# shutdown()\n\n/**\n* å°çº¿ç¨æ± çç¶ææ¹ä¸º shutdown\n* ä¸åæ¥åæ°ä»»å¡ï¼ä½æ¯ä¼å°é»å¡éåä¸­çä»»å¡æ§è¡å®\n*/\npublic void shutdown() {\n    final reentrantlock mainlock = this.mainlock;\n    mainlock.lock();\n    try {\n        checkshutdownaccess();\n        \n        // ä¿®æ¹çº¿ç¨æ± ç¶æä¸º shutdown\n        advancerunstate(shutdown);\n        \n  \t\t// ä¸­æ­ç©ºé²çº¿ç¨ï¼æ²¡ææ§è¡ä»»å¡ççº¿ç¨ï¼\n        // idleï¼ç©ºé²ç\n        interruptidleworkers();\n        onshutdown(); // hook for scheduledthreadpoolexecutor\n    } finally {\n        mainlock.unlock();\n    }\n    // å°è¯ç»ç»ï¼ä¸ä¸å®æå\n    // \n    tryterminate();\n}\nfinal void tryterminate() {\n    for (;;) {\n        int c = ctl.get();\n        // ç»ç»å¤±è´¥çæ¡ä»¶\n        // çº¿ç¨æ± ç¶æä¸ºrunning\n        // çº¿ç¨æ± ç¶æä¸º running shutdown stop ï¼ç¶æå¼å¤§äºtidyingï¼\n        // çº¿ç¨æ± ç¶æä¸ºshutdownï¼ä½é»å¡éåä¸­è¿æä»»å¡ç­å¾æ§è¡\n        if (isrunning(c) ||\n            runstateatleast(c, tidying) ||\n            (runstateof(c) == shutdown && ! workqueue.isempty()))\n            return;\n        \n        // å¦ææ´»è·çº¿ç¨æ°ä¸ä¸º0\n        if (workercountof(c) != 0) { // eligible to terminate\n            // ä¸­æ­ç©ºé²çº¿ç¨\n            interruptidleworkers(only_one);\n            return;\n        }\n\n        final reentrantlock mainlock = this.mainlock;\n        mainlock.lock();\n        try {\n            // å¤äºå¯ä»¥ç»ç»çç¶æ\n            // éè¿caså°çº¿ç¨æ± ç¶ææ¹ä¸ºtidying\n            if (ctl.compareandset(c, ctlof(tidying, 0))) {\n                try {\n                    terminated();\n                } finally {\n                    // éè¿caså°çº¿ç¨æ± ç¶ææ¹ä¸ºterminated\n                    ctl.set(ctlof(terminated, 0));\n                    termination.signalall();\n                }\n                return;\n            }\n        } finally {\n            mainlock.unlock();\n        }\n        // else retry on failed cas\n    }\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n\n\n# shutdownnow()\n\n/**\n* å°çº¿ç¨æ± çç¶ææ¹ä¸º stop\n* ä¸åæ¥åæ°ä»»å¡ï¼ä¹ä¸ä¼å¨æ§è¡é»å¡éåä¸­çä»»å¡\n* ä¼å°é»å¡éåä¸­æªæ§è¡çä»»å¡è¿åç»è°ç¨è\n*/\npublic list<runnable> shutdownnow() {\n    list<runnable> tasks;\n    final reentrantlock mainlock = this.mainlock;\n    mainlock.lock();\n    try {\n        checkshutdownaccess();\n        \n        // ä¿®æ¹ç¶æä¸ºstopï¼ä¸æ§è¡ä»»ä½ä»»å¡\n        advancerunstate(stop);\n        \n        // ä¸­æ­ææçº¿ç¨\n        interruptworkers();\n        \n        // å°æªæ§è¡çä»»å¡ä»éåä¸­ç§»é¤ï¼ç¶åè¿åç»è°ç¨è\n        tasks = drainqueue();\n    } finally {\n        mainlock.unlock();\n    }\n    // å°è¯ç»ç»ï¼ä¸å®ä¼æåï¼å ä¸ºé»å¡éåä¸ºç©ºäº\n    tryterminate();\n    return tasks;\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n',charsets:{cjk:!0},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"Javaéå",frontmatter:{title:"Javaéå",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/3dacb0/"},regularPath:"/01.Java/Java%E9%9B%86%E5%90%88.html",relativePath:"01.Java/Javaéå.md",key:"v-c2331f12",path:"/pages/3dacb0/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"NIO",frontmatter:{title:"NIO",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/b825b8/"},regularPath:"/01.Java/NIO.html",relativePath:"01.Java/NIO.md",key:"v-255c09a1",path:"/pages/b825b8/",headers:[{level:2,title:"ä¸ãç®ä»",slug:"ä¸ãç®ä»",normalizedTitle:"ä¸ãç®ä»",charIndex:15},{level:2,title:"äºãIOä¸NIOçåºå«",slug:"äºãioä¸nioçåºå«",normalizedTitle:"äºãioä¸nioçåºå«",charIndex:164},{level:3,title:"1ãé¢åæµåç¼å²åº",slug:"_1ãé¢åæµåç¼å²åº",normalizedTitle:"1ãé¢åæµåç¼å²åº",charIndex:337},{level:2,title:"ä¸ãééä¸ç¼å²åº",slug:"ä¸ãééä¸ç¼å²åº",normalizedTitle:"ä¸ãééä¸ç¼å²åº",charIndex:538},{level:2,title:"åãç¼å²åº(Buffer)",slug:"åãç¼å²åº-buffer",normalizedTitle:"åãç¼å²åº(buffer)",charIndex:700},{level:3,title:"1ãç¼å²åºç±»å",slug:"_1ãç¼å²åºç±»å",normalizedTitle:"1ãç¼å²åºç±»å",charIndex:718},{level:3,title:"2ãè·åç¼å²åº",slug:"_2ãè·åç¼å²åº",normalizedTitle:"2ãè·åç¼å²åº",charIndex:1114},{level:3,title:"3ãæ ¸å¿å±æ§",slug:"_3ãæ ¸å¿å±æ§",normalizedTitle:"3ãæ ¸å¿å±æ§",charIndex:1259},{level:3,title:"4ãæ ¸å¿æ¹æ³",slug:"_4ãæ ¸å¿æ¹æ³",normalizedTitle:"4ãæ ¸å¿æ¹æ³",charIndex:1719},{level:3,title:"5ãéç´æ¥ç¼å²åºåç´æ¥ç¼å²åº",slug:"_5ãéç´æ¥ç¼å²åºåç´æ¥ç¼å²åº",normalizedTitle:"5ãéç´æ¥ç¼å²åºåç´æ¥ç¼å²åº",charIndex:4784},{level:2,title:"äºãéé(Channel)",slug:"äºãéé-channel",normalizedTitle:"äºãéé(channel)",charIndex:5848},{level:3,title:"1ãç®ä»",slug:"_1ãç®ä»",normalizedTitle:"1ãç®ä»",charIndex:5866},{level:3,title:"2ãå¾è§£",slug:"_2ãå¾è§£",normalizedTitle:"2ãå¾è§£",charIndex:5993},{level:3,title:"3ãJava Channel",slug:"_3ãjava-channel",normalizedTitle:"3ãjava channel",charIndex:6373},{level:3,title:"4ãåæ£åèé",slug:"_4ãåæ£åèé",normalizedTitle:"4ãåæ£åèé",charIndex:11922},{level:2,title:"å­ãéé»å¡å¼ç½ç»éä¿¡",slug:"å­ãéé»å¡å¼ç½ç»éä¿¡",normalizedTitle:"å­ãéé»å¡å¼ç½ç»éä¿¡",charIndex:12978},{level:3,title:"1ãæ¦å¿µ",slug:"_1ãæ¦å¿µ",normalizedTitle:"1ãæ¦å¿µ",charIndex:12993},{level:3,title:"2ãä½¿ç¨",slug:"_2ãä½¿ç¨",normalizedTitle:"2ãä½¿ç¨",charIndex:13646}],headersStr:"ä¸ãç®ä» äºãIOä¸NIOçåºå« 1ãé¢åæµåç¼å²åº ä¸ãééä¸ç¼å²åº åãç¼å²åº(Buffer) 1ãç¼å²åºç±»å 2ãè·åç¼å²åº 3ãæ ¸å¿å±æ§ 4ãæ ¸å¿æ¹æ³ 5ãéç´æ¥ç¼å²åºåç´æ¥ç¼å²åº äºãéé(Channel) 1ãç®ä» 2ãå¾è§£ 3ãJava Channel 4ãåæ£åèé å­ãéé»å¡å¼ç½ç»éä¿¡ 1ãæ¦å¿µ 2ãä½¿ç¨",content:'# Java NIO\n\n\n# ä¸ãç®ä»\n\nJava NIOï¼New IOï¼æ¯ä»Java 1.4çæ¬å¼å§å¼å¥çä¸ä¸ªæ°çIO APIï¼å¯ä»¥æ¿ä»£æ åçJava IO APIãNIOä¸åæ¥çIOæåæ ·çä½ç¨åç®çï¼ä½æ¯ä½¿ç¨çæ¹å¼å®å¨ä¸åï¼NIOæ¯æé¢åç¼å²åºçãåºäºééçIOæä½ãNIOå°ä»¥æ´å é«æçæ¹å¼è¿è¡æä»¶çè¯»åæä½ã\n\n\n# äºãIOä¸NIOçåºå«\n\nIO                     NIO\né¢åæµ(Stream Oriented)   é¢åç¼å²åº(Buffer Oriented)\né»å¡IO(Blocking IO)      éé»å¡IO(NonBlocking IO)\n                       éæ©å¨(Selectors)\n\n\n# 1ãé¢åæµåç¼å²åº\n\nIO\n\nä¼ ç»IOå¨ä¼ è¾æ°æ®æ¶ï¼æ ¹æ®è¾å¥è¾åºçä¸åéè¦åå«å»ºç«ä¸åçé¾æ¥ï¼èä¸ä¼ è¾çæ°æ®æ¯ä»¥æµçå½¢å¼å¨é¾æ¥ä¸è¿è¡ä¼ è¾ç\n\nå°±åèªæ¥æ°´è¦éè¿æ°´ç®¡å°èªæ¥æ°´ååå®¶è¿æ¥èµ·æ¥ä¸æ ·\n\n\n\nNIO\n\nNIOå¨ä¼ è¾æ°æ®æ¶ï¼ä¼å¨è¾å¥è¾åºç«¯ä¹é´å»ºç«ééï¼ç¶åå°æ°æ®æ¾å¥å°ç¼å²åºä¸­ãç¼å²åºéè¿ééæ¥ä¼ è¾æ°æ®\n\nè¿éééå°±åæ¯éè·¯ï¼è½å¤è¿éä¸¤ä¸ªå°ç¹ãç¼å²åºå°±åæ¯ç«è½¦ï¼è½å¤çæ­£å°è¿è¡æ°æ®çä¼ è¾\n\n\n\n\n# ä¸ãééä¸ç¼å²åº\n\nJava NIOç³»ç»çæ ¸å¿å¨äºï¼éé(Channel)åç¼å²åº(Buffer)ãééè¡¨ç¤ºæå¼å° IO è®¾å¤(ä¾å¦ï¼æä»¶ãå¥æ¥å­)çè¿æ¥ãè¥éè¦ä½¿ç¨ NIO ç³»ç»ï¼éè¦è·åç¨äºè¿æ¥ IO è®¾å¤çééä»¥åç¨äºå®¹çº³æ°æ®çç¼å²åºãç¶åæä½ç¼å²åºï¼å¯¹æ°æ®è¿è¡å¤ç\n\nç®èè¨ä¹ï¼ééè´è´£ä¼ è¾ï¼ç¼å²åºè´è´£å­å¨\n\n\n# åãç¼å²åº(Buffer)\n\n\n# 1ãç¼å²åºç±»å\n\nBuffer å°±åä¸ä¸ªæ°ç»ï¼å¯ä»¥ä¿å­å¤ä¸ªç¸åç±»åçæ°æ®ãæ ¹æ®æ°æ®ç±»åä¸å(boolean é¤å¤) ï¼æä»¥ä¸Buffer å¸¸ç¨å­ç±»\n\n * ByteBuffer\n * CharBuffer\n * ShortBuffer\n * IntBuffer\n * LongBuffer\n * FloatBuffer\n * DoubleBuffer\n\nåç§ç±»åçç¼å²åºä¸­ï¼é½æä¸ä¸ªå¯¹åºç±»åçæ°ç»ï¼å¦\n\nByteBuffer\n\nfinal byte[] hb;                  // Non-null only for heap buffersCopy\n\n\n1\n\n\nIntBuffer\n\nfinal int[] hb;                  // Non-null only for heap buffersCopy\n\n\n1\n\n\nä»ä»¬çç»§æ¿å³ç³»å¦ä¸\n\n\n\n\n# 2ãè·åç¼å²åº\n\néè¿allocateæ¹æ³å¯ä»¥è·åä¸ä¸ªå¯¹åºç¼å²åºçå¯¹è±¡ï¼å®æ¯ç¼å²åºç±»çä¸ä¸ªéææ¹æ³\n\nä¾\n\n// è·åä¸ä¸ªå®¹éå¤§å°ä¸º1024å­èçå­èç¼å²åº\nByteBuffer byteBuffer = ByteBuffer.allocate(1024);Copy\n\n\n1\n2\n\n\n\n# 3ãæ ¸å¿å±æ§\n\nç¼å²åºçç¶ç±»Bufferä¸­æå ä¸ªæ ¸å¿å±æ§ï¼å¦ä¸\n\n// Invariants: mark <= position <= limit <= capacity\nprivate int mark = -1;\nprivate int position = 0;\nprivate int limit;\nprivate int capacity;Copy\n\n\n1\n2\n3\n4\n5\n\n * capacityï¼ç¼å²åºçå®¹éãéè¿æé å½æ°èµäºï¼ä¸æ¦è®¾ç½®ï¼æ æ³æ´æ¹\n * limitï¼ç¼å²åºççéãä½äºlimit åçæ°æ®ä¸å¯è¯»åãç¼å²åºçéå¶ä¸è½ä¸ºè´ï¼å¹¶ä¸ä¸è½å¤§äºå¶å®¹é\n * positionï¼ä¸ä¸ä¸ªè¯»åä½ç½®çç´¢å¼ï¼ç±»ä¼¼PCï¼ãç¼å²åºçä½ç½®ä¸è½ä¸ºè´ï¼å¹¶ä¸ä¸è½å¤§äºlimit\n * markï¼è®°å½å½åpositionçå¼ãpositionè¢«æ¹ååï¼å¯ä»¥éè¿è°ç¨reset() æ¹æ³æ¢å¤å°markçä½ç½®ã\n\nä»¥ä¸åä¸ªå±æ§å¿é¡»æ»¡è¶³ä»¥ä¸è¦æ±\n\nmark <= position <= limit <= capacity\n\n\n# 4ãæ ¸å¿æ¹æ³\n\n# put()æ¹æ³\n\n * put()æ¹æ³å¯ä»¥å°ä¸ä¸ªæ°æ®æ¾å¥å°ç¼å²åºä¸­ã\n * è¿è¡è¯¥æä½åï¼postitionçå¼ä¼+1ï¼æåä¸ä¸ä¸ªå¯ä»¥æ¾å¥çä½ç½®ãcapacity = limit ï¼ä¸ºç¼å²åºå®¹éçå¼ã\n\n\n\n# flip()æ¹æ³\n\n * flip()æ¹æ³ä¼åæ¢å¯¹ç¼å²åºçæä½æ¨¡å¼ï¼ç±å->è¯» / è¯»->å\n * è¿è¡è¯¥æä½å\n   * å¦ææ¯åæ¨¡å¼->è¯»æ¨¡å¼ï¼position = 0 ï¼ limit æåæåä¸ä¸ªåç´ çä¸ä¸ä¸ªä½ç½®ï¼capacityä¸å\n   * å¦ææ¯è¯»->åï¼åæ¢å¤ä¸ºput()æ¹æ³ä¸­çå¼\n\n\n\n# get()æ¹æ³\n\n * get()æ¹æ³ä¼è¯»åç¼å²åºä¸­çä¸ä¸ªå¼\n * è¿è¡è¯¥æä½åï¼positionä¼+1ï¼å¦æè¶è¿äºlimitåä¼æåºå¼å¸¸\n\n\n\n# rewind()æ¹æ³\n\n * è¯¥æ¹æ³åªè½å¨è¯»æ¨¡å¼ä¸ä½¿ç¨\n * rewind()æ¹æ³åï¼ä¼æ¢å¤positionãlimitåcapacityçå¼ï¼åä¸ºè¿è¡get()åçå¼\n\n\n\n# clean()æ¹æ³\n\n * clean()æ¹æ³ä¼å°ç¼å²åºä¸­çåä¸ªå±æ§æ¢å¤ä¸ºæåçç¶æï¼position = 0, capacity = limit\n * æ­¤æ¶ç¼å²åºçæ°æ®ä¾ç¶å­å¨ï¼å¤äºâè¢«éå¿âç¶æï¼ä¸æ¬¡è¿è¡åæä½æ¶ä¼è¦çè¿äºæ°æ®\n\n\n\n# mark()åreset()æ¹æ³\n\n * mark()æ¹æ³ä¼å°postionçå¼ä¿å­å°markå±æ§ä¸­\n * reset()æ¹æ³ä¼å°positionçå¼æ¹ä¸ºmarkä¸­ä¿å­çå¼\n\n# ä½¿ç¨å±ç¤º\n\npublic class Demo1 {\n\tpublic static void main(String[] args) {\n\t\tByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n\n\t\tSystem.out.println("æ¾å¥ååæ°");\n\t\tSystem.out.println("position " + byteBuffer.position());\n\t\tSystem.out.println("limit " + byteBuffer.limit());\n\t\tSystem.out.println("capacity " + byteBuffer.capacity());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println("------put()------");\n\t\tSystem.out.println("æ¾å¥3ä¸ªæ°æ®");\n\t\tbyte bt = 1;\n\t\tbyteBuffer.put(bt);\n\t\tbyteBuffer.put(bt);\n\t\tbyteBuffer.put(bt);\n\n\t\tSystem.out.println("æ¾å¥ååæ°");\n\t\tSystem.out.println("position " + byteBuffer.position());\n\t\tSystem.out.println("limit " + byteBuffer.limit());\n\t\tSystem.out.println("capacity " + byteBuffer.capacity());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println("------flip()-get()------");\n\t\tSystem.out.println("è¯»åä¸ä¸ªæ°æ®");\n\t\t// åæ¢æ¨¡å¼\n\t\tbyteBuffer.flip();\n\t\tbyteBuffer.get();\n\n\t\tSystem.out.println("è¯»åååæ°");\n\t\tSystem.out.println("position " + byteBuffer.position());\n\t\tSystem.out.println("limit " + byteBuffer.limit());\n\t\tSystem.out.println("capacity " + byteBuffer.capacity());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println("------rewind()------");\n\t\tbyteBuffer.rewind();\n\t\tSystem.out.println("æ¢å¤ååæ°");\n\t\tSystem.out.println("position " + byteBuffer.position());\n\t\tSystem.out.println("limit " + byteBuffer.limit());\n\t\tSystem.out.println("capacity " + byteBuffer.capacity());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println("------clear()------");\n\t\t// æ¸ç©ºç¼å²åºï¼è¿éåªæ¯æ¢å¤äºåä¸ªå±æ§çå¼ï¼ä½æ¯ç¼å²åºéçæ°æ®ä¾ç¶å­å¨\n\t\t// ä½æ¯ä¸æ¬¡åå¥çæ¶åä¼è¦çç¼å²åºä¸­ä¹åçæ°æ®\n\t\tbyteBuffer.clear();\n\t\tSystem.out.println("æ¸ç©ºååæ°");\n\t\tSystem.out.println("position " + byteBuffer.position());\n\t\tSystem.out.println("limit " + byteBuffer.limit());\n\t\tSystem.out.println("capacity " + byteBuffer.capacity());\n\t\tSystem.out.println();\n\t\tSystem.out.println("æ¸ç©ºåè·å¾æ°æ®");\n\t\tSystem.out.println(byteBuffer.get());\n\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n\n\næå°ç»æ\n\næ¾å¥ååæ°\nposition 0\nlimit 1024\ncapacity 1024\n\n------put()------\næ¾å¥3ä¸ªæ°æ®\næ¾å¥ååæ°\nposition 3\nlimit 1024\ncapacity 1024\n\n------flip()-get()------\nè¯»åä¸ä¸ªæ°æ®\nè¯»åååæ°\nposition 1\nlimit 3\ncapacity 1024\n\n------rewind()------\næ¢å¤ååæ°\nposition 0\nlimit 3\ncapacity 1024\n\n------clear()------\næ¸ç©ºååæ°\nposition 0\nlimit 1024\ncapacity 1024\n\næ¸ç©ºåè·å¾æ°æ®\n1Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n\n# 5ãéç´æ¥ç¼å²åºåç´æ¥ç¼å²åº\n\n# éç´æ¥ç¼å²åº\n\néè¿allocate()æ¹æ³è·åçç¼å²åºé½æ¯éç´æ¥ç¼å²åºãè¿äºç¼å²åºæ¯å»ºç«å¨JVMå åå­ä¹ä¸­çã\n\npublic static ByteBuffer allocate(int capacity) {\n    if (capacity < 0)\n    throw new IllegalArgumentException();\n\n    // å¨å åå­ä¸­å¼è¾ç©ºé´\n    return new HeapByteBuffer(capacity, capacity);\n}\n\nHeapByteBuffer(int cap, int lim) {        // package-private\n    // new byte[cap] åå»ºæ°ç»ï¼å¨å åå­ä¸­å¼è¾ç©ºé´\n    super(-1, 0, lim, cap, new byte[cap], 0);\n    /*\n    hb = new byte[cap];\n    offset = 0;\n    */\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n\néè¿éç´æ¥ç¼å²åºï¼æ³è¦å°æ°æ®åå¥å°ç©çç£çä¸­ï¼æèæ¯ä»ç©çç£çè¯»åæ°æ®ãé½éè¦ç»è¿JVMåæä½ç³»ç»ï¼æ°æ®å¨ä¸¤ä¸ªå°åç©ºé´ä¸­ä¼ è¾æ¶ï¼ä¼****ä¸ä»½ä¿å­å¨å¯¹æ¹çç©ºé´ä¸­ãæä»¥è´¹ç´æ¥ç¼å²åºçè¯»åæçè¾ä½\n\n# ç´æ¥ç¼å²åº\n\nåªæByteBufferå¯ä»¥è·å¾ç´æ¥ç¼å²åºï¼éè¿allocateDirect()è·åçç¼å²åºä¸ºç´æ¥ç¼å²åºï¼è¿äºç¼å²åºæ¯å»ºç«å¨ç©çåå­ä¹ä¸­çã\n\npublic static ByteBuffer allocateDirect(int capacity) {\n    return new DirectByteBuffer(capacity);\n}\n\nDirectByteBuffer(int cap) {                   // package-private\n\t...\n    // ç³è¯·ç©çåå­\n\tboolean pa = VM.isDirectMemoryPageAligned();\n\t...\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\nç´æ¥ç¼å²åºéè¿å¨æä½ç³»ç»åJVMä¹é´åå»ºç©çåå­æ å°æä»¶å å¿«ç¼å²åºæ°æ®è¯»/åå¥ç©çç£ççéåº¦ãæ¾å°ç©çåå­æ å°æä»¶ä¸­çæ°æ®å°±ä¸å½åºç¨ç¨åºæ§å¶äºï¼æä½ç³»ç»ä¼èªå¨å°ç©çåå­æ å°æä»¶ä¸­çæ°æ®åå¥å°ç©çåå­ä¸­\n\n\n# äºãéé(Channel)\n\n\n# 1ãç®ä»\n\nChannelç±java.nio.channels åå®ä¹çãChannel è¡¨ç¤ºIO æºä¸ç®æ æå¼çè¿æ¥ãChannel ç±»ä¼¼äºä¼ ç»çâæµâãåªä¸è¿Channel æ¬èº«ä¸è½ç´æ¥è®¿é®æ°æ®ï¼Channel åªè½ä¸Buffer è¿è¡äº¤äº\n\n\n# 2ãå¾è§£\n\nåºç¨ç¨åºè¿è¡è¯»åæä½è°ç¨å½æ°æ¶ï¼åºå±è°ç¨çæä½ç³»ç»æä¾ç»ç¨æ·çè¯»åAPIï¼è°ç¨è¿äºAPIæ¶ä¼çæå¯¹åºçæä»¤ï¼CPUåä¼æ§è¡è¿äºæä»¤ãå¨è®¡ç®æºååºç°çé£æ®µæ¶é´ï¼ææè¯»åè¯·æ±çæä»¤é½æCPUå»æ§è¡ï¼è¿å¤çè¯»åè¯·æ±ä¼å¯¼è´CPUæ æ³å»æ§è¡å¶ä»å½ä»¤ï¼ä»èCPUçå©ç¨çéä½\n\n\n\nåæ¥ï¼DMA(Direct Memory Accessï¼ç´æ¥å­å¨å¨è®¿é®)åºç°äºãå½IOè¯·æ±ä¼ å°è®¡ç®æºåºå±æ¶ï¼DMAä¼åCPUè¯·æ±ï¼è®©DMAå»å¤çè¿äºIOæä½ï¼ä»èå¯ä»¥è®©CPUå»æ§è¡å¶ä»æä»¤ãDMAå¤çIOæä½æ¶ï¼ä¼è¯·æ±è·åæ»çº¿çä½¿ç¨æãå½IOè¯·æ±è¿å¤æ¶ï¼ä¼å¯¼è´å¤§éæ»çº¿ç¨äºå¤çIOè¯·æ±ï¼ä»èéä½æç\n\n\n\näºæ¯ä¾¿æäºChannel(éé)ï¼Channelç¸å½äºä¸ä¸ªä¸é¨ç¨äºIOæä½çç¬ç«å¤çå¨ï¼å®å·æç¬ç«å¤çIOè¯·æ±çè½åï¼å½æIOè¯·æ±æ¶ï¼å®ä¼èªè¡å¤çè¿äºIOè¯·æ±\n\n\n\n\n# 3ãJava Channel\n\n# å¸¸ç¨å®ç°ç±»\n\n\n\n * æ¬å°æä»¶IO\n   * FileChannel\n * ç½ç»IO\n   * SocketChanelãServerSocketChannelï¼ç¨äºTCPä¼ è¾\n   * DatagramChannelï¼ç¨äºUDPä¼ è¾\n\n# è·å¾ééçæ¹æ³\n\nè·åééçä¸ç§æ¹å¼æ¯å¯¹æ¯æééçå¯¹è±¡è°ç¨getChannel() æ¹æ³ãæ¯æééçç±»å¦ä¸ï¼\n\n * FileInputStream\n * FileOutputStream\n * RandomAccessFile\n * DatagramSocket\n * Socket\n * ServerSocket\n\npublic class Demo2 {\n   public static void main(String[] args) throws IOException {\n      // æ¬å°éé\n      FileInputStream fileInputStream = new FileInputStream("");\n      FileChannel channel1 = fileInputStream.getChannel();\n\n      FileOutputStream fileOutputStream = new FileOutputStream("");\n      FileChannel channel2 = fileOutputStream.getChannel();\n   \n      // ç½ç»éé\n      Socket socket = new Socket();\n      SocketChannel channel3 = socket.getChannel();\n      \n      ServerSocket serverSocket = new ServerSocket();\n      ServerSocketChannel channel4 = serverSocket.getChannel();\n\n      DatagramSocket datagramSocket = new DatagramSocket();\n      DatagramChannel channel5 = datagramSocket.getChannel();\n       \n      // æåè¦å³é­éé\n       \n   }\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nä¹å¯ä»¥éè¿ééçéææ¹æ³open()æ¥è·å\n\npublic static void main(String[] args) throws IOException {\n   FileChannel open = FileChannel.open(Paths.get(""));\n   \n   SocketChannel open1 = SocketChannel.open();\n   \n   ...\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# getChannel()+éç´æ¥ç¼å²åº\n\n * getChannel()è·å¾éé\n * allocate()è·å¾éç´æ¥ç¼å²åº\n\néè¿éç´æ¥ç¼å²åºè¯»åæ°æ®ï¼éè¦éè¿ééæ¥ä¼ è¾ç¼å²åºéçæ°æ®\n\npublic class Demo4 {\n   public static void main(String[] args) {\n      FileInputStream is = null;\n      FileOutputStream os = null;\n      // è·å¾éé\n      FileChannel inChannel = null;\n      FileChannel outChannel = null;\n       \n      // å©ç¨ try-catch-finally ä¿è¯å³é­\n      try {\n         is = new FileInputStream("F:\\\\JDKLearning\\\\src\\\\main\\\\NIO\\\\day1\\\\1.jpg");\n         os = new FileOutputStream("F:\\\\JDKLearning\\\\src\\\\main\\\\NIO\\\\day1\\\\2.jpg");\n\n         // è·å¾éé\n         inChannel = is.getChannel();\n         outChannel = os.getChannel();\n\n         // è·å¾ç¼å²åºï¼ç¨äºå¨ééä¸­ä¼ è¾æ°æ®\n         ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n\n         // å¾ªç¯å°å­èæ°æ®æ¾å¥å°bufferä¸­ï¼ç¶ååå¥ç£çä¸­\n         while (inChannel.read(byteBuffer) != -1) {\n            // åæ¢æ¨¡å¼\n            byteBuffer.flip();\n            outChannel.write(byteBuffer);\n            byteBuffer.clear();\n         }\n      } catch (IOException e) {\n         e.printStackTrace();\n      } finally {\n         if (inChannel != null) {\n            try {\n               inChannel.close();\n            } catch (IOException e) {\n               e.printStackTrace();\n            }\n         }\n         if (outChannel != null) {\n            try {\n               outChannel.close();\n            } catch (IOException e) {\n               e.printStackTrace();\n            }\n         }\n         if (is != null) {\n            try {\n               is.close();\n            } catch (IOException e) {\n               e.printStackTrace();\n            }\n         }\n         if (os != null) {\n            try {\n               os.close();\n            } catch (IOException e) {\n               e.printStackTrace();\n            }\n         }\n      }\n   }\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n\n\nå¾çè¯»ååï¼è¢«åå¥å°äºæå®ä½ç½®\n\n# open()+ç´æ¥ç¼å²åº\n\n * éè¿openè·å¾éé\n * éè¿FileChannel.map()è·åç´æ¥ç¼å²åº\n\nä½¿ç¨ç´æ¥ç¼å²åºæ¶ï¼æ ééè¿ééæ¥ä¼ è¾æ°æ®ï¼ç´æ¥å°æ°æ®æ¾å¨ç¼å²åºåå³å¯\n\npublic class Demo5 {\n   public static void main(String[] args) throws IOException {\n      // éè¿open()æ¹æ³æ¥è·å¾éé\n      FileChannel inChannel = FileChannel.open(Paths.get("F:\\\\JDKLearning\\\\src\\\\main\\\\NIO\\\\day1\\\\1.jpg"), StandardOpenOption.READ);\n\n      // outChanneléè¦ä¸º READ WRITE CREATEæ¨¡å¼\n      // READ WRITEæ¯å ä¸ºåé¢è·åç´æ¥ç¼å²åºæ¶æ¨¡å¼ä¸ºREAD_WRITEæ¨¡å¼\n      // CREATEæ¯å ä¸ºè¦åå»ºæ°çæä»¶\n      FileChannel outChannel = FileChannel.open(Paths.get("F:\\\\JDKLearning\\\\src\\\\main\\\\NIO\\\\day1\\\\3.jpg"), StandardOpenOption.READ, StandardOpenOption.WRITE, StandardOpenOption.CREATE);\n\n      // è·å¾ç´æ¥ç¼å²åº\n      MappedByteBuffer inMapBuf = inChannel.map(FileChannel.MapMode.READ_ONLY, 0, inChannel.size());\n      MappedByteBuffer outMapBuf = outChannel.map(FileChannel.MapMode.READ_WRITE, 0, inChannel.size());\n\n      // å­èæ°ç»\n      byte[] bytes = new byte[inMapBuf.limit()];\n\n      // å ä¸ºæ¯ç´æ¥ç¼å²åºï¼å¯ä»¥ç´æ¥å°æ°æ®æ¾å¥å°åå­æ å°æä»¶ï¼æ ééè¿ééä¼ è¾\n      inMapBuf.get(bytes);\n      outMapBuf.put(bytes);\n\n      // å³é­ç¼å²åºï¼è¿éæ²¡æç¨try-catch-finally\n      inChannel.close();\n      outChannel.close();\n   }\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nè¿è¡ç»æï¼å¾çè¢«åå»º\n\n# ééé´ç´æ¥ä¼ è¾\n\npublic static void channelToChannel() throws IOException {\n   long start = System.currentTimeMillis();\n   // éè¿open()æ¹æ³æ¥è·å¾éé\n   FileChannel inChannel = FileChannel.open(Paths.get("F:\\\\JDKLearning\\\\src\\\\main\\\\NIO\\\\day1\\\\1.mp4"), StandardOpenOption.READ);\n\n   // outChanneléè¦ä¸º READ WRITE CREATEæ¨¡å¼\n   // READ WRITEæ¯å ä¸ºåé¢è·åç´æ¥ç¼å²åºæ¶æ¨¡å¼ä¸ºREAD_WRITEæ¨¡å¼\n   // CREATEæ¯å ä¸ºè¦åå»ºæ°çæä»¶\n   FileChannel outChannel = FileChannel.open(Paths.get("F:\\\\JDKLearning\\\\src\\\\main\\\\NIO\\\\day1\\\\4.mp4"), StandardOpenOption.READ, StandardOpenOption.WRITE, StandardOpenOption.CREATE);\n\n   // ééé´ç´æ¥ä¼ è¾\n   inChannel.transferTo(0, inChannel.size(), outChannel);\n   // å¯¹åºçè¿ætransferFrom\n   // outChannel.transferFrom(inChannel, 0, inChannel.size());\n\n   inChannel.close();\n   outChannel.close();\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n# ç´æ¥ç¼å²åºVSéç´æ¥ç¼å²åº\n\næç\n\nè¯»åä¸ä¸ªMP4æä»¶ï¼éè¿äºèè±è´¹æ¶é´çå¤å°æ¥å¤å®æ§è¡çéåº¦\n\n// getChannel() + éç´æ¥ç¼å²åºèæ¶\n708\n// open() + ç´æ¥ç¼å²åºèæ¶\n115\n// channel transferTo channelèæ¶\n47Copy\n\n\n1\n2\n3\n4\n5\n6\n\n\nåå­å ç¨\n\nç´æ¥ç¼å²åºçè¯»åéåº¦è½ç¶å¾å¿«ï¼ä½æ¯ä¼å ç¨å¾å¤å¾å¤åå­ç©ºé´ãå¦ææä»¶è¿å¤§ï¼ä¼ä½¿å¾è®¡ç®æºè¿è¡éåº¦åæ¢\n\n\n# 4ãåæ£åèé\n\n# åæ£è¯»å\n\nåæ£è¯»åï¼Scattering Readsï¼æ¯æä»Channel ä¸­è¯»åçæ°æ®âåæ£âå°å¤ä¸ªBuffer ä¸­\n\næ³¨æï¼æç§ç¼å²åºçé¡ºåºï¼ä»Channel ä¸­è¯»åçæ°æ®ä¾æ¬¡å° Buffer å¡«æ»¡\n\n\n\n# èéåå¥\n\nèéåå¥ï¼Gathering Writesï¼æ¯æå°å¤ä¸ªBuffer ä¸­çæ°æ®âèéâå°Channel\n\næç§ç¼å²åºçé¡ºåºï¼åå¥position ålimit ä¹é´çæ°æ®å°Channel\n\n\n\nä»£ç \n\npublic class Demo2 {\n   public static void main(String[] args) throws IOException {\n      FileInputStream is = new FileInputStream("F:\\\\JDKLearning\\\\src\\\\main\\\\nio\\\\day2\\\\è®¡å.txt");\n      FileOutputStream os = new FileOutputStream("F:\\\\JDKLearning\\\\src\\\\main\\\\nio\\\\day2\\\\è®¡å2.txt");\n\n      FileChannel inChannel = is.getChannel();\n      FileChannel outChannel = os.getChannel();\n\n      // è·å¾å¤ä¸ªç¼å²åºï¼å¹¶ä¸æ¾å¥å°ç¼å²åºæ°ç»ä¸­\n      ByteBuffer byteBuffer1 = ByteBuffer.allocate(50);\n      ByteBuffer byteBuffer2 = ByteBuffer.allocate(1024);\n      ByteBuffer[] byteBuffers = {byteBuffer1, byteBuffer2};\n\n      // åæ£è¯»å\n      inChannel.read(byteBuffers);\n      \n      byteBuffer1.flip();\n      byteBuffer2.flip();\n      \n      // èéåå¥\n      outChannel.write(byteBuffers);\n   }\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\n\n\n\n\n\n# å­ãéé»å¡å¼ç½ç»éä¿¡\n\n\n# 1ãæ¦å¿µ\n\n# ä¸¾ä¾\n\nå11ä¹°çå¿«éå°äºï¼å¿«éå°å¥ç»ä½ æçµè¯è¯´é©¬ä¸å°å°åºé¨å£ï¼éº»ç¦å¨é¨å£ç­ä¸ä¸ï¼æ¹ä¾¿ç­¾æ¶å¿«é\n\n * è¥ä¸ºé»å¡å¼çï¼ä½ å°äºå°åºé¨å£ä»¥åï¼å¿«éå°å¥è¿æ²¡å°çæé´ï¼ä½ ä»ä¹äºå¿ä¹åä¸äº\n * è¥ä¸ºéé»å¡å¼çï¼å¿«éå°å¥å°å¿«éæ¾å°é¨å«å¤ï¼é¨å«ç»ä½ åæ¶æ¯è¯´å¿«éå°äºï¼éº»ç¦å»åä¸ä¸ãå½å¿«éè¿æ²¡å°çæ¶åä½ å¯ä»¥åä½ èªå·±çäºå¿\n\n# é»å¡å¼ç½ç»éä¿¡\n\nä¼ ç»çIO æµé½æ¯é»å¡å¼çãä¹å°±æ¯è¯´ï¼å½ä¸ä¸ªçº¿ç¨è°ç¨read() æwrite() æ¶ï¼è¯¥çº¿ç¨è¢«é»å¡ï¼ç´å°æä¸äºæ°æ®è¢«è¯»åæåå¥ï¼è¯¥çº¿ç¨å¨æ­¤æé´ä¸è½æ§è¡å¶ä»ä»»å¡\n\nå æ­¤ï¼å¨å®æç½ç»éä¿¡è¿è¡IO æä½æ¶ï¼ç±äºçº¿ç¨ä¼é»å¡ï¼æä»¥æå¡å¨ç«¯å¿é¡»ä¸ºæ¯ä¸ªå®¢æ·ç«¯é½æä¾ä¸ä¸ªç¬ç«ççº¿ç¨è¿è¡å¤çï¼å½æå¡å¨ç«¯éè¦å¤çå¤§éå®¢æ·ç«¯æ¶ï¼æ§è½æ¥å§ä¸é\n\nä¹å°±æ¯è¯´ï¼æå¡å¨å¨ç­å¾IOåå¤å°±ç»ªçæé´ï¼çº¿ç¨å¤äºé»å¡ç¶æï¼è¥ä¸ºåçº¿ç¨ï¼ç­å¾æé´CPUæªæ§è¡ä»»ä½ä»»å¡ï¼æçéä½ãæä»¥éè¦å¼å¯å¤ä¸ªçº¿ç¨ï¼å½æäºçº¿ç¨å ä¸ºç­å¾IOåå¤å°±ç»ªæ¶ï¼CPUå¯ä»¥å»æ§è¡å¶ä»çº¿ç¨ä¸­çä»»å¡ãä½æ¯çº¿ç¨çåå»ºãåæ¢ä¸éæ¯çå¼éä¹æ¯ä¸å°çãå½å¤§éçä»»å¡å°æ¥æ¶ï¼æå¡å¨æ§è½ä¹æ¥å§ä¸éã\n\n\n\n# éé»å¡å¼ç½ç»éä¿¡\n\nJava NIO æ¯éé»å¡æ¨¡å¼çãå½çº¿ç¨ä»æééè¿è¡è¯»åæ°æ®æ¶ï¼è¥æ²¡ææ°æ®å¯ç¨æ¶ï¼è¯¥çº¿ç¨å¯ä»¥è¿è¡å¶ä»ä»»å¡ãçº¿ç¨éå¸¸å°éé»å¡IO çç©ºé²æ¶é´ç¨äºå¨å¶ä»ééä¸æ§è¡IO æä½ï¼æä»¥åç¬ççº¿ç¨å¯ä»¥ç®¡çå¤ä¸ªè¾å¥åè¾åºéé\n\nå æ­¤ï¼NIO å¯ä»¥è®©æå¡å¨ç«¯ä½¿ç¨ä¸ä¸ªææéå ä¸ªçº¿ç¨æ¥åæ¶å¤çè¿æ¥å°æå¡å¨ç«¯çææå®¢æ·ç«¯\n\n\n\n\n# 2ãä½¿ç¨\n\n# é»å¡å¼ç½ç»éä¿¡æ¼ç¤º\n\npublic class Demo1 {\n   public static void main(String[] args) throws IOException {\n      Thread thread1 = new Thread(()->{\n         try {\n            server();\n         } catch (IOException e) {\n            e.printStackTrace();\n         }\n      });\n\n      Thread thread2 = new Thread(()->{\n         try {\n            client();\n         } catch (IOException e) {\n            e.printStackTrace();\n         }\n      });\n\n      thread1.start();\n      thread2.start();\n   }\n\n   public static void client() throws IOException {\n      // åå»ºå®¢æ·ç«¯éé\n      SocketChannel socketChannel = SocketChannel.open(new InetSocketAddress("127.0.0.1", 2022));\n\n      // è¯»åä¿¡æ¯\n      FileChannel fileChannel = FileChannel.open(Paths.get("F:\\\\JDKLearning\\\\src\\\\main\\\\nio\\\\day3\\\\1.jpg"), StandardOpenOption.READ);\n\n      // åå»ºç¼å²åº\n      ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n\n      // åå¥æ°æ®\n      while (fileChannel.read(byteBuffer) != -1) {\n         byteBuffer.flip();\n         socketChannel.write(byteBuffer);\n         byteBuffer.clear();\n      }\n\n      fileChannel.close();\n      socketChannel.close();\n   }\n\n   public static void server() throws IOException {\n      // åå»ºæå¡ç«¯éé\n      ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n\n      FileChannel fileChannel = FileChannel.open(Paths.get("F:\\\\JDKLearning\\\\src\\\\main\\\\nio\\\\day3\\\\2.jpg"), StandardOpenOption.WRITE, StandardOpenOption.CREATE);\n\n      // ç»å®é¾æ¥\n      serverSocketChannel.bind(new InetSocketAddress(2022));\n\n      // è·åå®¢æ·ç«¯çéé\n      SocketChannel socketChannel = serverSocketChannel.accept();\n\n      // åå»ºç¼å²åº\n      ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n\n      while (socketChannel.read(byteBuffer) != -1) {\n         byteBuffer.flip();\n         fileChannel.write(byteBuffer);\n         byteBuffer.clear();\n      }\n\n      socketChannel.close();\n      fileChannel.close();\n      serverSocketChannel.close();\n   }\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n\n\n# éé»å¡å¼ç½ç»éä¿¡æ¼ç¤º\n\npublic class DemoNIO {\n\tpublic static void main(String[] args) {\n\t\tThread thread1 = new Thread(()->{\n\t\t\ttry {\n\t\t\t\tserver();\n\t\t\t} catch (IOException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t});\n\n\t\tThread thread2 = new Thread(()->{\n\t\t\ttry {\n\t\t\t\tclient();\n\t\t\t} catch (IOException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t});\n\t\tthread1.start();\n\t\tthread2.start();\n\t}\n\n\tpublic static void client() throws IOException {\n\t\tSocketChannel socketChannel = SocketChannel.open(new InetSocketAddress("127.0.0.1", 2020));\n\n\t\t// è®¾ç½®ä¸ºéé»å¡æ¨¡å¼\n\t\tsocketChannel.configureBlocking(false);\n\n\t\tByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (scanner.hasNext()) {\n\t\t\tString str = scanner.next();\n\t\t\tbyteBuffer.put(str.getBytes());\n\t\t\tbyteBuffer.flip();\n\t\t\tsocketChannel.write(byteBuffer);\n\t\t\tbyteBuffer.clear();\n\t\t}\n\n\t\tbyteBuffer.clear();\n\n\t\tsocketChannel.close();\n\t}\n\n\tpublic static void server() throws IOException {\n\t\tServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n\t\tserverSocketChannel.configureBlocking(false);\n\t\tserverSocketChannel.bind(new InetSocketAddress(2020));\n\n\t\t// è·å¾éæ©å¨\n\t\tSelector selector = Selector.open();\n\n\t\t// å°ééæ³¨åå°éæ©å¨ä¸­ï¼è®¾å®ä¸ºæ¥æ¶æä½\n\t\tserverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);\n\n\t\t// è½®è®­æ¥å\n\t\twhile (selector.select() > 0) {\n\t\t\tIterator<SelectionKey> iterator = selector.selectedKeys().iterator();\n\t\t\t// è·å¾äºä»¶çkey\n\t\t\twhile (iterator.hasNext()) {\n\t\t\t\tSelectionKey key = iterator.next();\n\t\t\t\tif (key.isAcceptable()) {\n\t\t\t\t\tSocketChannel socketChannel = serverSocketChannel.accept();\n\t\t\t\t\tsocketChannel.configureBlocking(false);\n\t\t\t\t\tsocketChannel.register(selector, SelectionKey.OP_READ);\n\t\t\t\t} else if (key.isReadable()) {\n\t\t\t\t\t// ä»éæ©å¨ä¸­è·åéé\n\t\t\t\t\tSocketChannel socketChannel = (SocketChannel) key.channel();\n\n\t\t\t\t\tByteBuffer byteBuffer = ByteBuffer.allocate(10);\n\n\t\t\t\t\twhile (socketChannel.read(byteBuffer) != -1) {\n\t\t\t\t\t\tint len = byteBuffer.limit();\n\t\t\t\t\t\tbyteBuffer.flip();\n\t\t\t\t\t\tSystem.out.println(new String(byteBuffer.array(), 0, len));\n\t\t\t\t\t\tbyteBuffer.clear();\n\t\t\t\t\t}\n\t\t\t\t\tsocketChannel.close();\n\t\t\t\t}\n\t\t\t\titerator.remove();\n\t\t\t}\n\t\t}\n\t\tserverSocketChannel.close();\n\t}\n}Copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n\n\n# éæ©å¨\n\néæ©å¨ï¼Selectorï¼æ¯SelectableChannle å¯¹è±¡çå¤è·¯å¤ç¨å¨ï¼Selector å¯ä»¥åæ¶çæ§å¤ä¸ªSelectableChannel çIO ç¶åµï¼ä¹å°±æ¯è¯´ï¼å©ç¨Selector å¯ä½¿ä¸ä¸ªåç¬ççº¿ç¨ç®¡çå¤ä¸ªChannelãSelector æ¯éé»å¡IO çæ ¸å¿\n\n\n\néæ©å¨çåå»º\n\n// åå»ºä¸ä¸ªéæ©å¨\nSelector selector = Selector.open();Copy\n\n\n1\n2\n\n\nç»å®éæ©å¨\n\néè¿è°ç¨ééçregisteræ¹æ³å¯ä»¥ç»å®éæ©å¨ï¼registeræ¹æ³æä¸¤ä¸ªåæ°\n\n * Selectorï¼å³ç»å®åªä¸ªéæ©å¨\n\n * opsï¼çå¬äºä»¶ç±»åãopsæ4ä¸ªå¼å¯ä»¥éæ©ï¼ä¸ºSelectionKeyçéæå±æ§\n   \n   \n\n// è®©éæ©å¨çå¬ä¸ç§ç¶æ\nmyChannel.register(selector, SelectionKey.OP_READ);\n// è®©éæ©å¨çå¬å¤ç§ç¶æ\nmyChannel.register(selector, SelectionKey.OP_READ | SelectionKey.OP_ACCEPT);Copy\n\n\n1\n2\n3\n4\n\n\nSelectionKey\n\nè¡¨ç¤ºSelectableChannel åSelector ä¹é´çæ³¨åå³ç³»ãæ¯æ¬¡åéæ©å¨æ³¨åééæ¶å°±ä¼éæ©ä¸ä¸ªäºä»¶(éæ©é®)ãéæ©é®åå«ä¸¤ä¸ªè¡¨ç¤ºä¸ºæ´æ°å¼çæä½éãæä½éçæ¯ä¸ä½é½è¡¨ç¤ºè¯¥é®çééææ¯æçä¸ç±»å¯éæ©æä½',normalizedContent:'# java nio\n\n\n# ä¸ãç®ä»\n\njava nioï¼new ioï¼æ¯ä»java 1.4çæ¬å¼å§å¼å¥çä¸ä¸ªæ°çio apiï¼å¯ä»¥æ¿ä»£æ åçjava io apiãnioä¸åæ¥çioæåæ ·çä½ç¨åç®çï¼ä½æ¯ä½¿ç¨çæ¹å¼å®å¨ä¸åï¼nioæ¯æé¢åç¼å²åºçãåºäºééçioæä½ãnioå°ä»¥æ´å é«æçæ¹å¼è¿è¡æä»¶çè¯»åæä½ã\n\n\n# äºãioä¸nioçåºå«\n\nio                     nio\né¢åæµ(stream oriented)   é¢åç¼å²åº(buffer oriented)\né»å¡io(blocking io)      éé»å¡io(nonblocking io)\n                       éæ©å¨(selectors)\n\n\n# 1ãé¢åæµåç¼å²åº\n\nio\n\nä¼ ç»ioå¨ä¼ è¾æ°æ®æ¶ï¼æ ¹æ®è¾å¥è¾åºçä¸åéè¦åå«å»ºç«ä¸åçé¾æ¥ï¼èä¸ä¼ è¾çæ°æ®æ¯ä»¥æµçå½¢å¼å¨é¾æ¥ä¸è¿è¡ä¼ è¾ç\n\nå°±åèªæ¥æ°´è¦éè¿æ°´ç®¡å°èªæ¥æ°´ååå®¶è¿æ¥èµ·æ¥ä¸æ ·\n\n\n\nnio\n\nnioå¨ä¼ è¾æ°æ®æ¶ï¼ä¼å¨è¾å¥è¾åºç«¯ä¹é´å»ºç«ééï¼ç¶åå°æ°æ®æ¾å¥å°ç¼å²åºä¸­ãç¼å²åºéè¿ééæ¥ä¼ è¾æ°æ®\n\nè¿éééå°±åæ¯éè·¯ï¼è½å¤è¿éä¸¤ä¸ªå°ç¹ãç¼å²åºå°±åæ¯ç«è½¦ï¼è½å¤çæ­£å°è¿è¡æ°æ®çä¼ è¾\n\n\n\n\n# ä¸ãééä¸ç¼å²åº\n\njava nioç³»ç»çæ ¸å¿å¨äºï¼éé(channel)åç¼å²åº(buffer)ãééè¡¨ç¤ºæå¼å° io è®¾å¤(ä¾å¦ï¼æä»¶ãå¥æ¥å­)çè¿æ¥ãè¥éè¦ä½¿ç¨ nio ç³»ç»ï¼éè¦è·åç¨äºè¿æ¥ io è®¾å¤çééä»¥åç¨äºå®¹çº³æ°æ®çç¼å²åºãç¶åæä½ç¼å²åºï¼å¯¹æ°æ®è¿è¡å¤ç\n\nç®èè¨ä¹ï¼ééè´è´£ä¼ è¾ï¼ç¼å²åºè´è´£å­å¨\n\n\n# åãç¼å²åº(buffer)\n\n\n# 1ãç¼å²åºç±»å\n\nbuffer å°±åä¸ä¸ªæ°ç»ï¼å¯ä»¥ä¿å­å¤ä¸ªç¸åç±»åçæ°æ®ãæ ¹æ®æ°æ®ç±»åä¸å(boolean é¤å¤) ï¼æä»¥ä¸buffer å¸¸ç¨å­ç±»\n\n * bytebuffer\n * charbuffer\n * shortbuffer\n * intbuffer\n * longbuffer\n * floatbuffer\n * doublebuffer\n\nåç§ç±»åçç¼å²åºä¸­ï¼é½æä¸ä¸ªå¯¹åºç±»åçæ°ç»ï¼å¦\n\nbytebuffer\n\nfinal byte[] hb;                  // non-null only for heap bufferscopy\n\n\n1\n\n\nintbuffer\n\nfinal int[] hb;                  // non-null only for heap bufferscopy\n\n\n1\n\n\nä»ä»¬çç»§æ¿å³ç³»å¦ä¸\n\n\n\n\n# 2ãè·åç¼å²åº\n\néè¿allocateæ¹æ³å¯ä»¥è·åä¸ä¸ªå¯¹åºç¼å²åºçå¯¹è±¡ï¼å®æ¯ç¼å²åºç±»çä¸ä¸ªéææ¹æ³\n\nä¾\n\n// è·åä¸ä¸ªå®¹éå¤§å°ä¸º1024å­èçå­èç¼å²åº\nbytebuffer bytebuffer = bytebuffer.allocate(1024);copy\n\n\n1\n2\n\n\n\n# 3ãæ ¸å¿å±æ§\n\nç¼å²åºçç¶ç±»bufferä¸­æå ä¸ªæ ¸å¿å±æ§ï¼å¦ä¸\n\n// invariants: mark <= position <= limit <= capacity\nprivate int mark = -1;\nprivate int position = 0;\nprivate int limit;\nprivate int capacity;copy\n\n\n1\n2\n3\n4\n5\n\n * capacityï¼ç¼å²åºçå®¹éãéè¿æé å½æ°èµäºï¼ä¸æ¦è®¾ç½®ï¼æ æ³æ´æ¹\n * limitï¼ç¼å²åºççéãä½äºlimit åçæ°æ®ä¸å¯è¯»åãç¼å²åºçéå¶ä¸è½ä¸ºè´ï¼å¹¶ä¸ä¸è½å¤§äºå¶å®¹é\n * positionï¼ä¸ä¸ä¸ªè¯»åä½ç½®çç´¢å¼ï¼ç±»ä¼¼pcï¼ãç¼å²åºçä½ç½®ä¸è½ä¸ºè´ï¼å¹¶ä¸ä¸è½å¤§äºlimit\n * markï¼è®°å½å½åpositionçå¼ãpositionè¢«æ¹ååï¼å¯ä»¥éè¿è°ç¨reset() æ¹æ³æ¢å¤å°markçä½ç½®ã\n\nä»¥ä¸åä¸ªå±æ§å¿é¡»æ»¡è¶³ä»¥ä¸è¦æ±\n\nmark <= position <= limit <= capacity\n\n\n# 4ãæ ¸å¿æ¹æ³\n\n# put()æ¹æ³\n\n * put()æ¹æ³å¯ä»¥å°ä¸ä¸ªæ°æ®æ¾å¥å°ç¼å²åºä¸­ã\n * è¿è¡è¯¥æä½åï¼postitionçå¼ä¼+1ï¼æåä¸ä¸ä¸ªå¯ä»¥æ¾å¥çä½ç½®ãcapacity = limit ï¼ä¸ºç¼å²åºå®¹éçå¼ã\n\n\n\n# flip()æ¹æ³\n\n * flip()æ¹æ³ä¼åæ¢å¯¹ç¼å²åºçæä½æ¨¡å¼ï¼ç±å->è¯» / è¯»->å\n * è¿è¡è¯¥æä½å\n   * å¦ææ¯åæ¨¡å¼->è¯»æ¨¡å¼ï¼position = 0 ï¼ limit æåæåä¸ä¸ªåç´ çä¸ä¸ä¸ªä½ç½®ï¼capacityä¸å\n   * å¦ææ¯è¯»->åï¼åæ¢å¤ä¸ºput()æ¹æ³ä¸­çå¼\n\n\n\n# get()æ¹æ³\n\n * get()æ¹æ³ä¼è¯»åç¼å²åºä¸­çä¸ä¸ªå¼\n * è¿è¡è¯¥æä½åï¼positionä¼+1ï¼å¦æè¶è¿äºlimitåä¼æåºå¼å¸¸\n\n\n\n# rewind()æ¹æ³\n\n * è¯¥æ¹æ³åªè½å¨è¯»æ¨¡å¼ä¸ä½¿ç¨\n * rewind()æ¹æ³åï¼ä¼æ¢å¤positionãlimitåcapacityçå¼ï¼åä¸ºè¿è¡get()åçå¼\n\n\n\n# clean()æ¹æ³\n\n * clean()æ¹æ³ä¼å°ç¼å²åºä¸­çåä¸ªå±æ§æ¢å¤ä¸ºæåçç¶æï¼position = 0, capacity = limit\n * æ­¤æ¶ç¼å²åºçæ°æ®ä¾ç¶å­å¨ï¼å¤äºâè¢«éå¿âç¶æï¼ä¸æ¬¡è¿è¡åæä½æ¶ä¼è¦çè¿äºæ°æ®\n\n\n\n# mark()åreset()æ¹æ³\n\n * mark()æ¹æ³ä¼å°postionçå¼ä¿å­å°markå±æ§ä¸­\n * reset()æ¹æ³ä¼å°positionçå¼æ¹ä¸ºmarkä¸­ä¿å­çå¼\n\n# ä½¿ç¨å±ç¤º\n\npublic class demo1 {\n\tpublic static void main(string[] args) {\n\t\tbytebuffer bytebuffer = bytebuffer.allocate(1024);\n\n\t\tsystem.out.println("æ¾å¥ååæ°");\n\t\tsystem.out.println("position " + bytebuffer.position());\n\t\tsystem.out.println("limit " + bytebuffer.limit());\n\t\tsystem.out.println("capacity " + bytebuffer.capacity());\n\t\tsystem.out.println();\n\n\t\tsystem.out.println("------put()------");\n\t\tsystem.out.println("æ¾å¥3ä¸ªæ°æ®");\n\t\tbyte bt = 1;\n\t\tbytebuffer.put(bt);\n\t\tbytebuffer.put(bt);\n\t\tbytebuffer.put(bt);\n\n\t\tsystem.out.println("æ¾å¥ååæ°");\n\t\tsystem.out.println("position " + bytebuffer.position());\n\t\tsystem.out.println("limit " + bytebuffer.limit());\n\t\tsystem.out.println("capacity " + bytebuffer.capacity());\n\t\tsystem.out.println();\n\n\t\tsystem.out.println("------flip()-get()------");\n\t\tsystem.out.println("è¯»åä¸ä¸ªæ°æ®");\n\t\t// åæ¢æ¨¡å¼\n\t\tbytebuffer.flip();\n\t\tbytebuffer.get();\n\n\t\tsystem.out.println("è¯»åååæ°");\n\t\tsystem.out.println("position " + bytebuffer.position());\n\t\tsystem.out.println("limit " + bytebuffer.limit());\n\t\tsystem.out.println("capacity " + bytebuffer.capacity());\n\t\tsystem.out.println();\n\n\t\tsystem.out.println("------rewind()------");\n\t\tbytebuffer.rewind();\n\t\tsystem.out.println("æ¢å¤ååæ°");\n\t\tsystem.out.println("position " + bytebuffer.position());\n\t\tsystem.out.println("limit " + bytebuffer.limit());\n\t\tsystem.out.println("capacity " + bytebuffer.capacity());\n\t\tsystem.out.println();\n\n\t\tsystem.out.println("------clear()------");\n\t\t// æ¸ç©ºç¼å²åºï¼è¿éåªæ¯æ¢å¤äºåä¸ªå±æ§çå¼ï¼ä½æ¯ç¼å²åºéçæ°æ®ä¾ç¶å­å¨\n\t\t// ä½æ¯ä¸æ¬¡åå¥çæ¶åä¼è¦çç¼å²åºä¸­ä¹åçæ°æ®\n\t\tbytebuffer.clear();\n\t\tsystem.out.println("æ¸ç©ºååæ°");\n\t\tsystem.out.println("position " + bytebuffer.position());\n\t\tsystem.out.println("limit " + bytebuffer.limit());\n\t\tsystem.out.println("capacity " + bytebuffer.capacity());\n\t\tsystem.out.println();\n\t\tsystem.out.println("æ¸ç©ºåè·å¾æ°æ®");\n\t\tsystem.out.println(bytebuffer.get());\n\n\t}\n}\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n\n\næå°ç»æ\n\næ¾å¥ååæ°\nposition 0\nlimit 1024\ncapacity 1024\n\n------put()------\næ¾å¥3ä¸ªæ°æ®\næ¾å¥ååæ°\nposition 3\nlimit 1024\ncapacity 1024\n\n------flip()-get()------\nè¯»åä¸ä¸ªæ°æ®\nè¯»åååæ°\nposition 1\nlimit 3\ncapacity 1024\n\n------rewind()------\næ¢å¤ååæ°\nposition 0\nlimit 3\ncapacity 1024\n\n------clear()------\næ¸ç©ºååæ°\nposition 0\nlimit 1024\ncapacity 1024\n\næ¸ç©ºåè·å¾æ°æ®\n1copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n\n\n\n# 5ãéç´æ¥ç¼å²åºåç´æ¥ç¼å²åº\n\n# éç´æ¥ç¼å²åº\n\néè¿allocate()æ¹æ³è·åçç¼å²åºé½æ¯éç´æ¥ç¼å²åºãè¿äºç¼å²åºæ¯å»ºç«å¨jvmå åå­ä¹ä¸­çã\n\npublic static bytebuffer allocate(int capacity) {\n    if (capacity < 0)\n    throw new illegalargumentexception();\n\n    // å¨å åå­ä¸­å¼è¾ç©ºé´\n    return new heapbytebuffer(capacity, capacity);\n}\n\nheapbytebuffer(int cap, int lim) {        // package-private\n    // new byte[cap] åå»ºæ°ç»ï¼å¨å åå­ä¸­å¼è¾ç©ºé´\n    super(-1, 0, lim, cap, new byte[cap], 0);\n    /*\n    hb = new byte[cap];\n    offset = 0;\n    */\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n\néè¿éç´æ¥ç¼å²åºï¼æ³è¦å°æ°æ®åå¥å°ç©çç£çä¸­ï¼æèæ¯ä»ç©çç£çè¯»åæ°æ®ãé½éè¦ç»è¿jvmåæä½ç³»ç»ï¼æ°æ®å¨ä¸¤ä¸ªå°åç©ºé´ä¸­ä¼ è¾æ¶ï¼ä¼****ä¸ä»½ä¿å­å¨å¯¹æ¹çç©ºé´ä¸­ãæä»¥è´¹ç´æ¥ç¼å²åºçè¯»åæçè¾ä½\n\n# ç´æ¥ç¼å²åº\n\nåªæbytebufferå¯ä»¥è·å¾ç´æ¥ç¼å²åºï¼éè¿allocatedirect()è·åçç¼å²åºä¸ºç´æ¥ç¼å²åºï¼è¿äºç¼å²åºæ¯å»ºç«å¨ç©çåå­ä¹ä¸­çã\n\npublic static bytebuffer allocatedirect(int capacity) {\n    return new directbytebuffer(capacity);\n}\n\ndirectbytebuffer(int cap) {                   // package-private\n\t...\n    // ç³è¯·ç©çåå­\n\tboolean pa = vm.isdirectmemorypagealigned();\n\t...\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\nç´æ¥ç¼å²åºéè¿å¨æä½ç³»ç»åjvmä¹é´åå»ºç©çåå­æ å°æä»¶å å¿«ç¼å²åºæ°æ®è¯»/åå¥ç©çç£ççéåº¦ãæ¾å°ç©çåå­æ å°æä»¶ä¸­çæ°æ®å°±ä¸å½åºç¨ç¨åºæ§å¶äºï¼æä½ç³»ç»ä¼èªå¨å°ç©çåå­æ å°æä»¶ä¸­çæ°æ®åå¥å°ç©çåå­ä¸­\n\n\n# äºãéé(channel)\n\n\n# 1ãç®ä»\n\nchannelç±java.nio.channels åå®ä¹çãchannel è¡¨ç¤ºio æºä¸ç®æ æå¼çè¿æ¥ãchannel ç±»ä¼¼äºä¼ ç»çâæµâãåªä¸è¿channel æ¬èº«ä¸è½ç´æ¥è®¿é®æ°æ®ï¼channel åªè½ä¸buffer è¿è¡äº¤äº\n\n\n# 2ãå¾è§£\n\nåºç¨ç¨åºè¿è¡è¯»åæä½è°ç¨å½æ°æ¶ï¼åºå±è°ç¨çæä½ç³»ç»æä¾ç»ç¨æ·çè¯»åapiï¼è°ç¨è¿äºapiæ¶ä¼çæå¯¹åºçæä»¤ï¼cpuåä¼æ§è¡è¿äºæä»¤ãå¨è®¡ç®æºååºç°çé£æ®µæ¶é´ï¼ææè¯»åè¯·æ±çæä»¤é½æcpuå»æ§è¡ï¼è¿å¤çè¯»åè¯·æ±ä¼å¯¼è´cpuæ æ³å»æ§è¡å¶ä»å½ä»¤ï¼ä»ècpuçå©ç¨çéä½\n\n\n\nåæ¥ï¼dma(direct memory accessï¼ç´æ¥å­å¨å¨è®¿é®)åºç°äºãå½ioè¯·æ±ä¼ å°è®¡ç®æºåºå±æ¶ï¼dmaä¼åcpuè¯·æ±ï¼è®©dmaå»å¤çè¿äºioæä½ï¼ä»èå¯ä»¥è®©cpuå»æ§è¡å¶ä»æä»¤ãdmaå¤çioæä½æ¶ï¼ä¼è¯·æ±è·åæ»çº¿çä½¿ç¨æãå½ioè¯·æ±è¿å¤æ¶ï¼ä¼å¯¼è´å¤§éæ»çº¿ç¨äºå¤çioè¯·æ±ï¼ä»èéä½æç\n\n\n\näºæ¯ä¾¿æäºchannel(éé)ï¼channelç¸å½äºä¸ä¸ªä¸é¨ç¨äºioæä½çç¬ç«å¤çå¨ï¼å®å·æç¬ç«å¤çioè¯·æ±çè½åï¼å½æioè¯·æ±æ¶ï¼å®ä¼èªè¡å¤çè¿äºioè¯·æ±\n\n\n\n\n# 3ãjava channel\n\n# å¸¸ç¨å®ç°ç±»\n\n\n\n * æ¬å°æä»¶io\n   * filechannel\n * ç½ç»io\n   * socketchanelãserversocketchannelï¼ç¨äºtcpä¼ è¾\n   * datagramchannelï¼ç¨äºudpä¼ è¾\n\n# è·å¾ééçæ¹æ³\n\nè·åééçä¸ç§æ¹å¼æ¯å¯¹æ¯æééçå¯¹è±¡è°ç¨getchannel() æ¹æ³ãæ¯æééçç±»å¦ä¸ï¼\n\n * fileinputstream\n * fileoutputstream\n * randomaccessfile\n * datagramsocket\n * socket\n * serversocket\n\npublic class demo2 {\n   public static void main(string[] args) throws ioexception {\n      // æ¬å°éé\n      fileinputstream fileinputstream = new fileinputstream("");\n      filechannel channel1 = fileinputstream.getchannel();\n\n      fileoutputstream fileoutputstream = new fileoutputstream("");\n      filechannel channel2 = fileoutputstream.getchannel();\n   \n      // ç½ç»éé\n      socket socket = new socket();\n      socketchannel channel3 = socket.getchannel();\n      \n      serversocket serversocket = new serversocket();\n      serversocketchannel channel4 = serversocket.getchannel();\n\n      datagramsocket datagramsocket = new datagramsocket();\n      datagramchannel channel5 = datagramsocket.getchannel();\n       \n      // æåè¦å³é­éé\n       \n   }\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\nä¹å¯ä»¥éè¿ééçéææ¹æ³open()æ¥è·å\n\npublic static void main(string[] args) throws ioexception {\n   filechannel open = filechannel.open(paths.get(""));\n   \n   socketchannel open1 = socketchannel.open();\n   \n   ...\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n# getchannel()+éç´æ¥ç¼å²åº\n\n * getchannel()è·å¾éé\n * allocate()è·å¾éç´æ¥ç¼å²åº\n\néè¿éç´æ¥ç¼å²åºè¯»åæ°æ®ï¼éè¦éè¿ééæ¥ä¼ è¾ç¼å²åºéçæ°æ®\n\npublic class demo4 {\n   public static void main(string[] args) {\n      fileinputstream is = null;\n      fileoutputstream os = null;\n      // è·å¾éé\n      filechannel inchannel = null;\n      filechannel outchannel = null;\n       \n      // å©ç¨ try-catch-finally ä¿è¯å³é­\n      try {\n         is = new fileinputstream("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day1\\\\1.jpg");\n         os = new fileoutputstream("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day1\\\\2.jpg");\n\n         // è·å¾éé\n         inchannel = is.getchannel();\n         outchannel = os.getchannel();\n\n         // è·å¾ç¼å²åºï¼ç¨äºå¨ééä¸­ä¼ è¾æ°æ®\n         bytebuffer bytebuffer = bytebuffer.allocate(1024);\n\n         // å¾ªç¯å°å­èæ°æ®æ¾å¥å°bufferä¸­ï¼ç¶ååå¥ç£çä¸­\n         while (inchannel.read(bytebuffer) != -1) {\n            // åæ¢æ¨¡å¼\n            bytebuffer.flip();\n            outchannel.write(bytebuffer);\n            bytebuffer.clear();\n         }\n      } catch (ioexception e) {\n         e.printstacktrace();\n      } finally {\n         if (inchannel != null) {\n            try {\n               inchannel.close();\n            } catch (ioexception e) {\n               e.printstacktrace();\n            }\n         }\n         if (outchannel != null) {\n            try {\n               outchannel.close();\n            } catch (ioexception e) {\n               e.printstacktrace();\n            }\n         }\n         if (is != null) {\n            try {\n               is.close();\n            } catch (ioexception e) {\n               e.printstacktrace();\n            }\n         }\n         if (os != null) {\n            try {\n               os.close();\n            } catch (ioexception e) {\n               e.printstacktrace();\n            }\n         }\n      }\n   }\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n\n\nå¾çè¯»ååï¼è¢«åå¥å°äºæå®ä½ç½®\n\n# open()+ç´æ¥ç¼å²åº\n\n * éè¿openè·å¾éé\n * éè¿filechannel.map()è·åç´æ¥ç¼å²åº\n\nä½¿ç¨ç´æ¥ç¼å²åºæ¶ï¼æ ééè¿ééæ¥ä¼ è¾æ°æ®ï¼ç´æ¥å°æ°æ®æ¾å¨ç¼å²åºåå³å¯\n\npublic class demo5 {\n   public static void main(string[] args) throws ioexception {\n      // éè¿open()æ¹æ³æ¥è·å¾éé\n      filechannel inchannel = filechannel.open(paths.get("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day1\\\\1.jpg"), standardopenoption.read);\n\n      // outchanneléè¦ä¸º read write createæ¨¡å¼\n      // read writeæ¯å ä¸ºåé¢è·åç´æ¥ç¼å²åºæ¶æ¨¡å¼ä¸ºread_writeæ¨¡å¼\n      // createæ¯å ä¸ºè¦åå»ºæ°çæä»¶\n      filechannel outchannel = filechannel.open(paths.get("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day1\\\\3.jpg"), standardopenoption.read, standardopenoption.write, standardopenoption.create);\n\n      // è·å¾ç´æ¥ç¼å²åº\n      mappedbytebuffer inmapbuf = inchannel.map(filechannel.mapmode.read_only, 0, inchannel.size());\n      mappedbytebuffer outmapbuf = outchannel.map(filechannel.mapmode.read_write, 0, inchannel.size());\n\n      // å­èæ°ç»\n      byte[] bytes = new byte[inmapbuf.limit()];\n\n      // å ä¸ºæ¯ç´æ¥ç¼å²åºï¼å¯ä»¥ç´æ¥å°æ°æ®æ¾å¥å°åå­æ å°æä»¶ï¼æ ééè¿ééä¼ è¾\n      inmapbuf.get(bytes);\n      outmapbuf.put(bytes);\n\n      // å³é­ç¼å²åºï¼è¿éæ²¡æç¨try-catch-finally\n      inchannel.close();\n      outchannel.close();\n   }\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\nè¿è¡ç»æï¼å¾çè¢«åå»º\n\n# ééé´ç´æ¥ä¼ è¾\n\npublic static void channeltochannel() throws ioexception {\n   long start = system.currenttimemillis();\n   // éè¿open()æ¹æ³æ¥è·å¾éé\n   filechannel inchannel = filechannel.open(paths.get("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day1\\\\1.mp4"), standardopenoption.read);\n\n   // outchanneléè¦ä¸º read write createæ¨¡å¼\n   // read writeæ¯å ä¸ºåé¢è·åç´æ¥ç¼å²åºæ¶æ¨¡å¼ä¸ºread_writeæ¨¡å¼\n   // createæ¯å ä¸ºè¦åå»ºæ°çæä»¶\n   filechannel outchannel = filechannel.open(paths.get("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day1\\\\4.mp4"), standardopenoption.read, standardopenoption.write, standardopenoption.create);\n\n   // ééé´ç´æ¥ä¼ è¾\n   inchannel.transferto(0, inchannel.size(), outchannel);\n   // å¯¹åºçè¿ætransferfrom\n   // outchannel.transferfrom(inchannel, 0, inchannel.size());\n\n   inchannel.close();\n   outchannel.close();\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n# ç´æ¥ç¼å²åºvséç´æ¥ç¼å²åº\n\næç\n\nè¯»åä¸ä¸ªmp4æä»¶ï¼éè¿äºèè±è´¹æ¶é´çå¤å°æ¥å¤å®æ§è¡çéåº¦\n\n// getchannel() + éç´æ¥ç¼å²åºèæ¶\n708\n// open() + ç´æ¥ç¼å²åºèæ¶\n115\n// channel transferto channelèæ¶\n47copy\n\n\n1\n2\n3\n4\n5\n6\n\n\nåå­å ç¨\n\nç´æ¥ç¼å²åºçè¯»åéåº¦è½ç¶å¾å¿«ï¼ä½æ¯ä¼å ç¨å¾å¤å¾å¤åå­ç©ºé´ãå¦ææä»¶è¿å¤§ï¼ä¼ä½¿å¾è®¡ç®æºè¿è¡éåº¦åæ¢\n\n\n# 4ãåæ£åèé\n\n# åæ£è¯»å\n\nåæ£è¯»åï¼scattering readsï¼æ¯æä»channel ä¸­è¯»åçæ°æ®âåæ£âå°å¤ä¸ªbuffer ä¸­\n\næ³¨æï¼æç§ç¼å²åºçé¡ºåºï¼ä»channel ä¸­è¯»åçæ°æ®ä¾æ¬¡å° buffer å¡«æ»¡\n\n\n\n# èéåå¥\n\nèéåå¥ï¼gathering writesï¼æ¯æå°å¤ä¸ªbuffer ä¸­çæ°æ®âèéâå°channel\n\næç§ç¼å²åºçé¡ºåºï¼åå¥position ålimit ä¹é´çæ°æ®å°channel\n\n\n\nä»£ç \n\npublic class demo2 {\n   public static void main(string[] args) throws ioexception {\n      fileinputstream is = new fileinputstream("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day2\\\\è®¡å.txt");\n      fileoutputstream os = new fileoutputstream("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day2\\\\è®¡å2.txt");\n\n      filechannel inchannel = is.getchannel();\n      filechannel outchannel = os.getchannel();\n\n      // è·å¾å¤ä¸ªç¼å²åºï¼å¹¶ä¸æ¾å¥å°ç¼å²åºæ°ç»ä¸­\n      bytebuffer bytebuffer1 = bytebuffer.allocate(50);\n      bytebuffer bytebuffer2 = bytebuffer.allocate(1024);\n      bytebuffer[] bytebuffers = {bytebuffer1, bytebuffer2};\n\n      // åæ£è¯»å\n      inchannel.read(bytebuffers);\n      \n      bytebuffer1.flip();\n      bytebuffer2.flip();\n      \n      // èéåå¥\n      outchannel.write(bytebuffers);\n   }\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n\n\n\n\n\n\n# å­ãéé»å¡å¼ç½ç»éä¿¡\n\n\n# 1ãæ¦å¿µ\n\n# ä¸¾ä¾\n\nå11ä¹°çå¿«éå°äºï¼å¿«éå°å¥ç»ä½ æçµè¯è¯´é©¬ä¸å°å°åºé¨å£ï¼éº»ç¦å¨é¨å£ç­ä¸ä¸ï¼æ¹ä¾¿ç­¾æ¶å¿«é\n\n * è¥ä¸ºé»å¡å¼çï¼ä½ å°äºå°åºé¨å£ä»¥åï¼å¿«éå°å¥è¿æ²¡å°çæé´ï¼ä½ ä»ä¹äºå¿ä¹åä¸äº\n * è¥ä¸ºéé»å¡å¼çï¼å¿«éå°å¥å°å¿«éæ¾å°é¨å«å¤ï¼é¨å«ç»ä½ åæ¶æ¯è¯´å¿«éå°äºï¼éº»ç¦å»åä¸ä¸ãå½å¿«éè¿æ²¡å°çæ¶åä½ å¯ä»¥åä½ èªå·±çäºå¿\n\n# é»å¡å¼ç½ç»éä¿¡\n\nä¼ ç»çio æµé½æ¯é»å¡å¼çãä¹å°±æ¯è¯´ï¼å½ä¸ä¸ªçº¿ç¨è°ç¨read() æwrite() æ¶ï¼è¯¥çº¿ç¨è¢«é»å¡ï¼ç´å°æä¸äºæ°æ®è¢«è¯»åæåå¥ï¼è¯¥çº¿ç¨å¨æ­¤æé´ä¸è½æ§è¡å¶ä»ä»»å¡\n\nå æ­¤ï¼å¨å®æç½ç»éä¿¡è¿è¡io æä½æ¶ï¼ç±äºçº¿ç¨ä¼é»å¡ï¼æä»¥æå¡å¨ç«¯å¿é¡»ä¸ºæ¯ä¸ªå®¢æ·ç«¯é½æä¾ä¸ä¸ªç¬ç«ççº¿ç¨è¿è¡å¤çï¼å½æå¡å¨ç«¯éè¦å¤çå¤§éå®¢æ·ç«¯æ¶ï¼æ§è½æ¥å§ä¸é\n\nä¹å°±æ¯è¯´ï¼æå¡å¨å¨ç­å¾ioåå¤å°±ç»ªçæé´ï¼çº¿ç¨å¤äºé»å¡ç¶æï¼è¥ä¸ºåçº¿ç¨ï¼ç­å¾æé´cpuæªæ§è¡ä»»ä½ä»»å¡ï¼æçéä½ãæä»¥éè¦å¼å¯å¤ä¸ªçº¿ç¨ï¼å½æäºçº¿ç¨å ä¸ºç­å¾ioåå¤å°±ç»ªæ¶ï¼cpuå¯ä»¥å»æ§è¡å¶ä»çº¿ç¨ä¸­çä»»å¡ãä½æ¯çº¿ç¨çåå»ºãåæ¢ä¸éæ¯çå¼éä¹æ¯ä¸å°çãå½å¤§éçä»»å¡å°æ¥æ¶ï¼æå¡å¨æ§è½ä¹æ¥å§ä¸éã\n\n\n\n# éé»å¡å¼ç½ç»éä¿¡\n\njava nio æ¯éé»å¡æ¨¡å¼çãå½çº¿ç¨ä»æééè¿è¡è¯»åæ°æ®æ¶ï¼è¥æ²¡ææ°æ®å¯ç¨æ¶ï¼è¯¥çº¿ç¨å¯ä»¥è¿è¡å¶ä»ä»»å¡ãçº¿ç¨éå¸¸å°éé»å¡io çç©ºé²æ¶é´ç¨äºå¨å¶ä»ééä¸æ§è¡io æä½ï¼æä»¥åç¬ççº¿ç¨å¯ä»¥ç®¡çå¤ä¸ªè¾å¥åè¾åºéé\n\nå æ­¤ï¼nio å¯ä»¥è®©æå¡å¨ç«¯ä½¿ç¨ä¸ä¸ªææéå ä¸ªçº¿ç¨æ¥åæ¶å¤çè¿æ¥å°æå¡å¨ç«¯çææå®¢æ·ç«¯\n\n\n\n\n# 2ãä½¿ç¨\n\n# é»å¡å¼ç½ç»éä¿¡æ¼ç¤º\n\npublic class demo1 {\n   public static void main(string[] args) throws ioexception {\n      thread thread1 = new thread(()->{\n         try {\n            server();\n         } catch (ioexception e) {\n            e.printstacktrace();\n         }\n      });\n\n      thread thread2 = new thread(()->{\n         try {\n            client();\n         } catch (ioexception e) {\n            e.printstacktrace();\n         }\n      });\n\n      thread1.start();\n      thread2.start();\n   }\n\n   public static void client() throws ioexception {\n      // åå»ºå®¢æ·ç«¯éé\n      socketchannel socketchannel = socketchannel.open(new inetsocketaddress("127.0.0.1", 2022));\n\n      // è¯»åä¿¡æ¯\n      filechannel filechannel = filechannel.open(paths.get("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day3\\\\1.jpg"), standardopenoption.read);\n\n      // åå»ºç¼å²åº\n      bytebuffer bytebuffer = bytebuffer.allocate(1024);\n\n      // åå¥æ°æ®\n      while (filechannel.read(bytebuffer) != -1) {\n         bytebuffer.flip();\n         socketchannel.write(bytebuffer);\n         bytebuffer.clear();\n      }\n\n      filechannel.close();\n      socketchannel.close();\n   }\n\n   public static void server() throws ioexception {\n      // åå»ºæå¡ç«¯éé\n      serversocketchannel serversocketchannel = serversocketchannel.open();\n\n      filechannel filechannel = filechannel.open(paths.get("f:\\\\jdklearning\\\\src\\\\main\\\\nio\\\\day3\\\\2.jpg"), standardopenoption.write, standardopenoption.create);\n\n      // ç»å®é¾æ¥\n      serversocketchannel.bind(new inetsocketaddress(2022));\n\n      // è·åå®¢æ·ç«¯çéé\n      socketchannel socketchannel = serversocketchannel.accept();\n\n      // åå»ºç¼å²åº\n      bytebuffer bytebuffer = bytebuffer.allocate(1024);\n\n      while (socketchannel.read(bytebuffer) != -1) {\n         bytebuffer.flip();\n         filechannel.write(bytebuffer);\n         bytebuffer.clear();\n      }\n\n      socketchannel.close();\n      filechannel.close();\n      serversocketchannel.close();\n   }\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n\n\n# éé»å¡å¼ç½ç»éä¿¡æ¼ç¤º\n\npublic class demonio {\n\tpublic static void main(string[] args) {\n\t\tthread thread1 = new thread(()->{\n\t\t\ttry {\n\t\t\t\tserver();\n\t\t\t} catch (ioexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t});\n\n\t\tthread thread2 = new thread(()->{\n\t\t\ttry {\n\t\t\t\tclient();\n\t\t\t} catch (ioexception e) {\n\t\t\t\te.printstacktrace();\n\t\t\t}\n\t\t});\n\t\tthread1.start();\n\t\tthread2.start();\n\t}\n\n\tpublic static void client() throws ioexception {\n\t\tsocketchannel socketchannel = socketchannel.open(new inetsocketaddress("127.0.0.1", 2020));\n\n\t\t// è®¾ç½®ä¸ºéé»å¡æ¨¡å¼\n\t\tsocketchannel.configureblocking(false);\n\n\t\tbytebuffer bytebuffer = bytebuffer.allocate(1024);\n\n\t\tscanner scanner = new scanner(system.in);\n\t\twhile (scanner.hasnext()) {\n\t\t\tstring str = scanner.next();\n\t\t\tbytebuffer.put(str.getbytes());\n\t\t\tbytebuffer.flip();\n\t\t\tsocketchannel.write(bytebuffer);\n\t\t\tbytebuffer.clear();\n\t\t}\n\n\t\tbytebuffer.clear();\n\n\t\tsocketchannel.close();\n\t}\n\n\tpublic static void server() throws ioexception {\n\t\tserversocketchannel serversocketchannel = serversocketchannel.open();\n\t\tserversocketchannel.configureblocking(false);\n\t\tserversocketchannel.bind(new inetsocketaddress(2020));\n\n\t\t// è·å¾éæ©å¨\n\t\tselector selector = selector.open();\n\n\t\t// å°ééæ³¨åå°éæ©å¨ä¸­ï¼è®¾å®ä¸ºæ¥æ¶æä½\n\t\tserversocketchannel.register(selector, selectionkey.op_accept);\n\n\t\t// è½®è®­æ¥å\n\t\twhile (selector.select() > 0) {\n\t\t\titerator<selectionkey> iterator = selector.selectedkeys().iterator();\n\t\t\t// è·å¾äºä»¶çkey\n\t\t\twhile (iterator.hasnext()) {\n\t\t\t\tselectionkey key = iterator.next();\n\t\t\t\tif (key.isacceptable()) {\n\t\t\t\t\tsocketchannel socketchannel = serversocketchannel.accept();\n\t\t\t\t\tsocketchannel.configureblocking(false);\n\t\t\t\t\tsocketchannel.register(selector, selectionkey.op_read);\n\t\t\t\t} else if (key.isreadable()) {\n\t\t\t\t\t// ä»éæ©å¨ä¸­è·åéé\n\t\t\t\t\tsocketchannel socketchannel = (socketchannel) key.channel();\n\n\t\t\t\t\tbytebuffer bytebuffer = bytebuffer.allocate(10);\n\n\t\t\t\t\twhile (socketchannel.read(bytebuffer) != -1) {\n\t\t\t\t\t\tint len = bytebuffer.limit();\n\t\t\t\t\t\tbytebuffer.flip();\n\t\t\t\t\t\tsystem.out.println(new string(bytebuffer.array(), 0, len));\n\t\t\t\t\t\tbytebuffer.clear();\n\t\t\t\t\t}\n\t\t\t\t\tsocketchannel.close();\n\t\t\t\t}\n\t\t\t\titerator.remove();\n\t\t\t}\n\t\t}\n\t\tserversocketchannel.close();\n\t}\n}copy\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n\n\n# éæ©å¨\n\néæ©å¨ï¼selectorï¼æ¯selectablechannle å¯¹è±¡çå¤è·¯å¤ç¨å¨ï¼selector å¯ä»¥åæ¶çæ§å¤ä¸ªselectablechannel çio ç¶åµï¼ä¹å°±æ¯è¯´ï¼å©ç¨selector å¯ä½¿ä¸ä¸ªåç¬ççº¿ç¨ç®¡çå¤ä¸ªchannelãselector æ¯éé»å¡io çæ ¸å¿\n\n\n\néæ©å¨çåå»º\n\n// åå»ºä¸ä¸ªéæ©å¨\nselector selector = selector.open();copy\n\n\n1\n2\n\n\nç»å®éæ©å¨\n\néè¿è°ç¨ééçregisteræ¹æ³å¯ä»¥ç»å®éæ©å¨ï¼registeræ¹æ³æä¸¤ä¸ªåæ°\n\n * selectorï¼å³ç»å®åªä¸ªéæ©å¨\n\n * opsï¼çå¬äºä»¶ç±»åãopsæ4ä¸ªå¼å¯ä»¥éæ©ï¼ä¸ºselectionkeyçéæå±æ§\n   \n   \n\n// è®©éæ©å¨çå¬ä¸ç§ç¶æ\nmychannel.register(selector, selectionkey.op_read);\n// è®©éæ©å¨çå¬å¤ç§ç¶æ\nmychannel.register(selector, selectionkey.op_read | selectionkey.op_accept);copy\n\n\n1\n2\n3\n4\n\n\nselectionkey\n\nè¡¨ç¤ºselectablechannel åselector ä¹é´çæ³¨åå³ç³»ãæ¯æ¬¡åéæ©å¨æ³¨åééæ¶å°±ä¼éæ©ä¸ä¸ªäºä»¶(éæ©é®)ãéæ©é®åå«ä¸¤ä¸ªè¡¨ç¤ºä¸ºæ´æ°å¼çæä½éãæä½éçæ¯ä¸ä½é½è¡¨ç¤ºè¯¥é®çééææ¯æçä¸ç±»å¯éæ©æä½',charsets:{cjk:!0},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"ES",frontmatter:{title:"ES",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/f4d6a4/"},regularPath:"/02.%E6%95%B0%E6%8D%AE%E5%BA%93/ES.html",relativePath:"02.æ°æ®åº/ES.md",key:"v-4721bed4",path:"/pages/f4d6a4/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"MogoDB",frontmatter:{title:"MogoDB",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/fa91e2/"},regularPath:"/02.%E6%95%B0%E6%8D%AE%E5%BA%93/MogoDB.html",relativePath:"02.æ°æ®åº/MogoDB.md",key:"v-062877d6",path:"/pages/fa91e2/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"MySQL",frontmatter:{title:"MySQL",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/7e2298/"},regularPath:"/02.%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL.html",relativePath:"02.æ°æ®åº/MySQL.md",key:"v-c44d2880",path:"/pages/7e2298/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"MybastisPlus",frontmatter:{title:"MybastisPlus",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/7e5d5d/"},regularPath:"/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/MybastisPlus.html",relativePath:"03.è®¡ç®æºåºç¡/MybastisPlus.md",key:"v-3da84d0d",path:"/pages/7e5d5d/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"SpringBoot",frontmatter:{title:"SpringBoot",date:"2022-05-24T15:20:40.000Z",permalink:"/pages/4501c4/"},regularPath:"/03.%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/SpringBoot.html",relativePath:"03.è®¡ç®æºåºç¡/SpringBoot.md",key:"v-4537776d",path:"/pages/4501c4/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/05/24, 14:05:00",lastUpdatedTimestamp:1653402068e3},{title:"å½æ¡£",frontmatter:{archivesPage:!0,title:"å½æ¡£",permalink:"/archives/",article:!1},regularPath:"/@pages/archivesPage.html",relativePath:"@pages/archivesPage.md",key:"v-536574fe",path:"/archives/",headersStr:null,content:"",normalizedContent:"",charsets:{},lastUpdated:"2022/04/22, 16:04:00",lastUpdatedTimestamp:1650646275e3},{title:"Home",frontmatter:{home:!0,heroImage:"/img/web.png",heroText:"Jerry's Binlog",tagline:"Write the Code. Change the World.",actionText:"Immediately into â",actionLink:"/java/",bannerBg:"none",postList:"simple"},regularPath:"/",relativePath:"index.md",key:"v-bf924ecc",path:"/",headersStr:null,content:"Learning is the process, not the result.",normalizedContent:"learning is the process, not the result.",charsets:{},lastUpdated:"2022/05/03, 11:05:00",lastUpdatedTimestamp:1651576601e3}],themeConfig:{nav:[{text:"HomePage",link:"/"},{text:"Java",link:"/java/",items:[{text:"Javaèææº",link:"/java/jvm/"},{text:"Javaå¹¶åç¼ç¨",link:"/java/juc/"}]},{text:"Database",link:"/database/",items:[{text:"MySQL",link:"/database/mysql/"},{text:"MongoDB",link:"/database/mongodb/"}]},{text:"Framework",link:"/framework/",items:[{text:"Mybatis-plus",link:"/framework/mybatis-plus/"},{text:"SpringBoot",link:"/framework/springboot/"}]},{text:"Development",link:"/dev/",items:[{text:"Git",link:"/dev/git/"}]},{text:"Project",link:"/project/",items:[{text:"project-01",link:"/project/campus01/"},{text:"project-02",link:"/project/campus02/"},{text:"project-03",link:"/project/campus03/"}]},{text:"About",link:"/about/"}],sidebarDepth:2,logo:"/img/logo.png",repo:"QianyizzZ/notes",searchMaxSuggestions:10,lastUpdated:"æåæ´æ°",docsDir:"docs",editLinks:!0,editLinkText:"å¨ GitHub ä¸ç¼è¾æ­¤é¡µ",category:!1,tag:!1,sidebar:{},updateBar:{showToArticle:!0},author:{name:"wxy",href:"https://qianyizzz.github.io/notes/"},footer:{createYear:2022,copyrightInfo:'oddfar | <a href="https://note.oddfar.com/sitemap.xml" target="_blank">sitemap.xml</a> | <a href="https://beian.miit.gov.cn/" target="_blank">åICPå¤20001094å·</a>'}}},lc=(e(160),e(216),e(149),e(225)),uc=e(226),pc=(e(398),e(241),e(44));var dc={computed:{$filterPosts:function(){return this.$site.pages.filter((function(n){var t=n.frontmatter,e=t.pageComponent,r=t.article,i=t.home;return!(e||!1===r||!0===i)}))},$sortPosts:function(){return(n=this.$filterPosts).sort((function(n,t){var e=n.frontmatter.sticky,r=t.frontmatter.sticky;return e&&r?e==r?Object(pc.a)(n,t):e-r:e&&!r?-1:!e&&r?1:Object(pc.a)(n,t)})),n;var n},$sortPostsByDate:function(){return(n=this.$filterPosts).sort((function(n,t){return Object(pc.a)(n,t)})),n;var n},$groupPosts:function(){return function(n){for(var t={},e={},r=function(r,i){var a=n[r].frontmatter,o=a.categories,s=a.tags;"array"===Object(pc.n)(o)&&o.forEach((function(e){e&&(t[e]||(t[e]=[]),t[e].push(n[r]))})),"array"===Object(pc.n)(s)&&s.forEach((function(t){t&&(e[t]||(e[t]=[]),e[t].push(n[r]))}))},i=0,a=n.length;i<a;i++)r(i);return{categories:t,tags:e}}(this.$sortPosts)},$categoriesAndTags:function(){return function(n){var t=[],e=[];for(var r in n.categories)t.push({key:r,length:n.categories[r].length});for(var i in n.tags)e.push({key:i,length:n.tags[i].length});return{categories:t,tags:e}}(this.$groupPosts)}}};Mi.component(lc.default),Mi.component(uc.default);function fc(n){return n.toString().padStart(2,"0")}e(402);Mi.component("Badge",(function(){return Promise.all([e.e(0),e.e(3)]).then(e.bind(null,514))})),Mi.component("CodeBlock",(function(){return Promise.resolve().then(e.bind(null,225))})),Mi.component("CodeGroup",(function(){return Promise.resolve().then(e.bind(null,226))}));e(403),e(404);var hc=[function(n){n.Vue,n.options,n.router,n.siteData},function(n){var t=n.Vue,e=(n.options,n.router,n.siteData);e.pages.map((function(n){var t=n.frontmatter,r=t.date,i=t.author;"string"==typeof r&&"Z"===r.charAt(r.length-1)&&(n.frontmatter.date=function(n){n instanceof Date||(n=new Date(n));return"".concat(n.getUTCFullYear(),"-").concat(fc(n.getUTCMonth()+1),"-").concat(fc(n.getUTCDate())," ").concat(fc(n.getUTCHours()),":").concat(fc(n.getUTCMinutes()),":").concat(fc(n.getUTCSeconds()))}(r)),i?n.author=i:e.themeConfig.author&&(n.author=e.themeConfig.author)})),t.mixin(dc)},{},function(n){n.Vue.mixin({computed:{$dataBlock:function(){return this.$options.__data__block__}}})},{},{},function(){"undefined"!=typeof window&&function(n,t,e){function r(n){var e=t.createElement("div");e.className="heart",i.push({el:e,x:n.clientX-5,y:n.clientY-5,scale:1,alpha:1,color:"#11a8cd"}),t.body.appendChild(e)}var i=[];n.requestAnimationFrame=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(n){setTimeout(n,1e3/60)},function(n){var e=t.createElement("style");e.type="text/css";try{e.appendChild(t.createTextNode(n))}catch(t){e.styleSheet.cssText=n}t.getElementsByTagName("head")[0].appendChild(e)}(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),function(){var t="function"==typeof n.onclick&&n.onclick;n.onclick=function(n){var e=!0;n.path&&n.path.forEach((function(n){1===n.nodeType&&"string"==typeof n.className&&n.className.indexOf("theme-vdoing-content")>-1&&(e=!1)})),e&&(t&&t(),r(n))}}(),function n(){for(var e=0;e<i.length;e++)i[e].alpha<=0?(t.body.removeChild(i[e].el),i.splice(e,1)):(i[e].y--,i[e].scale+=.004,i[e].alpha-=.013,i[e].el.style.cssText="left:"+i[e].x+"px;top:"+i[e].y+"px;opacity:"+i[e].alpha+";transform:scale("+i[e].scale+","+i[e].scale+") rotate(45deg);background:"+i[e].color+";z-index:99999");requestAnimationFrame(n)}()}(window,document)}],mc=[];e(65),e(78);e(133);function vc(n,t){return(vc=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}e(219),e(220);function gc(n){return(gc=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function bc(n,t){if(t&&("object"===Object(Co.a)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}function yc(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=gc(n);if(t){var i=gc(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return bc(this,e)}}var wc=function(n){!function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&vc(n,t)}(e,n);var t=yc(e);function e(){return us(this,e),t.apply(this,arguments)}return ds(e)}(function(){function n(){us(this,n),this.store=new Mi({data:{state:{}}})}return ds(n,[{key:"$get",value:function(n){return this.store.state[n]}},{key:"$set",value:function(n,t){Mi.set(this.store.state,n,t)}},{key:"$emit",value:function(){var n;(n=this.store).$emit.apply(n,arguments)}},{key:"$on",value:function(){var n;(n=this.store).$on.apply(n,arguments)}}]),n}());Object.assign(wc.prototype,{getPageAsyncComponent:qo,getLayoutAsyncComponent:Vo,getAsyncComponent:Jo,getVueComponent:Wo});var kc={install:function(n){var t=new wc;n.$vuepress=t,n.prototype.$vuepress=t}};function xc(n){n.beforeEach((function(t,e,r){if(_c(n,t.path))r();else if(/(\/|\.html)$/.test(t.path))if(/\/$/.test(t.path)){var i=t.path.replace(/\/$/,"")+".html";_c(n,i)?r(i):r()}else r();else{var a=t.path+"/",o=t.path+".html";_c(n,o)?r(o):_c(n,a)?r(a):r()}}))}function _c(n,t){var e=t.toLowerCase();return n.options.routes.some((function(n){return n.path.toLowerCase()===e}))}var Sc={props:{pageKey:String,slotKey:{type:String,default:"default"}},render:function(n){var t=this.pageKey||this.$parent.$page.key;return Ho("pageKey",t),Mi.component(t)||Mi.component(t,qo(t)),Mi.component(t)?n(t):n("")}},Tc={functional:!0,props:{slotKey:String,required:!0},render:function(n,t){var e=t.props,r=t.slots;return n("div",{class:["content__".concat(e.slotKey)]},r()[e.slotKey])}},jc={computed:{openInNewWindowTitle:function(){return this.$themeLocaleConfig.openNewWindowText||"(opens new window)"}}},Cc=(e(405),e(406),Object(ac.a)(jc,(function(){var n=this.$createElement,t=this._self._c||n;return t("span",[t("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"}},[t("path",{attrs:{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}}),this._v(" "),t("polygon",{attrs:{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}})]),this._v(" "),t("span",{staticClass:"sr-only"},[this._v(this._s(this.openInNewWindowTitle))])])}),[],!1,null,null,null).exports);function Ic(){return(Ic=Object(i.a)(Object(r.a)().mark((function n(t){var e,i,a,o;return Object(r.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e="undefined"!=typeof window&&window.__VUEPRESS_ROUTER_BASE__?window.__VUEPRESS_ROUTER_BASE__:cc.routerBase||cc.base,xc(i=new To({base:e,mode:"history",fallback:!1,routes:sc,scrollBehavior:function(n,t,e){return e||(n.hash?!Mi.$vuepress.$get("disableScrollBehavior")&&{selector:decodeURIComponent(n.hash)}:{x:0,y:0})}})),a={},n.prev=4,n.next=7,Promise.all(hc.filter((function(n){return"function"==typeof n})).map((function(n){return n({Vue:Mi,options:a,router:i,siteData:cc,isServer:t})})));case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(4),console.error(n.t0);case 12:return o=new Mi(Object.assign(a,{router:i,render:function(n){return n("div",{attrs:{id:"app"}},[n("RouterView",{ref:"layout"}),n("div",{class:"global-ui"},mc.map((function(t){return n(t)})))])}})),n.abrupt("return",{app:o,router:i});case 14:case"end":return n.stop()}}),n,null,[[4,9]])})))).apply(this,arguments)}Mi.config.productionTip=!1,Mi.use(To),Mi.use(kc),Mi.mixin(function(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Mi;jo(t),e.$vuepress.$set("siteData",t);var r=n(e.$vuepress.$get("siteData")),i=new r,a=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(i)),o={};return Object.keys(a).reduce((function(n,t){return t.startsWith("$")&&(n[t]=a[t].get),n}),o),{computed:o}}((function(n){return function(){function t(){us(this,t)}return ds(t,[{key:"setPage",value:function(n){this.__page=n}},{key:"$site",get:function(){return n}},{key:"$themeConfig",get:function(){return this.$site.themeConfig}},{key:"$frontmatter",get:function(){return this.$page.frontmatter}},{key:"$localeConfig",get:function(){var n,t,e=this.$site.locales,r=void 0===e?{}:e;for(var i in r)"/"===i?t=r[i]:0===this.$page.path.indexOf(i)&&(n=r[i]);return n||t||{}}},{key:"$siteTitle",get:function(){return this.$localeConfig.title||this.$site.title||""}},{key:"$canonicalUrl",get:function(){var n=this.$page.frontmatter.canonicalUrl;return"string"==typeof n&&n}},{key:"$title",get:function(){var n=this.$page,t=this.$page.frontmatter.metaTitle;if("string"==typeof t)return t;var e=this.$siteTitle,r=n.frontmatter.home?null:n.frontmatter.title||n.title;return e?r?r+" | "+e:e:r||"VuePress"}},{key:"$description",get:function(){var n=function(n){if(n){var t=n.filter((function(n){return"description"===n.name}))[0];if(t)return t.content}}(this.$page.frontmatter.meta);return n||(this.$page.frontmatter.description||this.$localeConfig.description||this.$site.description||"")}},{key:"$lang",get:function(){return this.$page.frontmatter.lang||this.$localeConfig.lang||"en-US"}},{key:"$localePath",get:function(){return this.$localeConfig.path||"/"}},{key:"$themeLocaleConfig",get:function(){return(this.$site.themeConfig.locales||{})[this.$localePath]||{}}},{key:"$page",get:function(){return this.__page?this.__page:function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.path.toLowerCase()===t.toLowerCase())return r}return{path:"",frontmatter:{}}}(this.$site.pages,this.$route.path)}}]),t}()}),cc)),Mi.component("Content",Sc),Mi.component("ContentSlotsDistributor",Tc),Mi.component("OutboundLink",Cc),Mi.component("ClientOnly",{functional:!0,render:function(n,t){var e=t.parent,r=t.children;if(e._isMounted)return r;e.$once("hook:mounted",(function(){e.$forceUpdate()}))}}),Mi.component("Layout",Vo("Layout")),Mi.component("NotFound",Vo("NotFound")),Mi.prototype.$withBase=function(n){var t=this.$site.base;return"/"===n.charAt(0)?t+n.slice(1):n},window.__VUEPRESS__={version:"1.9.7",hash:"295d5b8"},function(n){return Ic.apply(this,arguments)}(!1).then((function(n){var t=n.app;n.router.onReady((function(){t.$mount("#app")}))}))}]);